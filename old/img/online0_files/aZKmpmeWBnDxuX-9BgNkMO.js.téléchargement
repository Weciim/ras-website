if (self.CavalryLogger) { CavalryLogger.start_js(["XxkFP"]); }

__d("DetectBrokenProxyCache",["AsyncSignal","Cookie","URI"],(function(a,b,c,d,e,f){var g;function a(a,c){var d=b("Cookie").get(c);if(d!=a&&d!=null&&a!="0"){c={c:"si_detect_broken_proxy_cache",m:c+" "+a+" "+d};a=new(g||(g=b("URI")))("/common/scribe_endpoint.php").getQualifiedURI().toString();new(b("AsyncSignal"))(a,c).send()}}e.exports={run:a}}),null);
__d("XUpdateTimezoneControllerRouteBuilder",["jsExtraRouteBuilder"],(function(a,b,c,d,e,f){a=b("jsExtraRouteBuilder")("/ajax/autoset_timezone_ajax/",Object.freeze({is_forced:!1}),["/ajax/autoset_timezone_ajax.php","/ajax/timezone/update/","/ajax/timezone/update.php"],void 0);c=a;e.exports=c}),null);
__d("FleetBeaconSubscriptionNetwork_LogMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"FleetBeaconLogResponsePayload",kind:"LinkedField",name:"fleet_beacon_log",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_LogMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_LogMutation",selections:b},params:{id:"3531482613593478",metadata:{},name:"FleetBeaconSubscriptionNetwork_LogMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork_PublishMutation.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"FleetBeaconPublishResponsePayload",kind:"LinkedField",name:"fleet_beacon_publish",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"success",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_PublishMutation",selections:b,type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_PublishMutation",selections:b},params:{id:"3253299374687488",metadata:{},name:"FleetBeaconSubscriptionNetwork_PublishMutation",operationKind:"mutation",text:null}}}();e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork_Subscription.graphql",[],(function(a,b,c,d,e,f){"use strict";a=function(){var a=[{defaultValue:null,kind:"LocalArgument",name:"input"}],b=[{alias:null,args:[{kind:"Variable",name:"data",variableName:"input"}],concreteType:"TestFleetBeaconSubscribeResponsePayload",kind:"LinkedField",name:"test_fleet_beacon_subscribe",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"client_subscription_id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"test_id",storageKey:null}],storageKey:null}];return{fragment:{argumentDefinitions:a,kind:"Fragment",metadata:null,name:"FleetBeaconSubscriptionNetwork_Subscription",selections:b,type:"Subscription",abstractKey:null},kind:"Request",operation:{argumentDefinitions:a,kind:"Operation",name:"FleetBeaconSubscriptionNetwork_Subscription",selections:b},params:{id:"3194829573871785",metadata:{subscriptionName:"test_fleet_beacon_subscribe"},name:"FleetBeaconSubscriptionNetwork_Subscription",operationKind:"subscription",text:null}}}();e.exports=a}),null);
__d("CometVirtualCursorStatus",["requireCond","cr:1345969","UserAgent","setTimeout"],(function(a,b,c,d,e,f){"use strict";f.initLogging=d;var g=b("cr:1345969").log,h=null,i=null;function j(){i||(i=window.addEventListener("blur",function(){h=null,k()}))}function k(){i&&(i.remove(),i=null)}function a(a){h=a.keyCode,j()}function c(a){h=null,k()}if(typeof window!=="undefined"&&window.document&&window.document.createElement){e=document.documentElement;if(e)if(e.addEventListener)e.addEventListener("keydown",a,!0),e.addEventListener("keyup",c,!0);else if(e.attachEvent){f=e.attachEvent;f("onkeydown",a);f("onkeyup",c)}}var l={getKeyDownCode:function(){return h},isKeyDown:function(){return!!h}},m=!1,n=!1,o=null,p=!1;function q(a){var c=new Set(),d=l.isKeyDown(),e=a.WEBKIT_FORCE_AT_MOUSE_DOWN,f=a.clientX,g=a.clientY,h=a.isTrusted,i=a.mozInputSource,j=a.offsetX,k=a.offsetY,o=a.webkitForce;f===0&&g===0&&j>=0&&k>=0&&n&&h&&i==null&&c.add("Chrome");m&&n&&!d&&o!=null&&o<e&&j===0&&k===0&&i==null&&c.add("Safari-edge");f===0&&g===0&&j<0&&k<0&&n&&i==null&&c.add("Safari-old");if(!m&&!n&&!d&&h&&b("UserAgent").isBrowser("IE >= 10")&&i==null){o=a.target;e=o.clientHeight;d=o.clientWidth;f<0&&g<0?c.add("IE"):(j<0||j>d)&&(k<0||k>e)&&c.add("MSIE")}i===0&&h&&c.add("Firefox");return c}function r(){m=!0,b("setTimeout")(function(){m=!1},0)}function s(){n=!0,b("setTimeout")(function(){n=!1},0)}function t(a){p&&g({extra_data:{source_app:"comet"},indicated_browsers:o,is_virtual_cursor_action:a})}function u(a){o===null&&(o=Array.from(q(a)));p=o!=null&&o.length>0;a=a.target!=null&&a.target.getAttribute!=null&&a.target.getAttribute("data-accessibilityid")==="virtual_cursor_trigger";t(a);b("setTimeout")(function(){p=!1,o=null},0)}function d(){document.addEventListener("click",u,!0),document.addEventListener("mousedown",r,!0),document.addEventListener("mouseup",s,!0)}}),null);
__d("getBrowserTimezone",["FBLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){try{var a;a=((a=window.Intl)==null?void 0:a.DateTimeFormat)&&Intl.DateTimeFormat();a=(a==null?void 0:a.resolvedOptions)&&a.resolvedOptions();return a==null?void 0:a.timeZone}catch(a){b("FBLogger")("TimezoneAutoset").catching(a).warn("Could not read IANA timezone from browser");return null}}}),null);
__d("CometTimezoneUpdater",["UserTimezoneServerTimeData","XUpdateTimezoneControllerRouteBuilder","cometAsyncFetch","getBrowserGMTOffsetAdjustedForSkew","getBrowserTimezone","killswitch"],(function(a,b,c,d,e,f){"use strict";function a(){var a,c=(a=b("UserTimezoneServerTimeData")).force_update,d=a.server_gmt_offset,e=a.server_time;a=a.timezone;if(e==null||d==null)return;e=-b("getBrowserGMTOffsetAdjustedForSkew")(e);var f=b("killswitch")("TIMEZONE_SET_IANA_ZONE_NAME")?null:b("getBrowserTimezone")();(c===!0||e!==d||f!=null&&f!==a)&&b("cometAsyncFetch")(b("XUpdateTimezoneControllerRouteBuilder").buildExtraURL("/ajax/timezone/update.php",{}),{data:{gmt_off:e,is_forced:c,tz:f},method:"POST"})}c={updateTimezoneIfNecessary:a};d=c;e.exports=d}),null);
__d("CometAlertDialogImpl.react",["fbt","CometCardedDialog.react","CometRow.react","CometRowItem.react","React","TetraButton.react","TetraText.react","stylex"],(function(a,b,c,d,e,f,g){"use strict";e.exports=a;var h=b("React");function a(a){var c=a.body,d=a.close,e=a.onClose;a=a.title;return h.jsxs(b("CometCardedDialog.react"),{onClose:e,withCloseButton:!0,children:[h.jsx("div",{className:"bjjx79mm dati1w0a clqubjjj jbae33se",children:h.jsx(b("TetraText.react"),{numberOfLines:1,type:"headlineEmphasized2",children:a})}),h.jsx("div",{className:"l9j0dhe7 dati1w0a f10w8fjw hv4rvrfc pybr56ya",children:h.jsx(b("TetraText.react"),{type:"body3",children:c})}),h.jsx("div",{className:"a8nywdso ihqw7lf3 rz4wbd8a jb3vyjys",children:h.jsx(b("CometRow.react"),{align:"end",children:h.jsx(b("CometRowItem.react"),{children:h.jsx(b("TetraButton.react"),{label:(a=d)!=null?a:g._("Fermer"),onPress:e,testid:void 0,type:"primary"})})})})]})}}),null);
__d("CometIconWirelessSlashFilled.react",["CometSVGIcon.react","React"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=b("React");function a(a){return g.jsx(b("CometSVGIcon.react"),babelHelpers["extends"]({viewBox:"0 0 24 24"},a,{children:g.jsx("path",{d:"M23.7805.2195c.2925.293.2925.768 0 1.061l-22.5 22.5C1.134 23.927.942 24 .75 24c-.192 0-.384-.073-.5305-.2195-.2925-.293-.2925-.768 0-1.061l12.1967947-12.1971509c-2.3773758-.1150468-4.79162015.7286756-6.6038447 2.5401009-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.024 0-1.414 2.65728981-2.65728981 6.3696459-3.62280965 9.8005664-2.90852144l2.430738-2.43186193C11.7816792 4.58111626 6.15198938 5.65271062 2.27735 9.52735c-.3905.3905-1.0235.3905-1.414 0-.3905-.3905-.3905-1.0235 0-1.414 4.6714534-4.67191574 11.571522-5.78608437 17.3096457-3.34843552L22.7195.2195c.293-.2925.768-.2925 1.061 0zM12 18.5c.6905 0 1.25.5595 1.25 1.25S12.6905 21 12 21s-1.25-.5595-1.25-1.25.5595-1.25 1.25-1.25zm1.4175-4.81495c.9705.2455 1.8905.741 2.6485 1.499.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.512-.0975-.707-.293-.7835333-.7835333-1.8301422-1.1445778-2.8581093-1.0880116L11.574 15.52855l1.8435-1.8435zm3.8154-3.8154c.848.4725 1.649 1.059 2.3685 1.779.391.39.391 1.023 0 1.414-.195.195-.451.293-.707.293-.2555 0-.5115-.098-.707-.293-.7285-.728-1.5575-1.291-2.439-1.7085zm2.1908-2.1908l1.4425-1.4425c.8.545 1.5615 1.168 2.2705 1.877.3905.3905.3905 1.0235 0 1.414-.1955.1955-.451.293-.707.293-.256 0-.5115-.0975-.707-.293-.5933333-.59333333-1.2283333-1.11861111-1.895162-1.57959491L19.4237 7.67885l1.4425-1.4425z"})}))}}),null);
__d("CometGHLTestUBT",["Banzai","JSScheduler","ghlTestUBT"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=3;function a(){b("JSScheduler").scheduleLoggingPriCallback(function(){b("ghlTestUBT")(function(a){var c;return b("Banzai").post("search_check",(c={},c[g]=a,c))})})}}),null);
__d("CometErrorLogging",["ClientConsistency","ErrorPoster","ErrorPubSub","JSErrorLoggingConfig","SiteData","WebSession"],(function(a,b,c,d,e,f){"use strict";f.init=a;var g,h=(c=b("JSErrorLoggingConfig")).appId,i=c.extra,j=c.report_source,k=c.report_source_ref,l=c.sampleWeight,m;function n(a){b("ErrorPoster").postError(a,{additional_client_revisions:b("ClientConsistency").getAdditionalRevisions(),appId:h,cavalry_lid:m,cerror:!0,client_revision:(a=b("SiteData")).client_revision,extra:i,loggingFramework:"comet",push_phase:a.push_phase,report_source:j,report_source_ref:k,sample_weight:l,script_path:"/comet",server_revision:a.server_revision,spin:a.spin,web_session_id:b("WebSession").getId()})}function a(a){m=a,l!=null&&(g||(g=b("ErrorPubSub"))).addListener(n)}}),null);
__d("CometBootloaderEventsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:CometBootloaderEventsLoggerConfig")}),null);
__d("HasteResponseFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1823926");c=b("FalcoLoggerInternal").create("haste_response",a);e.exports=c}),null);
__d("CometBootloaderLoggerUtil",["BootloaderEvents","BootloaderEventsPerf","CometBootloaderEventsTypedLoggerLite","CometTimeSpentNavigation","HasteResponseFalcoEvent","SiteData","performanceNavigationStart"],(function(a,b,c,d,e,f){"use strict";f.initLogging=a;var g=!1;function a(a){var c=a.bl_sample_rate,d=a.hr_sample_rate,e=a.parent_lid;if(g||!(c||d))return;g=!0;var f=function(a){return{ms_since_navstart:Math.round(a-b("performanceNavigationStart")()),parent_lid:e,pkg_cohort:b("SiteData").pkg_cohort,request_path:(a=b("CometTimeSpentNavigation").getPathInfo())==null?void 0:a.name,svn_rev:b("SiteData").client_revision}};d&&b("BootloaderEvents").onHasteResponse(function(a){return b("HasteResponseFalcoEvent").log(function(){var c=b("BootloaderEventsPerf").computeHRData(a),d=b("BootloaderEventsPerf").flattenData(c);return babelHelpers["extends"]({},d,f(c.start_time))})});c&&b("BootloaderEvents").onBootload(function(a){a=b("BootloaderEventsPerf").computeBLData(a);var d=b("BootloaderEventsPerf").flattenData(a);b("CometBootloaderEventsTypedLoggerLite").log(babelHelpers["extends"]({},d,f(a.start_time)),{weight:c})})}}),null);
__d("CometPixelRatioUpdater",["Cookie","Run"],(function(a,b,c,d,e,f){"use strict";f.startDetecting=a;var g="dpr";function h(a){b("Cookie").set(g,String(a))}function i(){b("Cookie").clear(g)}function j(){window.devicePixelRatio!==1?h(window.devicePixelRatio):i()}function a(){b("Run").onBeforeUnload(j,!1),"onpagehide"in window&&window.addEventListener("pageHide",j)}}),null);
__d("CometNetworkStatusToast",["ix","fbt","CometIconWirelessSlashFilled.react","CometRelayEnvironmentFactory","CometToasterStateManager","NetworkStatus","React","TetraIcon.react","cometPushToast","fbicon"],(function(a,b,c,d,e,f,g,h){"use strict";f.subscribe=a;var i=b("React"),j=null;function k(a){a=a.online;var c=b("CometToasterStateManager").getInstance();j!=null&&(c.expire(j),j=null);j=a?b("cometPushToast").cometPushToast({icon:i.jsx(b("TetraIcon.react"),{color:"positive",icon:b("fbicon")._(g("485124"),24)}),message:h._("Votre connexion Internet a \u00e9t\u00e9 restaur\u00e9e.")},4e3,c):b("cometPushToast").cometPushToast({action:{label:h._("Actualiser"),onPress:function(){b("CometRelayEnvironmentFactory").commitLocalUpdateForEachEnvironment(function(a,b,c){c.invalidateStore()})}},icon:i.jsx(b("TetraIcon.react"),{color:"disabled",icon:b("CometIconWirelessSlashFilled.react"),size:24}),message:h._("Vous \u00eates actuellement hors ligne.")},Infinity,c)}function a(){b("NetworkStatus").onChange(k)}}),null);
__d("SimplePageLoadLogger",["ODS","performance"],(function(a,b,c,d,e,f){"use strict";f.logPageNavigationType=a;var g;function a(){b("ODS").bumpEntityKey(1678,"www_client_navigations",h())}function h(){if((g||(g=b("performance"))).navigation==null||(g||(g=b("performance"))).navigation.type==null)return"UNSUPPORTED";switch((g||(g=b("performance"))).navigation.type){case(g||(g=b("performance"))).navigation.TYPE_NAVIGATE:return"NAVIGATE";case(g||(g=b("performance"))).navigation.TYPE_RELOAD:return"RELOAD";case(g||(g=b("performance"))).navigation.TYPE_BACK_FORWARD:return"BACK_FORWARD";case(g||(g=b("performance"))).navigation.TYPE_RESERVED:return"RESERVED";default:return"UNKNOWN"}}}),null);
__d("CometRootDeferred",["CometBootloaderLoggerUtil","requireCond","CometErrorRoot.react","CometFullPageCompatRoot.react","CometVirtualCursorStatus","CometVCTracker","DeferredCookie","DetectBrokenProxyCache","ErrorGuard","JSScheduler","cr:1201738","cr:1813330","CometTimezoneUpdater","CometNetworkStatusToast","SimplePageLoadLogger","SketchComet","WebStorageMonster","cr:1332233","cr:1516609","cr:1632385"],(function(a,b,c,d,e,f){"use strict";f.initDeferred=a;var g;b("CometErrorRoot.react");b("CometFullPageCompatRoot.react");var h=b("CometVCTracker").CometVisualCompletionTraceObserver;function a(a){var c=a.blLoggingCavalryFields,d=a.deferredCookies,e=a.sketchInfo,f=a.userID;e!=null&&b("JSScheduler").scheduleSpeculativeCallback(function(){b("SketchComet").solveAllPrimitivesAndCallAsyncController(e.seed1,e.seed2,e.rounds)});b("cr:1632385")!=null&&(g||(g=b("ErrorGuard"))).applyWithGuard(function(){return b("cr:1632385").init()},null,[]);(g||(g=b("ErrorGuard"))).applyWithGuard(function(){return b("CometBootloaderLoggerUtil").initLogging(c)},null,[]);g.applyWithGuard(function(){return b("CometVirtualCursorStatus").initLogging()},null,[]);g.applyWithGuard(function(){return b("CometNetworkStatusToast").subscribe()},null,[]);g.applyWithGuard(function(){return b("SimplePageLoadLogger").logPageNavigationType()},null,[]);b("JSScheduler").scheduleSpeculativeCallback(function(){b("WebStorageMonster").schedule()});b("JSScheduler").scheduleSpeculativeCallback(function(){b("DetectBrokenProxyCache").run(f,"c_user")});b("cr:1201738")&&h.subscribe(function(a){a.interactionType==="INITIAL_LOAD"&&b("cr:1201738").init()});Object.keys(d).forEach(function(a){var c=d[a],e=c.expiration_for_js,f=c.first_party_only,g=c.path,h=c.secure;c=c.value;b("DeferredCookie").addToQueue(a,c,e,g,f,!1,h)});b("cr:1332233")&&(g||(g=b("ErrorGuard"))).applyWithGuard(function(){return b("cr:1332233")()},null,[]);b("cr:1516609")!=null&&(g||(g=b("ErrorGuard"))).applyWithGuard(function(){return b("cr:1516609").initSignalCollection()},null,[]);b("cr:1813330")&&(g||(g=b("ErrorGuard"))).applyWithGuard(function(){return b("cr:1813330").init()},null,[]);b("CometTimezoneUpdater").updateTimezoneIfNecessary()}}),null);
__d("WebBrowserDimensionsTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:WebBrowserDimensionsLoggerConfig")}),null);
__d("CometBrowserDimensionsLogger",["SiteData","WebBrowserDimensionsTypedLoggerLite","getViewportDimensions"],(function(a,b,c,d,e,f){"use strict";f.init=a;var g=null;function h(){g===null&&(g=b("getViewportDimensions")());return g}function a(a){var c,d=h();c={client_hint_width:a==null?void 0:a.clientHintWidth,pixel_ratio:(c=window.devicePixelRatio)!=null?c:1,screen_x:window.screen.width,screen_y:window.screen.height,server_pixel_ratio:b("SiteData").pr,server_viewport_x:a==null?void 0:a.viewportWidth,server_viewport_y:a==null?void 0:a.viewportHeight,viewport_x:d.width,viewport_y:d.height};window.navigator&&window.navigator.hardwareConcurrency&&(c.cpu_cores_count=window.navigator.hardwareConcurrency);if(window.innerWidth>0&&window.outerWidth>0){a=Math.round(window.outerWidth/window.innerWidth*100)/100;c.zoom_ratio=a}if(window.getComputedStyle&&document.documentElement!=null){d=window.getComputedStyle(document.documentElement);d!=null&&(c.document_font_size=d.fontSize)}b("WebBrowserDimensionsTypedLoggerLite").log(c)}}),null);
__d("MWChatMultitabCookieWriter.bs",["DeferredCookie","MWChatThreadId.bs","recoverableViolation"],(function(a,b,c,d,e,f){"use strict";function a(a){var c=a.chatHeads.map(function(a){return{i:b("MWChatThreadId.bs").serializeFuture(a)}});a=a.openTabsState;var d;if(a.length!==1)d=void 0;else{a=a[0];a=a.threadID;d=a?b("MWChatThreadId.bs").serializeFuture(a._0):void 0}a=JSON.stringify({t3:c,utc3:Date.now(),lm3:d,v:1});a!==void 0?b("DeferredCookie").addToQueue("presence","C"+a,0,"",!1,!1,!0):b("recoverableViolation")("Failed to serialize cookie","messenger_comet")}c=1;f.version=c;f.write=a}),null);
__d("XDeviceClassRealtimeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/web_perf/get_perf_level/",{})}),null);
__d("getEarlyResources",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return Array.from(document.querySelectorAll("head script[data-bootloader-hash]"))}}),null);
__d("WebDevicePerfInfoLogging",["regeneratorRuntime","Promise","AsyncTypedRequest","Banzai","JSScheduler","VisibilityListener","WebDevicePerfInfoData","XDeviceClassRealtimeController","getEarlyResources"],(function(a,b,c,d,e,f){"use strict";f.doLog=a;f.doLogPromise=c;function g(a){var b=document.createElement("canvas");b=b.getContext("webgl")||b.getContext("experimental-webgl");if(!b)return;var c=b.getExtension("WEBGL_debug_renderer_info");if(!c)return;var d=b.getParameter(c.UNMASKED_RENDERER_WEBGL);b=b.getParameter(c.UNMASKED_VENDOR_WEBGL);a.gpu_vendor=b;a.gpu_renderer=d}function h(a){var c=window.performance.getEntriesByType("resource"),d=b("getEarlyResources")(),e={};d.forEach(function(a){a=a.getAttribute("src");a!==null&&a!==void 0&&(e[a]=!0)});var f=0,g=0,h=0,i=0;c.forEach(function(a){if(e[a.name]===!0){var c=b("VisibilityListener").getHiddenTime(a.startTime,a.responseEnd);c=c!=null&&c>0;if(!c){c=a.transferSize===0;var d=a.transferSize<a.encodedBodySize,j=a.responseEnd-a.responseStart;c?(f+=a.encodedBodySize/j,g++):d||(h+=a.transferSize/j,i++)}}});g>0&&(a.cached_speed_sample=f/g,a.cached_file_count=g);i>0&&(a.remote_speed_sample=h/i,a.remote_file_count=i)}function i(){var a={};navigator&&navigator.hardwareConcurrency!==void 0&&(a.cpu_cores=navigator.hardwareConcurrency);navigator&&navigator.deviceMemory!==void 0&&(a.ram=navigator.deviceMemory);b("WebDevicePerfInfoData").needsFullUpdate&&g(a);return a}function j(){var a=i();b("WebDevicePerfInfoData").shouldLogResourcePerf&&h(a);b("Banzai").post("web_device_perf_info_log",a)}function k(){var a,c;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:a=i();d.next=3;return b("regeneratorRuntime").awrap(new(b("AsyncTypedRequest"))(b("XDeviceClassRealtimeController").getURIBuilder().getURI()).setData(a).promisePayload());case 3:c=d.sent;return d.abrupt("return",c.devicePerfClassLevel);case 5:case"end":return d.stop()}},null,this)}function a(){(b("WebDevicePerfInfoData").needsFullUpdate||b("WebDevicePerfInfoData").needsPartialUpdate||b("WebDevicePerfInfoData").shouldLogResourcePerf)&&b("JSScheduler").scheduleSpeculativeCallback(j)}function c(){return new(b("Promise"))(function(a,c){b("WebDevicePerfInfoData").needsFullUpdate||b("WebDevicePerfInfoData").needsPartialUpdate?b("JSScheduler").scheduleSpeculativeCallback(function(){k().then(a)["catch"](c)}):c()})}}),null);
__d("BladeRunnerConfig",["RTISubscriptionManagerConfig","WebDriverConfig","err","isEmpty"],(function(a,b,c,d,e,f){var g,h="javascript-sandbox",i="OverrideServer";a=function(){function a(){}var c=a.prototype;c.patchRequestHeaders=function(a){var c={},d=b("RTISubscriptionManagerConfig").bladerunner_www_sandbox;if(!(g||(g=b("isEmpty")))(b("WebDriverConfig").auxiliaryServiceInfo)){var e;e=(e=b("WebDriverConfig").auxiliaryServiceInfo.BladeRunner)!=null?e:b("WebDriverConfig").auxiliaryServiceInfo["BladeRunner-sandcastle"];e!=null&&typeof e.ip_address==="string"&&(c[i]=e.ip_address+":18293")}else d!=null&&(c[h]=d);for(var f in a)c[f]=a[f];return c};return a}();c=new a();d=c;e.exports=d}),null);
__d("MqttPublishListener",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({NOT_CONNECTED:"NOT_CONNECTED",PUBLISH_ERROR:"PUBLISH_ERROR",QUEUED:"QUEUED",SENT:"SENT",ACKED:"ACKED",NOT_ACKED:"NOT_ACKED"});f.MqttPublishEvent=a}),null);
__d("RequestStreamE2EClientLoggerEvent",[],(function(a,b,c,d,e,f){a=Object.freeze({RECEIVED:"received",SENT:"sent",FAILURE:"failure",PUBACK:"puback"});e.exports=a}),null);
__d("RequestStreamE2EClientLoggerMessageType",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUEST_STREAM:"request_stream",AMENDMENT:"amendment",AMENDMENT_ACK:"amendment_ack",CANCEL:"cancel",RESPONSE:"response",RESPONSE_ACK:"response_ack",TIMED_REQUEST:"timed_request",INTERRUPT:"interrupt"});e.exports=a}),null);
__d("BladeRunnerLogger",["BanzaiLogger","BladeRunnerTypes","FBLogger","MqttPublishListener","ODS","Random","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","RequestStreamE2EClientSamplingConfig"],(function(a,b,c,d,e,f){var g="bladerunner_js_client",h={info:"info",warning:"warning",exception:"exception"};a=function(){function a(){this.setFBLoggerLevel(1)}var c=a.prototype;c.info=function(a){this.$2>=2&&b("FBLogger")(g).info("BladeRunner info: %s",a),this.$3(h.info,a)};c.warn=function(a){this.$2>=1&&b("FBLogger")(g).warn("BladeRunner warn: %s",a),this.$3(h.warning,a)};c.exception=function(a,c){c===void 0&&(c="");var d=c+" "+a.toString();this.$2>=0&&b("FBLogger")(g).warn("BladeRunner exception: %s, %s",c,a.toString());this.$3(h.exception,d)};c.trimForLogging=function(a){var b=1024;return typeof a==="string"&&a.length>b?"[trimmed]:"+a.substring(0,b)+"...":a};c.bumpCounter=function(a,c){c===void 0&&(c=1),b("ODS").bumpEntityKey(2966,"BladeRunnerClient",a,c)};c.setClientSessionId=function(a){this.$1=a};c.setFBLoggerLevel=function(a){this.$2=a};c.$3=function(a,b){};c.shouldLogE2E=function(a){var c=b("RequestStreamE2EClientSamplingConfig").sampleRate;if(c>1&&a!=null){a=b("RequestStreamE2EClientSamplingConfig").methodToSamplingMultiplier[a];a===0?c=0:a!=null&&(c/=a)}return b("Random").coinflip(c)};c.logE2EEvent=function(a,c,d,e,f){c===void 0&&(c=b("RequestStreamE2EClientLoggerEvent").RECEIVED);d===void 0&&(d=null);e===void 0&&(e=null);f===void 0&&(f=null);if(d==null)return;a={request_id:d.requestId,message_type:a,event:c,method:e,timestamp_ms:Date.now(),transport:"WEB_BR_MQTT"};d.auxId&&(a.aux_id=d.auxId);f!=null&&(a.additional_data=f);b("BanzaiLogger").log("RequestStreamE2EClientLoggerConfig",a)};c.logFrameWithMQTTEvent=function(a,c,d){switch(c){case b("MqttPublishListener").MqttPublishEvent.SENT:this.logFrame(a,b("RequestStreamE2EClientLoggerEvent").SENT,d);break;case b("MqttPublishListener").MqttPublishEvent.ACKED:this.logFrame(a,b("RequestStreamE2EClientLoggerEvent").PUBACK,d);break;case b("MqttPublishListener").MqttPublishEvent.NOT_ACKED:case b("MqttPublishListener").MqttPublishEvent.NOT_CONNECTED:case b("MqttPublishListener").MqttPublishEvent.PUBLISH_ERROR:this.logFrameFailure(a,c,d)}};c.logFrameFailure=function(a,c,d){this.logFrame(a,b("RequestStreamE2EClientLoggerEvent").FAILURE,babelHelpers["extends"]({},d,{reason:c}))};c.logFrame=function(a,c,d){d===void 0&&(d=null);var e=null,f=null,g=null;switch(a.type){case b("BladeRunnerTypes").StreamFrameType.REQUEST:e=b("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM;var h=a.getRequest();f=h.getHeaders().method;g=h.getInstrumentationData();break;case b("BladeRunnerTypes").StreamFrameType.DATA:e=b("RequestStreamE2EClientLoggerMessageType").AMENDMENT;g=a.getData().getInstrumentationData();break}g!=null&&e!=null&&this.logE2EEvent(e,c,g,f,d)};return a}();c=new a();d=c;e.exports=d}),null);
__d("BladeRunnerTypesInternal",["Base64","BladeRunnerLogger","BladeRunnerTypes"],(function(a,b,c,d,e,f){var g=function(){function a(){}var b=a.prototype;b.getHeaders=function(){if(this.headers!=null)return this.headers;throw new Error("Expected headers")};b.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};a.readObject=function(b){var c=new a();c.streamId=n(b.streamId);c.requestType=n(b.requestType);c.payload=q(b.payload);c.headers=t(b.headers);c.extraHeader=q(b.extraHeader);c.requestTarget=q(b.requestTarget);c.instrumentationData=q(b.instrumentationData);return c};return a}();f.GatewayStreamRequest=g;var h=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=n(b.streamId);c.dataId=o(b.dataId);c.data=q(b.data);c.shouldAck=v(b.shouldAck);return c};var c=a.prototype;c.rawData=function(){if(this.data==null)throw new Error("Expected data");return this.data};c.decodeData=function(){if(this.data==null)throw new Error("Expected data");return b("Base64").decode(this.data)};c.setData=function(a){this.data=b("Base64").encode(a)};c.getInstrumentationData=function(){if(this.instrumentationData!=null)return JSON.parse(this.instrumentationData);else return null};return a}();f.GatewayStreamData=h;var i=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=n(b.streamId);c.dataId=n(b.dataId);c.success=u(b.success);c.message=q(b.message);c.code=o(b.code);return c};return a}();f.GatewayStreamDataAck=i;i.ACK_CODE_LANDED_AND_ACCEPTED=20;i.ACK_CODE_LANDED_BUT_NOT_ACCEPTED=21;i.ACK_CODE_FAILED_TO_LAND=50;var j=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=o(b.streamId);c.message=q(b.message);return c};return a}();f.GatewayStreamLog=j;var k=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=n(b.streamId);c.status=n(b.status);c.message=q(b.message);c.code=o(b.code);c.shouldRetry=v(b.shouldRetry);c.retryDelayMs=o(b.retryDelayMs);return c};return a}();f.GatewayStreamStatusUpdate=k;var l=function(){function a(){}a.readObject=function(b){var c=new a();c.streamId=n(b.streamId);c.newBody=q(b.newBody);c.newExtraHeader=q(b.newExtraHeader);c.patchExtraHeader=q(b.patchExtraHeader);c.killBody=v(b.killBody);c.temporary=v(b.temporary);return c};return a}();f.GatewayStreamRewriteRequest=l;var m=function(){function a(){}var c=a.prototype;c.getRequest=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request;throw new Error("Expected request")};c.getData=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data;throw new Error("Expected data")};c.getDataAck=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck;throw new Error("Expected dataAck")};c.getStatusUpdate=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate;throw new Error("Expected status update")};c.getLog=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log;throw new Error("Expected log")};c.getRewriteRequest=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest;throw new Error("Expected rewrite request")};c.getStreamId=function(){if(this.type==b("BladeRunnerTypes").StreamFrameType.REQUEST&&this.request!=null)return this.request.streamId;if(this.type==b("BladeRunnerTypes").StreamFrameType.DATA&&this.data!=null)return this.data.streamId;if(this.type==b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE&&this.statusUpdate!=null)return this.statusUpdate.streamId;if(this.type==b("BladeRunnerTypes").StreamFrameType.LOG&&this.log!=null)return this.log.streamId;if(this.type==b("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST&&this.rewriteRequest!=null)return this.rewriteRequest.streamId;if(this.type==b("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.dataAck!=null)return this.dataAck.streamId;throw new Error("Frame with unexpected type")};c.isInstrumented=function(){if(this.type===b("BladeRunnerTypes").StreamFrameType.REQUEST)return this.getRequest().instrumentationData!=null;else if(this.type===b("BladeRunnerTypes").StreamFrameType.DATA)return this.getData().instrumentationData!=null;else return!1};a.readObject=function(c){var d=new a();d.type=n(c.type);switch(d.type){case b("BladeRunnerTypes").StreamFrameType.REQUEST:d.request=g.readObject(r(c.request));break;case b("BladeRunnerTypes").StreamFrameType.DATA:d.data=h.readObject(r(c.data));break;case b("BladeRunnerTypes").StreamFrameType.DATA_ACK:d.dataAck=i.readObject(r(c.dataAck));break;case b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:d.statusUpdate=k.readObject(r(c.statusUpdate));break;case b("BladeRunnerTypes").StreamFrameType.LOG:d.log=j.readObject(r(c.log));break;case b("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:d.rewriteRequest=l.readObject(r(c.rewriteRequest));break;default:b("BladeRunnerLogger").warn("Frame with unexpected type: "+d.type);return null}return d};a.newRequestFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.REQUEST;d.request=c;return d};a.newDataFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.DATA;d.data=c;return d};a.newDataAckFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.DATA_ACK;d.dataAck=c;return d};a.newStatusUpdateFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE;d.statusUpdate=c;return d};a.newLogFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.LOG;d.log=c;return d};a.newRewriteRequestFrame=function(c){var d=new a();d.type=b("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST;d.rewriteRequest=c;return d};return a}();f.GatewayStreamFrame=m;a=function(){function a(a,b,c){this.batchId=a,this.frames=b,this.instrumentationData=c}var b=a.prototype;b.getFrames=function(){if(this.frames!=null)return this.frames;throw new Error("Expected frames")};b.getInstrumentationData=function(){if(this.instrumentationData!=null)try{return JSON.parse(this.instrumentationData)}catch(a){return null}else return null};b.write=function(){return JSON.stringify(this)};b.isInstrumented=function(){return this.getFrames().some(function(a){return a.isInstrumented()})};a.read=function(b){b=JSON.parse(b);var c=b.batchId||0,d=[];for(var e=b.frames,f=Array.isArray(e),g=0,e=f?e:e[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=e.length)break;h=e[g++]}else{g=e.next();if(g.done)break;h=g.value}h=h;h=m.readObject(h);h!=null&&d.push(h)}h=b.instrumentationData||null;return new a(c,d,h)};return a}();f.GatewayStreamBatch=a;function n(a){if(typeof a==="number")return a;throw new Error("Expected number")}function o(a){return a==null?null:n(a)}function p(a){if(typeof a==="string")return a;throw new Error("Expected string")}function q(a){return a==null?null:p(a)}function r(a){if(typeof a==="object"&&a!=null)return a;throw new Error("Expected object")}function s(a){if(typeof a==="object"&&a!=null){var b=a,c={};Object.keys(b).forEach(function(a){var d=b[a];typeof d==="string"&&d!=null&&(c[a]=d)});return c}throw new Error("Expected string map")}function t(a){return a==null?null:s(a)}function u(a){if(typeof a==="boolean"&&a!=null)return a;throw new Error("Expected boolean")}function v(a){return a==null?null:u(a)}}),null);
__d("BladeRunnerEventHandler",["BladeRunnerLogger","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){var g=1e3;a=function(){function a(a,b,c){this.$2=a,this.$1=b,this.$3=c}var c=a.prototype;c.onProxyResponse=function(a){this.$4(a);var c=[];for(var d=a.getFrames(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;this.$2.witnessFrame(g)&&c.push(g)}b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").RESPONSE,b("RequestStreamE2EClientLoggerEvent").SENT,a.getInstrumentationData());c.length>0&&this.$5(new(b("BladeRunnerTypesInternal").GatewayStreamBatch)(a.batchId,c,a.instrumentationData))};c.onDisconnect=function(){this.$2.resetErrors();var a=new(b("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();a.streamId=this.$2.getRequest().streamId;a.status=b("BladeRunnerTypes").StreamStatus.CLOSED;a.shouldRetry=!0;a.retryDelayMs=0;a=new(b("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[b("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a)]);this.onProxyResponse(a)};c.$4=function(a){var c=this;a=a.getFrames().filter(function(a){return a.type==b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE});for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;f=f.getStatusUpdate();if(f.status==b("BladeRunnerTypes").StreamStatus.CLOSED||f.status==b("BladeRunnerTypes").StreamStatus.REJECTED){this.$2.onError();var h=f.shouldRetry!=null&&f.shouldRetry,i=f.message!=null?f.message:"null";if(h&&this.$2.getErrorCount()<=this.$2.getRetriesAllowed()){f.status=b("BladeRunnerTypes").StreamStatus.PAUSED;var j=g;f.retryDelayMs!=null&&(j=f.retryDelayMs);b("BladeRunnerLogger").info("Can retry: stream "+f.streamId+" closed with status "+f.status+", message "+i+". Error count: "+this.$2.getErrorCount()+", retryDelay "+j+"ms. Already retrying: "+this.$2.getRetryRequestScheduled().toString());this.$2.getRetryRequestScheduled()?b("BladeRunnerLogger").bumpCounter("stream_closed_already_retrying"):(b("BladeRunnerLogger").bumpCounter("stream_closed_will_retry"),this.$2.setRetryRequestScheduled(!0),j>0?b("setTimeoutAcrossTransitions")(function(){return c.$6()},j):this.$6())}else b("BladeRunnerLogger").info("Will not retry: stream "+f.streamId+" closed with status "+f.status+", message "+i+". Error count: "+this.$2.getErrorCount()+", shouldRetry "+h.toString()+". Already retrying: "+this.$2.getRetryRequestScheduled().toString()),h?b("BladeRunnerLogger").bumpCounter("stream_closed_retry_exceeded"):b("BladeRunnerLogger").bumpCounter("stream_closed_no_retry"),this.$3.removeStream(f.streamId)}}};c.$6=function(){this.$2.setRetryRequestScheduled(!1),this.$2.isAlive()&&this.$3.sendRetryStreamRequest(this.$2)};c.$5=function(a){b("BladeRunnerLogger").bumpCounter("send_to_handler");var c=[];this.$1.onBatch(a);for(var a=a.getFrames(),d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;try{switch(f.type){case b("BladeRunnerTypes").StreamFrameType.DATA:this.$1.onData(f.getData());c.push(f.getData());break;case b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:this.$1.onStatusUpdate(f.getStatusUpdate().status);break;case b("BladeRunnerTypes").StreamFrameType.LOG:f=f.getLog().message;f!=null&&this.$1.onLog(f);break;case b("BladeRunnerTypes").StreamFrameType.DATA_ACK:break;default:throw new Error("Frame with unexpected type")}}catch(a){b("BladeRunnerLogger").bumpCounter("send_to_handler_error"),b("BladeRunnerLogger").exception(a,"Failed sending frame to stream handler")}}this.$7(c)};c.$7=function(a){var c=[];for(var d=0;d<a.length;d++){var e=a[d];if(e.shouldAck===!0&&e.dataId!=null){var f=new(b("BladeRunnerTypesInternal").GatewayStreamDataAck)();f.streamId=e.streamId;f.dataId=e.dataId;f.success=!0;c.push(f)}}this.$3.sendDataAcks(c)};return a}();e.exports=a}),null);
__d("MqttEnv",["killswitch"],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({mqtt_waterfall_log_client_sampling:1,mqtt_ws_polling_enabled:3,mqtt_lp_use_fetch:9,mqtt_fast_lp:11,mqtt_lp_no_delay:12,mqtt_enable_publish_over_polling:13});f.MqttGkNames=a;c=function(){var a=c.prototype;a.random=function(){return this.$1!=null?this.$1():Math.random()};a.isUserLoggedInNow=function(){return this.$2!=null?this.$2():!0};a.clearTimeout=function(a){function b(b){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a){if(this.$3!=null){this.$3(a);return}clearTimeout(a)});a.setTimeout=function(a){function b(b,c){return a.apply(this,arguments)}b.toString=function(){return a.toString()};return b}(function(a,b){for(var c=arguments.length,d=new Array(c>2?c-2:0),e=2;e<c;e++)d[e-2]=arguments[e];return this.$4!=null?this.$4.apply(null,arguments):setTimeout.apply(null,arguments)});a.getLoggerInstance=function(){return this.$5!=null?this.$5():g.getInstance()};a.genGk=function(a){return this.$6!=null?this.$6(a):!1};a.killswitch=function(a){return this.$7!=null?this.$7(a):b("killswitch")(a)};a.createSocket=function(a,b){return this.$8!=null?this.$8(a,b):new WebSocket(a)};a.scheduleCallback=function(a){return this.$9!=null?this.$9(a):a()};a.scheduleLoggingCallback=function(a){return this.$10!=null?this.$10(a):a()};a.configRead=function(a,b){return this.$11!=null?this.$11(a,b):b};a.configWrite=function(a,b){this.$12!=null&&this.$12(a,b)};function c(){this.$1=null,this.$2=null,this.$3=null,this.$4=null,this.$5=null,this.$6=null,this.$7=null,this.$8=null,this.$9=null,this.$10=null,this.$11=null,this.$12=null}a.initialize=function(a,b,c,d,e,f,g,h,i,j,k,l){this.$1=a,this.$2=b,this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$7=l,this.$8=g,this.$9=h,this.$10=i,this.$11=j,this.$12=k};return c}();var g=function(){function a(){}a.getInstance=function(){return new a()};var b=a.prototype;b.setAppId=function(a){};b.eventLogConnect=function(a){};b.eventLogPull=function(a){};b.eventLogPullFinish=function(a){};b.eventLogDisconnect=function(a){};b.eventLogOutgoingPublish=function(a){};b.eventLogIncomingPublish=function(a){};b.eventLogPublishTimeout=function(a){};b.eventLogMiscellaneousError=function(a){};b.logIfLoggedOut=function(){};b.logError=function(a){};b.logErrorWarn=function(a){};b.logWarn=function(a){};b.debugTrace=function(a){};b.bumpCounter=function(a){};return a}();d=new c();f.Env=d}),null);
__d("IrisSubscribeChecker",["MqttEnv"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env;a=function(){function a(a){this.$1=g.getLoggerInstance();this.$2=null;this.$3=!1;this.$4=!1;this.$5=!1;this.$6=!0;this.$7=0;this.$8=a;if(typeof window!=="undefined"){a=window.location.hostname;(a==="m.facebook.com"||a==="mobile.facebook.com"||a==="mtouch.facebook.com")&&(this.$6=!1)}}var b=a.prototype;b.start=function(){this.$6=!0};b.stop=function(){this.$6=!1,this.$9()};b.onConnectAttempt=function(){};b.onConnectFailure=function(){this.$9()};b.onConnected=function(){var a=this;this.$7++;this.$9();this.$3=!1;this.$4=!1;this.$5=!1;this.$6&&(this.$2=g.setTimeout(function(){a.$10()},8e3))};b.onConnectSuccess=function(){};b.onConnectionLost=function(){this.$9()};b.onSubscribe=function(a){a==="/t_ms"&&(this.$3=!0)};b.onUnsubscribe=function(a){};b.onPublish=function(a){(a==="/messenger_sync_get_diffs"||a==="/messenger_sync_create_queue")&&(this.$4=!0,this.$3&&(this.$5=!0,this.$9()))};b.onMessage=function(a){};b.onWSFatal=function(){};b.$9=function(){this.$2&&(g.clearTimeout(this.$2),this.$2=null)};b.$10=function(){if(this.$4===!1){var a=this.$7==1?"no_iris_session_initialConnect":"no_iris_session";this.$1.bumpCounter(a);this.$1.eventLogMiscellaneousError({errorMessage:a});this.$8()?this.$1.bumpCounter(a+".withProvider"):this.$1.bumpCounter(a+".withoutProvider");this.$3===!0?this.$1.bumpCounter(a+".withTopicSubscribe"):this.$1.bumpCounter(a+".withoutTopicSubscribe")}this.$3===!1&&this.$1.bumpCounter("no_iris_topic_subscribe");this.$3===!0&&this.$4===!0&&this.$5===!1&&this.$1.bumpCounter("session_before_topic_subscribe")};return a}();e.exports=a}),null);
__d("MqttAnalyticsHook",["MqttEnv"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env;a=function(){function a(){this.$1=g.getLoggerInstance(),this.$2=0,this.$3=0,this.$4=0,this.$5=0,this.$1.bumpCounter("session_start"),g.isUserLoggedInNow()||this.$1.bumpCounter("session_start.logout")}var b=a.prototype;b.onConnectAttempt=function(){this.$1.bumpCounter("ws_connect_attempt")};b.onConnectFailure=function(){this.$3++,this.$1.bumpCounter("ws_connect_failure")};b.onConnected=function(){this.$1.bumpCounter("ws_connect_connected")};b.onConnectSuccess=function(){this.$2===0&&this.$1.bumpCounter("ws_connect_first_success"),this.$2++,this.$1.bumpCounter("ws_connect_success")};b.onConnectionLost=function(){this.$1.bumpCounter("ws_disconnect")};b.onSubscribe=function(a){};b.onUnsubscribe=function(a){};b.onPublish=function(a){this.$1.bumpCounter("ws_publish."+a)};b.onMessage=function(a){this.$1.bumpCounter("message_arrived."+a)};b.onWSFatal=function(){this.$1.bumpCounter("ws_fatal")};b.onPollRequestSent=function(){this.$1.bumpCounter("polling_request_send")};b.onPollRequestSuccess=function(){this.$1.bumpCounter("polling_request_succeed"),this.$4===0&&this.$1.bumpCounter("polling_first_success"),this.$4++};b.onPollResponse=function(a){this.$1.bumpCounter("lp.message_arrived."+a)};b.onPollFinish=function(){this.$1.bumpCounter("polling_request_finish")};b.onPollRequestFailed=function(a){this.$1.bumpCounter("polling_request_failed"),this.$1.bumpCounter("polling_request_failed_"+a),this.$5++};return a}();e.exports=a}),null);
__d("MqttConnectionHookCollection",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.addHook=function(a){this.$1.add(a)};b.removeHook=function(a){this.$1["delete"](a)};b.onConnectAttempt=function(){this.$1.forEach(function(a){a.onConnectAttempt()})};b.onConnectFailure=function(){this.$1.forEach(function(a){a.onConnectFailure()})};b.onConnected=function(){this.$1.forEach(function(a){a.onConnected()})};b.onConnectSuccess=function(){this.$1.forEach(function(a){a.onConnectSuccess()})};b.onConnectionLost=function(){this.$1.forEach(function(a){a.onConnectionLost()})};b.onSubscribe=function(a){this.$1.forEach(function(b){b.onSubscribe(a)})};b.onUnsubscribe=function(a){this.$1.forEach(function(b){b.onUnsubscribe(a)})};b.onPublish=function(a){this.$1.forEach(function(b){b.onPublish(a)})};b.onMessage=function(a){this.$1.forEach(function(b){b.onMessage(a)})};b.onWSFatal=function(){this.$1.forEach(function(a){a.onWSFatal()})};return a}();e.exports=a}),null);
__d("MqttProtocolUtils",["MqttEnv"],(function(a,b,c,d,e,f){var g=b("MqttEnv").Env;function a(a,b){if(a==null)return b;var c=new Uint8Array(a.length+b.length);c.set(a);c.set(b,a.length);return c}function c(a,b){b=b;var c=0,d=1,e;do{if(b===a.length)return null;e=a[b++];c+=(e&127)*d;d*=128}while((e&128)!==0);return{value:c,offset:b}}function d(a){a=a;var b=new Array(1);for(var c=0;c<4;c++){var d=a%128;a>>=7;if(a>0)b[c]=d|128;else{b[c]=d;break}}return b}function h(a,b,c){c=c;b[c++]=a>>8;b[c++]=a%256;return c}function f(a,b){return 256*a[b]+a[b+1]}function i(a){var b=0;for(var c=0,d=a.length;c<d;c++){var e=a.charCodeAt(c);e<128?b+=1:e<2048?b+=2:e>=55296&&e<=56319?(b+=4,c++):b+=3}return b}function j(a,b,c,d){d=h(b,c,d);k(a,c,d);return d+b}function k(a,b,c){c=c;for(var d=0,e=a.length;d<e;d++){var f=a.charCodeAt(d);f<128?b[c++]=f:f<2048?(b[c++]=192|f>>6,b[c++]=128|f&63):f<55296||f>=57344?(b[c++]=224|f>>12,b[c++]=128|f>>6&63,b[c++]=128|f&63):(f=65536+((f&1023)<<10|a.charCodeAt(++d)&1023),b[c++]=240|f>>18,b[c++]=128|f>>12&63,b[c++]=128|f>>6&63,b[c++]=128|f&63)}}function l(a,b,c){var d=[],e=b,f=0;while(e<b+c){var g=a[e++];if(g<128)d[f++]=String.fromCharCode(g);else if(g>191&&g<224){var h=a[e++];d[f++]=String.fromCharCode((g&31)<<6|h&63)}else if(g>239&&g<365){h=a[e++];var i=a[e++],j=a[e++];h=((g&7)<<18|(h&63)<<12|(i&63)<<6|j&63)-65536;d[f++]=String.fromCharCode(55296+(h>>10));d[f++]=String.fromCharCode(56320+(h&1023))}else{i=a[e++];j=a[e++];d[f++]=String.fromCharCode((g&15)<<12|(i&63)<<6|j&63)}}return d.join("")}b=function(){"use strict";function a(a,b,c){this.$1=a*1e3,this.$4=b,this.$5=c,this.$3=!1}var b=a.prototype;b.$6=function(){var a=this;this.$3?(this.$3=!1,this.$4(),this.$2=g.setTimeout(function(){a.$6()},this.$1)):this.$5()};b.reset=function(){var a=this;this.$3=!0;this.$2&&(g.clearTimeout(this.$2),this.$2=null);this.$1>0&&(this.$2=g.setTimeout(function(){a.$6()},this.$1))};b.cancel=function(){this.$2&&(g.clearTimeout(this.$2),this.$2=null)};return a}();e.exports={UTF8Length:i,convertStringToUTF8:k,concatBuffers:a,decodeMultiByteInt:c,convertUTF8ToString:l,encodeMultiByteInt:d,writeUInt16BE:h,readUInt16BE:f,writeString:j,Pinger:b}}),null);
__d("MqttUtils",["MqttEnv"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h={endpointWithSessionId:function(a,b){return this.endpointWithExtraParameter(a,"sid",b.toString())},endpointWithExtraParameters:function(a,b){var c=this,d=a;b.forEach(function(a,b,e){d=c.endpointWithExtraParameter(d,b,a)});return d},endpointWithExtraParameter:function(a,b,c){if(a.indexOf("?")>0)return a+"&"+b+"="+c;else return a+"?"+b+"="+c},generateSessionId:function(){return Math.floor(g.random()*Number.MAX_SAFE_INTEGER)},promiseDone:function(a,b,c){var d=arguments.length>1?a.then(b,c):a;d.then(null,function(a){g.setTimeout(function(){if(a instanceof Error)throw a;else throw new Error("promiseDone")},0)})},promiseDoneWithTimeout:function(a,b,c,d){var e=!1;g.setTimeout(function(){e||(e=!0,c(new Error("promise timeout")))},d);h.promiseDone(a,function(a){e||(e=!0,b(a))},function(a){e||(e=!0,c(a))})},sprintf:function(a){for(var b=arguments.length,c=new Array(b>1?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];var e=0;return a.replace(/%s/g,function(){return String(c[e++])})},hasWSSupport:function(){return"WebSocket"in a&&a.WebSocket!=null&&"CLOSING"in a.WebSocket.prototype},getWSAvailability:function(){var b="";if("WebSocket"in a&&a.WebSocket!==null)b+="W";else return"none";"CLOSING"in a.WebSocket.prototype&&(b+="C");return b}};e.exports=h}),null);
__d("MqttProtocolCodec",["MqttProtocolUtils","MqttUtils"],(function(a,b,c,d,e,f){var g=(c=b("MqttProtocolUtils")).UTF8Length,h=c.convertStringToUTF8,i=c.convertUTF8ToString,j=c.decodeMultiByteInt,k=c.encodeMultiByteInt,l=c.readUInt16BE,m=c.writeString,n=c.writeUInt16BE,o=b("MqttUtils").sprintf,p=Object.freeze({CONNECT:1,CONNACK:2,PUBLISH:3,PUBACK:4,SUBSCRIBE:8,SUBACK:9,UNSUBSCRIBE:10,UNSUBACK:11,PINGREQ:12,PINGRESP:13,DISCONNECT:14}),q=[0,6,77,81,73,115,100,112,3];function r(a,b){b=b;var c=b,d=a[b],e=d>>4;b+=1;var f=j(a,b);if(f==null)return{wireMessage:null,position:c};b=f.offset;f=b+f.value;if(f>a.length)return{wireMessage:null,position:c};var g;switch(e){case p.CONNACK:c=a[b++];c=!!(c&1);var h=a[b++];g=new u(c,h);break;case p.PUBLISH:c=d&15;h=c>>1&3;d=l(a,b);b+=2;var k=i(a,b,d);b+=d;d=null;h===1&&(d=l(a,b),b+=2);var m=w.createWithBytes(a.subarray(b,f)),n=(c&1)===1;c=(c&8)===8;g=new x(k,m,h,d,n,c);break;case p.PINGREQ:g=new s("PINGREQ");break;case p.PINGRESP:g=new s("PINGRESP");break;case p.PUBACK:case p.UNSUBACK:k=l(a,b);g=new v(e===p.PUBACK?"PUBACK":"UNSUBACK",k);break;case p.SUBACK:m=l(a,b);b+=2;h=a.subarray(b,f);g=new t(m,h);break;default:throw new Error(o("Invalid MQTT message type %s.",e))}return{wireMessage:g,position:f}}function a(a){var b=[],c=0;while(c<a.length){var d=r(a,c),e=d.wireMessage;c=d.position;if(e)b.push(e);else break}d=null;c<a.length&&(d=a.subarray(c));return{messages:b,remaining:d}}d=function(){"use strict";function a(a){this.messageType=p[a]}var b=a.prototype;b.encode=function(){throw new TypeError("Cannot abstract class WireMessage")};return a}();var s=function(b){"use strict";babelHelpers.inheritsLoose(a,b);function a(a){return b.call(this,a)||this}var c=a.prototype;c.encode=function(){var a=new ArrayBuffer(2),b=new Uint8Array(a);b[0]=(this.messageType&15)<<4;return a};return a}(d);f=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"DISCONNECT")||this}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=new ArrayBuffer(2),c=new Uint8Array(b);c[0]=a;c.set(k(0),1);return b};return b}(d);var t=function(b){"use strict";babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"SUBACK")||this;d.messageIdentifier=a;d.returnCode=c;return d}return a}(d),u=function(b){"use strict";babelHelpers.inheritsLoose(a,b);function a(a,c){var d;d=b.call(this,"CONNACK")||this;d.sessionPresent=a;d.returnCode=c;return d}return a}(d),v=function(b){"use strict";babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.messageIdentifier=c;return a}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=2,c=k(b),d=c.length+1;b=new ArrayBuffer(b+d);var e=new Uint8Array(b);e[0]=a;e.set(c,1);d=n(this.messageIdentifier,e,d);return b};return a}(d);c=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b,c){var d;d=a.call(this,"CONNECT")||this;d.clientId=b;d.connectOptions=c;return d}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4,b=q.length+3;b+=g(this.clientId)+2;b+=g(this.connectOptions.userName)+2;var c=k(b);b=new ArrayBuffer(1+c.length+b);var d=new Uint8Array(b);d[0]=a;a=1;d.set(c,1);a+=c.length;d.set(q,a);a+=q.length;c=2|128;d[a++]=c;a=n(this.connectOptions.keepAliveInterval,d,a);a=m(this.clientId,g(this.clientId),d,a);a=m(this.connectOptions.userName,g(this.connectOptions.userName),d,a);return b};return b}(d);b=function(a){"use strict";babelHelpers.inheritsLoose(b,a);function b(b,c,d,e){var f;f=a.call(this,b)||this;f.topic=c;if(d<0&&d>1||d===1&&e==null)throw new TypeError(o("Argument Invalid. qos: %s messageType: %s.",d,b));f.qos=d;f.messageIdentifier=e;return f}var c=b.prototype;c.encode=function(){var a=(this.messageType&15)<<4;a|=2;var b=g(this.topic),c=2+b+2;this.messageType===p.SUBSCRIBE&&(c+=1);var d=k(c);c=new ArrayBuffer(1+d.length+c);var e=new Uint8Array(c);e[0]=a;a=1;e.set(d,1);a+=d.length;this.messageIdentifier!=null&&(a=n(this.messageIdentifier,e,a));a=m(this.topic,b,e,a);this.messageType===p.SUBSCRIBE&&this.qos!=null&&(e[a++]=this.qos);return c};return b}(d);var w=function(){"use strict";function a(a,b){this.payloadString=a,this.payloadBytes=b}a.createWithString=function(b){var c=new Uint8Array(new ArrayBuffer(g(b)));h(b,c,0);return new a(b,c)};a.createWithBytes=function(b){var c=i(b,0,b.length);return new a(c,b)};var b=a.prototype;b.string=function(){return this.payloadString};b.bytes=function(){return this.payloadBytes};return a}(),x=function(b){"use strict";babelHelpers.inheritsLoose(a,b);function a(a,c,d,e,f,g){var h;h=b.call(this,"PUBLISH")||this;h.topic=a;h.payloadMessage=c;h.qos=d;h.messageIdentifier=e;h.retained=f!=null?f:!1;h.duplicate=g!=null?g:!1;if(h.qos===1&&h.messageIdentifier==null)throw new TypeError("Argument Invalid. messageIdentifier: null and qos: 1");return h}var c=a.prototype;c.encode=function(){var a=(this.messageType&15)<<4;this.duplicate&&(a|=8);a=a|=this.qos<<1;this.retained&&a!=1;var b=g(this.topic),c=b+2,d=this.qos===0?0:2;c+=d;d=this.payloadMessage.bytes();c+=d.byteLength;var e=k(c);c=new ArrayBuffer(1+e.length+c);var f=new Uint8Array(c);f[0]=a;f.set(e,1);a=1+e.length;a=m(this.topic,b,f,a);this.qos!==0&&this.messageIdentifier!=null&&(a=n(this.messageIdentifier,f,a));f.set(d,a);return c};return a}(d);e.exports={MESSAGE_TYPE:p,WireMessage:{Base:d,PubAckUnsubAck:v,Ping:s,ConnAck:u,Connect:c,Disconnect:f,Subscription:b,Publish:x},createMessageWithString:w.createWithString,decodeMessage:r,decodeByteMessages:a}}),null);
__d("MqttTypes",[],(function(a,b,c,d,e,f){"use strict";a=function(a,b){this.errorCode=a,this.errorMessage=b};f.MqttError=a;b=function(a,b){this.mqttError=a,this.connAck=b};f.ConnectFailure=b;c=function(a){babelHelpers.inheritsLoose(b,a);function b(b,c,d){d===void 0&&(d=null);c=a.call(this,c)||this;c.isRecoverable=b;c.originalError=d;return c}return b}(babelHelpers.wrapNativeSuper(Error));f.MqttChannelError=c}),null);
__d("MqttProtocolClient",["MqttEnv","MqttProtocolCodec","MqttTypes","MqttProtocolUtils"],(function(a,b,c,d,e,f){"use strict";var g=30,h=6e4,i=b("MqttEnv").Env,j=(a=b("MqttProtocolCodec")).MESSAGE_TYPE,k=a.WireMessage,l=a.createMessageWithString,m=a.decodeByteMessages;c=b("MqttTypes").MqttError;var n=b("MqttTypes").ConnectFailure,o=b("MqttProtocolUtils").concatBuffers,p=b("MqttProtocolUtils").Pinger,q={SOCKET_ERROR:new c(1,"Socket error"),SOCKET_MESSAGE:new c(2,"Unable to parse invalid socket message"),INVALID_DATA_TYPE:new c(3,"Received non-arraybuffer from socket."),CONNECT_TIMEOUT:new c(4,"Connect timed out"),CONNACK_FAILURE:new c(5,"Connection failure due to connack"),PING_TIMEOUT:new c(6,"Ping timeout"),APP_DISCONNECT:new c(7,"Disconnect initiated by app"),SERVER_DISCONNECT:new c(8,"Disconnect message sent my server"),SOCKET_CLOSE:new c(9,"Socket connection closed")};d=function(){function a(a){this.$3=a,this.$2={userName:"",mqttVersion:3,keepAliveInterval:10,ignoreSubProtocol:!1,onConnectSuccess:function(){},onConnectFailure:function(a){},onConnection:function(){},onConnectionError:function(a){},onConnectionLost:function(a){},onMessageArrived:function(a,b,c){},onMessageDelivered:function(a,b){}},this.$1="mqttwsclient",this.$4=0,this.$5=!1,this.$9=i.getLoggerInstance()}var b=a.prototype;b.connect=function(a){var b=this;if(this.$5)throw new Error("Invalid state: connect - already connected");this.$2=a;this.setConnected(!1);this.$7!=null&&(i.clearTimeout(this.$7),this.$7=null);this.$7=i.setTimeout(function(){b.$9.bumpCounter("protocol.error.connect.timeout"),b.$11(q.CONNECT_TIMEOUT)},g*1e3);this.$6=i.createSocket(this.$3);this.$6.binaryType="arraybuffer";this.$6.onopen=function(){b.setConnected(!0),b.$12(new k.Connect(b.$1,a)),a.onConnection()};this.$6.onmessage=function(a){a=a.data;if(!(a instanceof ArrayBuffer)){b.$9.bumpCounter("protocol.error.onmessage.type");b.$11(q.INVALID_DATA_TYPE);return}try{a=new Uint8Array(a);b.$10!=null&&(a=o(b.$10,a),b.$9.bumpCounter("protocol.debug.usingMessagesBuffer"),delete b.$10,b.$10=null);a=m(a);var c=a.messages;b.$10=a.remaining;for(var a=0;a<c.length;a++)b.handleMessage(c[a])}catch(a){b.$10=null,b.$9.logError(a,q.SOCKET_MESSAGE.errorMessage),b.$9.bumpCounter("protocol.error.onmessage.parse"),b.$11(q.SOCKET_MESSAGE)}};this.$6.onerror=function(a){b.$9.bumpCounter("protocol.error.socket"),b.$11(q.SOCKET_ERROR)};this.$6.onclose=function(a){b.$9.bumpCounter("protocol.socket.close"),b.$11(q.SOCKET_CLOSE)};this.$8!=null&&this.$8.cancel();this.$8=new p(a.keepAliveInterval,this.$12.bind(this,new k.Ping("PINGREQ")),this.$11.bind(this,q.PING_TIMEOUT))};b.$13=function(){this.setConnected(!1),this.$8!=null&&this.$8.cancel(),this.$7!=null&&(i.clearTimeout(this.$7),this.$7=null),this.$6!=null&&(this.$6.onopen=function(a){},this.$6.onmessage=function(a){},this.$6.onerror=function(a){},this.$6.onclose=function(a){},this.$6.readyState===this.$6.OPEN&&this.$6.close(),delete this.$6,this.$6=null),this.$2.onConnectSuccess=function(){},this.$2.onConnectFailure=function(a){},this.$2.onConnection=function(){},this.$2.onConnectionError=function(a){},this.$2.onConnectionLost=function(a){},this.$2.onMessageArrived=function(a,b,c){},this.$2.onMessageDelivered=function(a,b){}};b.disconnect=function(){if(this.$6==null||this.$6.readyState!==this.$6.OPEN||!this.$5){this.$13();return}this.$12(new k.Disconnect());this.$9.bumpCounter("protocol.debug.disconnect");this.$11(q.APP_DISCONNECT)};b.isConnected=function(){return this.$5};b.setConnected=function(a){this.$5=a};b.subscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.subscribe.notconnected");throw new Error("Invalid state: subscribe - not connected")}this.$9.bumpCounter("protocol.subscribe."+a);a=new k.Subscription("SUBSCRIBE",a,0,this.$14());this.$12(a)};b.unsubscribe=function(a){if(!this.$5){this.$9.bumpCounter("protocol.error.unsubscribe.notconnected");throw new Error("Invalid state: unsubscribe - not connected")}this.$9.bumpCounter("protocol.unsubscribe."+a);a=new k.Subscription("UNSUBSCRIBE",a,0,this.$14());this.$12(a)};b.publish=function(a,b,c){this.$5||this.$9.bumpCounter("protocol.error.publish.notconnected");this.$9.bumpCounter("protocol.publish."+a);var d=this.$14();a=new k.Publish(a,l(b),c,d);this.$12(a);return d};b.$14=function(){++this.$4===h&&(this.$4=1);return this.$4};b.$11=function(a,b){this.$9.bumpCounter("protocol.debug.disconnect.internal");var c=this.$5,d=this.$2,e=d.onConnectionLost,f=d.onConnectFailure;this.setConnected(!1);this.$13();c?i.scheduleCallback(function(){e(a)}):i.scheduleCallback(function(){f(new n(a,b!=null?b:-1))})};b.$12=function(a){var b=this.$6;if(b==null)return;if(b.readyState!=b.OPEN)return;b.send(a.encode())};b.handleMessage=function(a){var b=this;switch(a.messageType){case j.CONNACK:this.$7!=null&&(i.clearTimeout(this.$7),this.$7=null);if(a instanceof k.ConnAck){var c=a;if(c.returnCode!==0){this.$9.bumpCounter("protocol.error.connack.invalidreturncode");this.setConnected(!1);this.$11(q.CONNACK_FAILURE,c.returnCode);return}i.scheduleCallback(function(){b.$2.onConnectSuccess()});this.$8!=null&&this.$8.reset()}break;case j.PUBLISH:if(a instanceof k.Publish){var d=a;i.scheduleCallback(function(){b.$2.onMessageArrived(d.topic,d.payloadMessage.payloadString,d.qos)});c=d.messageIdentifier;this.$9.bumpCounter("protocol.publish.received");if(d.qos===1&&c!=null){c=new k.PubAckUnsubAck("PUBACK",c);this.$12(c)}}break;case j.PUBACK:if(a instanceof k.PubAckUnsubAck){c=a;var e=c.messageIdentifier;this.$9.bumpCounter("protocol.puback.received");i.scheduleCallback(function(){b.$2.onMessageDelivered("",e)})}break;case j.PINGRESP:this.$8!=null&&this.$8.reset();break;case j.DISCONNECT:this.$11(q.SERVER_DISCONNECT);break;case j.SUBACK:this.$9.bumpCounter("protocol.suback.received");break;case j.UNSUBACK:this.$9.bumpCounter("protocol.unsuback.received");break;default:this.$9.logError(new Error("MqttProtocolClient: Received unhandled message type: "+a.messageType),"Received unhandled message type");this.$9.bumpCounter("protocol.error.handlemessage.unsupportedtype");break}};return a}();e.exports=d}),null);
__d("MqttUserName",["gkx"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,c,d,e,f,g,h){h===void 0&&(h=null),this.$1=a,this.$2=c,this.$3=d,this.$4=e,this.$5=f,this.$6=g,this.$7=b("gkx")("1166607")?!1:typeof document==="object"&&document&&document.hasFocus&&document.hasFocus(),this.$8=h}var c=a.prototype;c.gen=function(a,c,d,e){e===void 0&&(e=[]);var f=b("gkx")("1166607")?!1:this.$7;a={u:this.$1,s:a,cp:this.$3,ecp:this.$2,chat_on:this.$6,fg:f,d:this.$4,ct:"websocket",mqtt_sid:"",aid:this.$5,st:c,pm:d,dc:"",no_auto_fg:!0,gas:this.$8,pack:e};return JSON.stringify(a)};c.setForegroundState=function(a){this.$7=a};c.setChatVisibility=function(a){this.$6=a};c.getEndpointCapabilities=function(){return this.$2};c.getDeviceId=function(){return this.$4};c.setEndpointCapabilities=function(a){this.$2=a};c.getIsGuestAuthStringPresent=function(){return this.$8!==null};return a}();e.exports=a}),null);
__d("MqttConnection",["Promise","MqttConnectionHookCollection","MqttEnv","MqttProtocolClient","MqttPublishListener","MqttTypes","MqttUserName","MqttUtils"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env;b("MqttEnv").MqttGkNames;var h=b("MqttPublishListener").MqttPublishEvent;b("MqttTypes").ConnectFailure;var i=b("MqttTypes").MqttChannelError;b("MqttTypes").MqttError;var j=10,k="publish",l="subscribe",m="unsubscribe",n=function(a){},o=18e4,p=5*1e3,q=15,r=21;a=function(){function a(){this.$8=!1;this.$10=g.getLoggerInstance();this.$11="Disconnected";this.$14=new Set();this.$17=new Map();this.$20=0;this.$21=0;this.$12=0;this.$13=0;this.$8=!1;this.$5="";this.$6=new(b("MqttUserName"))("",0,1,"",0,!0);this.$9=0;this.$15=0;this.$16=!1;this.$7=null;var a=function(){};this.$1=a;this.$2=a;this.$3=a;this.$18=!1;this.$19=!1;this.$22=new(b("MqttConnectionHookCollection"))();this.$4=function(){return[]}}var c=a.prototype;c.run=function(a){var b=this,c=a.onStateChange,d=a.onJSError,e=a.onMessageReceived,f=a.endpoint,g=a.mqttUserName,h=a.subscribedTopics;a=a.extraConnectMessageProvider;if(this.$8){this.$10.debugTrace("run","Run called while in running state.");return}this.$1=c;this.$3=e;this.$5=f;this.$6=g;this.$8=!0;this.$12=0;this.$2=d||n;h&&h.forEach(function(a){return b.$14.add(a)});this.$4=a;this.$23();this.$24()};c.shutdown=function(){this.$25(),this.$26("shutdown"),this.$8=!1,this.$10.debugTrace("shutdown","Shutdown")};c.subscribe=function(a){this.$14.add(a);this.ensureConnected(l)&&this.$27(a);return!0};c.publish=function(a,c,d,e){var f={resolve:function(){},reject:function(a){}};e!=null&&(f.listener=e);var g=new(b("Promise"))(function(a,b){f.resolve=a,f.reject=b}),i=this.ensureConnected(k);!i?(e==null?void 0:e.onEvent(h.NOT_CONNECTED),f.reject(new Error("Client disconnected"))):this.$28(a,c,d,f);return g};c.unsubscribe=function(a){this.$14["delete"](a);this.ensureConnected(m)&&this.$29(a);return!0};c.addHook=function(a){this.$22.addHook(a)};c.removeHook=function(a){this.$22.removeHook(a)};c.isRunning=function(){return this.$8};c.getSessionId=function(){return this.$9};c.hasFatal=function(){return this.$18};c.hasConnectSuccess=function(){return this.$19};c.canPublish=function(){return this.ensureConnected("canPublish")};c.ensureConnected=function(a){return!this.$8||this.$7==null||!this.$7.isConnected()?!1:!0};c.connectionState=function(){return this.$11};c.mqttStateFromConnectionState=function(a){switch(a){case"Connecting":case"TransportConnected":return"Connecting";case"Connected":return"Connected";case"Disconnected":return"Disconnected"}throw new Error("Unknown state "+a)};c.testOnlyGetSubscribedTopics=function(){return this.$14};c.$23=function(){var a=this;typeof window!=="undefined"&&window.addEventListener("unload",function(b){return a.$30(b)})};c.$30=function(a){this.publish("/browser_close","{}",0)};c.$25=function(){this.$8&&this.$7!=null&&(this.$31("Disconnected"),this.$7!=null&&this.$7.disconnect(),this.$7=null)};c.$32=function(a){if(this.$11==="Connected"&&a==="Disconnected"&&this.$15===0){this.$15=Date.now();return}if(a==="Connecting"&&this.$15!==0&&!this.$16){this.$10.bumpCounter("protocol.reconnectstarted");this.$16=!0;return}if(a==="Connected"&&this.$15!==0){a=Date.now()-this.$15;switch(Math.floor(a/3e4)){case 0:this.$10.bumpCounter("protocol.reconnectedwithin30s");break;case 1:this.$10.bumpCounter("protocol.reconnectedwithin60s");break;case 2:this.$10.bumpCounter("protocol.reconnectedwithin90s");break;case 3:this.$10.bumpCounter("protocol.reconnectedwithin120s");break;default:this.$10.bumpCounter("protocol.reconnectedmorethan120s");break}this.$15=0;this.$16=!1;return}};c.$31=function(a){a!==this.$11&&(this.$32(a),this.$11=a,this.$1(a))};c.$24=function(){var a=this;if(!this.$8)return;this.$31("Connecting");var c=Date.now();this.$9=b("MqttUtils").generateSessionId();var d=Array.from(this.$14),e=b("MqttUtils").endpointWithSessionId(this.$5,this.$9);e=b("MqttUtils").endpointWithExtraParameter(e,"cid",this.$6.getDeviceId());try{this.$7=new(b("MqttProtocolClient"))(e);var f=this.$33(),g=f.map(function(a){return a.topic});e=this.$6.gen(this.$9,d,f);this.$7!=null&&(this.$7.connect({userName:e,mqttVersion:3,keepAliveInterval:j,ignoreSubProtocol:!0,onConnectFailure:function(b){return a.$34(b,c,d,g)},onConnectSuccess:function(){return a.$35(c,d,g)},onConnection:function(){return a.$36(f,d)},onConnectionError:function(b){return a.$37(b)},onConnectionLost:function(b){return a.$38(b)},onMessageArrived:function(b,c,d){return a.$39(b,c,d)},onMessageDelivered:function(b,c){return a.$40(b,c)}}),this.$10.bumpCounter("protocol.connectattempt"),this.$22.onConnectAttempt(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.connectattempt"))}catch(a){this.$10.bumpCounter("js_error_in_init_exception"),this.$31("Disconnected"),this.$41(!1,!1,c,d,[],14,a.message),a&&this.$10.logErrorWarn(a,"ws_js_error"),this.$22.onWSFatal(),this.$42(new i(!1,"ws_js_error",a),"client_init")}};c.$33=function(){var a=this.$4(),b=65536;a=a.map(function(a){a.messageId=b--;return a});return a};c.$27=function(a){try{if(this.$7!=null){this.$7.subscribe(a);this.$10.debugTrace("_doSubscribe","Subscribing to "+a);this.$22.onSubscribe(a);this.$10.bumpCounter("protocol.subscribe");return!0}}catch(b){this.$10.logError(b,"Exception subscribing"),this.$10.bumpCounter("subscribe_exception."+a),this.$10.bumpCounter("protocol.subscribe.error")}return!1};c.$29=function(a){try{if(this.$7!=null){this.$7.unsubscribe(a);this.$10.debugTrace("_doUnsubscribe","Unsubscribing to "+a);this.$22.onUnsubscribe(a);this.$10.bumpCounter("protocol.unsubscribe");return!0}}catch(b){this.$10.logError(b,"Exception unsubscribing"),this.$10.bumpCounter("unsubscribe_exception."+a),this.$10.bumpCounter("protocol.unsubscribe.error")}return!1};c.$28=function(a,b,c,d){if(this.$7!=null)try{b=this.$7.publish(a,b,c);this.$10.bumpCounter("protocol.publish");var e=b!=null?b:"null";this.$10.debugTrace("_doPublish","publish "+a+" with messageId:"+e+" qos:"+c);this.$22.onPublish(a);(e=d.listener)==null?void 0:e.onEvent(h.SENT);b!=null?this.$17.set(b,d):d.resolve();return!0}catch(b){this.$10.logError(b,"Exception publishing");this.$10.bumpCounter("publish_exception."+a);d.reject(b);this.$10.bumpCounter("protocol.publish.error");return!1}else return!1};c.$43=function(a){var b=this;a===void 0&&(a=null);if(!this.$8)return;this.$25();this.$26("reconnect");this.$44();this.$9=-1;this.$13=0;a=a!=null?a:Math.pow(2,Math.min(this.$12,6))*(1e3+g.random()*200);this.$10.debugTrace("_scheduleReconnect","Reconnect in "+a+" ms");g.setTimeout(function(){b.$24()},a);this.$12+=1};c.$44=function(){var a=Date.now()-this.$13,b=this.$13!==0&&a>p,c=this.$12>q;(b||c)&&(this.$12=0);this.$13!==0&&a<=p&&this.$10.bumpCounter("short_lived_session");c&&this.$10.bumpCounter("connection_attempt_limit")};c.$41=function(a,b,c,d,e,f,g){a===!0?this.$21++:this.$20++,this.$10.eventLogConnect({sessionID:this.$9,connectionStatus:a,connectionState:this.mqttStateFromConnectionState(this.$11),ackReceived:b,duration:Date.now()-c,hostname:this.$5,attemptNumber:this.$12,failTotal:this.$20,successTotal:this.$21,subscribedTopics:d,publishes:e,errorCode:f,errorMessage:g})};c.$34=function(a,b,c,d){var e=a.mqttError,f=e.errorMessage;this.$10.debugTrace("connect","Connect failed "+f);this.$10.bumpCounter("protocol.onconnectfailure");this.$22.onConnectFailure();this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectfailure");this.$41(!1,a.connAck!=null,b,c,d,e.errorCode,f);if(a.connAck!=null){this.$10.bumpCounter("protocol.connect_failure."+a.connAck);if(a.connAck===r){this.$43(o);return}}this.$43()};c.$36=function(a,b){var c=this;this.$10.bumpCounter("protocol.onconnection");this.$10.debugTrace("Connect","Socket established");this.$22.onConnected();this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnection");b.forEach(function(a){c.$22.onSubscribe(a)});a.forEach(function(a){c.$22.onPublish(a.topic)});this.$31("TransportConnected")};c.$35=function(a,b,c){this.$10.bumpCounter("protocol.onconnectsuccess"),this.$10.debugTrace("connect","Connect success"),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectsucess"),this.$22.onConnectSuccess(),this.$19=!0,this.$41(!0,!0,a,b,c),this.$31("Connected"),this.$45(b),this.$13=Date.now()};c.$38=function(a){this.$10.bumpCounter("protocol.onconnectionlost"),a.errorCode&&this.$10.eventLogDisconnect({sessionID:this.$9,errorCode:a.errorCode,errorMessage:a.errorMessage,duration:Date.now()-this.$13}),this.$10.debugTrace("connect","connection lost"),this.$22.onConnectionLost(),this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onconnectionlost"),this.$43()};c.$37=function(a){};c.$39=function(a,b,c){this.$10.bumpCounter("protocol.onmessagearrived");this.$6.getIsGuestAuthStringPresent()&&this.$10.bumpCounter("guestAuthentication.onmessagearrived");this.$10.debugTrace("onMessageArrived","Message received on "+a);this.$22.onMessage(a);try{this.$3(a,b,c)}catch(b){this.$10.logError(b,"Listener threw error"),this.$10.bumpCounter("listener_error."+a)}};c.$40=function(a,b){this.$10.bumpCounter("protocol.onmessagedelivered");a=b!=null?b:"null";this.$10.debugTrace("onMessageDelivered","Delivered Message {ID: "+a+"}");if(b==null)return;a=this.$17.get(b);if(a==null){this.$10.bumpCounter("protocol.message_with_unknown_id");return}this.$17["delete"](b);(b=a.listener)==null?void 0:b.onEvent(h.ACKED);a.resolve()};c.$26=function(a){this.$10.bumpCounter("protocol.fail_all_unacked_publishes."+a),this.$17.forEach(function(b,c,d){(c=b.listener)==null?void 0:c.onEvent(h.NOT_ACKED);b.reject(new Error(a))}),this.$17.clear()};c.$45=function(a){var b=this,c=new Set(a);c.forEach(function(a){b.$14.has(a)||b.unsubscribe(a)});a=new Set(this.$14);a.forEach(function(a){c.has(a)||b.subscribe(a)})};c.$42=function(a,b){try{this.$10.bumpCounter("js_error_in_init");this.$10.bumpCounter(b+".error");this.$18=!0;var c=a?a.message:"error";this.$10.debugTrace("onError",b+": "+c);this.$2(a)}catch(a){this.$10.bumpCounter("js_error_in_error_logging"),this.$10.logError(a,"JS error while trying to log previous error")}};return a}();e.exports=a}),null);
__d("isFastRefreshEnabledForCurrentDomain",[],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(){return!1}}),null);
__d("MqttChannel",["Promise","requireDeferred","ChannelClientID","IrisSubscribeChecker","MqttAnalyticsHook","MqttConnection","MqttEnv","MqttPublishListener","MqttPublishTimeoutConfig","MqttUserName","MqttUtils","isFastRefreshEnabledForCurrentDomain","promiseDone"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttEnv").MqttGkNames,i=b("MqttPublishListener").MqttPublishEvent,j=b("MqttPublishTimeoutConfig").mqttPublishTimeoutMs||60*1e3;a=function(){function a(a){var c=this,d=a.endpoint,e=a.pollingEndpoint,f=a.userFbid,h=a.appId,i=a.initialSubscribedTopics,j=a.capabilities,k=a.clientCapabilities,l=a.chatVisibility;l=l===void 0?!0:l;a=a.guestAuthString;a=a===void 0?null:a;this.$10=g.getLoggerInstance();this.$10.setAppId(h);this.$11=new(b("MqttUserName"))(f,j,k,b("ChannelClientID").getID(),h,l,a);this.$1=d;this.$2=e;this.$5="Disconnected";this.$7="LPInactive";this.$6="Disconnected";this.$3=[];this.$4=new Set();this.$8=new Map();this.$9=new(b("MqttConnection"))();this.$12=null;this.$15=new(b("MqttAnalyticsHook"))();this.$14=new Map();this.$13=[];if(!g.isUserLoggedInNow()&&!b("isFastRefreshEnabledForCurrentDomain")()&&(a==null||a=="")){this.$10.bumpCounter("logged_out_init");return}this.$9.addHook(this.$15);this.$9.addHook(new(b("IrisSubscribeChecker"))(function(){return c.$4.size>0}));this.$16(i);this.$17();this.$10.logIfLoggedOut()}var c=a.prototype;c.$16=function(a){var c=this;if(this.$9.isRunning()){this.$18("run","Connection started calling run again");return}if(g.genGk(h.mqtt_ws_polling_enabled)){var d=g.killswitch("MQTT_WS_FORCE_LONG_POLLING");if(d){this.$18("MqttChannel","Websocket disabled, will do long polling only");return}else if(!b("MqttUtils").hasWSSupport()){this.$18("MqttChannel","Websocket Unavailable, will do long polling only");this.$10.bumpCounter("ws_unavailable_polling");return}}this.$9.run({onStateChange:function(a){c.$19(a)},onJSError:function(a){c.$20(a)},onMessageReceived:function(a,b,d){c.$21(a,b,d)},endpoint:this.$1,mqttUserName:this.$11,subscribedTopics:a,extraConnectMessageProvider:function(){return c.$22()}})};c.shutdown=function(){this.$9&&this.$9.shutdown()};c.publish=function(a,c,d){d===void 0&&(d={qos:1,skipBuffer:!1});var e;d.qos===0?e=this.$23(a,c,d.listener):e=this.$24(a,c,d);b("MqttUtils").promiseDone(e,function(){},function(a){(a=d.listener)==null?void 0:a.onEvent(i.PUBLISH_ERROR)});return e};c.$23=function(a,b,c){return this.$25(a,b,0,c)};c.$24=function(a,c,d){var e={resolve:function(){},reject:function(a){}},f=new(b("Promise"))(function(a,b){e.resolve=a,e.reject=b}),h=g.random();a={topic:a,payload:c,options:d,ack:e,publishToken:h,timeoutId:null};if(d.skipBuffer)if(this.$9.connectionState()==="Connecting"){this.$13.push(a);(c=d.listener)==null?void 0:c.onEvent(i.QUEUED)}else this.$26(a);else{a.timeoutId=this.$27(h);this.$14.set(h,a);(c=d.listener)==null?void 0:c.onEvent(i.QUEUED);this.$28(a)}return f};c.$26=function(a){b("MqttUtils").promiseDone(this.$25(a.topic,a.payload,a.options.qos,a.options.listener),function(){a.ack.resolve()},function(b){a.ack.reject(b)})};c.$28=function(a){var c=this;b("MqttUtils").promiseDone(this.$25(a.topic,a.payload,a.options.qos,a.options.listener),function(){return c.$29(a)},function(a){})};c.$25=function(a,c,d,e){var f=this,g,h,j=this.getConnectionState(),k=Date.now();!this.$9.canPublish()&&this.$12&&this.$12.canPublish()?(g=this.$12.publish(a,c,d),h="lp",e!=null&&(g=g.then(function(){return e.onEvent(i.SENT)})),this.$10.bumpCounter("try_publish_lp")):(g=this.$9.publish(a,c,d,e),h="ws",this.$10.bumpCounter("try_publish_ws"));b("promiseDone")(g,function(){f.$10.eventLogOutgoingPublish({sessionID:f.$9.getSessionId(),topic:a,qos:d,payloadSizeBytes:c.length*2,success:!0,protocol:h,errorMessage:null,connectionState:j,startTime:k})},function(b){f.$10.eventLogOutgoingPublish({sessionID:f.$9.getSessionId(),topic:a,qos:d,payloadSizeBytes:c.length*2,success:!1,protocol:h,errorMessage:b.toString(),connectionState:j,startTime:k})});return g};c.subscribe=function(a,b){var c=this;this.$9.subscribe(a);var d=this.$8.get(a);!d?(d=[b],this.$8.set(a,d)):d.push(b);return function(){var d=c.$8.get(a)||[];d=d.filter(function(a){return a!==b});c.$8.set(a,d);d.length===0&&c.unsubscribeAll(a)}};c.subscribeChannelEvents=function(a){this.$3.push(a)};c.unsubscribeChannelEvents=function(a){a=this.$3.indexOf(a);a>-1&&this.$3.splice(a,1)};c.registerExtraConnectPayloadProvider=function(a){var b=this;this.$18("MqttChannel","registerExtraConnectPayloadProvider called");this.$4.add(a);if(this.$9.isRunning()){a=a.getPublishMessages();a.forEach(function(a){b.publish(a.topic,a.payload,{qos:a.qos,skipBuffer:!0})})}};c.unregisterExtraConnectPayloadProvider=function(a){this.$4["delete"](a)};c.unsubscribeAll=function(a){this.$9.unsubscribe(a),this.$8["delete"](a)};c.getConnectionState=function(){return this.$5};c.getLongPollingStatus=function(){return this.$7};c.getEndpoint=function(){return this.$1};c.addHook=function(a){this.$9.addHook(a)};c.removeHook=function(a){this.$9.removeHook(a)};c.testOnlyMessageReceived=function(a,b){this.$21(a,b,-1)};c.$30=function(a){var b=this.$14.get(a);b!=null&&b.timeoutId!=null&&g.clearTimeout(b.timeoutId);this.$14["delete"](a)};c.$27=function(a){var b=this;a=g.setTimeout(function(a){var c=b.$14.get(a);if(!c)return;var d=c.topic;b.$10.bumpCounter("publish_timeout."+d);b.$10.debugTrace("publish_timeout","Timeout publishing topic: "+d+" publishToken: "+a);b.$10.eventLogPublishTimeout({topic:d});b.$30(a);c.ack.reject(new Error("Publish Timed Out"))},j,a);return a};c.$29=function(a){var b=a.publishToken,c=this.$14.get(b);if(!c)return;this.$30(b);a.ack.resolve();this.$10.debugTrace("publish_success","Topic: "+a.topic+" publishToken: "+a.publishToken);this.$10.bumpCounter("publish_success."+a.topic)};c.$21=function(a,b,c){var d=this.$8.get(a);this.$10.eventLogIncomingPublish({sessionID:this.$9.getSessionId(),topic:a,connectionState:this.getConnectionState(),qos:c,payloadSizeBytes:b.length*2});if(!d)this.$10.debugTrace("_onMessageReceived",a+" being dropped, no listeners");else for(var c=d,a=Array.isArray(c),d=0,c=a?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(a){if(d>=c.length)break;e=c[d++]}else{d=c.next();if(d.done)break;e=d.value}e=e;try{e(b)}catch(a){this.$10.logError(a,"Listener exception"),this.$10.bumpCounter("listener_error")}}};c.$20=function(a){if(g.genGk(h.mqtt_ws_polling_enabled)){a.isRecoverable?this.$10.bumpCounter("recoverable_error_skipped"):this.$10.bumpCounter("unrecoverable_error_skipped");return}a.isRecoverable?this.$10.bumpCounter("recoverable_error_not_skipped"):this.$10.bumpCounter("unrecoverable_error_not_skipped");this.$31(a)};c.$32=function(a){this.$31(a)};c.$31=function(a){for(var b=this.$3,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.onJSError&&e.onJSError(a)}};c.$33=function(){var a=this;this.$13.forEach(function(b){a.$26(b)});this.$13=[];this.$14.forEach(function(b,c,d){a.$28(b)})};c.$19=function(a){a==="Connecting"?(this.$13.forEach(function(a){a.ack.reject(new Error("Client Reconnecting"))}),this.$13=[]):a==="TransportConnected"&&this.$33(),this.$18("_changeState","Connection state = "+a),this.$34(a,this.$7)};c.$35=function(a,b){this.$12&&this.$12.canPublish()&&this.$33(),this.$18("_changeLPStatus","LP status = "+a+", LP Request status = "+b),this.$34(this.$6,a)};c.$34=function(a,b){var c=this.$9.mqttStateFromConnectionState(a);this.$12&&this.$12.canPublish()&&(c="Connected");this.$6=a;(c!==this.$5||b!=this.$7)&&(this.$5=c,this.$7=b,this.$36(c))};c.$36=function(a){for(var b=this.$3,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;e.onMQTTStateChanged(a)}};c.$22=function(){var a=this,b=[];this.$4.forEach(function(c){try{c=c.getPublishMessages();Array.prototype.push.apply(b,c)}catch(b){a.$10.logError(b,"ConnectPayload provider exception"),a.$10.bumpCounter("connectPayloadProvider_error")}});return b};c.$17=function(){var a=this;g.genGk(h.mqtt_ws_polling_enabled)&&this.$2&&this.$2!=""&&b("requireDeferred")("MqttLongPollingRunner").onReady(function(b){b=new b(a.$2,a.$11,a.$9.hasFatal(),a.$9.hasConnectSuccess(),function(b,c,d){return a.$21(b,c,d)},function(){return Array.from(a.$8.keys())},function(){return a.$22()},function(b){a.$32(b)},function(b,c){a.$35(b,c)});b.start();a.$9.addHook(b);b.addHook(a.$15);a.$12=b;a.$10.debugTrace("MqttChannel","longPollingRunner loaded")})};c.$18=function(a,b){this.$10.debugTrace(a,"Mqtt channel: "+b)};c.setForegroundState=function(a){this.$11&&this.$11.setForegroundState(a)};c.setChatVisibility=function(a){this.$11&&this.$11.setChatVisibility(a)};c.getEndpointCapabilities=function(){return this.$11.getEndpointCapabilities()};c.setEndpointCapabilities=function(a){this.$11.setEndpointCapabilities(a)};return a}();e.exports=a}),null);
__d("FantailLogger",["FantailConfig"],(function(a,b,c,d,e,f){var g=b("FantailConfig").FantailLogQueue;a={debug:function(a,b){var c;for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];g&&(c=g.get(a)).debug.apply(c,[b].concat(e))},info:function(a,b){var c;for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];g&&(c=g.get(a)).info.apply(c,[b].concat(e))},warn:function(a,b){var c;for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];g&&(c=g.get(a)).warn.apply(c,[b].concat(e))},error:function(a,b){var c;for(var d=arguments.length,e=new Array(d>2?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];g&&(c=g.get(a)).error.apply(c,[b].concat(e))}};e.exports=a}),null);
__d("MqttUnifiedClientConnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744057");c=b("FalcoLoggerInternal").create("mqtt_unified_client_connect",a);e.exports=c}),null);
__d("MqttUnifiedClientDisconnectFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744058");c=b("FalcoLoggerInternal").create("mqtt_unified_client_disconnect",a);e.exports=c}),null);
__d("MqttUnifiedClientIncomingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744059");c=b("FalcoLoggerInternal").create("mqtt_unified_client_incoming_publish",a);e.exports=c}),null);
__d("MqttUnifiedClientOutgoingPublishFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1744060");c=b("FalcoLoggerInternal").create("mqtt_unified_client_outgoing_publish",a);e.exports=c}),null);
__d("MqttWsClientTypedLoggerLite",["generateLiteTypedLogger"],(function(a,b,c,d,e,f){"use strict";e.exports=b("generateLiteTypedLogger")("logger:MqttWsClientLoggerConfig")}),null);
__d("MqttLogger",["ChannelClientID","FantailLogger","FBLogger","Log","LogHistory","MqttEnv","ODS","MqttUnifiedClientConnectFalcoEvent","MqttUnifiedClientDisconnectFalcoEvent","MqttUnifiedClientIncomingPublishFalcoEvent","MqttUnifiedClientOutgoingPublishFalcoEvent","MqttUtils","MqttWsClientTypedLoggerLite","Random","gkx"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttWsClientTypedLoggerLite").log,i=b("Random").coinflip,j="mqtt_client",k=100,l=5e3,m=null,n={CONNECT:"mqtt_client_connect",DISCONNECT:"mqtt_client_disconnect",PUBLISH:"mqtt_client_publish",CLIENT_ERROR:"mqtt_client_error",PUBLISH_TIMEOUT:"mqtt_qos1_publish_timeout",SOCKET_DISCONNECT:"mqtt_protocol_error"},o={CONNECT:"connect",DISCONNECT:"disconnect",OUTGOING_PUBLISH:"outgoing_publish",INCOMING_PUBLISH:"incoming_publish"};a=function(){a.getInstance=function(){m||(m=new a());return m};function a(){this.$1=b("LogHistory").getInstance(j),this.$2=0,this.$3=b("gkx")("778292"),this.$4=Date.now(),this.$5=b("ChannelClientID").getID()}var c=a.prototype;c.setAppId=function(a){this.$2===0&&(this.$2=a)};c.eventLogConnect=function(a){var c=a.sessionID,d=a.connectionStatus,e=a.connectionState,f=a.ackReceived,h=a.duration,i=a.hostname,j=a.attemptNumber;a.failTotal;a.successTotal;var k=a.subscribedTopics,l=a.publishes,m=a.errorCode;a=a.errorMessage;var p=d?"success":"failed";this.bumpCounter(n.CONNECT+"."+p);p={device_id:this.$5,session_id:c,logged_in:g.isUserLoggedInNow(),href:window.location.hostname,connection_status:d,duration:h,hostname:i,feature_availability:b("MqttUtils").getWSAvailability(),attempt_number:j,subscribed_topics:k,publishes:l,error_code:m,error_message:a};var q={event_type:o.CONNECT,acked:f,connection_state:e,client_type:"WEBSOCKET",duration:h,error:a,session_id:c};this.$6(n.CONNECT,p);this.$7(function(){b("MqttUnifiedClientConnectFalcoEvent").log(function(){return q})})};c.eventLogPull=function(a){var b=a.pullEventName,c=a.sessionID,d=a.status,e=a.duration,f=a.hostname;a=a.errorMessage;c={device_id:this.$5,session_id:c,logged_in:g.isUserLoggedInNow(),href:window.location.hostname,connection_status:d,duration:e,hostname:f,error_message:a};this.$6(b,c)};c.eventLogPullFinish=function(a){var b=a.pullEventName,c=a.sessionID,d=a.duration,e=a.errorMessage,f=a.publishReceived;a=a.publishSent;c={device_id:this.$5,session_id:c,logged_in:g.isUserLoggedInNow(),href:window.location.hostname,duration:d,error_message:e,publish_received:f,publish_sent:a};this.$6(b,c)};c.eventLogDisconnect=function(a){var c=a.sessionID,d=a.errorCode,e=a.errorMessage;a=a.duration;this.bumpCounter(n.DISCONNECT);d={device_id:this.$5,session_id:c,href:window.location.hostname,duration:a,error_code:d,error_message:e};var f={event_type:o.DISCONNECT,connection_state:"Disconnected",client_type:"WEBSOCKET",duration:a,error:e,session_id:c};this.$6(n.DISCONNECT,d);this.$7(function(){b("MqttUnifiedClientDisconnectFalcoEvent").log(function(){return f})})};c.eventLogOutgoingPublish=function(a){var c=a.sessionID,d=a.topic,e=a.qos,f=a.payloadSizeBytes,g=a.success,h=a.protocol,j=a.errorMessage,k=a.connectionState;a=a.startTime;this.bumpCounter(n.PUBLISH+"."+d);h={device_id:this.$5,href:window.location.hostname,topic:d,qos:e,payload_size_bytes:f,success:g?1:0,protocol:h,error_message:j};var m={event_type:o.OUTGOING_PUBLISH,session_id:c,topic:d,client_type:"WEBSOCKET",connection_state:k,qos:e,acked:e==1?g:null,duration:Date.now()-a,error:j,payload_size:f};i(l)&&this.$6(n.PUBLISH,h,l);this.$7(function(){b("MqttUnifiedClientOutgoingPublishFalcoEvent").log(function(){return m})})};c.eventLogIncomingPublish=function(a){var c=a.sessionID,d=a.topic,e=a.connectionState,f=a.qos;a=a.payloadSizeBytes;var g={event_type:o.INCOMING_PUBLISH,session_id:c,topic:d,client_type:"WEBSOCKET",connection_state:e,qos:f,payload_size:a};c=d=="/webrtc"||d=="/rtc_multi";this.$8(function(){b("MqttUnifiedClientIncomingPublishFalcoEvent").log(function(){return g})},20,c)};c.logError=function(a,c){var d=this;g.scheduleLoggingCallback(function(){try{b("FBLogger")(j).catching(a).mustfix(c),d.$9(b("FantailLogger").error,c)}catch(a){}})};c.eventLogPublishTimeout=function(a){a=a.topic;a={device_id:this.$5,href:window.location.hostname,topic:a};this.$6(n.PUBLISH_TIMEOUT,a)};c.eventLogMiscellaneousError=function(a){a=a.errorMessage;a={device_id:this.$5,logged_in:g.isUserLoggedInNow(),href:window.location.hostname,error_message:a,time_passed:Date.now()-this.$4};this.$6(n.CLIENT_ERROR,a)};c.logIfLoggedOut=function(){if(!b("gkx")("1186990")||g.isUserLoggedInNow())return;var a={logged_in:g.isUserLoggedInNow(),href:window.location.href,error_message:"Not logged in",time_passed:Date.now()-this.$4};this.$6(n.CLIENT_ERROR,a)};c.logErrorWarn=function(a,c){var d=this;g.scheduleLoggingCallback(function(){try{b("FBLogger")(j).catching(a).warn(c),d.$9(b("FantailLogger").warn,c)}catch(a){}})};c.logWarn=function(a,c){var d=this;g.scheduleLoggingCallback(function(){try{d.$1.warn(a,c),d.$9(b("FantailLogger").warn,c)}catch(a){}})};c.debugTrace=function(a,c){var d=this;g.scheduleLoggingCallback(function(){try{d.$1.debug(a,c),d.$9(b("FantailLogger").debug,c)}catch(a){}})};c.bumpCounter=function(a){var c=this;if(!i(k))return;g.scheduleLoggingCallback(function(){c.$2!==0&&b("ODS").bumpEntityKey(2966,"mqtt_ws_client",c.$2+"."+a,k),b("ODS").bumpEntityKey(2966,"mqtt_ws_client",a,k)})};c.$6=function(a,c,d){var e=this;g.scheduleLoggingCallback(function(){c.event_type=a;c.app_id=e.$2;c.online=e.$10();var f=JSON.stringify(c);e.$1.log(a,f,{weight:d});a!==n.DISCONNECT&&h(c);e.$9(b("FantailLogger").info,f)})};c.$8=function(a,c,d){c!==0?d=b("gkx")("1272991")&&(d==!0||i(c)):d=b("gkx")("1272991");d&&g.scheduleCallback(a)};c.$7=function(a){this.$8(a,0,!1)};c.$9=function(a,b){g.scheduleLoggingCallback(function(){})};c.$10=function(){return window.navigator&&window.navigator.onLine!==void 0?window.navigator.onLine:!1};return a}();e.exports=a}),null);
__d("MqttEnvInitializer",["CurrentUser","JSScheduler","MqttEnv","MqttLogger","Random","WebStorage","clearTimeout","gkx","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";var g,h=b("MqttEnv").MqttGkNames,i=b("MqttEnv").Env,j="mqtt:",k={genGk:function(a){switch(a){case h.mqtt_waterfall_log_client_sampling:return b("gkx")("832242");case h.mqtt_ws_polling_enabled:return!0;case h.mqtt_lp_use_fetch:return b("gkx")("945829");case h.mqtt_fast_lp:return b("gkx")("1001007");case h.mqtt_lp_no_delay:return b("gkx")("1066746");case h.mqtt_enable_publish_over_polling:return b("gkx")("968609");default:b("MqttLogger").getInstance().logError(new Error("unknown gk"),"Unknown GK value "+a);return!1}},useJSScheduler:function(a){return b("gkx")("987139")?a:null},initialize:function(){i.initialize(b("Random").random,b("CurrentUser").isLoggedInNow,b("clearTimeout"),b("setTimeoutAcrossTransitions"),function(){return b("MqttLogger").getInstance()},k.genGk,null,k.useJSScheduler(b("JSScheduler").scheduleNormalPriCallback),k.useJSScheduler(b("JSScheduler").scheduleLoggingPriCallback),function(a,c){var d=(g||(g=b("WebStorage"))).getLocalStorage();if(d){d=d.getItem(j+a);if(d!=null)return d}return c},function(a,c){var d=(g||(g=b("WebStorage"))).getLocalStorage();d&&(c==null?d.removeItem(j+a):d.setItem(j+a,c))})}};e.exports=k}),null);
__d("FBMqttChannel",["MqttChannel","MqttEnvInitializer","MqttWebConfig"],(function(a,b,c,d,e,f){"use strict";b("MqttEnvInitializer").initialize();e.exports=new(b("MqttChannel"))({endpoint:(a=b("MqttWebConfig")).endpoint,pollingEndpoint:a.pollingEndpoint,userFbid:a.fbid,appId:a.appID,initialSubscribedTopics:a.subscribedTopics,capabilities:a.capabilities,clientCapabilities:a.clientCapabilities,chatVisibility:a.chatVisibility})}),null);
__d("BladeRunnerSocket",["Promise","BladeRunnerEventHandler","BladeRunnerLogger","BladeRunnerTypes","BladeRunnerTypesInternal","CurrentUser","FBMqttChannel","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","uuid"],(function(a,b,c,d,e,f){"use strict";var g="Connected",h="Disconnected",i=511*1024,j="/br_sr",k="/sr_res",l=null;a=function(){function a(a){this.$1=[],this.$2=0,this.$3=0,this.$4=null,this.$5=0,this.$6=new Map(),this.$7=a!=null?a:b("FBMqttChannel"),this.$8=new Map(),b("BladeRunnerLogger").setClientSessionId(b("uuid")()),this.$9()}a.get=function(){l==null&&(l=new a(b("FBMqttChannel")));return l};var c=a.prototype;c.sendNewStreamRequest=function(c,d){d=new(b("BladeRunnerEventHandler"))(c,d,this);var e=c.getRequest();this.$6.set(e.streamId,d);if(!this.$10()){this.$11(d,e.streamId);return}this.getStreamCount()<=a.maxStreamCount?this.$12(e):(b("BladeRunnerLogger").bumpCounter("socket_request_throttled_max_streams"),b("BladeRunnerLogger").warn("Maximum stream count reached, will not send request: "+JSON.stringify(c.getRequest().getHeaders())),this.$11(d,e.streamId))};c.sendRetryStreamRequest=function(a){this.$12(a.getRequest())};c.sendCancel=function(a){b("BladeRunnerLogger").bumpCounter("socket_send_cancel");var c=new(b("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();c.streamId=a;c.status=b("BladeRunnerTypes").StreamStatus.CLOSED;this.$13(c);this.removeStream(a)};c.sendAmendment=function(a,c,d){b("BladeRunnerLogger").bumpCounter("socket_send_amendment");var e=new(b("BladeRunnerTypesInternal").GatewayStreamData)();e.streamId=a;e.setData(c);d!=null&&(e.instrumentationData=d);this.$14(e)};c.sendAmendmentWithAck=function(a,c,d){var e=this;b("BladeRunnerLogger").bumpCounter("socket_send_amendment");var f=this.$15(),g=new(b("BladeRunnerTypesInternal").GatewayStreamData)();g.streamId=a;g.setData(c);g.shouldAck=!0;g.dataId=f;d!=null&&(g.instrumentationData=d);a=new(b("Promise"))(function(a,b){e.$8.set(f,{resolve:a,reject:b})});this.$14(g);return a};c.$14=function(a){this.$1.push(b("BladeRunnerTypesInternal").GatewayStreamFrame.newDataFrame(a)),this.$16()};c.sendDataAcks=function(a){b("BladeRunnerLogger").bumpCounter("socket_send_data_ack",a.length),this.$17(a)};c.removeStream=function(a){this.$6["delete"](a)};c.getStreamCount=function(){return this.$6.size};c.getNextStreamId=function(){this.$5++;return this.$5};c.onMQTTStateChanged=function(a){this.$16();if(a!=h&&a!=g||this.$4==a)return;this.$4=a;b("BladeRunnerLogger").info("MQTTStateChanged: "+a);a==h?(b("BladeRunnerLogger").bumpCounter("mqtt_state_disconnected"),this.$18()):a==g&&b("BladeRunnerLogger").bumpCounter("mqtt_state_connected")};c.$12=function(a){b("BladeRunnerLogger").bumpCounter("socket_send_request"),this.$1.push(b("BladeRunnerTypesInternal").GatewayStreamFrame.newRequestFrame(a)),this.$16()||b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,b("RequestStreamE2EClientLoggerEvent").FAILURE,a.getInstrumentationData(),a.getHeaders().method,{reason:"MQTT Not Connected"})};c.$13=function(a){this.$1.push(b("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(a)),this.$16()};c.$17=function(a){for(var c=0;c<a.length;c++){var d=a[c];this.$1.push(b("BladeRunnerTypesInternal").GatewayStreamFrame.newDataAckFrame(d))}this.$16()};c.$19=function(){this.$2++;return this.$2};c.$15=function(){this.$3++;return this.$3};c.$16=function(){if(this.$7.getConnectionState()===g&&this.$1.length>0){try{this.$20(this.$1)}finally{this.$1=[]}return!0}return!1};c.$20=function(a){var c=this,d=new(b("BladeRunnerTypesInternal").GatewayStreamBatch)(this.$19(),a),e=d.write();if(e.length>i){var f=Math.floor(a.length/2);if(f===0){var g=new Error("Publish is too long: "+e.length);a.forEach(function(a){return b("BladeRunnerLogger").logFrameFailure(a,"too long")});this.$21(d,g,"Publish is too long");throw g}this.$20(a.slice(0,f));this.$20(a.slice(f,a.length))}else try{b("BladeRunnerLogger").info("send message to "+j+" ("+e.length+" bytes)");g={qos:1,skipBuffer:!1};if(d.isInstrumented()){var h=Date.now();g.listener={onEvent:function(c){var d=(Date.now()-h).toString();for(var e=0;e<a.length;e++){var f=a[e];b("BladeRunnerLogger").logFrameWithMQTTEvent(f,c,{latency:d})}}}}this.$7.publish(j,e,g)["catch"](function(a){c.$21(d,a,"Failed publishing to MQTT")});b("BladeRunnerLogger").bumpCounter("mqtt_publish_success")}catch(a){this.$21(d,a,"Failed publishing to MQTT");throw a}};c.$9=function(){var a=this;b("BladeRunnerLogger").info("Starting socket with endpoint "+this.$7.getEndpoint()+" useragent "+navigator.userAgent);this.onMQTTStateChanged(this.$7.getConnectionState());this.$7.subscribeChannelEvents({onMQTTStateChanged:function(b){a.onMQTTStateChanged(b)},onJSError:function(a){var c=a!=null&&typeof a.isRecoverable==="boolean"?a.isRecoverable:!1;c?b("BladeRunnerLogger").bumpCounter("mqtt_channel_recoverable_error"):(b("BladeRunnerLogger").warn("JS error in MQTTChannel: "+(typeof a=="object"&&a!=null?a.toString():"unknown error")+", "+JSON.stringify(a)),b("BladeRunnerLogger").bumpCounter("mqtt_channel_error"))}});this.$7.subscribe(j,function(a){throw new Error("Unexpected response: "+j+" "+a.toString())});this.$7.subscribe(k,function(b){a.$22(b)})};c.$22=function(a){a=b("BladeRunnerTypesInternal").GatewayStreamBatch.read(a);this.processBatch(a)};c.$21=function(a,c,d){for(var a=a.getFrames(),e=Array.isArray(a),f=0,a=e?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=a.length)break;g=a[f++]}else{f=a.next();if(f.done)break;g=f.value}g=g;if(g.type===b("BladeRunnerTypes").StreamFrameType.REQUEST){var h=g.getRequest(),i=this.$6.get(h.streamId);i!=null&&this.$23(i,h.streamId,b("BladeRunnerTypes").StreamStatus.CLOSED,!0,null)}else if(g.type===b("BladeRunnerTypes").StreamFrameType.DATA){i=g.getData();h=i.dataId;if(i.shouldAck!=null&&i.shouldAck&&h!=null){g=new(b("BladeRunnerTypesInternal").GatewayStreamDataAck)();g.streamId=i.streamId;g.dataId=h;g.success=!1;g.code=b("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_FAILED_TO_LAND;g.message=d;this.$24(g)}}}b("BladeRunnerLogger").info("Failed publishing to MQTT: "+c.message);b("BladeRunnerLogger").bumpCounter("mqtt_publish_error")};c.$24=function(a){var c=this.$8.get(a.dataId);c!=null&&(this.$8["delete"](a.dataId),a.success?c.resolve(!0):a.code===b("BladeRunnerTypesInternal").GatewayStreamDataAck.ACK_CODE_LANDED_BUT_NOT_ACCEPTED?c.resolve(!1):c.reject(a.message))};c.processBatch=function(a){try{b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").RESPONSE,b("RequestStreamE2EClientLoggerEvent").RECEIVED,a.getInstrumentationData());b("BladeRunnerLogger").bumpCounter("socket_process_batch");var c=JSON.stringify(a);b("BladeRunnerLogger").info("Received batch ("+c.length+" bytes)");c=null;for(var d=a.getFrames(),e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;var h=g.getStreamId();c==null&&(c=h);if(h!=null&&c!=h)throw new Error("Received batch with frames for multiple streams");g.type==b("BladeRunnerTypes").StreamFrameType.DATA_ACK&&this.$24(g.getDataAck())}if(c!=null){h=this.$6.get(c);h!=null?h.onProxyResponse(a):b("BladeRunnerLogger").info("Received batch with frames for unknown stream id: "+c)}else b("BladeRunnerLogger").info("Received batch with no frames")}catch(a){b("BladeRunnerLogger").exception(a,"Failed processing batch from MQTT");b("BladeRunnerLogger").bumpCounter("socket_process_batch_error");throw a}};c.$18=function(){this.$6.forEach(function(a,b,c){a.onDisconnect()})};c.$11=function(a,c){this.$23(a,c,b("BladeRunnerTypes").StreamStatus.REJECTED,!1,0)};c.$23=function(a,c,d,e,f){var g=new(b("BladeRunnerTypesInternal").GatewayStreamStatusUpdate)();g.streamId=c;g.status=d;g.shouldRetry=e;g.retryDelayMs=f;c=new(b("BladeRunnerTypesInternal").GatewayStreamBatch)(null,[b("BladeRunnerTypesInternal").GatewayStreamFrame.newStatusUpdateFrame(g)]);a.onProxyResponse(c)};c.$10=function(){if(!b("CurrentUser").isLoggedIn()){b("BladeRunnerLogger").bumpCounter("request_stream_user_logged_out");return!1}return!0};return a}();e.exports=a;a.maxStreamCount=2e3}),null);
__d("BladeRunnerStream",["regeneratorRuntime"],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a}var c=a.prototype;c.getStreamHandler=function(){return this.$1};c.cancel=function(){};c.amendWithAck=function(a){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:return a.abrupt("return",!1);case 1:case"end":return a.stop()}},null,this)};c.amendFireAndForget=function(a){};c.isAlive=function(){return!1};c.canAmend=function(){return!1};c.getStatus=function(){return null};c.getStreamId=function(){return 0};return a}();e.exports=a}),null);
__d("BladeRunnerStreamState",["BladeRunnerLogger","BladeRunnerTypes","BladeRunnerTypesInternal"],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a,this.$2=null,this.$3=0,this.$4=!1,this.$5=0,this.$6=!1}var c=a.prototype;c.getRequest=function(){return this.$1};c.isAlive=function(){return!(this.$2==b("BladeRunnerTypes").StreamStatus.CLOSED||this.$2==b("BladeRunnerTypes").StreamStatus.REJECTED)};c.canAmend=function(){return this.$2==b("BladeRunnerTypes").StreamStatus.ACCEPTED||this.$2==b("BladeRunnerTypes").StreamStatus.STARTED||this.$2==b("BladeRunnerTypes").StreamStatus.PAUSED};c.getLastStatus=function(){return this.$2};c.setLastStatus=function(a){this.$2=a};c.onError=function(){this.$3+=1};c.getErrorCount=function(){return this.$3};c.resetErrors=function(){this.$3=0};c.getRetryRequestScheduled=function(){return this.$6};c.setRetryRequestScheduled=function(a){this.$6=a};c.witnessFrame=function(a){switch(a.type){case b("BladeRunnerTypes").StreamFrameType.STATUS_UPDATE:var c=a.getStatusUpdate(),d=!0;switch(c.status){case b("BladeRunnerTypes").StreamStatus.ACCEPTED:d=!this.$4;this.$4||(this.$4=!0);break;case b("BladeRunnerTypes").StreamStatus.STARTED:d=this.getLastStatus()!=b("BladeRunnerTypes").StreamStatus.STARTED;break;case b("BladeRunnerTypes").StreamStatus.PAUSED:d=this.getLastStatus()==b("BladeRunnerTypes").StreamStatus.STARTED;break;case b("BladeRunnerTypes").StreamStatus.CLOSED:case b("BladeRunnerTypes").StreamStatus.REJECTED:default:d=!0}this.setLastStatus(c.status);return d;case b("BladeRunnerTypes").StreamFrameType.REWRITE_REQUEST:this.$7(a.getRewriteRequest());return!1;default:return!0}};c.setRetriesAllowed=function(a){this.$5=a};c.getRetriesAllowed=function(){return this.$5};c.$7=function(a){if(!(a.temporary!=null||a.temporary==!0)){a.newBody!=null&&(this.$1.payload=a.newBody);a.newExtraHeader!=null&&(this.$1.extraHeader=a.newExtraHeader,this.$1.headers=JSON.parse(a.newExtraHeader));if(a.patchExtraHeader!=null)try{var c=JSON.parse(a.patchExtraHeader),d=this.$1.extraHeader!=null?JSON.parse(this.$1.extraHeader):{};this.$1.headers==null&&(this.$1.headers={});var e=Object.keys(c);for(var f=0;f<e.length;f++){var g=e[f];this.$1.headers[g]=c[g];d[g]=c[g]}this.$1.extraHeader=JSON.stringify(d)}catch(c){b("BladeRunnerLogger").warn("Failed to patch header: "+a.patchExtraHeader)}a.killBody!=null&&a.killBody==!0&&(this.$1.payload=null)}};return a}();e.exports=a}),null);
__d("BladeRunnerSocketStream",["regeneratorRuntime","Promise","BladeRunnerLogger","BladeRunnerStream","BladeRunnerStreamState","BladeRunnerTypes","BladeRunnerTypesInternal","RequestStreamE2EClientLoggerEvent","RequestStreamE2EClientLoggerMessageType","uuid"],(function(a,b,c,d,e,f){var g=4,h={reason:"stream_dead"};a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e,f){c=a.call(this,c)||this;c.$BladeRunnerSocketStream1=e;c.$BladeRunnerSocketStream2=new(b("BladeRunnerStreamState"))(d);c.$BladeRunnerSocketStream2.setRetriesAllowed(g);c.$BladeRunnerSocketStream3=f;return c}var d=c.prototype;d.send=function(){var a=this.$BladeRunnerSocketStream2.getRequest();b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").REQUEST_STREAM,b("RequestStreamE2EClientLoggerEvent").RECEIVED,a.getInstrumentationData(),a.getHeaders().method,this.$BladeRunnerSocketStream3?{clientForced:"true"}:null);this.$BladeRunnerSocketStream1.sendNewStreamRequest(this.$BladeRunnerSocketStream2,this.getStreamHandler())};d.amendWithAck=function(a){var c,d;return b("regeneratorRuntime").async(function(e){while(1)switch(e.prev=e.next){case 0:c=this.$BladeRunnerSocketStream2.getRequest();d=c.getInstrumentationData();d&&(d.auxId=b("uuid")(),b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").AMENDMENT,b("RequestStreamE2EClientLoggerEvent").RECEIVED,d));if(!this.canAmend()){e.next=5;break}return e.abrupt("return",this.$BladeRunnerSocketStream1.sendAmendmentWithAck(c.streamId,a,d==null?null:JSON.stringify(d)));case 5:b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").AMENDMENT,b("RequestStreamE2EClientLoggerEvent").FAILURE,d,null,h);return e.abrupt("return",b("Promise").reject("Stream is closed or not accepted"));case 7:case"end":return e.stop()}},null,this)};d.amendFireAndForget=function(a){var c=this.$BladeRunnerSocketStream2.getRequest();c=c.getInstrumentationData();c&&(c.auxId=b("uuid")(),b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").AMENDMENT,b("RequestStreamE2EClientLoggerEvent").RECEIVED,c));if(this.canAmend())this.$BladeRunnerSocketStream1.sendAmendment(this.$BladeRunnerSocketStream2.getRequest().streamId,a,c==null?null:JSON.stringify(c));else{b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").AMENDMENT,b("RequestStreamE2EClientLoggerEvent").FAILURE,c,null,h);throw new Error("Stream is closed or not accepted")}};d.cancel=function(){b("BladeRunnerLogger").logE2EEvent(b("RequestStreamE2EClientLoggerMessageType").CANCEL,b("RequestStreamE2EClientLoggerEvent").RECEIVED,this.$BladeRunnerSocketStream2.getRequest().getInstrumentationData()),this.isAlive()&&(this.$BladeRunnerSocketStream1.sendCancel(this.$BladeRunnerSocketStream2.getRequest().streamId),this.$BladeRunnerSocketStream2.setLastStatus(b("BladeRunnerTypes").StreamStatus.CLOSED),this.getStreamHandler().onClientCancel())};d.isAlive=function(){return this.$BladeRunnerSocketStream2.isAlive()};d.canAmend=function(){return this.$BladeRunnerSocketStream2.canAmend()};d.getStatus=function(){return this.$BladeRunnerSocketStream2.getLastStatus()};d.getStreamId=function(){return this.$BladeRunnerSocketStream2.getRequest().streamId};return c}(b("BladeRunnerStream"));e.exports=a}),null);
__d("BladeRunnerClient",["Base64","BladeRunnerConfig","BladeRunnerLogger","BladeRunnerSocket","BladeRunnerSocketStream","BladeRunnerTypes","BladeRunnerTypesInternal","Random","requireCond","uuid","cr:1817887"],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a!=null?a:b("BladeRunnerSocket").get()}var c=a.prototype;c.requestStream=function(a,c,d,e){e===void 0&&(e={});b("cr:1817887")!=null&&b("cr:1817887").startSinglePulsarTest();var f=new(b("BladeRunnerTypesInternal").GatewayStreamRequest)();f.streamId=this.$1.getNextStreamId();f.requestType=b("BladeRunnerTypes").StreamRequestType.BLADE_RUNNER;f.headers=b("BladeRunnerConfig").patchRequestHeaders(a);f.extraHeader=JSON.stringify(f.headers);f.payload=c!=null?b("Base64").encode(c):null;a=e.requestId!=null;c=!1;a||(c=this.$2(f,e));(a||c)&&(f.instrumentationData=JSON.stringify(e));c=new(b("BladeRunnerSocketStream"))(d,f,this.$1,a);c.send();return c};c.logInfo=function(a){b("BladeRunnerLogger").info(a)};c.bumpCounter=function(a){b("BladeRunnerLogger").bumpCounter(a)};c.$2=function(a,c){if(c.requestId!=null)return!1;var d=a.getHeaders().method;d=b("BladeRunnerLogger").shouldLogE2E(d);a=a.getHeaders().requestId;d&&(c.requestId=a!=null?a:b("uuid")());return d};return a}();e.exports=a}),null);
__d("TWriteBuffer",[],(function(a,b,c,d,e,f){a=function(){function a(b){b===void 0&&(b=a.DEFAULT_BYTE_BUFFER_SIZE),this.$1=new DataView(new ArrayBuffer(b)),this.$2=0}var b=a.prototype;b.write=function(a){this.$2+a.length>this.$1.byteLength&&this.$3(this.$2+a.length);for(var b=0;b<a.length;b++)this.$1.setUint8(this.$2+b,a[b]);this.$2+=a.length;return a.length};b.writeByte=function(a){this.$2+1>this.$1.byteLength&&this.$3(this.$2+1);this.$1.setUint8(this.$2,a);this.$2++;return 1};b.writeFloatBE=function(a){this.$2+Float32Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float32Array.BYTES_PER_ELEMENT);this.$1.setFloat32(this.$2,a);this.$2+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$2+Float64Array.BYTES_PER_ELEMENT>this.$1.byteLength&&this.$3(this.$2+Float64Array.BYTES_PER_ELEMENT);this.$1.setFloat64(this.$2,a);this.$2+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){var a=new Uint8Array(this.$1.buffer,0,this.$2);return a};b.currentSize=function(){return this.$2};b.getUnderlyingDataView=function(){return this.$1};b.$3=function(a){a=a*2;if(!Number.isSafeInteger(a))throw new Error("unable to resize");a=new DataView(new ArrayBuffer(a));for(var b=0;b<this.$2;b++)a.setUint8(b,this.$1.getUint8(b));this.$1=a};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();e.exports=a;a.DEFAULT_BYTE_BUFFER_SIZE=16}),null);
__d("StringToUtf8",["TWriteBuffer"],(function(a,b,c,d,e,f){a=function(a){var c=new(b("TWriteBuffer"))(a.length),d;for(var e=0;e<a.length;e++){d=a.charCodeAt(e);if(d<128)c.writeByte(d);else if(d<2048)c.writeByte(d>>6|192),c.writeByte(d&63|128);else if((d&64512)==55296){if(e+1>=a.length)throw new Error("UTF-16 string is truncated: ["+d.toString(16)+"]");if((a.charCodeAt(e+1)&64512)!==56320)throw new Error("Invalid UTF-16 string: ["+d.toString(16)+", "+a.charCodeAt(e+1).toString(16)+"]");d=65536+((d&1023)<<10)+(a.charCodeAt(++e)&1023);c.writeByte(d>>18|240);c.writeByte(d>>12&63|128);c.writeByte(d>>6&63|128);c.writeByte(d&63|128)}else c.writeByte(d>>12|224),c.writeByte(d>>6&63|128),c.writeByte(d&63|128)}return c.toByteArray()};f.StringToUtf8=a}),null);
__d("ThriftTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,STRUCT:12,MAP:13,SET:14,LIST:15,FLOAT:19});b=a;e.exports=b}),null);
__d("Utf8ToString",[],(function(a,b,c,d,e,f){var g=function(a,b){throw new Error(a+": ["+b.map(function(a){return a.toString(16)}).toString()+"]")},h=function(a){g("Invalid UTF-8 sequence",a)},i=function(a,b){g("Not enough bytes for "+a+"-byte sequence",b)};a=function(a){var b=0,c=[];while(b<a.length){var d=a[b++];if(d<128)c.push(String.fromCharCode(d));else if(d>=128&&d<194)h([d]);else if(d>=194&&d<224){b>=a.length&&i(2,[d]);var e=a[b++];(e&192)!==128&&h([d,e]);c.push(String.fromCharCode((d&31)<<6|e&63))}else if(d>=240&&d<245){b+2>=a.length&&i(4,[d]);e=a[b++];var f=a[b++],g=a[b++];(d==240&&(!(e>=144&&e<192)||(f&192)!==128||(g&192)!==128)||d>=241&&d<244&&((e&192)!==128||(f&192)!==128||(g&192)!==128)||d==244&&(!(e>=128&&e<144)||(f&192)!==128||(g&192)!==128))&&h([d,e,f,g]);e=((d&7)<<18|(e&63)<<12|(f&63)<<6|g&63)-65536;c.push(String.fromCharCode(55296+(e>>10)));c.push(String.fromCharCode(56320+(e&1023)))}else if(d>=245)h([d]);else{b+1>=a.length&&i(3,[d]);f=a[b++];g=a[b++];d==224?f>=160&&f<192||h([d,f,g]):d>=225&&d<237?f>=128&&f<192||h([d,f,g]):d==237?f>=128&&f<160||h([d,f,g]):d>=238&&d<240&&(f>=128&&f<192||h([d,f,g]));g>=128&&g<192||h([d,f,g]);c.push(String.fromCharCode((d&15)<<12|(f&63)<<6|g&63))}}return c.join("")};f.Utf8ToString=a}),null);
__d("TCompactProtocol",["StringToUtf8","ThriftTypes","Utf8ToString"],(function(a,b,c,d,e,f){var g=Object.freeze({CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12,CT_FLOAT:13}),h=Object.freeze({NONE:-1,CT_BOOLEAN_TRUE:g.CT_BOOLEAN_TRUE,CT_BOOLEAN_FALSE:g.CT_BOOLEAN_FALSE}),i=[g.CT_STOP,0,g.CT_BOOLEAN_TRUE,g.CT_BYTE,g.CT_DOUBLE,0,g.CT_I16,0,g.CT_I32,0,g.CT_I64,g.CT_BINARY,g.CT_STRUCT,g.CT_MAP,g.CT_SET,g.CT_LIST,0,0,0,g.CT_FLOAT],j=Math.pow(2,7)-1,k=-1*Math.pow(2,7),l=Math.pow(2,15)-1,m=-1*Math.pow(2,15),n=Math.pow(2,31)-1,o=-1*Math.pow(2,31),p=Math.pow(2,32)-1,q=BigInt("9223372036854775807"),r=BigInt("-9223372036854775808"),s=BigInt("18446744073709551615"),t=BigInt(63),u=BigInt(1),v=BigInt(7),w=BigInt("0x7f"),x=BigInt("0x80"),y=Math.pow(2,4);a=function(){function a(a){this.$4=null,this.$5=null,this.$1=a,this.$2=[],this.$3=0,this.$6=new DataView(new ArrayBuffer(1))}var c=a.prototype;c.readStructBegin=function(){this.$2.push(this.$3),this.$3=0};c.readStructEnd=function(){this.$3=this.$2.pop()};c.writeStructBegin=function(a){this.$2.push(this.$3);this.$3=0;return 0};c.writeStructEnd=function(){this.$3=this.$2.pop();return 0};c.writeFieldBegin=function(a){if(a.ftype===b("ThriftTypes").BOOL){this.$4={fid:a.fid,fname:a.fname,ftype:a.ftype};return 0}else return this.$7(a,h.NONE)};c.writeListBegin=function(a){return this.$8(a)};c.writeSetBegin=function(a){return this.$8(a)};c.writeMapBegin=function(a){var b=0;if(a.size===0)b+=this.$1.writeByte(0);else{b+=this.writeVarint32(a.size);if(a.ktype!=null&&a.vtype!=null)b+=this.$1.writeByte(this.$9(a.ktype)<<4|this.$9(a.vtype));else throw new Error("received invalid map info: "+JSON.stringify(a))}return b};c.$7=function(a,b){var c=0;b=b===h.NONE?this.$9(a.ftype):b;a.fid>this.$3&&a.fid-this.$3<=y-1?c+=this.$1.writeByte(a.fid-this.$3<<4|b):(c+=this.$1.writeByte(b),c+=this.writeI16(a.fid));this.$3=a.fid;return c};c.$8=function(a){var b=0,c=this.$9(a.etype);a.size<=y-2?b+=this.$1.writeByte(a.size<<4|c):(b+=this.$1.writeByte(240|c),b+=this.writeVarint32(a.size));return b};c.readFieldBegin=function(){var a=this.$1.readByte(),c=a&15;if(c===b("ThriftTypes").STOP)return{ftype:b("ThriftTypes").STOP,fid:0};a=(a&240)>>>4;var d;a===0?d=this.readI16():d=this.$3+a;a=this.$10(c);(c===g.CT_BOOLEAN_TRUE||c===g.CT_BOOLEAN_FALSE)&&(this.$5=c===g.CT_BOOLEAN_TRUE);this.$3=d;return{ftype:a,fid:d}};c.readListBegin=function(){return this.$11()};c.readSetBegin=function(){return this.$11()};c.readMapBegin=function(){var a=this.readVarint32();if(a>0){var b=this.$1.readByte(),c=this.$12(b>>4,"readMapBegin:key");b=this.$12(b&15,"readMapBegin:value");return{ktype:this.$10(c),vtype:this.$10(b),size:a}}return{size:a}};c.$12=function(a,b){if(a<0||a>13)throw new Error(b+" read invalid compact type: "+a);return a};c.$11=function(){var a=this.$1.readByte(),b=this.$12(a&15,"_readListOrSetBegin");b=this.$10(b);a=a>>4&15;a===15&&(a=this.readVarint32());return{etype:b,size:a}};c.readFieldEnd=function(){};c.readByte=function(){this.$6.setUint8(0,this.$1.readByte());return this.$6.getInt8(0)};c.writeByte=function(a){if(a<k||a>j)throw new Error("byte to write is out of range: "+a);this.$6.setInt8(0,a);return this.$1.writeByte(this.$6.getUint8(0))};c.readFloat=function(){return this.$1.readFloatBE()};c.writeFloat=function(a){return this.$1.writeFloatBE(a)};c.readDouble=function(){return this.$1.readDoubleBE()};c.writeDouble=function(a){return this.$1.writeDoubleBE(a)};c.writeString=function(a){return this.writeBinary(b("StringToUtf8").StringToUtf8(a))};c.skip=function(a){switch(a){case b("ThriftTypes").STOP:return;case b("ThriftTypes").BOOL:this.readBool();break;case b("ThriftTypes").BYTE:this.readByte();break;case b("ThriftTypes").DOUBLE:this.readDouble();break;case b("ThriftTypes").I16:this.readI16();break;case b("ThriftTypes").I32:this.readI32();break;case b("ThriftTypes").I64:this.readI64();break;case b("ThriftTypes").STRING:this.readString();break;case b("ThriftTypes").STRUCT:this.readStructBegin();var c;while(!0){c=this.readFieldBegin();if(c.ftype===b("ThriftTypes").STOP)break;this.skip(c.ftype)}this.readStructEnd();break;case b("ThriftTypes").MAP:c=this.readMapBegin();if(c.size>0&&c.ktype!=null&&c.vtype!=null){var d=c.ktype,e=c.vtype;for(var f=0;f<c.size;f++)this.skip(d),this.skip(e)}break;case b("ThriftTypes").SET:case b("ThriftTypes").LIST:f=this.$11();for(var d=0;d<f.size;d++)this.skip(f.etype);break;case b("ThriftTypes").FLOAT:this.readFloat();break;default:throw new Error("encoutered unknow thrift type: "+a+" in skip")}};c.toByteArray=function(){return this.$1.toByteArray()};c.writeFieldStop=function(){return this.$1.writeByte(b("ThriftTypes").STOP)};c.writeI16=function(a){if(a<m||a>l)throw new Error("trying to write i16 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI16=function(){var a=this.zigzagToI32(this.readVarint32());if(a<m||a>l)throw new Error("read invalid i16: "+a);return a};c.writeI32=function(a){if(a<o||a>n)throw new Error("i32 out of range: "+a);return this.writeVarint32(this.i32ToZigzag(a))};c.readI32=function(){return this.zigzagToI32(this.readVarint32())};c.writeI64=function(a){return this.writeVarint64(this.i64ToZigzag(a))};c.readI64=function(){return this.zigzagToI64(this.readVarint64())};c.readBool=function(){var a;this.$5!=null?(a=this.$5,this.$5=null):a=this.$1.readByte()===g.CT_BOOLEAN_TRUE;return a};c.writeBool=function(a){var b=0;this.$4!=null?(b+=this.$7(this.$4,a?h.CT_BOOLEAN_TRUE:h.CT_BOOLEAN_FALSE),this.$4=null):b+=this.$1.writeByte(a?g.CT_BOOLEAN_TRUE:g.CT_BOOLEAN_FALSE);return b};c.readBinary=function(){var a=this.readVarint32();return a===0?new Uint8Array(0):this.$1.readBytes(a)};c.writeBinary=function(a){var b=0;b+=this.writeVarint32(a.length);b+=this.$1.write(a);return b};c.i32ToZigzag=function(a){if(a<o||a>n)throw new Error("number: "+a+" is out of range of i32");return(a<<1^(a<0?4294967295:0))>>>0};c.zigzagToI32=function(a){if(a<0||a>p)throw new Error("number: "+a+" is out of range of uint32");return a>>>1^-1*(a&1)};c.i64ToZigzag=function(a){if(a>q||a<r)throw new Error("i64 out of range: "+a.toString());return a>>t^a<<u};c.zigzagToI64=function(a){if(a<0||a>s)throw new Error("invalid uint64: "+a.toString());return(a&u)===u?~(a>>u):a>>u};c.writeVarint32=function(a){if(a<0||a>p)throw new Error("writeVarint32 received out of range uint32: "+a);a=a;var b=0;while(!0)if(a>>>7===0){this.$1.writeByte(a);b++;break}else this.$1.writeByte(a&127|128),b++,a>>>=7;return b};c.readVarint32=function(){var a=0,b=0,c;while(!0){c=this.$1.readByte();a=(a|(c&127)<<b)>>>0;b+=7;if((c&128)==0){if(b===35&&(c&240)!=0)throw new Error("result exceeded 32 bit limit");break}if(b>28)throw new Error("result exceeded 32 bit limit")}return a};c.writeVarint64=function(a){if(a<0||a>s)throw new Error("invalid uint64: "+a.toString());a=a;var b=0;while(!0)if(a>>v==0){this.$1.writeByte(Number(a));b++;break}else this.$1.writeByte(Number(a&w|x)),b++,a>>=v;return b};c.readVarint64=function(){var a=BigInt(0),b=BigInt(0),c;while(!0){c=BigInt(this.$1.readByte());a|=(c&w)<<b;b+=v;if((c&x)==0){if(b==70&&c!==u)throw new Error("result exceeded 64 bit limit");break}if(b>63)throw new Error("result exceeded 64 bit limit")}return a};c.readString=function(){return b("Utf8ToString").Utf8ToString(this.readBinary())};c.getLastFieldId=function(){return this.$3};c.getLastField=function(){return this.$2};c.getBooleanFieldInfo=function(){return this.$4};c.getBooleanValue=function(){return this.$5};c.$9=function(a){return i[a]};c.$10=function(a){switch(a){case g.CT_STOP:return b("ThriftTypes").STOP;case g.CT_BOOLEAN_FALSE:case g.CT_BOOLEAN_TRUE:return b("ThriftTypes").BOOL;case g.CT_BYTE:return b("ThriftTypes").BYTE;case g.CT_I16:return b("ThriftTypes").I16;case g.CT_I32:return b("ThriftTypes").I32;case g.CT_I64:return b("ThriftTypes").I64;case g.CT_DOUBLE:return b("ThriftTypes").DOUBLE;case g.CT_FLOAT:return b("ThriftTypes").FLOAT;case g.CT_BINARY:return b("ThriftTypes").STRING;case g.CT_LIST:return b("ThriftTypes").LIST;case g.CT_SET:return b("ThriftTypes").SET;case g.CT_MAP:return b("ThriftTypes").MAP;case g.CT_STRUCT:return b("ThriftTypes").STRUCT;default:throw new Error("don't know what type")}};return a}();e.exports=a}),null);
__d("TNoOpWriteBuffer",[],(function(a,b,c,d,e,f){a=function(){function a(){this.$1=0}var b=a.prototype;b.write=function(a){this.$1+=a.length;return a.length};b.writeByte=function(a){this.$1++;return 1};b.writeFloatBE=function(a){this.$1+=Float32Array.BYTES_PER_ELEMENT;return Float32Array.BYTES_PER_ELEMENT};b.writeDoubleBE=function(a){this.$1+=Float64Array.BYTES_PER_ELEMENT;return Float64Array.BYTES_PER_ELEMENT};b.toByteArray=function(){throw new Error("operation not supported")};b.currentSize=function(){return this.$1};b.readByte=function(){throw new Error("operation not supported")};b.readBytes=function(a){throw new Error("operation not supported")};b.readFloatBE=function(){throw new Error("operation not supported")};b.readDoubleBE=function(){throw new Error("operation not supported")};return a}();e.exports=a}),null);
__d("TReadBuffer",[],(function(a,b,c,d,e,f){a=function(){function a(a){this.$1=a,this.$2=0}var b=a.prototype;b.readByte=function(){if(this.$2<this.$1.length)return this.$1[this.$2++];throw new Error("no available byte to read")};b.readBytes=function(a){if(a<0)throw new Error("cannot readBytes of negative length: "+a);if(a+this.$2>this.$1.length)throw new Error("not enough bytes to read");var b=new Uint8Array(this.$1.buffer,this.$3(),a);this.$2+=a;return b};b.readFloatBE=function(){if(Float32Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat32(this.$3());this.$2+=Float32Array.BYTES_PER_ELEMENT;return a};b.readDoubleBE=function(){if(Float64Array.BYTES_PER_ELEMENT+this.$2>this.$1.length)throw new Error("not enough bytes to read");var a=new DataView(this.$1.buffer).getFloat64(this.$3());this.$2+=Float64Array.BYTES_PER_ELEMENT;return a};b.$3=function(){return this.$2+this.$1.byteOffset};b.getCurrentCursor=function(){return this.$2};b.writeByte=function(a){throw new Error("operation not supported")};b.write=function(a){throw new Error("operation not supported")};b.toByteArray=function(){throw new Error("operation not supported")};b.writeFloatBE=function(a){throw new Error("operation not supported")};b.writeDoubleBE=function(a){throw new Error("operation not supported")};return a}();e.exports=a}),null);
__d("CompactSerializer",["TCompactProtocol","TNoOpWriteBuffer","TReadBuffer","TWriteBuffer"],(function(a,b,c,d,e,f){f.deserializeNoThrow=a;f.deserialize=g;f.serializeNoThrow=c;f.serialize=h;function a(a,b,c){try{return g(a,b)}catch(a){c!=null&&c(a)}return null}function g(a,c){a=new(b("TReadBuffer"))(a);a=new(b("TCompactProtocol"))(a);return c(a)}function c(a,b,c,d){c===void 0&&(c=!1);try{return h(a,b,c)}catch(a){d!=null&&d(a)}return null}function h(a,c,d){d===void 0&&(d=!1);if(d){d=new(b("TNoOpWriteBuffer"))();var e=new(b("TCompactProtocol"))(d);c(a,e);e=new(b("TWriteBuffer"))(d.currentSize())}else e=new(b("TWriteBuffer"))();d=new(b("TCompactProtocol"))(e);c(a,d);return d.toByteArray()}}),null);
__d("DgwClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1755537");c=b("FalcoLoggerInternal").create("dgw_client",a);e.exports=c}),null);
__d("DGWLoggingContext",["DgwClientFalcoEvent","FBLogger","$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g="dgw_client";f.DGW_MODULE=g;a=b("$InternalEnum")({STREAM_COMPONENT:"WebStream",ACK_MANAGER_COMPONENT:"WebStreamAckManager",CODEC_COMPONENT:"WebCodec"});f.DGWLoggingComponent=a;c=function(){function a(a,b,c,d){this.$4=a,this.$1=b,this.$3=c,this.$2=d}var c=a.prototype;c.logEvent=function(a,c,d){this.$5(a,c,null,d);a="dgwComponent: "+a+" | Event: "+c;d!=null&&(a+=" | Extra Info: "+d);b("FBLogger")(g).debug(a)};c.$5=function(a,c,d,e){var f=this,g=this.$1;g!=null&&b("DgwClientFalcoEvent").log(function(){return{event:c,logging_id:g,dgw_version:f.$4,error:d,uuid:f.$2,dgw_component:a,extra_info:e,destination_tier:f.$3}})};c.logError=function(a,c,d,e){this.$5(a,c,d,e),b("FBLogger")(g).mustfix("Error received. Event: "+c+" | Error: "+d)};c.logWarn=function(a,c,d,e){this.$5(a,c,d,e),b("FBLogger")(g).warn("Warning received. Event: "+c+" | Warning: "+d)};return a}();f.DGWLoggingContext=c}),null);
__d("DGWAckManager",["regeneratorRuntime","Promise","DGWLoggingContext"],(function(a,b,c,d,e,f){"use strict";var g=function(){var b=a.prototype;b.stopTracking=function(a){clearTimeout(this.$1),this.$3(a)};function a(a,b,c){var d=this;this.$3=c;this.sendId=a;this.$2=b;this.handleAckReceived=function(){d.stopTracking(!0)};this.$1=setTimeout(function(){d.stopTracking(!1)},b)}return a}();a=function(){function a(a){this.$1=new Map(),this.$2=a}var c=a.prototype;c.waitForAck=function(a,c){var d,e;return b("regeneratorRuntime").async(function(f){while(1)switch(f.prev=f.next){case 0:d=this.$1;f.prev=1;f.next=4;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b,e){d.set(a,new g(a,c,b))}));case 4:e=f.sent;e===!0?this.$2.logEvent(b("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Received ACK","sendId: "+a):this.$2.logWarn(b("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"ACK timeout","Request "+a+" timed out after "+c+"ms");d["delete"](a);return f.abrupt("return",e);case 10:f.prev=10;f.t0=f["catch"](1);d["delete"](a);throw f.t0;case 14:case"end":return f.stop()}},null,this,[[1,10]])};c.handleAckReceived=function(a){var c=this.$1.get(a);if(c===void 0){this.$2.logWarn(b("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"untracked ACK","Received ACK for ackId "+a+" which was not being tracked");return}c.handleAckReceived()};c.clearPendingAcks=function(){var a=this;this.$1.forEach(function(c,d,e){a.$2.logEvent(b("DGWLoggingContext").DGWLoggingComponent.ACK_MANAGER_COMPONENT,"Clearing pending ACK with ackId "+c.sendId),c.stopTracking(!1),e["delete"](d)})};return a}();f.DGWAckManager=a}),null);
__d("DGWExponentialBackoff",["regeneratorRuntime","Promise"],(function(a,b,c,d,e,f){"use strict";f.callWithExponentialBackoff=a;var g={maxRetries:5,baseRetryInterval:1e3,backoffFactor:Math.sqrt(2)},h=function(b){babelHelpers.inheritsLoose(a,b);function a(a,c){a=b.call(this,a)||this;a.errors=c;return a}return a}(babelHelpers.wrapNativeSuper(Error));function a(a,c){return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:c===void 0&&(c=g);d.prev=1;d.next=4;return b("regeneratorRuntime").awrap(i(a,c));case 4:return d.abrupt("return",d.sent);case 7:d.prev=7;d.t0=d["catch"](1);throw d.t0.errors[d.t0.errors.length-1];case 10:case"end":return d.stop()}},null,this,[[1,7]])}function i(a,c){var d,e,f,g,i;return b("regeneratorRuntime").async(function(k){while(1)switch(k.prev=k.next){case 0:d=0,e=[],f=c.baseRetryInterval,g=c.backoffFactor;case 4:if(!(d<=c.maxRetries)){k.next=20;break}k.prev=5;k.next=8;return b("regeneratorRuntime").awrap(a());case 8:i=k.sent;return k.abrupt("return",i);case 12:k.prev=12,k.t0=k["catch"](5),e.push(k.t0);case 15:k.next=17;return b("regeneratorRuntime").awrap(j(f*Math.pow(g,d)));case 17:++d;k.next=4;break;case 20:throw new h("Max call count exceeded",e);case 21:case"end":return k.stop()}},null,this,[[5,12]])}function j(a){return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:c.next=2;return b("regeneratorRuntime").awrap(new(b("Promise"))(function(b){return setTimeout(b,a)}));case 2:case"end":return c.stop()}},null,this)}}),null);
__d("DGWStreamEvents",["DGWLoggingContext","FBLogger"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$3=new Map(),this.$4=new Map(),this.$5=a}var c=a.prototype;c.streamEstablished=function(){this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"open"),this.$2=Date.now()};c.streamEstablishmentPending=function(){this.$1=Date.now(),this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"streamPending")};c.dataSent=function(a,c,d){var e=d?"sendWithAckRequested":"sendWithoutAckRequested";this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,e,"sendId:"+a+", payloadSize:"+c);this.$3.set(a,{ackRequested:d,payloadSize:c,sendTimestamp:Date.now()})};c.ackReceived=function(a){b("FBLogger")(b("DGWLoggingContext").DGW_MODULE).debug("DGWStreamEvents ackReceived - sendId:"+a);a=this.$3.get(a);a!=null&&(a.ackReceivedTimestamp=Date.now())};c.ackSent=function(a){b("FBLogger")(b("DGWLoggingContext").DGW_MODULE).debug("DGWStreamEvents ackSent - ackId:"+a),this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"ACK sent","ackId: "+a)};c.dataReceived=function(a,c,d){b("FBLogger")(b("DGWLoggingContext").DGW_MODULE).debug("dataReceived - sendId:"+a+", payloadSize:"+c+", ackRequested:"+d.toString()),this.$4.set(a,{ackRequested:d,payloadSize:c,receiveTimestamp:Date.now()})};c.streamClosed=function(a,c){this.$6=Date.now();var d=this.$7();a?this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"Stream closed gracefully",d):(b("FBLogger")(b("DGWLoggingContext").DGW_MODULE).debug("streamClosed with errors. DGWStreamEvents: ",d),this.$5.logError(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"Stream closed abnormally",c,d))};c.connectionEstablishmentFailure=function(a){this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"WebSocket connection establishment failure","WebSocket close code: "+a)};c.streamEstablishmentFailure=function(a,c){this.$5.logError(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"Failed to establish DGW Stream","Last seen error: "+a.toString(),c)};c.error=function(a,c){var d={};d.msg=c;d.state=this.$7();this.$5.logError(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,a,JSON.stringify(d))};c.$7=function(){var a={};a.currentNetworkCondition=window.navigator&&window.navigator.onLine==!0;a.establishRequestTimestamp=this.$1;a.establishedTimestamp=this.$2;a.streamClosedTimestamp=this.$6;a.sendHistory=JSON.stringify(Array.from(this.$3.entries()));a.receiveHistory=JSON.stringify(Array.from(this.$4.entries()));return JSON.stringify(a)};return a}();f.DGWStreamEvents=a}),null);
__d("DGWCppBridge",["Promise"],(function(c,d,e,g,i,k){var l=function(){var e=typeof document!=="undefined"&&document.currentScript?document.currentScript.src:void 0;typeof __filename!=="undefined"&&(e=e||__filename);return function(g){g=g||{};var i;i||(i=typeof g!=="undefined"?g:{});var k,m;i.ready=new(d("Promise"))(function(c,d){k=c,m=d});var n={},o;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o]);var q=!1,r=!1,s=!1,t;q="object"===typeof window;r="function"===typeof importScripts;s="object"===typeof process&&"object"===typeof process.versions&&"string"===typeof process.versions.node;t=!q&&!s&&!r;var u="",v,w,x,y;s?(u=r?d.call(null,"path").dirname(u)+"/":__dirname+"/",v=function(c,e){var g=Y(c);if(g)return e?g:g.toString();x||(x=d.call(null,"fs"));y||(y=d.call(null,"path"));c=y.normalize(c);return x.readFileSync(c,e?null:"utf8")},w=function(c){c=v(c,!0);c.buffer||(c=new Uint8Array(c));ma(c.buffer);return c},1<process.argv.length&&process.argv[1].replace(/\\/g,"/"),process.argv.slice(2),process.on("uncaughtException",function(c){throw c}),process.on("unhandledRejection",L),i.inspect=function(){return"[Emscripten Module object]"}):t?("undefined"!=typeof read&&(v=function(c){var d=Y(c);return d?W(d):read(c)}),w=function(c){var d;if(d=Y(c))return d;if("function"===typeof readbuffer)return new Uint8Array(readbuffer(c));d=read(c,"binary");ma("object"===typeof d);return d},"undefined"!==typeof print&&("undefined"===typeof console&&(console={}),emptyFunction=print,emptyFunction=emptyFunction="undefined"!==typeof printErr?printErr:print)):(q||r)&&(r?u=self.location.href:document.currentScript&&(u=document.currentScript.src),e&&(u=e),0!==u.indexOf("blob:")?u=u.substr(0,u.lastIndexOf("/")+1):u="",v=function(c){try{var d=new XMLHttpRequest();d.open("GET",c,!1);d.send(null);return d.responseText}catch(d){if(c=Y(c))return W(c);throw d}},r&&(w=function(c){try{var d=new XMLHttpRequest();d.open("GET",c,!1);d.responseType="arraybuffer";d.send(null);return new Uint8Array(d.response)}catch(d){if(c=Y(c))return c;throw d}}));i.print||emptyFunction.bind(console);var z=i.printErr||emptyFunction.bind(console);for(o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o]);n=null;var A;i.wasmBinary&&(A=i.wasmBinary);i.noExitRuntime&&i.noExitRuntime;function B(){this.buffer=new ArrayBuffer(K/65536*65536),this.grow=function(c){return Rb(c)}}function ia(){this.exports=function(i,k,l){function q(i,aa,Ub){aa.a;var ba=l,ca=new i.Int8Array(Ub),da=new i.Int16Array(Ub),k=new i.Int32Array(Ub),ea=new i.Uint8Array(Ub);new i.Uint16Array(Ub);var fa=new i.Uint32Array(Ub);new i.Float32Array(Ub);var Vb;new i.Float64Array(Ub);var ga=i.Math.imul,Wb;i.Math.fround;var Xb;i.Math.abs;var Yb;i.Math.clz32;i.Math.min;var m;i.Math.max;var Zb;i.Math.floor;var $b;i.Math.ceil;var ac;i.Math.sqrt;var q=aa.abort,bc;i.NaN;var ma;i.Infinity;var T=aa.c,Z=aa.d,Y=aa.e,L=aa.f,A=aa.g,D=aa.h,E=aa.i,G=aa.j,H=aa.k,I=aa.l,F=aa.m,J=aa.n,cc=aa.o,Fa=aa.p,M=aa.q,N=aa.r,Ra=aa.s,Sa=aa.t,Xa=aa.u,O=aa.v,P=aa.w,Q=aa.x,R=aa.y,V=5250992;function z(v){v=v|0;var c=0,i=0,l=0,n=0,w=0,x=0,o=0,r=0,s=0,t=0,u=0,y=0;y=V-16|0;V=y;a:{b:{c:{d:{e:{f:{g:{h:{i:{j:{k:{l:{if(v>>>0<=244){n=k[1899];w=v>>>0<11?16:v+11&-8;v=w>>>3|0;c=n>>>v|0;if(c&3){i=v+((c^-1)&1)|0;w=i<<3;c=k[w+7644>>2];v=c+8|0;l=k[c+8>>2];w=w+7636|0;m:{if((l|0)==(w|0)){k[1899]=Ge(i)&n;break m}k[l+12>>2]=w;k[w+8>>2]=l}i=i<<3;k[c+4>>2]=i|3;c=c+i|0;k[c+4>>2]=k[c+4>>2]|1;break a}r=k[1901];if(w>>>0<=r>>>0)break l;if(c){i=2<<v;v=(0-i|i)&c<<v;v=(0-v&v)+-1|0;c=v>>>12&16;i=c;v=v>>>c|0;c=v>>>5&8;i=i|c;v=v>>>c|0;c=v>>>2&4;i=i|c;v=v>>>c|0;c=v>>>1&2;i=i|c;v=v>>>c|0;c=v>>>1&1;i=(i|c)+(v>>>c|0)|0;l=i<<3;c=k[l+7644>>2];v=k[c+8>>2];l=l+7636|0;n:{if((v|0)==(l|0)){n=Ge(i)&n;k[1899]=n;break n}k[v+12>>2]=l;k[l+8>>2]=v}v=c+8|0;k[c+4>>2]=w|3;x=c+w|0;i=i<<3;w=i-w|0;k[x+4>>2]=w|1;k[c+i>>2]=w;if(r){i=r>>>3|0;c=(i<<3)+7636|0;l=k[1904];i=1<<i;o:{if(!(i&n)){k[1899]=i|n;i=c;break o}i=k[c+8>>2]}k[c+8>>2]=l;k[i+12>>2]=l;k[l+12>>2]=c;k[l+8>>2]=i}k[1904]=x;k[1901]=w;break a}t=k[1900];if(!t)break l;v=(t&0-t)+-1|0;c=v>>>12&16;i=c;v=v>>>c|0;c=v>>>5&8;i=i|c;v=v>>>c|0;c=v>>>2&4;i=i|c;v=v>>>c|0;c=v>>>1&2;i=i|c;v=v>>>c|0;c=v>>>1&1;c=k[((i|c)+(v>>>c|0)<<2)+7900>>2];x=(k[c+4>>2]&-8)-w|0;i=c;while(1){p:{v=k[i+16>>2];if(!v){v=k[i+20>>2];if(!v)break p}l=(k[v+4>>2]&-8)-w|0;i=l>>>0<x>>>0;x=i?l:x;c=i?v:c;i=v;continue}break}u=c+w|0;if(u>>>0<=c>>>0)break k;s=k[c+24>>2];l=k[c+12>>2];if((l|0)!=(c|0)){v=k[c+8>>2];k[v+12>>2]=l;k[l+8>>2]=v;break b}i=c+20|0;v=k[i>>2];if(!v){v=k[c+16>>2];if(!v)break j;i=c+16|0}while(1){o=i;l=v;i=v+20|0;v=k[i>>2];if(v)continue;i=l+16|0;v=k[l+16>>2];if(v)continue;break}k[o>>2]=0;break b}w=-1;if(v>>>0>4294967231)break l;c=v+11|0;w=c&-8;r=k[1900];if(!r)break l;x=0-w|0;c=c>>>8|0;n=0;q:{if(!c)break q;n=31;if(w>>>0>16777215)break q;i=c+1048320>>>16&8;c=c<<i;v=c+520192>>>16&4;n=c<<v;c=n+245760>>>16&2;v=(n<<c>>>15|0)-(c|(v|i))|0;n=(v<<1|w>>>v+21&1)+28|0}i=k[(n<<2)+7900>>2];r:{s:{t:{if(!i){v=0;break t}v=0;c=w<<((n|0)==31?0:25-(n>>>1|0)|0);while(1){u:{o=(k[i+4>>2]&-8)-w|0;if(o>>>0>=x>>>0)break u;l=i;x=o;if(x)break u;x=0;v=i;break s}o=k[i+20>>2];i=k[((c>>>29&4)+i|0)+16>>2];v=o?(o|0)==(i|0)?v:o:v;c=c<<1;if(i)continue;break}}if(!(v|l)){v=2<<n;v=(0-v|v)&r;if(!v)break l;v=(v&0-v)+-1|0;c=v>>>12&16;i=c;v=v>>>c|0;c=v>>>5&8;i=i|c;v=v>>>c|0;c=v>>>2&4;i=i|c;v=v>>>c|0;c=v>>>1&2;i=i|c;v=v>>>c|0;c=v>>>1&1;v=k[((i|c)+(v>>>c|0)<<2)+7900>>2]}if(!v)break r}while(1){i=(k[v+4>>2]&-8)-w|0;c=i>>>0<x>>>0;x=c?i:x;l=c?v:l;c=k[v+16>>2];c?v=c:v=k[v+20>>2];if(v)continue;break}}if(!l|x>>>0>=k[1901]-w>>>0)break l;n=l+w|0;if(n>>>0<=l>>>0)break k;s=k[l+24>>2];c=k[l+12>>2];if((l|0)!=(c|0)){v=k[l+8>>2];k[v+12>>2]=c;k[c+8>>2]=v;break c}i=l+20|0;v=k[i>>2];if(!v){v=k[l+16>>2];if(!v)break i;i=l+16|0}while(1){o=i;c=v;i=v+20|0;v=k[i>>2];if(v)continue;i=c+16|0;v=k[c+16>>2];if(v)continue;break}k[o>>2]=0;break c}c=k[1901];if(c>>>0>=w>>>0){v=k[1904];i=c-w|0;v:{if(i>>>0>=16){k[1901]=i;l=v+w|0;k[1904]=l;k[l+4>>2]=i|1;k[v+c>>2]=i;k[v+4>>2]=w|3;break v}k[1904]=0;k[1901]=0;k[v+4>>2]=c|3;c=v+c|0;k[c+4>>2]=k[c+4>>2]|1}v=v+8|0;break a}l=k[1902];if(l>>>0>w>>>0){c=l-w|0;k[1902]=c;v=k[1905];i=v+w|0;k[1905]=i;k[i+4>>2]=c|1;k[v+4>>2]=w|3;v=v+8|0;break a}v=0;x=w+47|0;i=x;k[2017]?c=k[2019]:(k[2020]=-1,k[2021]=-1,k[2018]=4096,k[2019]=4096,k[2017]=y+12&-16^1431655768,k[2022]=0,k[2010]=0,c=4096);n=i+c|0;o=0-c|0;i=n&o;if(i>>>0<=w>>>0)break a;c=k[2009];if(c){r=k[2007];s=r+i|0;if(s>>>0<=r>>>0|s>>>0>c>>>0)break a}if(ea[8040]&4)break f;w:{x:{c=k[1905];if(c){v=8044;while(1){r=k[v>>2];if(r+k[v+4>>2]>>>0>c>>>0?r>>>0<=c>>>0:0)break x;v=k[v+8>>2];if(v)continue;break}}c=Nb(0);if((c|0)==-1)break g;n=i;v=k[2018];l=v+-1|0;l&c&&(n=(i-c|0)+(c+l&0-v)|0);if(n>>>0<=w>>>0|n>>>0>2147483646)break g;v=k[2009];if(v){l=k[2007];o=l+n|0;if(o>>>0<=l>>>0|o>>>0>v>>>0)break g}v=Nb(n);if((c|0)!=(v|0))break w;break e}n=o&n-l;if(n>>>0>2147483646)break g;c=Nb(n);if((c|0)==(k[v>>2]+k[v+4>>2]|0))break h;v=c}if(!((v|0)==-1|w+48>>>0<=n>>>0)){c=k[2019];c=c+(x-n|0)&0-c;if(c>>>0>2147483646){c=v;break e}if((Nb(c)|0)!=-1){n=c+n|0;c=v;break e}Nb(0-n|0);break g}c=v;if((v|0)!=-1)break e;break g}q()}l=0;break b}c=0;break c}if((c|0)!=-1)break e}k[2010]=k[2010]|4}if(i>>>0>2147483646)break d;c=Nb(i);v=Nb(0);if(c>>>0>=v>>>0|(c|0)==-1|(v|0)==-1)break d;n=v-c|0;if(n>>>0<=w+40>>>0)break d}v=k[2007]+n|0;k[2007]=v;v>>>0>fa[2008]&&(k[2008]=v);y:{z:{A:{i=k[1905];if(i){v=8044;while(1){l=k[v>>2];x=k[v+4>>2];if((l+x|0)==(c|0))break A;v=k[v+8>>2];if(v)continue;break}break z}v=k[1903];(c>>>0>=v>>>0?v:0)||(k[1903]=c);v=0;k[2012]=n;k[2011]=c;k[1907]=-1;k[1908]=k[2017];k[2014]=0;while(1){i=v<<3;l=i+7636|0;k[i+7644>>2]=l;k[i+7648>>2]=l;v=v+1|0;if((v|0)!=32)continue;break}v=n+-40|0;i=c+8&7?-8-c&7:0;l=v-i|0;k[1902]=l;i=c+i|0;k[1905]=i;k[i+4>>2]=l|1;k[(v+c|0)+4>>2]=40;k[1906]=k[2021];break y}if(ea[v+12|0]&8|c>>>0<=i>>>0|l>>>0>i>>>0)break z;k[v+4>>2]=n+x;v=i+8&7?-8-i&7:0;c=v+i|0;k[1905]=c;l=k[1902]+n|0;v=l-v|0;k[1902]=v;k[c+4>>2]=v|1;k[(i+l|0)+4>>2]=40;k[1906]=k[2021];break y}l=k[1903];c>>>0<l>>>0&&(k[1903]=c,l=0);x=c+n|0;v=8044;B:{C:{D:{E:{F:{G:{while(1){if((x|0)!=k[v>>2]){v=k[v+8>>2];if(v)continue;break G}break}if(!(ea[v+12|0]&8))break F}v=8044;while(1){l=k[v>>2];if(l>>>0<=i>>>0){x=l+k[v+4>>2]|0;if(x>>>0>i>>>0)break E}v=k[v+8>>2];continue}}k[v>>2]=c;k[v+4>>2]=k[v+4>>2]+n;s=(c+8&7?-8-c&7:0)+c|0;k[s+4>>2]=w|3;c=x+(x+8&7?-8-x&7:0)|0;v=(c-s|0)-w|0;o=w+s|0;if((c|0)==(i|0)){k[1905]=o;v=k[1902]+v|0;k[1902]=v;k[o+4>>2]=v|1;break C}if(k[1904]==(c|0)){k[1904]=o;v=k[1901]+v|0;k[1901]=v;k[o+4>>2]=v|1;k[v+o>>2]=v;break C}i=k[c+4>>2];if((i&3)==1){t=i&-8;H:{if(i>>>0<=255){w=i>>>3|0;i=k[c+8>>2];l=k[c+12>>2];if((l|0)==(i|0)){k[1899]=k[1899]&Ge(w);break H}k[i+12>>2]=l;k[l+8>>2]=i;break H}r=k[c+24>>2];n=k[c+12>>2];I:{if((n|0)!=(c|0)){i=k[c+8>>2];k[i+12>>2]=n;k[n+8>>2]=i;break I}J:{x=c+20|0;w=k[x>>2];if(w)break J;x=c+16|0;w=k[x>>2];if(w)break J;n=0;break I}while(1){i=x;n=w;x=n+20|0;w=k[x>>2];if(w)continue;x=n+16|0;w=k[n+16>>2];if(w)continue;break}k[i>>2]=0}if(!r)break H;i=k[c+28>>2];l=(i<<2)+7900|0;K:{if(k[l>>2]==(c|0)){k[l>>2]=n;if(n)break K;k[1900]=k[1900]&Ge(i);break H}k[r+(k[r+16>>2]==(c|0)?16:20)>>2]=n;if(!n)break H}k[n+24>>2]=r;i=k[c+16>>2];i&&(k[n+16>>2]=i,k[i+24>>2]=n);i=k[c+20>>2];if(!i)break H;k[n+20>>2]=i;k[i+24>>2]=n}c=c+t|0;v=v+t|0}k[c+4>>2]=k[c+4>>2]&-2;k[o+4>>2]=v|1;k[v+o>>2]=v;if(v>>>0<=255){c=v>>>3|0;v=(c<<3)+7636|0;i=k[1899];c=1<<c;L:{if(!(i&c)){k[1899]=c|i;c=v;break L}c=k[v+8>>2]}k[v+8>>2]=o;k[c+12>>2]=o;k[o+12>>2]=v;k[o+8>>2]=c;break C}i=o;l=v>>>8|0;c=0;M:{if(!l)break M;c=31;if(v>>>0>16777215)break M;w=l+1048320>>>16&8;l=l<<w;c=l+520192>>>16&4;n=l<<c;l=n+245760>>>16&2;c=(n<<l>>>15|0)-(l|(c|w))|0;c=(c<<1|v>>>c+21&1)+28|0}k[i+28>>2]=c;k[o+16>>2]=0;k[o+20>>2]=0;i=(c<<2)+7900|0;l=k[1900];w=1<<c;N:{if(!(l&w)){k[1900]=l|w;k[i>>2]=o;break N}x=v<<((c|0)==31?0:25-(c>>>1|0)|0);c=k[i>>2];while(1){i=c;if((k[c+4>>2]&-8)==(v|0))break D;c=x>>>29|0;x=x<<1;l=(c&4)+i|0;c=k[l+16>>2];if(c)continue;break}k[l+16>>2]=o}k[o+24>>2]=i;k[o+12>>2]=o;k[o+8>>2]=o;break C}v=n+-40|0;l=c+8&7?-8-c&7:0;o=v-l|0;k[1902]=o;l=c+l|0;k[1905]=l;k[l+4>>2]=o|1;k[(v+c|0)+4>>2]=40;k[1906]=k[2021];v=(x+(x+-39&7?39-x&7:0)|0)+-47|0;l=v>>>0<i+16>>>0?i:v;k[l+4>>2]=27;v=k[2014];k[l+16>>2]=k[2013];k[l+20>>2]=v;v=k[2012];k[l+8>>2]=k[2011];k[l+12>>2]=v;k[2013]=l+8;k[2012]=n;k[2011]=c;k[2014]=0;v=l+24|0;while(1){k[v+4>>2]=7;c=v+8|0;v=v+4|0;if(x>>>0>c>>>0)continue;break}if((i|0)==(l|0))break y;k[l+4>>2]=k[l+4>>2]&-2;n=l-i|0;k[i+4>>2]=n|1;k[l>>2]=n;if(n>>>0<=255){c=n>>>3|0;v=(c<<3)+7636|0;l=k[1899];c=1<<c;O:{if(!(l&c)){k[1899]=c|l;c=v;break O}c=k[v+8>>2]}k[v+8>>2]=i;k[c+12>>2]=i;k[i+12>>2]=v;k[i+8>>2]=c;break y}k[i+16>>2]=0;k[i+20>>2]=0;c=i;l=n>>>8|0;v=0;P:{if(!l)break P;v=31;if(n>>>0>16777215)break P;x=l+1048320>>>16&8;l=l<<x;v=l+520192>>>16&4;o=l<<v;l=o+245760>>>16&2;v=(o<<l>>>15|0)-(l|(v|x))|0;v=(v<<1|n>>>v+21&1)+28|0}k[c+28>>2]=v;c=(v<<2)+7900|0;l=k[1900];x=1<<v;Q:{if(!(l&x)){k[1900]=l|x;k[c>>2]=i;k[i+24>>2]=c;break Q}v=n<<((v|0)==31?0:25-(v>>>1|0)|0);c=k[c>>2];while(1){l=c;if((n|0)==(k[c+4>>2]&-8))break B;c=v>>>29|0;v=v<<1;x=l+(c&4)|0;c=k[x+16>>2];if(c)continue;break}k[x+16>>2]=i;k[i+24>>2]=l}k[i+12>>2]=i;k[i+8>>2]=i;break y}v=k[i+8>>2];k[v+12>>2]=o;k[i+8>>2]=o;k[o+24>>2]=0;k[o+12>>2]=i;k[o+8>>2]=v}v=s+8|0;break a}v=k[l+8>>2];k[v+12>>2]=i;k[l+8>>2]=i;k[i+24>>2]=0;k[i+12>>2]=l;k[i+8>>2]=v}v=k[1902];if(v>>>0<=w>>>0)break d;c=v-w|0;k[1902]=c;v=k[1905];i=v+w|0;k[1905]=i;k[i+4>>2]=c|1;k[v+4>>2]=w|3;v=v+8|0;break a}k[1897]=48;v=0;break a}R:{if(!s)break R;v=k[l+28>>2];i=(v<<2)+7900|0;S:{if(k[i>>2]==(l|0)){k[i>>2]=c;if(c)break S;r=Ge(v)&r;k[1900]=r;break R}k[s+(k[s+16>>2]==(l|0)?16:20)>>2]=c;if(!c)break R}k[c+24>>2]=s;v=k[l+16>>2];v&&(k[c+16>>2]=v,k[v+24>>2]=c);v=k[l+20>>2];if(!v)break R;k[c+20>>2]=v;k[v+24>>2]=c}T:{if(x>>>0<=15){v=w+x|0;k[l+4>>2]=v|3;v=v+l|0;k[v+4>>2]=k[v+4>>2]|1;break T}k[l+4>>2]=w|3;k[n+4>>2]=x|1;k[n+x>>2]=x;if(x>>>0<=255){c=x>>>3|0;v=(c<<3)+7636|0;i=k[1899];c=1<<c;U:{if(!(i&c)){k[1899]=c|i;c=v;break U}c=k[v+8>>2]}k[v+8>>2]=n;k[c+12>>2]=n;k[n+12>>2]=v;k[n+8>>2]=c;break T}c=n;i=x>>>8|0;v=0;V:{if(!i)break V;v=31;if(x>>>0>16777215)break V;w=i+1048320>>>16&8;i=i<<w;v=i+520192>>>16&4;o=i<<v;i=o+245760>>>16&2;v=(o<<i>>>15|0)-(i|(v|w))|0;v=(v<<1|x>>>v+21&1)+28|0}k[c+28>>2]=v;k[n+16>>2]=0;k[n+20>>2]=0;c=(v<<2)+7900|0;W:{i=1<<v;X:{if(!(i&r)){k[1900]=i|r;k[c>>2]=n;break X}v=x<<((v|0)==31?0:25-(v>>>1|0)|0);w=k[c>>2];while(1){c=w;if((k[c+4>>2]&-8)==(x|0))break W;i=v>>>29|0;v=v<<1;i=(i&4)+c|0;w=k[i+16>>2];if(w)continue;break}k[i+16>>2]=n}k[n+24>>2]=c;k[n+12>>2]=n;k[n+8>>2]=n;break T}v=k[c+8>>2];k[v+12>>2]=n;k[c+8>>2]=n;k[n+24>>2]=0;k[n+12>>2]=c;k[n+8>>2]=v}v=l+8|0;break a}Y:{if(!s)break Y;v=k[c+28>>2];i=(v<<2)+7900|0;Z:{if(k[i>>2]==(c|0)){k[i>>2]=l;if(l)break Z;k[1900]=Ge(v)&t;break Y}k[s+(k[s+16>>2]==(c|0)?16:20)>>2]=l;if(!l)break Y}k[l+24>>2]=s;v=k[c+16>>2];v&&(k[l+16>>2]=v,k[v+24>>2]=l);v=k[c+20>>2];if(!v)break Y;k[l+20>>2]=v;k[v+24>>2]=l}_:{if(x>>>0<=15){v=w+x|0;k[c+4>>2]=v|3;v=v+c|0;k[v+4>>2]=k[v+4>>2]|1;break _}k[c+4>>2]=w|3;k[u+4>>2]=x|1;k[x+u>>2]=x;if(r){i=r>>>3|0;v=(i<<3)+7636|0;l=k[1904];i=1<<i;$:{if(!(i&n)){k[1899]=i|n;i=v;break $}i=k[v+8>>2]}k[v+8>>2]=l;k[i+12>>2]=l;k[l+12>>2]=v;k[l+8>>2]=i}k[1904]=u;k[1901]=x}v=c+8|0}V=y+16|0;return v|0}function U(l){l=l|0;var c,d,e=0,g,i=0,m=0,n;a:{if(!l)break a;e=l+-8|0;d=k[l+-4>>2];l=d&-8;i=e+l|0;b:{if(d&1)break b;if(!(d&3))break a;d=k[e>>2];e=e-d|0;if(e>>>0<fa[1903])break a;l=l+d|0;if(k[1904]!=(e|0)){if(d>>>0<=255){g=k[e+8>>2];d=d>>>3|0;c=k[e+12>>2];if((c|0)==(g|0)){k[1899]=k[1899]&Ge(d);break b}k[g+12>>2]=c;k[c+8>>2]=g;break b}n=k[e+24>>2];d=k[e+12>>2];c:{if((e|0)!=(d|0)){c=k[e+8>>2];k[c+12>>2]=d;k[d+8>>2]=c;break c}d:{g=e+20|0;c=k[g>>2];if(c)break d;g=e+16|0;c=k[g>>2];if(c)break d;d=0;break c}while(1){m=g;d=c;g=d+20|0;c=k[g>>2];if(c)continue;g=d+16|0;c=k[d+16>>2];if(c)continue;break}k[m>>2]=0}if(!n)break b;g=k[e+28>>2];c=(g<<2)+7900|0;e:{if(k[c>>2]==(e|0)){k[c>>2]=d;if(d)break e;k[1900]=k[1900]&Ge(g);break b}k[n+(k[n+16>>2]==(e|0)?16:20)>>2]=d;if(!d)break b}k[d+24>>2]=n;c=k[e+16>>2];c&&(k[d+16>>2]=c,k[c+24>>2]=d);c=k[e+20>>2];if(!c)break b;k[d+20>>2]=c;k[c+24>>2]=d;break b}d=k[i+4>>2];if((d&3)!=3)break b;k[1901]=l;k[i+4>>2]=d&-2;k[e+4>>2]=l|1;k[l+e>>2]=l;return}if(i>>>0<=e>>>0)break a;d=k[i+4>>2];if(!(d&1))break a;f:{if(!(d&2)){if(k[1905]==(i|0)){k[1905]=e;l=k[1902]+l|0;k[1902]=l;k[e+4>>2]=l|1;if(k[1904]!=(e|0))break a;k[1901]=0;k[1904]=0;return}if(k[1904]==(i|0)){k[1904]=e;l=k[1901]+l|0;k[1901]=l;k[e+4>>2]=l|1;k[l+e>>2]=l;return}l=(d&-8)+l|0;g:{if(d>>>0<=255){c=k[i+8>>2];d=d>>>3|0;g=k[i+12>>2];if((c|0)==(g|0)){k[1899]=k[1899]&Ge(d);break g}k[c+12>>2]=g;k[g+8>>2]=c;break g}n=k[i+24>>2];d=k[i+12>>2];h:{if((i|0)!=(d|0)){c=k[i+8>>2];k[c+12>>2]=d;k[d+8>>2]=c;break h}i:{g=i+20|0;c=k[g>>2];if(c)break i;g=i+16|0;c=k[g>>2];if(c)break i;d=0;break h}while(1){m=g;d=c;g=d+20|0;c=k[g>>2];if(c)continue;g=d+16|0;c=k[d+16>>2];if(c)continue;break}k[m>>2]=0}if(!n)break g;g=k[i+28>>2];c=(g<<2)+7900|0;j:{if(k[c>>2]==(i|0)){k[c>>2]=d;if(d)break j;k[1900]=k[1900]&Ge(g);break g}k[n+(k[n+16>>2]==(i|0)?16:20)>>2]=d;if(!d)break g}k[d+24>>2]=n;c=k[i+16>>2];c&&(k[d+16>>2]=c,k[c+24>>2]=d);c=k[i+20>>2];if(!c)break g;k[d+20>>2]=c;k[c+24>>2]=d}k[e+4>>2]=l|1;k[l+e>>2]=l;if(k[1904]!=(e|0))break f;k[1901]=l;return}k[i+4>>2]=d&-2;k[e+4>>2]=l|1;k[l+e>>2]=l}if(l>>>0<=255){l=l>>>3|0;d=(l<<3)+7636|0;c=k[1899];l=1<<l;k:{if(!(c&l)){k[1899]=l|c;l=d;break k}l=k[d+8>>2]}k[d+8>>2]=e;k[l+12>>2]=e;k[e+12>>2]=d;k[e+8>>2]=l;return}k[e+16>>2]=0;k[e+20>>2]=0;i=e;g=l>>>8|0;c=0;l:{if(!g)break l;c=31;if(l>>>0>16777215)break l;d=g;g=g+1048320>>>16&8;c=d<<g;n=c+520192>>>16&4;c=c<<n;m=c+245760>>>16&2;c=(c<<m>>>15|0)-(m|(g|n))|0;c=(c<<1|l>>>c+21&1)+28|0}k[i+28>>2]=c;m=(c<<2)+7900|0;m:{n:{g=k[1900];d=1<<c;o:{if(!(g&d)){k[1900]=d|g;k[m>>2]=e;k[e+24>>2]=m;break o}g=l<<((c|0)==31?0:25-(c>>>1|0)|0);d=k[m>>2];while(1){c=d;if((k[d+4>>2]&-8)==(l|0))break n;d=g>>>29|0;g=g<<1;m=c+(d&4)|0;d=k[m+16>>2];if(d)continue;break}k[m+16>>2]=e;k[e+24>>2]=c}k[e+12>>2]=e;k[e+8>>2]=e;break m}l=k[c+8>>2];k[l+12>>2]=e;k[c+8>>2]=e;k[e+24>>2]=0;k[e+12>>2]=c;k[e+8>>2]=l}l=k[1907]+-1|0;k[1907]=l;if(l)break a;e=8052;while(1){l=k[e>>2];e=l+8|0;if(l)continue;break}k[1907]=-1}}function dc(n,c,d,o,e){n=n|0;c=c|0;d=d|0;o=o|0;e=e|0;var q=0,g=0,i=0,l=0,m=0;if(w(n,k[c+8>>2],e)){k[c+28>>2]==1|k[c+4>>2]!=(d|0)||(k[c+28>>2]=o);return}a:{if(w(n,k[c>>2],e)){if(!(k[c+20>>2]!=(d|0)?k[c+16>>2]!=(d|0):0)){if((o|0)!=1)break a;k[c+32>>2]=1;return}k[c+32>>2]=o;if(k[c+44>>2]!=4){q=n+16|0;l=q+(k[n+12>>2]<<3)|0;m=c;b:{c:{while(1){d:{if(q>>>0>=l>>>0)break d;da[c+52>>1]=0;Ba(q,c,d,d,1,e);if(ea[c+54|0])break d;e:{if(!ea[c+53|0])break e;if(ea[c+52|0]){o=1;if(k[c+24>>2]==1)break c;i=1;g=1;if(ea[n+8|0]&2)break e;break c}i=1;o=g;if(!(ca[n+8|0]&1))break c}q=q+8|0;continue}break}o=g;n=4;if(!i)break b}n=3}k[m+44>>2]=n;if(o&1)break a}k[c+20>>2]=d;k[c+40>>2]=k[c+40>>2]+1;if(k[c+36>>2]!=1|k[c+24>>2]!=2)break a;ca[c+54|0]=1;return}g=k[n+12>>2];q=n+16|0;ld(q,c,d,o,e);if((g|0)<2)break a;g=q+(g<<3)|0;q=n+24|0;n=k[n+8>>2];if(!(k[c+36>>2]!=1?!(n&2):0)){while(1){if(ea[c+54|0])break a;ld(q,c,d,o,e);q=q+8|0;if(q>>>0<g>>>0)continue;break}break a}if(!(n&1))while(1){if(ea[c+54|0]|k[c+36>>2]==1)break a;ld(q,c,d,o,e);q=q+8|0;if(q>>>0<g>>>0)continue;break a}while(1){if(ea[c+54|0]|(k[c+24>>2]==1?k[c+36>>2]==1:0))break a;ld(q,c,d,o,e);q=q+8|0;if(q>>>0<g>>>0)continue;break}}}function W(i,c,d){var e,l,g;if(d>>>0>=512){N(i|0,c|0,d|0)|0;return i}l=i+d|0;a:{if(!((i^c)&3)){b:{if((d|0)<1){d=i;break b}if(!(i&3)){d=i;break b}d=i;while(1){ca[d|0]=ea[c|0];c=c+1|0;d=d+1|0;if(d>>>0>=l>>>0)break b;if(d&3)continue;break}}e=l&-4;c:{if(e>>>0<64)break c;g=e+-64|0;if(d>>>0>g>>>0)break c;while(1){k[d>>2]=k[c>>2];k[d+4>>2]=k[c+4>>2];k[d+8>>2]=k[c+8>>2];k[d+12>>2]=k[c+12>>2];k[d+16>>2]=k[c+16>>2];k[d+20>>2]=k[c+20>>2];k[d+24>>2]=k[c+24>>2];k[d+28>>2]=k[c+28>>2];k[d+32>>2]=k[c+32>>2];k[d+36>>2]=k[c+36>>2];k[d+40>>2]=k[c+40>>2];k[d+44>>2]=k[c+44>>2];k[d+48>>2]=k[c+48>>2];k[d+52>>2]=k[c+52>>2];k[d+56>>2]=k[c+56>>2];k[d+60>>2]=k[c+60>>2];c=c- -64|0;d=d- -64|0;if(d>>>0<=g>>>0)continue;break}}if(d>>>0>=e>>>0)break a;while(1){k[d>>2]=k[c>>2];c=c+4|0;d=d+4|0;if(d>>>0<e>>>0)continue;break}break a}if(l>>>0<4){d=i;break a}e=l+-4|0;if(e>>>0<i>>>0){d=i;break a}d=i;while(1){ca[d|0]=ea[c|0];ca[d+1|0]=ea[c+1|0];ca[d+2|0]=ea[c+2|0];ca[d+3|0]=ea[c+3|0];c=c+4|0;d=d+4|0;if(d>>>0<=e>>>0)continue;break}}if(d>>>0<l>>>0)while(1){ca[d|0]=ea[c|0];c=c+1|0;d=d+1|0;if((l|0)!=(d|0))continue;break}return i}function ec(q,c,d,e,r,g){var s=0,i=0,l,m,n=0,o,t;s=5;a:{b:{if(!q|!c|(!d|!e))break b;if(!r|!g)break b;s=0;k[d>>2]=0;k[e>>2]=0;n=tc(q,c,r,g);if(!n)break b;i=z(n<<4);if(!i)return 3;r=c-k[g>>2]|0;c=i;while(1){if(!r)break a;l=ea[q|0];if(l>>>0>=6){ia(i,s);return 6}g=r+-1|0;m=l|k[c>>2]&-16;k[c>>2]=m;c:{if(!(!(1<<l&52)|l>>>0>5)){k[c>>2]=m&-268435441;r=g;q=q+1|0;break c}if(g>>>0<=2)break a;t=(l|0)!=1;o=ea[q+1|0]|ea[q+2|0]<<8|ea[q+3|0]<<16;if(!(t|(o|0)==1)){ia(i,s);return 7}g=r+-4|0;k[c>>2]=m&-268435441|o<<4;if((l|0)==3){if((o|0)!=1){ia(i,s);return 10}if(!g){U(i);return 1}r=r+-5|0;g=q+5|0;q=ea[q+4|0];if(q>>>0<=4){ca[c+4|0]=q;q=g;break c}ca[c+4|0]=4;q=g;break c}if(!g)break a;r=r+-5|0;g=q+5|0;m=ea[q+4|0];if(!t){ca[c+4|0]=ca[c+4|0]&1|m<<1;q=g;break c}q=g;if(l)break c;ca[c+4|0]=m<<1|m>>>7;if(!o){ia(i,s);return 9}q=o+-1|0;k[c+12>>2]=q;l=z(q);k[c+8>>2]=l;if(!l){ia(i,s);return 3}if(r>>>0<q>>>0){ia(i,s+1|0);return 1}W(l,g,q);r=r-q|0;q=q+g|0}c=c+16|0;s=s+1|0;if((n|0)!=(s|0))continue;break}if(r){ia(i,n);return 1}k[d>>2]=i;k[e>>2]=n;s=0}return s}ia(i,s);return 1}function fc(i,c,d){i=i|0;c=c|0;d=d|0;var e=0,l=0,g=0,m;l=V+-64|0;V=l;a:{if(w(c,7072,0)){k[d>>2]=0;g=1;break a}if(bd(i,c)){g=1;i=k[d>>2];if(!i)break a;k[d>>2]=k[i>>2];break a}b:{if(!c)break b;c=x(c,6852);if(!c)break a;e=k[d>>2];e&&(k[d>>2]=k[e>>2]);m=k[c+8>>2];e=k[i+8>>2];if(m&(e^-1)&7|(m^-1)&e&96)break a;g=1;if(w(k[i+12>>2],k[c+12>>2],0))break a;if(w(k[i+12>>2],7060,0)){i=k[c+12>>2];if(!i)break a;g=!x(i,6904);break a}e=k[i+12>>2];if(!e)break b;g=0;e=x(e,6852);if(e){if(!(ca[i+8|0]&1))break a;g=sc(e,k[c+12>>2]);break a}e=k[i+12>>2];if(!e)break a;e=x(e,6964);if(e){if(!(ca[i+8|0]&1))break a;g=Ya(e,k[c+12>>2]);break a}i=k[i+12>>2];if(!i)break a;e=x(i,6756);if(!e)break a;i=k[c+12>>2];if(!i)break a;i=x(i,6756);if(!i)break a;k[l+20>>2]=-1;k[l+16>>2]=e;k[l+12>>2]=0;k[l+8>>2]=i;Aa(l+24|0);k[l+56>>2]=1;ba[k[k[i>>2]+28>>2]](i,l+8|0,k[d>>2],1);i=k[l+32>>2];!k[d>>2]|(i|0)!=1||(k[d>>2]=k[l+24>>2]);g=(i|0)==1;break a}g=0}V=l- -64|0;return g|0}function gc(){var d=0,c;d=V-80|0;V=d;nc();oc();pc();L(4660,4688,4724,0,2672,42,2675,0,2675,0,1882,2677,43);k[d+76>>2]=0;k[d+72>>2]=44;c=k[d+76>>2];k[d+64>>2]=k[d+72>>2];k[d+68>>2]=c;Gd(d- -64|0);k[d+76>>2]=0;k[d+72>>2]=45;c=k[d+76>>2];k[d+56>>2]=k[d+72>>2];k[d+60>>2]=c;Hd(d+56|0);k[d+76>>2]=0;k[d+72>>2]=46;c=k[d+76>>2];k[d+48>>2]=k[d+72>>2];k[d+52>>2]=c;Jd(d+48|0);k[d+76>>2]=0;k[d+72>>2]=47;c=k[d+76>>2];k[d+40>>2]=k[d+72>>2];k[d+44>>2]=c;Kd(d+40|0);k[d+76>>2]=0;k[d+72>>2]=48;c=k[d+76>>2];k[d+32>>2]=k[d+72>>2];k[d+36>>2]=c;wa(1940,d+32|0);k[d+76>>2]=0;k[d+72>>2]=49;c=k[d+76>>2];k[d+24>>2]=k[d+72>>2];k[d+28>>2]=c;wa(1955,d+24|0);k[d+76>>2]=0;k[d+72>>2]=50;c=k[d+76>>2];k[d+16>>2]=k[d+72>>2];k[d+20>>2]=c;pd(d+16|0);k[d+76>>2]=0;k[d+72>>2]=51;c=k[d+76>>2];k[d+8>>2]=k[d+72>>2];k[d+12>>2]=c;wa(1986,d+8|0);Re();V=d+80|0}function hc(){var d=0,c;d=V+-64|0;V=d;L(3008,3036,3072,0,2672,19,2675,0,2675,0,1682,2677,20);k[d+60>>2]=0;k[d+56>>2]=21;c=k[d+60>>2];k[d+48>>2]=k[d+56>>2];k[d+52>>2]=c;Va(1695,d+48|0);k[d+60>>2]=0;k[d+56>>2]=22;c=k[d+60>>2];k[d+40>>2]=k[d+56>>2];k[d+44>>2]=c;Ua(1710,d+40|0);k[d+60>>2]=0;k[d+56>>2]=23;c=k[d+60>>2];k[d+32>>2]=k[d+56>>2];k[d+36>>2]=c;Va(1725,d+32|0);k[d+60>>2]=0;k[d+56>>2]=24;c=k[d+60>>2];k[d+24>>2]=k[d+56>>2];k[d+28>>2]=c;Ua(1734,d+24|0);k[d+60>>2]=0;k[d+56>>2]=25;c=k[d+60>>2];k[d+16>>2]=k[d+56>>2];k[d+20>>2]=c;vd(d+16|0);k[d+60>>2]=0;k[d+56>>2]=26;c=k[d+60>>2];k[d+8>>2]=k[d+56>>2];k[d+12>>2]=c;xd(d+8|0);k[d+60>>2]=0;k[d+56>>2]=27;c=k[d+60>>2];k[d>>2]=k[d+56>>2];k[d+4>>2]=c;Ad(d);V=d- -64|0}function Aa(e){var c,d;c=e+39|0;ca[c+-1|0]=0;ca[e|0]=0;ca[c+-2|0]=0;ca[e+1|0]=0;ca[c+-3|0]=0;ca[e+2|0]=0;ca[c+-4|0]=0;ca[e+3|0]=0;c=0-e&3;e=c+e|0;k[e>>2]=0;d=39-c&-4;c=d+e|0;k[c+-4>>2]=0;a:{if(d>>>0<9)break a;k[e+8>>2]=0;k[e+4>>2]=0;k[c+-8>>2]=0;k[c+-12>>2]=0;if(d>>>0<25)break a;k[e+24>>2]=0;k[e+20>>2]=0;k[e+16>>2]=0;k[e+12>>2]=0;k[c+-16>>2]=0;k[c+-20>>2]=0;k[c+-24>>2]=0;k[c+-28>>2]=0;c=d;d=e&4|24;c=c-d|0;if(c>>>0<32)break a;e=e+d|0;while(1){k[e+24>>2]=0;k[e+28>>2]=0;k[e+16>>2]=0;k[e+20>>2]=0;k[e+8>>2]=0;k[e+12>>2]=0;k[e>>2]=0;k[e+4>>2]=0;e=e+32|0;c=c+-32|0;if(c>>>0>31)continue;break}}}function ic(o,c,d,q,e,r){o=o|0;c=c|0;d=d|0;q=q|0;e=e|0;r=r|0;var g=0,i=0,l=0,m=0,n,s;if(w(o,k[c+8>>2],r)){Ca(c,d,q,e);return}i=ea[c+53|0];g=k[o+12>>2];ca[c+53|0]=0;l=ea[c+52|0];ca[c+52|0]=0;m=o+16|0;Ba(m,c,d,q,e,r);n=ea[c+53|0];i=i|n;s=ea[c+52|0];l=l|s;a:{if((g|0)<2)break a;m=m+(g<<3)|0;g=o+24|0;while(1){if(ea[c+54|0])break a;b:{if(s){if(k[c+24>>2]==1)break a;if(ea[o+8|0]&2)break b;break a}if(!n)break b;if(!(ca[o+8|0]&1))break a}da[c+52>>1]=0;Ba(g,c,d,q,e,r);n=ea[c+53|0];i=n|i;s=ea[c+52|0];l=s|l;g=g+8|0;if(g>>>0<m>>>0)continue;break}}ca[c+53|0]=(i&255)!=0;ca[c+52|0]=(l&255)!=0}function jc(e,c,g,d,i){e=e|0;c=c|0;g=g|0;d=d|0;i=i|0;if(w(e,k[c+8>>2],i)){k[c+28>>2]==1|k[c+4>>2]!=(g|0)||(k[c+28>>2]=d);return}a:{if(w(e,k[c>>2],i)){if(!(k[c+20>>2]!=(g|0)?k[c+16>>2]!=(g|0):0)){if((d|0)!=1)break a;k[c+32>>2]=1;return}k[c+32>>2]=d;b:{if(k[c+44>>2]==4)break b;da[c+52>>1]=0;e=k[e+8>>2];ba[k[k[e>>2]+20>>2]](e,c,g,g,1,i);if(ea[c+53|0]){k[c+44>>2]=3;if(!ea[c+52|0])break b;break a}k[c+44>>2]=4}k[c+20>>2]=g;k[c+40>>2]=k[c+40>>2]+1;if(k[c+36>>2]!=1|k[c+24>>2]!=2)break a;ca[c+54|0]=1;return}e=k[e+8>>2];ba[k[k[e>>2]+24>>2]](e,c,g,d,i)}}function x(i,c){var d=0,e=0,g=0,l=0;d=V+-64|0;V=d;e=k[i>>2];g=k[e+-4>>2];l=k[e+-8>>2];k[d+20>>2]=0;k[d+16>>2]=6708;k[d+12>>2]=i;k[d+8>>2]=c;e=0;Aa(d+24|0);i=i+l|0;a:{if(w(g,c,0)){k[d+56>>2]=1;ba[k[k[g>>2]+20>>2]](g,d+8|0,i,i,1,0);e=k[d+32>>2]==1?i:0;break a}ba[k[k[g>>2]+24>>2]](g,d+8|0,i,1,0);b:switch(k[d+44>>2]){case 0:e=k[d+48>>2]==1?k[d+36>>2]==1?k[d+40>>2]==1?k[d+28>>2]:0:0:0;break a;case 1:break b;default:break a}if(k[d+32>>2]!=1&&k[d+48>>2]|k[d+36>>2]!=1|k[d+40>>2]!=1)break a;e=k[d+24>>2]}V=d- -64|0;return e}function ya(m,c,d,e,n,g,o){var i=0,l=0;i=V-16|0;V=i;k[m+4>>2]=e;k[m>>2]=c;c=ra(m+8|0);e=ra(m+20|0);l=ra(m+32|0);k[m+52>>2]=o;k[m+48>>2]=g;k[m+44>>2]=n;if(!(!d|!n)){g=0;while(1){a:{b:switch(k[d>>2]&15){case 0:m=d+4|0;o=k[m+4>>2];k[i>>2]=k[m>>2];k[i+4>>2]=o;k[i+8>>2]=k[m+8>>2];af(c,i);break a;case 3:k[i>>2]=k[d+4>>2];bf(e,i);break a;case 1:break b;default:break a}ca[i|0]=ea[d+4|0];cf(l,i)}d=d+16|0;g=g+1|0;if((g|0)!=(n|0))continue;break}}V=i+16|0}function kc(){var d=0,c=0;c=V-16|0;V=c;H(4840,2021,4,0);ua(ua(ua(ua(c,2033,0),2048,1),2076,2),2107,3);d=Rb(c,2156);K(2139,d);y(d);d=Rb(c,2180);K(2167,d);y(d);d=Rb(c,2210);K(2192,d);y(d);d=Rb(c,2243);K(2227,d);y(d);d=Rb(c,2275);K(2258,d);y(d);d=Rb(c,2308);K(2289,d);y(d);d=Rb(c,2340);K(2322,d);y(d);d=Rb(c,2375);K(2356,d);y(d);d=Rb(c,2398);K(2386,d);y(d);F(2409,4840,+fa[607]);V=c+16|0}function lc(){var d=0,c;d=V-32|0;V=d;L(2592,2620,2656,0,2672,1,2675,0,2675,0,1348,2677,2);Ye();k[d+28>>2]=0;k[d+24>>2]=4;c=k[d+28>>2];k[d+16>>2]=k[d+24>>2];k[d+20>>2]=c;Ed(d+16|0);k[d+28>>2]=0;k[d+24>>2]=5;c=k[d+28>>2];k[d+8>>2]=k[d+24>>2];k[d+12>>2]=c;Fd(d+8|0);k[d+28>>2]=0;k[d+24>>2]=6;c=k[d+28>>2];k[d>>2]=k[d+24>>2];k[d+4>>2]=c;Id(d);Ze();We();Xe();Te();V=d+32|0}function mc(g,c){g=g|0;c=c|0;var d=0,e;d=V-16|0;V=d;ea[c+11|0]>>>7|0?e=k[c>>2]:e=c;ea[c+11|0]>>>7|0?c=k[c+4>>2]:c=ea[c+11|0];c=ec(e,c,d+12|0,d+8|0,d+4|0,d);a:{if(!c){c=k[d+12>>2];if(!c){ya(g,0,0,0,k[d+8>>2],k[d+4>>2],k[d>>2]);break a}ya(g,0,c,k[c>>2]>>>4&16777215,k[d+8>>2],k[d+4>>2],k[d>>2]);break a}U(k[d+4>>2]);ya(g,c,0,0,k[d+8>>2],0,0)}V=d+16|0}function nc(){var d=0,c;d=V-32|0;V=d;L(3568,3648,3720,0,2672,53,2675,0,2675,0,1828,2677,54);Se();k[d+28>>2]=0;k[d+24>>2]=56;c=k[d+28>>2];k[d+16>>2]=k[d+24>>2];k[d+20>>2]=c;qd(d+16|0);k[d+28>>2]=0;k[d+24>>2]=57;c=k[d+28>>2];k[d+8>>2]=k[d+24>>2];k[d+12>>2]=c;rd(d+8|0);k[d+28>>2]=0;k[d+24>>2]=58;c=k[d+28>>2];k[d>>2]=k[d+24>>2];k[d+4>>2]=c;sd(d);he();ie();V=d+32|0}function oc(){var d=0,c;d=V-32|0;V=d;L(3980,4060,4132,0,2672,61,2675,0,2675,0,1845,2677,62);Ve();k[d+28>>2]=0;k[d+24>>2]=64;c=k[d+28>>2];k[d+16>>2]=k[d+24>>2];k[d+20>>2]=c;wd(d+16|0);k[d+28>>2]=0;k[d+24>>2]=65;c=k[d+28>>2];k[d+8>>2]=k[d+24>>2];k[d+12>>2]=c;yd(d+8|0);k[d+28>>2]=0;k[d+24>>2]=66;c=k[d+28>>2];k[d>>2]=k[d+24>>2];k[d+4>>2]=c;Bd(d);fe();ge();V=d+32|0}function pc(){var d=0,c;d=V-32|0;V=d;L(4380,4460,4532,0,2672,69,2675,0,2675,0,1863,2677,70);Ue();k[d+28>>2]=0;k[d+24>>2]=72;c=k[d+28>>2];k[d+16>>2]=k[d+24>>2];k[d+20>>2]=c;td(d+16|0);k[d+28>>2]=0;k[d+24>>2]=73;c=k[d+28>>2];k[d+8>>2]=k[d+24>>2];k[d+12>>2]=c;ud(d+8|0);k[d+28>>2]=0;k[d+24>>2]=74;c=k[d+28>>2];k[d>>2]=k[d+24>>2];k[d+4>>2]=c;zd(d);ee();ce();V=d+32|0}function qc(i,c,d,e,g){i=i|0;c=c|0;d=d|0;e=e|0;g=g|0;if(w(i,k[c+8>>2],g)){k[c+28>>2]==1|k[c+4>>2]!=(d|0)||(k[c+28>>2]=e);return}a:{if(!w(i,k[c>>2],g))break a;if(!(k[c+20>>2]!=(d|0)?k[c+16>>2]!=(d|0):0)){if((e|0)!=1)break a;k[c+32>>2]=1;return}k[c+20>>2]=d;k[c+32>>2]=e;k[c+40>>2]=k[c+40>>2]+1;k[c+36>>2]!=1|k[c+24>>2]!=2||(ca[c+54|0]=1);k[c+44>>2]=4}}function ab(i,c,d){var e=0,l=0,g=0;g=V-16|0;V=g;if(4294967279>=d>>>0){a:{if(d>>>0<=10){ca[i+11|0]=d;e=i;break a}d>>>0>=11?(l=d+16&-16,e=l+-1|0,e=(e|0)==11?l:e):e=10;l=e+1|0;e=l;4294967295<e>>>0&&(oa(6413),q());e=ha(e);k[i>>2]=e;k[i+8>>2]=l|-2147483648;k[i+4>>2]=d}d&&W(e,c,d);ca[g+15|0]=0;ca[d+e|0]=ea[g+15|0];V=g+16|0;return}oa(6400);q()}function rc(i,c,d){i=i|0;c=c|0;d=d|0;var e=0,g=0;e=V+-64|0;V=e;g=1;a:{if(w(i,c,0))break a;g=0;if(!c)break a;c=x(c,6756);g=0;if(!c)break a;k[e+20>>2]=-1;k[e+16>>2]=i;k[e+12>>2]=0;k[e+8>>2]=c;Aa(e+24|0);k[e+56>>2]=1;ba[k[k[c>>2]+28>>2]](c,e+8|0,k[d>>2],1);i=k[e+32>>2];(i|0)==1&&(k[d>>2]=k[e+24>>2]);g=(i|0)==1}i=g;V=e- -64|0;return i|0}function Ca(g,c,d,e){ca[g+53|0]=1;a:{if(k[g+4>>2]!=(d|0))break a;ca[g+52|0]=1;d=k[g+16>>2];if(!d){k[g+36>>2]=1;k[g+24>>2]=e;k[g+16>>2]=c;if((e|0)!=1|k[g+48>>2]!=1)break a;ca[g+54|0]=1;return}if((c|0)==(d|0)){d=k[g+24>>2];(d|0)==2&&(k[g+24>>2]=e,d=e);if(k[g+48>>2]!=1|(d|0)!=1)break a;ca[g+54|0]=1;return}ca[g+54|0]=1;k[g+36>>2]=k[g+36>>2]+1}}function sc(g,c){var d,e=0;a:{while(1){if(!c)return 0;c=x(c,6852);if(!c|k[c+8>>2]&(k[g+8>>2]^-1))break a;if(w(k[g+12>>2],k[c+12>>2],0))return 1;if(!(ca[g+8|0]&1))break a;d=k[g+12>>2];if(!d)break a;d=x(d,6852);if(d){c=k[c+12>>2];g=d;continue}break}g=k[g+12>>2];if(!g)break a;g=x(g,6964);if(!g)break a;e=Ya(g,k[c+12>>2])}return e}function tc(l,c,d,e){var g,m,i,n=0;if(!c){k[e>>2]=0;return 0}a:{while(1){m=l+1|0;g=c+-1|0;i=ea[l|0];b:{if(!(i>>>0>5|!(1<<i&52))){c=g;l=m;break b}if(g>>>0<3)break a;i=c+-4|0;g=ea[m|0]|ea[m+1|0]<<8|ea[m+2|0]<<16;if(i>>>0<g>>>0)break a;c=i-g|0;l=(m+g|0)+3|0}n=n+1|0;if(c)continue;break}k[e>>2]=0;return n}k[d>>2]=l;k[e>>2]=c;return n}function za(g){var c,d=0,e=0;a:{b:{c=g;if(!(c&3))break b;if(!ea[g|0])return 0;while(1){c=c+1|0;if(!(c&3))break b;if(ea[c|0])continue;break}break a}while(1){d=c;c=c+4|0;e=k[d>>2];if(!((e^-1)&e+-16843009&-2139062144))continue;break}if(!(e&255))return d-g|0;while(1){e=ea[d+1|0];c=d+1|0;d=c;if(e)continue;break}}return c-g|0}function ib(){P(7060,4848),O(7084,4853,1,1,0),qe(),re(),ue(),le(),se(),Zd(),ve(),$d(),we(),xe(),ye(),cc(2896,4959),cc(5704,4971),I(5792,4,5004),I(5884,2,5017),I(5976,4,5032),Xa(2740,5047),ze(),gb(5093),fb(5130),eb(5169),db(5200),cb(5240),bb(5269),Ae(),Be(),gb(5376),fb(5408),eb(5441),db(5474),cb(5508),bb(5541),Ce(),De()}function uc(i,c,d,e){i=i|0;c=c|0;d=d|0;e=e|0;var g=0,l;g=V-16|0;V=g;ea[e+11|0]>>>7|0?l=k[e>>2]:l=e;ea[e+11|0]>>>7|0?e=k[e+4>>2]:e=ea[e+11|0];c=xc(l,e,c,d,g+12|0,g+8|0);d=k[g+12>>2];a:{if(!c){k[i+8>>2]=k[g+8>>2];k[i+4>>2]=d;k[i>>2]=0;break a}U(d);k[i+8>>2]=0;k[i+4>>2]=0;k[i>>2]=c}V=g+16|0}function vc(i,c,d){var e=0,g=0;e=V-16|0;V=e;k[e>>2]=k[i+8>>2];g=k[i+8>>2];k[e+8>>2]=i+8;k[e+4>>2]=ga(c,12)+g;if(k[e>>2]!=k[e+4>>2])while(1){g=k[d+4>>2];c=k[e>>2];k[c>>2]=k[d>>2];k[c+4>>2]=g;k[c+8>>2]=k[d+8>>2];c=k[e>>2]+12|0;k[e>>2]=c;if((c|0)!=k[e+4>>2])continue;break}k[k[e+8>>2]>>2]=k[e>>2];V=e+16|0}function wc(g,c,d){var e=0;e=V-16|0;V=e;k[e>>2]=g;g=k[g+4>>2];k[e+4>>2]=g;k[e+8>>2]=g+ga(c,12);if(k[e+4>>2]!=k[e+8>>2])while(1){c=k[d+4>>2];g=k[e+4>>2];k[g>>2]=k[d>>2];k[g+4>>2]=c;k[g+8>>2]=k[d+8>>2];g=k[e+4>>2]+12|0;k[e+4>>2]=g;if((g|0)!=k[e+8>>2])continue;break}k[k[e>>2]+4>>2]=k[e+4>>2];V=e+16|0}function xc(n,c,d,e,g,o){var i=0,q=0,l,m=0;a:{if(e<<24>>24<=-1){q=4;if(d)break a}q=5;if(!n|c>>>0>16777215|(!g|!o))break a;m=c+5|0;i=z(m);if(!i)return 3;q=0;ca[i|0]=0;l=c+1|0;ca[i+1|0]=l;ca[i+2|0]=l>>>8;ca[i+3|0]=l>>>16;ca[i+4|0]=d?e|128:e;W(i+5|0,n,c);k[g>>2]=i;k[o>>2]=m}return q}function yc(){var d=0,c;d=V-32|0;V=d;L(3268,3296,3332,0,2672,37,2675,0,2675,0,1804,2677,38);k[d+28>>2]=0;k[d+24>>2]=39;c=k[d+28>>2];k[d+16>>2]=k[d+24>>2];k[d+20>>2]=c;od(1816,d+16|0);k[d+28>>2]=0;k[d+24>>2]=40;c=k[d+28>>2];k[d+8>>2]=k[d+24>>2];k[d+12>>2]=c;od(1725,d+8|0);V=d+32|0}function zc(g){var c,d,e=0;ea[g+11|0]>>>7|0?c=k[g+4>>2]:c=ea[g+11|0];e=z(c+4|0);c=e;ea[g+11|0]>>>7|0?d=k[g+4>>2]:d=ea[g+11|0];k[c>>2]=d;d=e+4|0;ea[g+11|0]>>>7|0?c=k[g>>2]:c=g;ea[g+11|0]>>>7|0?g=k[g+4>>2]:g=ea[g+11|0];W(d,c,g);return e}function Ac(i,c,d,e){i=i|0;c=c|0;d=d|0;e=e|0;var g=0,l=0;if(w(i,k[c+8>>2],0)){Da(c,d,e);return}g=k[i+12>>2];l=i+16|0;Za(l,c,d,e);a:{if((g|0)<2)break a;g=(g<<3)+l|0;i=i+24|0;while(1){Za(i,c,d,e);if(ea[c+54|0])break a;i=i+8|0;if(i>>>0<g>>>0)continue;break}}}function Bc(i,c,d){var e,g;e=V-16|0;V=e;k[e>>2]=k[i+8>>2];g=k[i+8>>2];k[e+8>>2]=i+8;k[e+4>>2]=(c<<2)+g;if(k[e>>2]!=k[e+4>>2])while(1){k[k[e>>2]>>2]=k[d>>2];c=k[e>>2]+4|0;k[e>>2]=c;if((c|0)!=k[e+4>>2])continue;break}k[k[e+8>>2]>>2]=k[e>>2];V=e+16|0}function Mb(l,c){var d=0,e=0,g,i;e=V-32|0;V=e;d=Ib(e+8|0,Jb(l,((k[l+4>>2]-k[l>>2]|0)/12|0)+1|0),(k[l+4>>2]-k[l>>2]|0)/12|0,l+8|0);g=k[d+8>>2];i=k[c+4>>2];k[g>>2]=k[c>>2];k[g+4>>2]=i;k[g+8>>2]=k[c+8>>2];k[d+8>>2]=k[d+8>>2]+12;Hb(l,d);Fb(d);V=e+32|0}function Cc(g,c,d){var e;e=V-16|0;V=e;k[e>>2]=g;g=k[g+4>>2];k[e+4>>2]=g;k[e+8>>2]=g+(c<<2);if(k[e+4>>2]!=k[e+8>>2])while(1){k[k[e+4>>2]>>2]=k[d>>2];g=k[e+4>>2]+4|0;k[e+4>>2]=g;if((g|0)!=k[e+8>>2])continue;break}k[k[e>>2]+4>>2]=k[e+4>>2];V=e+16|0}function Dc(g,c,d){var e,i;e=V-16|0;V=e;k[e>>2]=k[g+8>>2];i=k[g+8>>2];k[e+8>>2]=g+8;k[e+4>>2]=c+i;if(k[e>>2]!=k[e+4>>2])while(1){ca[k[e>>2]]=ea[d|0];c=k[e>>2]+1|0;k[e>>2]=c;if((c|0)!=k[e+4>>2])continue;break}k[k[e+8>>2]>>2]=k[e>>2];V=e+16|0}function Ec(g,c,d){var e;e=V-16|0;V=e;k[e>>2]=g;g=k[g+4>>2];k[e+4>>2]=g;k[e+8>>2]=g+c;if(k[e+4>>2]!=k[e+8>>2])while(1){ca[k[e+4>>2]]=ea[d|0];g=k[e+4>>2]+1|0;k[e+4>>2]=g;if((g|0)!=k[e+8>>2])continue;break}k[k[e>>2]+4>>2]=k[e+4>>2];V=e+16|0}function Jb(g,c){var d=0,e;d=V-16|0;V=d;k[d+12>>2]=c;e=Eb();if(e>>>0>=c>>>0){g=(k[g+8>>2]-k[g>>2]|0)/12|0;g>>>0<e>>>1>>>0&&(k[d+8>>2]=g<<1,g=V-16|0,V=g,V=g+16|0,g=d+12|0,c=d+8|0,e=k[(fa[c>>2]<fa[g>>2]?g:c)>>2]);V=d+16|0;return e}la();q()}function Bb(g,c){var d=0,e;d=V-16|0;V=d;k[d+12>>2]=c;e=Qb();if(e>>>0>=c>>>0){g=k[g+8>>2]-k[g>>2]>>2;g>>>0<e>>>1>>>0&&(k[d+8>>2]=g<<1,g=V-16|0,V=g,V=g+16|0,g=d+12|0,c=d+8|0,e=k[(fa[c>>2]<fa[g>>2]?g:c)>>2]);V=d+16|0;return e}la();q()}function wb(g,c){var d=0,e;d=V-16|0;V=d;k[d+12>>2]=c;e=rb();if(e>>>0>=c>>>0){g=k[g+8>>2]-k[g>>2]|0;g>>>0<e>>>1>>>0&&(k[d+8>>2]=g<<1,g=V-16|0,V=g,V=g+16|0,g=d+12|0,c=d+8|0,e=k[(fa[c>>2]<fa[g>>2]?g:c)>>2]);V=d+16|0;return e}la();q()}function Fc(i,c,d){var e=0,g=0;e=V-32|0;V=e;a:{if((k[i+8>>2]-k[i+4>>2]|0)/12>>>0>=c>>>0){wc(i,c,d);break a}g=Ib(e+8|0,Jb(i,((k[i+4>>2]-k[i>>2]|0)/12|0)+c|0),(k[i+4>>2]-k[i>>2]|0)/12|0,i+8|0);vc(g,c,d);Hb(i,g);Fb(g)}V=e+32|0}function Ob(g,c){var d,e;d=V-16|0;V=d;k[d>>2]=g;g=k[g+4>>2];k[d+4>>2]=g;k[d+8>>2]=g+12;e=k[c+4>>2];g=k[d+4>>2];k[g>>2]=k[c>>2];k[g+4>>2]=e;k[g+8>>2]=k[c+8>>2];k[d+4>>2]=k[d+4>>2]+12;k[k[d>>2]+4>>2]=k[d+4>>2];V=d+16|0}function w(e,c,d){if(!d)return k[e+4>>2]==k[c+4>>2];if((e|0)==(c|0))return 1;d=V-16|0;k[d+8>>2]=e;k[d+12>>2]=k[k[d+8>>2]+4>>2];d=k[d+12>>2];e=V-16|0;k[e+8>>2]=c;k[e+12>>2]=k[k[e+8>>2]+4>>2];return!Pc(d,k[e+12>>2])}function Da(g,c,d){var e;e=k[g+16>>2];if(!e){k[g+36>>2]=1;k[g+24>>2]=d;k[g+16>>2]=c;return}a:{if((c|0)==(e|0)){if(k[g+24>>2]!=2)break a;k[g+24>>2]=d;return}ca[g+54|0]=1;k[g+24>>2]=2;k[g+36>>2]=k[g+36>>2]+1}}function Gc(i,c,d){var e=0,g=0;e=V-32|0;V=e;a:{if(k[i+8>>2]-k[i+4>>2]>>2>>>0>=c>>>0){Cc(i,c,d);break a}g=Ab(e+8|0,Bb(i,(k[i+4>>2]-k[i>>2]>>2)+c|0),k[i+4>>2]-k[i>>2]>>2,i+8|0);Bc(g,c,d);ub(i,g);zb(g)}V=e+32|0}function Hc(i,c,d){var e=0,g=0;e=V-32|0;V=e;a:{if(k[i+8>>2]-k[i+4>>2]>>>0>=c>>>0){Ec(i,c,d);break a}g=vb(e+8|0,wb(i,(k[i+4>>2]-k[i>>2]|0)+c|0),k[i+4>>2]-k[i>>2]|0,i+8|0);Dc(g,c,d);ub(i,g);sb(g)}V=e+32|0}function Ic(g,c){g=g|0;c=c|0;var d=0,e;d=V-16|0;V=d;c=Uc(c,d+12|0,d+8|0);e=k[d+12>>2];a:{if(!c){k[g+8>>2]=k[d+8>>2];k[g+4>>2]=e;k[g>>2]=0;break a}U(e);k[g+8>>2]=0;k[g+4>>2]=0;k[g>>2]=c}V=d+16|0}function Jc(g,c){g=g|0;c=c|0;var d=0,e;d=V-16|0;V=d;c=Qc(c,d+12|0,d+8|0);e=k[d+12>>2];a:{if(!c){k[g+8>>2]=k[d+8>>2];k[g+4>>2]=e;k[g>>2]=0;break a}U(e);k[g+8>>2]=0;k[g+4>>2]=0;k[g>>2]=c}V=d+16|0}function Kc(e,c){var d;d=k[c+4>>2];k[e>>2]=k[c>>2];k[e+4>>2]=d;ta(e+8|0,c+8|0);ta(e+20|0,c+20|0);ta(e+32|0,c+32|0);k[e+52>>2]=k[c+52>>2];d=k[c+48>>2];k[e+44>>2]=k[c+44>>2];k[e+48>>2]=d;return e}function ta(e,c){var d;d=V-16|0;V=d;k[e>>2]=0;k[e+4>>2]=0;k[d+12>>2]=0;k[e+8>>2]=0;V=d+16|0;k[e>>2]=k[c>>2];k[e+4>>2]=k[c+4>>2];k[e+8>>2]=k[c+8>>2];k[c+8>>2]=0;k[c>>2]=0;k[c+4>>2]=0;return e}function Lc(g,c){var d,e;d=V-16|0;V=d;k[d+4>>2]=g;e=k[c+4>>2];k[d+8>>2]=k[c>>2];k[d+12>>2]=e;k[k[d+4>>2]>>2]=k[d+8>>2];k[k[d+4>>2]+4>>2]=k[d+12>>2];k[d+4>>2]=k[d+4>>2]+8;V=d+16|0;return g}function Mc(g){g=g|0;var c=0,d=0,e;c=V-16|0;V=c;d=te(c+12|0,c+8|0);e=k[c+12>>2];a:{if(!d){k[g+8>>2]=k[c+8>>2];k[g+4>>2]=e;k[g>>2]=0;break a}U(e);k[g+8>>2]=0;k[g+4>>2]=0;k[g>>2]=d}V=c+16|0}function Nc(i,c){var d=0,e,g;d=V-16|0;V=d;k[d+12>>2]=i;e=ha(12);k[e+8>>2]=k[c+8>>2];g=k[c+4>>2];k[e>>2]=k[c>>2];k[e+4>>2]=g;k[k[d+12>>2]>>2]=e;k[d+12>>2]=k[d+12>>2]+8;V=d+16|0;return i}function Oc(g,c){var d=0,e=0;e=V-16|0;V=e;d=V-16|0;V=d;k[g>>2]=0;k[g+4>>2]=0;k[d+12>>2]=0;k[g+8>>2]=0;V=d+16|0;d=(k[c+4>>2]-k[c>>2]|0)/12|0;d&&(be(g,d),gd(g,k[c>>2],k[c+4>>2],d));V=e+16|0}function Oa(i,c){i=i|0;c=c|0;var d=0,e,g,l;d=V-16|0;V=d;e=k[i>>2];g=d+8|0;i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(e=k[k[c>>2]+e>>2]);ba[e|0](g,l);i=qb(d+8|0);pb(d+8|0);V=d+16|0;return i|0}function Pc(g,c){var d,e;d=ea[g|0];e=ea[c|0];a:{if(!d|(d|0)!=(e|0))break a;while(1){e=ea[c+1|0];d=ea[g+1|0];if(!d)break a;c=c+1|0;g=g+1|0;if((d|0)==(e|0))continue;break}}return d-e|0}function Qc(g,c,d){var e;e=5;a:{if(!c|!d)break a;e=8;if(g>>>0>4)break a;e=z(5);if(!e)return 3;ca[e+4|0]=g;ca[e+1|0]=1;ca[e+2|0]=0;ca[e|0]=3;ca[e+3|0]=0;k[c>>2]=e;k[d>>2]=5;e=0}return e}function Ib(l,c,d,e){var g=0,i=0;g=V-16|0;V=g;k[g+12>>2]=0;k[l+12>>2]=0;k[l+16>>2]=e;c&&(i=Cb(c));k[l>>2]=i;d=ga(d,12)+i|0;k[l+8>>2]=d;k[l+4>>2]=d;k[l+12>>2]=ga(c,12)+i;V=g+16|0;return l}function Ab(l,c,d,e){var g=0,i=0;g=V-16|0;V=g;k[g+12>>2]=0;k[l+12>>2]=0;k[l+16>>2]=e;c&&(i=xb(c));k[l>>2]=i;d=(d<<2)+i|0;k[l+8>>2]=d;k[l+4>>2]=d;k[l+12>>2]=(c<<2)+i;V=g+16|0;return l}function Rc(g,c){var d=0,e=0;e=V-16|0;V=e;d=V-16|0;V=d;k[g>>2]=0;k[g+4>>2]=0;k[d+12>>2]=0;k[g+8>>2]=0;V=d+16|0;d=k[c+4>>2]-k[c>>2]>>2;d&&(de(g,d),id(g,k[c>>2],k[c+4>>2],d));V=e+16|0}function Sc(g,c){var d=0,e=0;e=V-32|0;V=e;d=Ab(e+8|0,Bb(g,(k[g+4>>2]-k[g>>2]>>2)+1|0),k[g+4>>2]-k[g>>2]>>2,g+8|0);k[k[d+8>>2]>>2]=k[c>>2];k[d+8>>2]=k[d+8>>2]+4;ub(g,d);zb(d);V=e+32|0}function Tc(g,c){var d=0,e=0;e=V-16|0;V=e;d=V-16|0;V=d;k[g>>2]=0;k[g+4>>2]=0;k[d+12>>2]=0;k[g+8>>2]=0;V=d+16|0;d=k[c+4>>2]-k[c>>2]|0;d&&(je(g,d),kd(g,k[c>>2],k[c+4>>2],d));V=e+16|0}function Za(l,c,d,e){var g,m,i,n;m=k[l+4>>2];l=k[l>>2];i=l;n=c;g=0;a:{if(!d)break a;c=m>>8;g=c;if(!(m&1))break a;g=k[c+k[d>>2]>>2]}ba[k[k[l>>2]+28>>2]](i,n,g+d|0,m&2?e:2)}function na(i,c){i=i|0;c=c|0;var d=0,e,g,l;d=V-16|0;V=d;e=k[i>>2];g=d;i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(e=k[k[c>>2]+e>>2]);k[g+12>>2]=ba[e|0](l);V=d+16|0;return k[d+12>>2]}function Nb(e){var c=0,d;c=k[1893];d=e+3&-4;e=c+d|0;a:{if(e>>>0<=c>>>0?(d|0)>=1:0)break a;if(e>>>0>S()<<16>>>0&&!(Ra(e|0)|0))break a;k[1893]=e;return c}k[1897]=48;return-1}function Uc(g,c,d){var e;if(g<<24>>24<0)return 4;e=5;if(!(!c|!d)){e=z(5);if(!e)return 3;ca[e+4|0]=g;ca[e+1|0]=1;ca[e+2|0]=0;ca[e|0]=1;ca[e+3|0]=0;k[c>>2]=e;k[d>>2]=5;e=0}return e}function Vc(){var d=0,c;d=V-16|0;V=d;L(3164,3192,3228,0,2672,33,2675,0,2675,0,1775,2677,34);k[d+12>>2]=0;k[d+8>>2]=35;c=k[d+12>>2];k[d>>2]=k[d+8>>2];k[d+4>>2]=c;Dd(d);V=d+16|0}function ob(g,c){g=g|0;c=c|0;var d=0,i,e,l;d=V-16|0;V=d;i=k[g>>2];e=d;g=k[g+4>>2];c=(g>>1)+c|0;l=c;g&1&&(i=k[k[c>>2]+i>>2]);ca[e+15|0]=ba[i|0](l);V=d+16|0;return ea[d+15|0]}function Wc(i,c){i=i|0;c=c|0;var d=0,e,g,l;d=V-16|0;V=d;e=k[i>>2];g=d;i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(e=k[k[c>>2]+e>>2]);ba[e|0](g,l);i=Ga(d);ef(d);V=d+16|0;return i|0}function Xc(i,c){i=i|0;c=c|0;var d=0,e,g,l;d=V-16|0;V=d;e=k[i>>2];g=d;i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(e=k[k[c>>2]+e>>2]);ba[e|0](g,l);i=Ga(d);Ha(d);V=d+16|0;return i|0}function Yc(i,c){i=i|0;c=c|0;var d=0,e,g,l;d=V-16|0;V=d;e=k[i>>2];g=d;i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(e=k[k[c>>2]+e>>2]);ba[e|0](g,l);i=Ga(d);La(d);V=d+16|0;return i|0}function Kb(g,c){var d=0,e=0;e=V-32|0;V=e;d=vb(e+8|0,wb(g,(k[g+4>>2]-k[g>>2]|0)+1|0),k[g+4>>2]-k[g>>2]|0,g+8|0);ca[k[d+8>>2]]=ea[c|0];k[d+8>>2]=k[d+8>>2]+1;ub(g,d);sb(d);V=e+32|0}function vb(l,c,d,e){var g=0,i=0;g=V-16|0;V=g;k[g+12>>2]=0;k[l+12>>2]=0;k[l+16>>2]=e;c&&(i=df(c));k[l>>2]=i;d=d+i|0;k[l+8>>2]=d;k[l+4>>2]=d;k[l+12>>2]=c+i;V=g+16|0;return l}function Ya(d,c){a:{if(!c)break a;c=x(c,6964);if(!c|k[c+8>>2]&(k[d+8>>2]^-1))break a;if(!w(k[d+12>>2],k[c+12>>2],0))break a;return w(k[d+16>>2],k[c+16>>2],0)}return 0}function Lb(e,c){var d;d=V-16|0;V=d;k[d>>2]=e;e=k[e+4>>2];k[d+4>>2]=e;k[d+8>>2]=e+4;k[k[d+4>>2]>>2]=k[c>>2];k[d+4>>2]=k[d+4>>2]+4;k[k[d>>2]+4>>2]=k[d+4>>2];V=d+16|0}function Zc(){var c=0;c=V-16|0;V=c;H(2564,1024,4,0);kf(kf(kf(kf(kf(kf(kf(kf(kf(c+8|0,1043,0),1070,1),1097,2),1130,3),1161,4),1197,5),1233,6),1269,7),1310,8);V=c+16|0}function Qb(){var d,c;d=V-16|0;V=d;k[d+12>>2]=1073741823;k[d+8>>2]=2147483647;c=V-16|0;V=c;V=c+16|0;V=d+16|0;c=d+8|0;d=d+12|0;return k[(fa[c>>2]<fa[d>>2]?c:d)>>2]}function Eb(){var d,c;d=V-16|0;V=d;k[d+12>>2]=357913941;k[d+8>>2]=2147483647;c=V-16|0;V=c;V=c+16|0;V=d+16|0;c=d+8|0;d=d+12|0;return k[(fa[c>>2]<fa[d>>2]?c:d)>>2]}function $c(e,c){var d;d=V-16|0;V=d;k[d>>2]=e;e=k[e+4>>2];k[d+4>>2]=e;k[d+8>>2]=e+1;ca[k[d+4>>2]]=ea[c|0];k[d+4>>2]=k[d+4>>2]+1;k[k[d>>2]+4>>2]=k[d+4>>2];V=d+16|0}function rb(){var d,c;d=V-16|0;V=d;k[d+12>>2]=-1;k[d+8>>2]=2147483647;c=V-16|0;V=c;V=c+16|0;V=d+16|0;c=d+8|0;d=d+12|0;return k[(fa[c>>2]<fa[d>>2]?c:d)>>2]}function ad(i,c,d,e){i=i|0;c=c|0;d=d|0;e=e|0;var g=0;g=V-16|0;V=g;k[g+12>>2]=c;k[g+8>>2]=d;k[g+4>>2]=e;i=ba[i|0](g+12|0,g+8|0,g+4|0)|0;V=g+16|0;return i|0}function bd(g,c){var d=0,e=0;d=g;e=c;a:{if(ea[g+8|0]&24)g=1;else{g=0;if(!c)break a;c=x(c,6804);if(!c)break a;g=(ea[c+8|0]&24)!=0}g=w(d,e,g)}return g}function cd(g,c,d){g=g|0;c=c|0;d=d|0;var e;e=(k[g+4>>2]-k[g>>2]|0)/12|0;if(e>>>0<c>>>0){Fc(g,c-e|0,d);return}e>>>0>c>>>0&&mb(g,k[g>>2]+ga(c,12)|0)}function dd(d){d=d|0;var c=0;c=V-16|0;V=c;k[c+12>>2]=d;d=V-16|0;k[d+8>>2]=k[c+12>>2];k[d+12>>2]=k[k[d+8>>2]+4>>2];d=Fe(k[d+12>>2]);V=c+16|0;return d|0}function ed(i,c,d,e,g,l){i=i|0;c=c|0;d=d|0;e=e|0;g=g|0;l=l|0;if(w(i,k[c+8>>2],l)){Ca(c,d,e,g);return}i=k[i+8>>2];ba[k[k[i>>2]+20>>2]](i,c,d,e,g,l)}function fd(g,c,d){g=g|0;c=c|0;d=d|0;var e;e=k[g+4>>2]-k[g>>2]>>2;if(e>>>0<c>>>0){Gc(g,c-e|0,d);return}e>>>0>c>>>0&&lb(g,k[g>>2]+(c<<2)|0)}function gd(i,c,d,e){var g=0;g=V-16|0;V=g;k[g>>2]=i;i=k[i+4>>2];k[g+4>>2]=i;k[g+8>>2]=ga(e,12)+i;oe(c,d,g+4|0);k[k[g>>2]+4>>2]=k[g+4>>2];V=g+16|0}function hd(e,c){e=e|0;c=c|0;var d=0;d=V-80|0;V=d;Gb(d+8|0,c);ba[e|0](d+24|0,d+8|0);e=Kc(ha(56),d+24|0);kb(d+24|0);y(d+8|0);V=d+80|0;return e|0}function id(i,c,d,e){var g=0;g=V-16|0;V=g;k[g>>2]=i;i=k[i+4>>2];k[g+4>>2]=i;k[g+8>>2]=(e<<2)+i;Oe(c,d,g+4|0);k[k[g>>2]+4>>2]=k[g+4>>2];V=g+16|0}function Ba(m,c,d,e,g,n){var i,o,l;i=k[m+4>>2];o=i>>8;m=k[m>>2];l=m;i&1&&(o=k[k[e>>2]+o>>2]);ba[k[k[m>>2]+20>>2]](l,c,d,e+o|0,i&2?g:2,n)}function jd(g,c,d){g=g|0;c=c|0;d=d|0;var e;e=k[g+4>>2]-k[g>>2]|0;if(e>>>0<c>>>0){Hc(g,c-e|0,d);return}e>>>0>c>>>0&&nb(g,k[g>>2]+c|0)}function kd(i,c,d,e){var g=0;g=V-16|0;V=g;k[g>>2]=i;i=k[i+4>>2];k[g+4>>2]=i;k[g+8>>2]=e+i;Oe(c,d,g+4|0);k[k[g>>2]+4>>2]=k[g+4>>2];V=g+16|0}function ld(l,c,d,e,g){var m,i,n;m=k[l+4>>2];i=m>>8;l=k[l>>2];n=l;m&1&&(i=k[k[d>>2]+i>>2]);ba[k[k[l>>2]+24>>2]](n,c,d+i|0,m&2?e:2,g)}function md(g,c){var d=0,e;d=V-16|0;V=d;k[d+12>>2]=g;e=ha(1);ca[e|0]=ea[c|0];k[k[d+12>>2]>>2]=e;k[d+12>>2]=k[d+12>>2]+8;V=d+16|0;return g}function nd(i,c,d,e){i=i|0;c=c|0;d=d|0;e=e|0;var g,l;g=k[i>>2];i=k[i+4>>2];c=(i>>1)+c|0;l=c;i&1&&(g=k[g+k[c>>2]>>2]);ba[g|0](l,d,e)}function ia(g,c){var d=0,e;if(c)while(1){e=(d<<4)+g|0;ea[e|0]&15||U(k[e+8>>2]);d=d+1|0;if((d|0)!=(c|0))continue;break}U(g)}function Va(g,c){var d=0,e;d=V-16|0;V=d;e=k[c+4>>2];k[d+8>>2]=k[c>>2];k[d+12>>2]=e;T(3008,g|0,2,3088,2748,28,v(d+8|0)|0,0);V=d+16|0}function Ua(g,c){var d=0,e;d=V-16|0;V=d;e=k[c+4>>2];k[d+8>>2]=k[c>>2];k[d+12>>2]=e;T(3008,g|0,3,3096,3108,29,v(d+8|0)|0,0);V=d+16|0}function od(g,c){var d=0,e;d=V-16|0;V=d;e=k[c+4>>2];k[d+8>>2]=k[c>>2];k[d+12>>2]=e;T(3268,g|0,2,3348,2748,41,v(d+8|0)|0,0);V=d+16|0}function wa(g,c){var d=0,e;d=V-16|0;V=d;e=k[c+4>>2];k[d+8>>2]=k[c>>2];k[d+12>>2]=e;T(4660,g|0,2,4772,2748,81,v(d+8|0)|0,0);V=d+16|0}function pd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4660,1970,2,4780,2748,82,v(c+8|0)|0,0);V=c+16|0}function qd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3568,3356,3,3740,3108,85,v(c+8|0)|0,0);V=c+16|0}function rd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3568,3366,4,3760,3776,86,v(c+8|0)|0,0);V=c+16|0}function sd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3568,3373,2,3784,2748,87,v(c+8|0)|0,0);V=c+16|0}function td(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4380,3356,3,4552,3108,97,v(c+8|0)|0,0);V=c+16|0}function ud(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4380,3366,4,4576,3776,98,v(c+8|0)|0,0);V=c+16|0}function vd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3008,1743,2,3116,2748,30,v(c+8|0)|0,0);V=c+16|0}function wd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3980,3356,3,4152,3108,91,v(c+8|0)|0,0);V=c+16|0}function xd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3008,1751,2,3124,2748,31,v(c+8|0)|0,0);V=c+16|0}function yd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3980,3366,4,4176,3776,92,v(c+8|0)|0,0);V=c+16|0}function zd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4380,3373,2,4592,2748,99,v(c+8|0)|0,0);V=c+16|0}function Ad(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3008,1763,3,3132,3108,32,v(c+8|0)|0,0);V=c+16|0}function Bd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3980,3373,2,4192,2748,93,v(c+8|0)|0,0);V=c+16|0}function Cd(i,d,e,g){i=i|0;d=d|0;e=e|0;g=g|0;var c=0;c=V-32|0;V=c;Gb(c,g);ba[i|0](c+16|0,d,e,c);i=Ma(c+16|0);y(c);V=c+32|0;return i|0}function Dd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(3164,1789,2,3244,2748,36,v(c+8|0)|0,0);V=c+16|0}function Ed(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(2592,1364,2,2712,2748,12,v(c+8|0)|0,0);V=c+16|0}function Fd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(2592,1376,2,2752,2748,13,v(c+8|0)|0,0);V=c+16|0}function Gd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4660,1392,2,4740,2748,77,v(c+8|0)|0,0);V=c+16|0}function Hd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4660,1898,2,4748,2748,78,v(c+8|0)|0,0);V=c+16|0}function Id(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(2592,1392,2,2760,2748,14,v(c+8|0)|0,0);V=c+16|0}function Jd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4660,1912,2,4756,2748,79,v(c+8|0)|0,0);V=c+16|0}function Kd(e){var c=0,d;c=V-16|0;V=c;d=k[e+4>>2];k[c+8>>2]=k[e>>2];k[c+12>>2]=d;T(4660,1927,2,4764,2748,80,v(c+8|0)|0,0);V=c+16|0}function qa(i,c,d){i=i|0;c=c|0;d=d|0;var e,g;e=k[i>>2];i=k[i+4>>2];c=(i>>1)+c|0;g=c;i&1&&(e=k[e+k[c>>2]>>2]);ba[e|0](g,d)}function Ld(e,c,d){e=e|0;c=c|0;d=d|0;e=k[e>>2]+ga(c,12)|0;k[e+8>>2]=k[d+8>>2];c=k[d+4>>2];k[e>>2]=k[d>>2];k[e+4>>2]=c;return 1}function Md(g,c,d,e){g=g|0;c=c|0;d=d|0;e=e|0;if(w(g,k[c+8>>2],0)){Da(c,d,e);return}g=k[g+8>>2];ba[k[k[g>>2]+28>>2]](g,c,d,e)}function Nd(g,c,d){g=g|0;c=c|0;d=d|0;var e;e=ha(12);g=k[g>>2];c=k[c>>2];k[e+8>>2]=k[d>>2];k[e+4>>2]=c;k[e>>2]=g;return e|0}function Na(g,c){g=g|0;c=c|0;var d,e;d=k[g>>2];g=k[g+4>>2];c=(g>>1)+c|0;e=c;g&1&&(d=k[k[c>>2]+d>>2]);return ba[d|0](e)|0}function Od(){var c=0;c=V-16|0;V=c;H(2956,1561,4,0);pa(pa(pa(pa(pa(c+8|0,1573,0),1589,1),1605,2),1631,3),1662,4);V=c+16|0}function ha(d){var c=0;d=d?d:1;a:{while(1){c=z(d);if(c)break a;c=k[1898];if(c){ba[c|0]();continue}break}Sa();q()}return c}function Ja(g,c,d){g=g|0;c=c|0;d=d|0;var e=0;e=V-16|0;V=e;ba[k[g>>2]](e+8|0,c,d);g=qb(e+8|0);pb(e+8|0);V=e+16|0;return g|0}function Pd(g,c){g=g|0;c=c|0;var d=0,e;d=V-16|0;V=d;e=k[c+52>>2];k[d+12>>2]=k[c+48>>2];k[d+8>>2]=e;jb(g,d+8|0);V=d+16|0}function Qd(e,c){var d=0;d=V-16|0;V=d;k[d+12>>2]=e;c=ja(c);k[k[d+12>>2]>>2]=c;k[d+12>>2]=k[d+12>>2]+8;V=d+16|0;return e}function Rd(g,c){g=g|0;c=c|0;var d=0,e;d=V-16|0;V=d;e=k[c+8>>2];k[d+12>>2]=k[c+4>>2];k[d+8>>2]=e;jb(g,d+8|0);V=d+16|0}function mb(e,c){var d;d=k[e+4>>2];if((d|0)!=(c|0))while(1){d=d+-12|0;if((d|0)!=(c|0))continue;break}k[e+4>>2]=c}function nb(e,c){var d;d=k[e+4>>2];if((d|0)!=(c|0))while(1){d=d+-1|0;if((d|0)!=(c|0))continue;break}k[e+4>>2]=c}function lb(e,c){var d;d=k[e+4>>2];if((d|0)!=(c|0))while(1){d=d+-4|0;if((d|0)!=(c|0))continue;break}k[e+4>>2]=c}function Sb(e,c,d){e=e|0;c=c|0;d=d|0;if((k[c+4>>2]-k[c>>2]|0)/12>>>0>d>>>0){Je(e,k[c>>2]+ga(d,12)|0);return}k[e>>2]=1}function Hb(e,c){var d=0;d=c+4|0;ae(k[e>>2],k[e+4>>2],d);B(e,d);B(e+4|0,c+8|0);B(e+8|0,c+12|0);k[c>>2]=k[c+4>>2]}function ub(e,c){var d=0;d=c+4|0;yb(k[e>>2],k[e+4>>2],d);B(e,d);B(e+4|0,c+8|0);B(e+8|0,c+12|0);k[c>>2]=k[c+4>>2]}function Sd(e,c,d){e=e|0;c=c|0;d=d|0;if(k[c+4>>2]-k[c>>2]>>2>>>0>d>>>0){Le(e,k[c>>2]+(d<<2)|0);return}k[e>>2]=1}function Td(g,c){var d=0,e;d=za(c);e=ha(d+13|0);k[e+8>>2]=0;k[e+4>>2]=d;k[e>>2]=d;k[g>>2]=W(e+12|0,c,d+1|0)}function Ud(){var c=0;c=V-16|0;V=c;H(2980,1475,4,0);sa(sa(sa(sa(c+8|0,1488,0),1506,1),1523,2),1542,3);V=c+16|0}function Vd(d,c){if(k[d+8>>2]!=(c|0))while(1){k[d+8>>2]=k[d+8>>2]+-12;if(k[d+8>>2]!=(c|0))continue;break}}function Wd(d,c){if(k[d+8>>2]!=(c|0))while(1){k[d+8>>2]=k[d+8>>2]+-4;if(k[d+8>>2]!=(c|0))continue;break}}function Xd(d,c){if(k[d+8>>2]!=(c|0))while(1){k[d+8>>2]=k[d+8>>2]+-1;if(k[d+8>>2]!=(c|0))continue;break}}function Ma(e){var c,d;c=ha(12);d=k[e+4>>2];k[c>>2]=k[e>>2];k[c+4>>2]=d;k[c+8>>2]=k[e+8>>2];return c}function Yd(e,c,d){e=e|0;c=c|0;d=d|0;if(k[c+4>>2]-k[c>>2]>>>0>d>>>0){Ie(e,k[c>>2]+d|0);return}k[e>>2]=1}function Zd(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4910;Y(7176,k[c+12>>2],4,-2147483648,2147483647);V=c+16|0}function $d(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4927;Y(7200,k[c+12>>2],4,-2147483648,2147483647);V=c+16|0}function oa(d){var c=0;c=M(8)|0;k[c>>2]=6512;k[c>>2]=6556;Td(c+4|0,d);k[c>>2]=6604;Fa(c|0,6636,102);q()}function ae(g,c,d){var e=0;e=d;c=c-g|0;d=k[d>>2]+ga((c|0)/-12|0,12)|0;k[e>>2]=d;(c|0)>=1&&W(d,g,c)}function be(e,c){var d=0;Eb()>>>0<c>>>0&&(la(),q());d=Cb(c);k[e>>2]=d;k[e+4>>2]=d;k[e+8>>2]=ga(c,12)+d}function ce(){var c=0;c=V-16|0;V=c;k[c+12>>2]=76;T(4380,3382,4,4624,2704,101,ja(c+12|0)|0,0);V=c+16|0}function de(e,c){var d;Qb()>>>0<c>>>0&&(la(),q());d=xb(c);k[e>>2]=d;k[e+4>>2]=d;k[e+8>>2]=(c<<2)+d}function ee(){var c=0;c=V-16|0;V=c;k[c+12>>2]=75;T(4380,3378,3,4600,3804,100,ja(c+12|0)|0,0);V=c+16|0}function fe(){var c=0;c=V-16|0;V=c;k[c+12>>2]=67;T(3980,3378,3,4200,3804,94,ja(c+12|0)|0,0);V=c+16|0}function ge(){var c=0;c=V-16|0;V=c;k[c+12>>2]=68;T(3980,3382,4,4224,2704,95,ja(c+12|0)|0,0);V=c+16|0}function B(e,c){var d;d=V-16|0;V=d;k[d+12>>2]=k[e>>2];k[e>>2]=k[c>>2];k[c>>2]=k[d+12>>2];V=d+16|0}function he(){var c=0;c=V-16|0;V=c;k[c+12>>2]=59;T(3568,3378,3,3792,3804,88,ja(c+12|0)|0,0);V=c+16|0}function ie(){var c=0;c=V-16|0;V=c;k[c+12>>2]=60;T(3568,3382,4,3824,2704,89,ja(c+12|0)|0,0);V=c+16|0}function je(e,c){var d;rb()>>>0<c>>>0&&(la(),q());d=df(c);k[e>>2]=d;k[e+4>>2]=d;k[e+8>>2]=c+d}function ke(l,c,d,e,g,i){l=l|0,c=c|0,d=d|0,e=e|0,g=g|0,i=i|0,w(l,k[c+8>>2],i)&&Ca(c,d,e,g)}function le(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4889;Y(7152,k[c+12>>2],2,-32768,32767);V=c+16|0}function me(d){d=d|0;var c=0;c=V-16|0;V=c;k[c+12>>2]=d;d=k[c+12>>2];ib();V=c+16|0;return d|0}function ne(d){var c;c=V-16|0;V=c;k[d>>2]=0;k[d+4>>2]=0;k[c+12>>2]=0;k[d+8>>2]=0;V=c+16|0}function oe(e,c,d){c=c-e|0,(c|0)>=1&&(W(k[d>>2],e,c),k[d>>2]=k[d>>2]+ga((c>>>0)/12|0,12))}function pe(d){var c;d=k[d>>2]+-12|0;c=k[d+8>>2]+-1|0;k[d+8>>2]=c;(c|0)<=-1&&U(d)}function hb(e,c){e=e|0;c=c|0;var d=0;d=V-16|0;V=d;ba[e|0](d,c);e=Ma(d);V=d+16|0;return e|0}function qe(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4858;Y(7096,k[c+12>>2],1,-128,127);V=c+16|0}function re(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4863;Y(7140,k[c+12>>2],1,-128,127);V=c+16|0}function se(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4895;Y(7164,k[c+12>>2],2,0,65535);V=c+16|0}function te(e,c){var d;d=z(1);if(!d)return 3;ca[d|0]=2;k[e>>2]=d;k[c>>2]=1;return 0}function ue(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4875;Y(7128,k[c+12>>2],1,0,255);V=c+16|0}function yb(g,c,d){var e;e=d;c=c-g|0;d=k[d>>2]-c|0;k[e>>2]=d;(c|0)>=1&&W(d,g,c)}function ve(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4914;Y(7188,k[c+12>>2],4,0,-1);V=c+16|0}function we(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4932;Y(7212,k[c+12>>2],4,0,-1);V=c+16|0}function v(e){var c,d;c=ha(8);d=k[e+4>>2];k[c>>2]=k[e>>2];k[c+4>>2]=d;return c}function xe(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4946;J(7224,k[c+12>>2],4);V=c+16|0}function ye(){var c=0;c=V-16|0;V=c;k[c+12>>2]=4952;J(7236,k[c+12>>2],8);V=c+16|0}function ze(){var c=0;c=V-16|0;V=c;k[c+12>>2]=5063;Z(2464,0,k[c+12>>2]);V=c+16|0}function Ae(){var c=0;c=V-16|0;V=c;k[c+12>>2]=5307;Z(6272,4,k[c+12>>2]);V=c+16|0}function Be(){var c=0;c=V-16|0;V=c;k[c+12>>2]=5337;Z(6312,5,k[c+12>>2]);V=c+16|0}function Ce(){var c=0;c=V-16|0;V=c;k[c+12>>2]=5575;Z(6352,6,k[c+12>>2]);V=c+16|0}function De(){var c=0;c=V-16|0;V=c;k[c+12>>2]=5606;Z(6392,7,k[c+12>>2]);V=c+16|0}function Ee(d){d=d|0;var c=0;c=V-16|0;V=c;ba[d|0](c);d=Ma(c);V=c+16|0;return d|0}function Fe(e){var c=0,d;c=za(e)+1|0;d=z(c);return!d?0:W(d,e,c)}function Ge(d){var c;c=d&31;d=0-d&31;return(-1>>>c&-2)<<c|(-1<<d&-2)>>>d}function gb(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6032,0,k[c+12>>2]);V=c+16|0}function fb(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6072,1,k[c+12>>2]);V=c+16|0}function eb(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6112,2,k[c+12>>2]);V=c+16|0}function db(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6152,3,k[c+12>>2]);V=c+16|0}function cb(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6192,4,k[c+12>>2]);V=c+16|0}function bb(d){var c=0;c=V-16|0;V=c;k[c+12>>2]=d;Z(6232,5,k[c+12>>2]);V=c+16|0}function He(g,c,d,e){g=g|0,c=c|0,d=d|0,e=e|0,w(g,k[c+8>>2],0)&&Da(c,d,e)}function Ie(e,c){var d=0;d=V-16|0;V=d;k[e>>2]=E(3268,md(d+8|0,c)|0);V=d+16|0}function Je(e,c){var d=0;d=V-16|0;V=d;k[e>>2]=E(3008,Nc(d+8|0,c)|0);V=d+16|0}function Ke(d,c){d=d|0;c=c|0;if(k[d+4>>2]!=k[d+8>>2]){$c(d,c);return}Kb(d,c)}function jb(e,c){var d=0;d=V-16|0;V=d;k[e>>2]=E(2464,Lc(d+8|0,c)|0);V=d+16|0}function Le(e,c){var d=0;d=V-16|0;V=d;k[e>>2]=E(3164,Qd(d+8|0,c)|0);V=d+16|0}function Me(d,c){d=d|0;c=c|0;if(k[d+4>>2]!=k[d+8>>2]){Lb(d,c);return}Sc(d,c)}function Ne(d,c){d=d|0;c=c|0;if(k[d+4>>2]!=k[d+8>>2]){Ob(d,c);return}Mb(d,c)}function Oe(e,c,d){c=c-e|0,(c|0)>=1&&(W(k[d>>2],e,c),k[d>>2]=k[d>>2]+c)}function Pe(e,c,d){e=e|0;c=c|0;d=d|0;k[k[e>>2]+(c<<2)>>2]=k[d>>2];return 1}function Qe(){Zc(),lc(),Ud(),Od(),hc(),Vc(),yc(),gc(),kc(),ba[103](7585)|0}function Ia(g,c,d,e){g=g|0;c=c|0;d=d|0;e=e|0;return ba[k[g>>2]](c,d,e)|0}function Re(){var c=0;c=V-16|0;V=c;A(2006,2,4788,2748,83,52);V=c+16|0}function Se(){var c=0;c=V-16|0;V=c;D(3568,1,3736,2672,84,55);V=c+16|0}function Rb(e,c){var d=0;d=V-16|0;V=d;ab(e,c,za(c));V=d+16|0;return e}function Te(){var c=0;c=V-16|0;V=c;A(1455,2,2932,2748,18,10);V=c+16|0}function Ue(){var c=0;c=V-16|0;V=c;D(4380,1,4548,2672,96,71);V=c+16|0}function Ve(){var c=0;c=V-16|0;V=c;D(3980,1,4148,2672,90,63);V=c+16|0}function We(){var c=0;c=V-16|0;V=c;A(1417,2,2920,2748,16,8);V=c+16|0}function Xe(){var c=0;c=V-16|0;V=c;A(1435,1,2928,2672,17,9);V=c+16|0}function Ye(){var c=0;c=V-16|0;V=c;D(2592,4,2688,2704,11,3);V=c+16|0}function Ze(){var c=0;c=V-16|0;V=c;A(1398,4,2768,2704,15,7);V=c+16|0}function $e(e,c,d){e=e|0;c=c|0;d=d|0;ca[k[e>>2]+c|0]=ea[d|0];return 1}function Gb(e,c){var d=0;d=V-16|0;V=d;ab(e,c+4|0,k[c>>2]);V=d+16|0}function Cb(c){357913941<c>>>0&&(oa(2472),q());return ha(ga(c,12))}function xb(c){1073741823<c>>>0&&(oa(2472),q());return ha(c<<2)}function af(d,c){if(fa[d+4>>2]<fa[d+8>>2]){Ob(d,c);return}Mb(d,c)}function bf(d,c){if(fa[d+4>>2]<fa[d+8>>2]){Lb(d,c);return}Sc(d,c)}function cf(d,c){if(fa[d+4>>2]<fa[d+8>>2]){$c(d,c);return}Kb(d,c)}function df(c){4294967295<c>>>0&&(oa(2472),q());return ha(c)}function La(c){k[c>>2]&&(nb(c,k[c>>2]),U(k[c>>2]));return c}function ef(c){k[c>>2]&&(mb(c,k[c>>2]),U(k[c>>2]));return c}function Ha(c){k[c>>2]&&(lb(c,k[c>>2]),U(k[c>>2]));return c}function ja(d){var c;c=ha(4);k[c>>2]=k[d>>2];return c}function kb(c){La(c+32|0);Ha(c+20|0);ef(c+8|0);return c}function $a(e,c,d){e=e|0;c=c|0;d|0;return w(e,c,0)|0}function Fb(c){Vd(c,k[c+4>>2]),k[c>>2]&&U(k[c>>2])}function zb(c){Wd(c,k[c+4>>2]),k[c>>2]&&U(k[c>>2])}function sb(c){Xd(c,k[c+4>>2]),k[c>>2]&&U(k[c>>2])}function Ea(c){c=c|0;k[c>>2]=6556;pe(c+4|0);return c|0}function Tb(c){c=c|0;return(k[c+4>>2]-k[c>>2]|0)/12|0}function ff(d,c){d=d|0,c=c|0,ca[d|0]=ea[d|0]&254|c&1}function gf(d,c){d=d|0,c=c|0,ca[d|0]=ca[d|0]&1|c<<1}function hf(c){c=c|0;return k[c+4>>2]-k[c>>2]>>2}function jf(c){c=c|0;return k[c+4>>2]-k[c>>2]|0}function y(c){ea[c+11|0]>>>7|0&&U(k[c>>2])}function pa(e,c,d){G(2956,c|0,d|0);return e}function kf(e,c,d){G(2564,c|0,d|0);return e}function ua(e,c,d){G(4840,c|0,d|0);return e}function sa(e,c,d){G(2980,c|0,d|0);return e}function K(d,c){F(d|0,2896,+(zc(c)>>>0))}function lf(d,c){d=d|0,c=c|0,Rc(d,c+20|0)}function mf(d,c){d=d|0,c=c|0,Tc(d,c+32|0)}function qb(c){R(k[c>>2]);return k[c>>2]}function nf(d,c){d=d|0,c=c|0,k[d+8>>2]=c}function of(d,c){d=d|0,c=c|0,Oc(d,c+8|0)}function Ta(c){c=c|0;return ea[c|0]>>>1|0}function pf(c){c=c|0;return k[c+52>>2]}function Ka(c){c=c|0;return ba[c|0]()|0}function qf(c){c=c|0;return k[c+44>>2]}function rf(c){c=c|0,c&&U(La(c))}function sf(c){c=c|0,c&&U(Ha(c))}function tf(c){c=c|0,c&&U(ef(c))}function Pa(c){c=c|0;return k[c+4>>2]}function Db(c){c=c|0;return k[c+8>>2]}function uf(c){c=c|0,c&&U(kb(c))}function Wa(c){c=c|0;return ca[c|0]&1}function tb(c){c=c|0;return k[c>>2]}function vf(c){c=c|0;return ea[c|0]}function Ga(c){return ta(ha(12),c)}function xa(c){c=c|0,c&&U(c)}function wf(c){c|0;return q()|0}function va(){return ra(ha(12))|0}function xf(c){c|0;return 3568}function yf(c){c|0;return 2592}function zf(c){c|0;return 4380}function Af(c){c|0;return 3980}function Bf(c){c|0;return 3008}function Cf(c){c|0;return 3164}function Df(c){c|0;return 3268}function Ef(c){c|0;return 4660}function Ff(c){c|0;return 6488}function Gf(c){c=c|0,Ea(c),U(c)}function Qa(c){c=c|0;return c|0}function Hf(c){c=c|0,U(Ea(c))}function ra(c){ne(c);return c}function la(){oa(6481),q()}function ka(c){c=c|0,U(c)}function pb(c){Q(k[c>>2])}function Pb(c){c|0}ba[1]=yf;ba[2]=xa;ba[3]=Nd;ba[4]=Rd;ba[5]=Db;ba[6]=tb;ba[7]=uc;ba[8]=Ic;ba[9]=Mc;ba[10]=Jc;ba[11]=ad;ba[12]=Oa;ba[13]=na;ba[14]=Na;ba[15]=Cd;ba[16]=hb;ba[17]=Ee;ba[18]=hb;ba[19]=Bf;ba[20]=xa;ba[21]=Wa;ba[22]=ff;ba[23]=Ta;ba[24]=gf;ba[25]=Rd;ba[26]=Db;ba[27]=nf;ba[28]=ob;ba[29]=qa;ba[30]=Oa;ba[31]=na;ba[32]=qa;ba[33]=Cf;ba[34]=xa;ba[35]=vf;ba[36]=Na;ba[37]=Df;ba[38]=xa;ba[39]=Wa;ba[40]=Ta;ba[41]=ob;ba[42]=Ef;ba[43]=uf;ba[44]=tb;ba[45]=of;ba[46]=lf;ba[47]=mf;ba[48]=Pa;ba[49]=qf;ba[50]=Pd;ba[51]=pf;ba[52]=mc;ba[53]=xf;ba[54]=rf;ba[55]=va;ba[56]=Ke;ba[57]=jd;ba[58]=jf;ba[59]=Yd;ba[60]=$e;ba[61]=Af;ba[62]=tf;ba[63]=va;ba[64]=Ne;ba[65]=cd;ba[66]=Tb;ba[67]=Sb;ba[68]=Ld;ba[69]=zf;ba[70]=sf;ba[71]=va;ba[72]=Me;ba[73]=fd;ba[74]=hf;ba[75]=Sd;ba[76]=Pe;ba[77]=Na;ba[78]=Wc;ba[79]=Xc;ba[80]=Yc;ba[81]=na;ba[82]=Oa;ba[83]=hd;ba[84]=Ka;ba[85]=qa;ba[86]=nd;ba[87]=na;ba[88]=Ja;ba[89]=Ia;ba[90]=Ka;ba[91]=qa;ba[92]=nd;ba[93]=na;ba[94]=Ja;ba[95]=Ia;ba[96]=Ka;ba[97]=qa;ba[98]=nd;ba[99]=na;ba[100]=Ja;ba[101]=Ia;ba[102]=Ea;ba[103]=me;ba[104]=Qa;ba[105]=ka;ba[106]=Ff;ba[107]=Hf;ba[108]=Pa;ba[109]=Gf;ba[110]=Qa;ba[111]=ka;ba[112]=Pb;ba[113]=Pb;ba[114]=$a;ba[115]=ka;ba[116]=$a;ba[117]=ka;ba[118]=rc;ba[119]=ke;ba[120]=qc;ba[121]=He;ba[122]=ka;ba[123]=ed;ba[124]=jc;ba[125]=Md;ba[126]=ka;ba[127]=ic;ba[128]=dc;ba[129]=Ac;ba[130]=ka;ba[131]=fc;function S(){return Ub.byteLength/65536|0}return{z:Qe,A:U,B:z,C:dd,D:ib,E:wf}}var d=new Uint8Array(k.buffer);for(var C=new Uint8Array(123),g=25;g>=0;--g)C[48+g]=52+g,C[65+g]=g,C[97+g]=26+g;C[43]=62;C[47]=63;function e(g,i,k){var l,n,e=0,c=i,d=k.length;i=i+(d*3>>2)-(k[d-2]=="=")-(k[d-1]=="=");for(;e<d;e+=4)l=C[k.charCodeAt(e+1)],n=C[k.charCodeAt(e+2)],g[c++]=C[k.charCodeAt(e)]<<2|l>>4,c<i&&(g[c++]=l<<4|n>>2),c<i&&(g[c++]=n<<6|C[k.charCodeAt(e+3)])}e(d,1024,"RGd3Q29kZWNSZXR1cm5Db2RlAERnd0NvZGVjUmV0dXJuQ29kZV9TdWNjZXNzAERnd0NvZGVjUmV0dXJuQ29kZV9GYWlsdXJlAERnd0NvZGVjUmV0dXJuQ29kZV9Ob3RFbm91Z2hEYXRhAERnd0NvZGVjUmV0dXJuQ29kZV9PdXRPZk1lbW9yeQBEZ3dDb2RlY1JldHVybkNvZGVfQWNrSWRPdXRPZkJvdW5kcwBEZ3dDb2RlY1JldHVybkNvZGVfSW52YWxpZFBhcmFtZXRlcgBEZ3dDb2RlY1JldHVybkNvZGVfSW52YWxpZEZyYW1lVHlwZQBEZ3dDb2RlY1JldHVybkNvZGVfSW52YWxpZEFja0ZyYW1lTGVuZ3RoAERnd0NvZGVjUmV0dXJuQ29kZV9JbnZhbGlkRHJhaW5SZWFzb24ARW5jb2RlREdXUmVzdWx0AGdldFJhd0ZyYW1lAGdldFJhd0ZyYW1lU2l6ZQBnZXRSYwBlbmNvZGVER1dEYXRhRnJhbWUAZW5jb2RlREdXQWNrRnJhbWUAZW5jb2RlREdXRW1wdHlGcmFtZQBlbmNvZGVER1dEcmFpbkZyYW1lAERnd0ZyYW1lVHlwZQBEZ3dGcmFtZVR5cGVfRGF0YQBEZ3dGcmFtZVR5cGVfQWNrAERnd0ZyYW1lVHlwZV9FbXB0eQBEZ3dGcmFtZVR5cGVfRHJhaW4ARHJhaW5SZWFzb24ARHJhaW5SZWFzb25fRUxCAERyYWluUmVhc29uX1NMQgBEcmFpblJlYXNvbl9BcHBTZXJ2ZXJQdXNoAERyYWluUmVhc29uX0dyYWNlUGVyaW9kRXhwaXJlZABEcmFpblJlYXNvbl9Vbmtub3duAERHV0RhdGFGcmFtZQBnZXRSZXF1aXJlc0FjawBzZXRSZXF1aXJlc0FjawBnZXRBY2tJZABzZXRBY2tJZABnZXREYXRhAGdldERhdGFTaXplAHNldERhdGFTaXplAERHV0RyYWluRnJhbWUAZ2V0RHJhaW5SZWFzb24AREdXQWNrRnJhbWUAZ2V0UmVzZXJ2ZWQAREdXQWNrRnJhbWVKU1ZlYwBER1dEYXRhRnJhbWVKU1ZlYwBER1dEcmFpbkZyYW1lSlNWZWMARGVjb2RlREdXUmVzdWx0AGdldERhdGFGcmFtZXMAZ2V0RHJhaW5GcmFtZXMAZ2V0QWNrRnJhbWVzAGdldEZyYW1lTGVuZ3RoAGdldENvdW50RnJhbWVzAGdldEJ1ZlJlbWFpbmRlcgBnZXRCdWZSZW1haW5kZXJTaXplAGRlY29kZURHV0ZyYW1lAERHV1ZlcnNpb25zAERHV1ZFUl9HRU5FU0lTAERHV1ZFUl9QUkVGSVhFRF9BUFBfSEVBREVSUwBER1dWRVJfSEFORExFU19ER1dfRFJBSU5fRlJBTUUAREdXVkVSX0hBTkRMRVNfREdXX0RFQVVUSF9GUkFNRQBBUFBIRUFERVJfUFJFRklYAHgtZGd3LWFwcC0ASEVBREVSX0FQUElEAHgtZGd3LWFwcGlkAEhFQURFUl9BUFBWRVJTSU9OAHgtZGd3LWFwcHZlcnNpb24ASEVBREVSX0FVVEhUWVBFAHgtZGd3LWF1dGh0eXBlAEhFQURFUl9BVVRIVE9LRU4AQXV0aG9yaXphdGlvbgBIRUFERVJfREdXX1ZFUlNJT04AeC1kZ3ctdmVyc2lvbgBIRUFERVJfTE9HR0lOR19JRAB4LWRndy1sb2dnaW5naWQASEVBREVSX1RBUkdFVF9USUVSAHgtZGd3LXRpZXIASEVBREVSX1VVSUQAeC1kZ3ctdXVpZABER1dfQ0xJRU5UX1ZFUlNJT04AAwAAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWNFRQAAoBwAAIAJAABhbGxvY2F0b3I8VD46OmFsbG9jYXRlKHNpemVfdCBuKSAnbicgZXhjZWVkcyBtYXhpbXVtIHN1cHBvcnRlZCBzaXplADE4RGd3Q29kZWNSZXR1cm5Db2RlAAAAAFQcAADsCQAAMTVFbmNvZGVER1dSZXN1bHQAAACgHAAADAoAAFAxNUVuY29kZURHV1Jlc3VsdAAAgB0AACgKAAAAAAAAIAoAAFBLMTVFbmNvZGVER1dSZXN1bHQAgB0AAEwKAAABAAAAIAoAAGlpAHYAdmk=");e(d,2688,"PAoAAAQKAADEGwAALBwAAGlpaWlpAAAAtAoAAGAKAABOMTBlbXNjcmlwdGVuM3ZhbEUAAKAcAACgCgAAaWlpACwcAAA8CgAABAoAAGAKAAAgCgAArBsAANgbAABQCwAATlN0M19fMjEyYmFzaWNfc3RyaW5nSWNOU18xMWNoYXJfdHJhaXRzSWNFRU5TXzlhbGxvY2F0b3JJY0VFRUUATlN0M19fMjIxX19iYXNpY19zdHJpbmdfY29tbW9uSUxiMUVFRQAAAACgHAAAHwsAACQdAADgCgAAAAAAAAEAAABICwAAAAAAACAKAADYGwAAIAoAACAKAACMCwAAMTFEcmFpblJlYXNvbgAAAFQcAAB8CwAAMTJEZ3dGcmFtZVR5cGUAAFQcAACUCwAAMTRER1dEYXRhRnJhbWVKUwAAAACgHAAArAsAAFAxNERHV0RhdGFGcmFtZUpTAAAAgB0AAMgLAAAAAAAAwAsAAFBLMTRER1dEYXRhRnJhbWVKUwAAgB0AAOwLAAABAAAAwAsAANgbAAAADAAAlBsAANwLAADYGwAAdmlpaQAAAAC0CgAAAAwAABQcAAAADAAAlBsAANwLAAAUHAAAMTVER1dEcmFpbkZyYW1lSlMAAACgHAAASAwAAFAxNURHV0RyYWluRnJhbWVKUwAAgB0AAGQMAAAAAAAAXAwAAFBLMTVER1dEcmFpbkZyYW1lSlMAgB0AAIgMAAABAAAAXAwAAIwLAACcDAAAMTNER1dBY2tGcmFtZUpTAKAcAAC0DAAAUDEzREdXQWNrRnJhbWVKUwAAAACAHQAAzAwAAAAAAADEDAAAUEsxM0RHV0Fja0ZyYW1lSlMAAACAHQAA8AwAAAEAAADEDAAA2BsAAAQNAABwdXNoX2JhY2sAcmVzaXplAHNpemUAZ2V0AHNldABOU3QzX18yNnZlY3RvckkxM0RHV0Fja0ZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUATlN0M19fMjEzX192ZWN0b3JfYmFzZUkxM0RHV0Fja0ZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUATlN0M19fMjIwX192ZWN0b3JfYmFzZV9jb21tb25JTGIxRUVFAACgHAAAqg0AACQdAABuDQAAAAAAAAEAAADQDQAAAAAAACQdAAA6DQAAAAAAAAEAAADYDQAAAAAAAFBOU3QzX18yNnZlY3RvckkxM0RHV0Fja0ZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUAAAAAgB0AAAgOAAAAAAAA8A0AAFBLTlN0M19fMjZ2ZWN0b3JJMTNER1dBY2tGcmFtZUpTTlNfOWFsbG9jYXRvcklTMV9FRUVFAAAAgB0AAFAOAAABAAAA8A0AAEAOAACUGwAAQA4AAMQM");e(d,3760,"lBsAAEAOAAAsHAAAxAwAAHZpaWlpAAAALBwAAIgOAAC0CgAA8A0AACwcAABpaWlp");e(d,3824,"rBsAAPANAAAsHAAAxAwAAE5TdDNfXzI2dmVjdG9ySTE0REdXRGF0YUZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUATlN0M19fMjEzX192ZWN0b3JfYmFzZUkxNERHV0RhdGFGcmFtZUpTTlNfOWFsbG9jYXRvcklTMV9FRUVFAAAAJB0AADUPAAAAAAAAAQAAANANAAAAAAAAJB0AAAAPAAAAAAAAAQAAAHQPAAAAAAAAUE5TdDNfXzI2dmVjdG9ySTE0REdXRGF0YUZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUAAACAHQAApA8AAAAAAACMDwAAUEtOU3QzX18yNnZlY3RvckkxNERHV0RhdGFGcmFtZUpTTlNfOWFsbG9jYXRvcklTMV9FRUVFAACAHQAA7A8AAAEAAACMDwAA3A8AAJQbAADcDwAAwAs=");e(d,4176,"lBsAANwPAAAsHAAAwAsAACwcAAAkEAAAtAoAAIwPAAAsHA==");e(d,4224,"rBsAAIwPAAAsHAAAwAsAAE5TdDNfXzI2dmVjdG9ySTE1REdXRHJhaW5GcmFtZUpTTlNfOWFsbG9jYXRvcklTMV9FRUVFAE5TdDNfXzIxM19fdmVjdG9yX2Jhc2VJMTVER1dEcmFpbkZyYW1lSlNOU185YWxsb2NhdG9ySVMxX0VFRUUAJB0AAMYQAAAAAAAAAQAAANANAAAAAAAAJB0AAJAQAAAAAAAAAQAAAAQRAAAAAAAAUE5TdDNfXzI2dmVjdG9ySTE1REdXRHJhaW5GcmFtZUpTTlNfOWFsbG9jYXRvcklTMV9FRUVFAACAHQAANBEAAAAAAAAcEQAAUEtOU3QzX18yNnZlY3RvckkxNURHV0RyYWluRnJhbWVKU05TXzlhbGxvY2F0b3JJUzFfRUVFRQCAHQAAfBEAAAEAAAAcEQAAbBEAAJQbAABsEQAAXAw=");e(d,4576,"lBsAAGwRAAAsHAAAXAwAACwcAAC0EQAAtAoAABwRAAAsHA==");e(d,4624,"rBsAABwRAAAsHAAAXAwAADE1RGVjb2RlREdXUmVzdWx0AAAAoBwAACASAABQMTVEZWNvZGVER1dSZXN1bHQAAIAdAAA8EgAAAAAAADQSAABQSzE1RGVjb2RlREdXUmVzdWx0AIAdAABgEgAAAQAAADQSAAAECgAAdBIAAIwPAAB0EgAAHBEAAHQSAADwDQAAdBIAACwcAAB0EgAAtAoAAHQSAAA0EgAAUAsAAE44ZmFjZWJvb2s5ZGlzdHJpYmd3NmNvbW1vbjExREdXVmVyc2lvbnNFAAAAVBwAALwSAAB2b2lkAGJvb2wAY2hhcgBzaWduZWQgY2hhcgB1bnNpZ25lZCBjaGFyAHNob3J0AHVuc2lnbmVkIHNob3J0AGludAB1bnNpZ25lZCBpbnQAbG9uZwB1bnNpZ25lZCBsb25nAGZsb2F0AGRvdWJsZQBzdGQ6OnN0cmluZwBzdGQ6OmJhc2ljX3N0cmluZzx1bnNpZ25lZCBjaGFyPgBzdGQ6OndzdHJpbmcAc3RkOjp1MTZzdHJpbmcAc3RkOjp1MzJzdHJpbmcAZW1zY3JpcHRlbjo6dmFsAGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGNoYXI+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHNpZ25lZCBjaGFyPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBjaGFyPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxzaG9ydD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgc2hvcnQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGludD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8dW5zaWduZWQgaW50PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxsb25nPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1bnNpZ25lZCBsb25nPgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQ4X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVpbnQ4X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGludDE2X3Q+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PHVpbnQxNl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzxpbnQzMl90PgBlbXNjcmlwdGVuOjptZW1vcnlfdmlldzx1aW50MzJfdD4AZW1zY3JpcHRlbjo6bWVtb3J5X3ZpZXc8ZmxvYXQ+AGVtc2NyaXB0ZW46Om1lbW9yeV92aWV3PGRvdWJsZT4ATlN0M19fMjEyYmFzaWNfc3RyaW5nSWhOU18xMWNoYXJfdHJhaXRzSWhFRU5TXzlhbGxvY2F0b3JJaEVFRUUAAAAAJB0AAAYWAAAAAAAAAQAAAEgLAAAAAAAATlN0M19fMjEyYmFzaWNfc3RyaW5nSXdOU18xMWNoYXJfdHJhaXRzSXdFRU5TXzlhbGxvY2F0b3JJd0VFRUUAACQdAABgFgAAAAAAAAEAAABICwAAAAAAAE5TdDNfXzIxMmJhc2ljX3N0cmluZ0lEc05TXzExY2hhcl90cmFpdHNJRHNFRU5TXzlhbGxvY2F0b3JJRHNFRUVFAAAAJB0AALgWAAAAAAAAAQAAAEgLAAAAAAAATlN0M19fMjEyYmFzaWNfc3RyaW5nSURpTlNfMTFjaGFyX3RyYWl0c0lEaUVFTlNfOWFsbG9jYXRvcklEaUVFRUUAAAAkHQAAFBcAAAAAAAABAAAASAsAAAAAAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lhRUUAAKAcAABwFwAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJaEVFAACgHAAAmBcAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SXNFRQAAoBwAAMAXAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0l0RUUAAKAcAADoFwAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJaUVFAACgHAAAEBgAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWpFRQAAoBwAADgYAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lsRUUAAKAcAABgGAAATjEwZW1zY3JpcHRlbjExbWVtb3J5X3ZpZXdJbUVFAACgHAAAiBgAAE4xMGVtc2NyaXB0ZW4xMW1lbW9yeV92aWV3SWZFRQAAoBwAALAYAABOMTBlbXNjcmlwdGVuMTFtZW1vcnlfdmlld0lkRUUAAKAcAADYGAAAYmFzaWNfc3RyaW5nAGFsbG9jYXRvcjxUPjo6YWxsb2NhdGUoc2l6ZV90IG4pICduJyBleGNlZWRzIG1heGltdW0gc3VwcG9ydGVkIHNpemUAdmVjdG9yAHN0ZDo6ZXhjZXB0aW9uAAAAAAAAjBkAAGgAAABpAAAAagAAAFN0OWV4Y2VwdGlvbgAAAACgHAAAfBkAAAAAAAC4GQAAZgAAAGsAAABsAAAAU3QxMWxvZ2ljX2Vycm9yAMgcAACoGQAAjBkAAAAAAADsGQAAZgAAAG0AAABsAAAAU3QxMmxlbmd0aF9lcnJvcgAAAADIHAAA2BkAALgZAABTdDl0eXBlX2luZm8AAAAAoBwAAPgZAABOMTBfX2N4eGFiaXYxMTZfX3NoaW1fdHlwZV9pbmZvRQAAAADIHAAAEBoAAAgaAABOMTBfX2N4eGFiaXYxMTdfX2NsYXNzX3R5cGVfaW5mb0UAAADIHAAAQBoAADQaAABOMTBfX2N4eGFiaXYxMTdfX3BiYXNlX3R5cGVfaW5mb0UAAADIHAAAcBoAADQaAABOMTBfX2N4eGFiaXYxMTlfX3BvaW50ZXJfdHlwZV9pbmZvRQDIHAAAoBoAAJQaAABOMTBfX2N4eGFiaXYxMjBfX2Z1bmN0aW9uX3R5cGVfaW5mb0UAAAAAyBwAANAaAAA0GgAATjEwX19jeHhhYml2MTI5X19wb2ludGVyX3RvX21lbWJlcl90eXBlX2luZm9FAAAAyBwAAAQbAACUGgAAAAAAAIQbAABuAAAAbwAAAHAAAABxAAAAcgAAAE4xMF9fY3h4YWJpdjEyM19fZnVuZGFtZW50YWxfdHlwZV9pbmZvRQDIHAAAXBsAADQaAAB2AAAASBsAAJAbAABEbgAASBsAAJwbAABiAAAASBsAAKgbAABjAAAASBsAALQbAABQYwAAgB0AAMAbAAAAAAAAuBsAAGgAAABIGwAA1BsAAGEAAABIGwAA4BsAAHMAAABIGwAA7BsAAHQAAABIGwAA+BsAAGkAAABIGwAABBwAAGoAAABIGwAAEBwAAGwAAABIGwAAHBwAAG0AAABIGwAAKBwAAGYAAABIGwAANBwAAGQAAABIGwAAQBwAAAAAAACMHAAAbgAAAHMAAABwAAAAcQAAAHQAAABOMTBfX2N4eGFiaXYxMTZfX2VudW1fdHlwZV9pbmZvRQAAAADIHAAAaBwAADQaAAAAAAAAZBoAAG4AAAB1AAAAcAAAAHEAAAB2AAAAdwAAAHgAAAB5AAAAAAAAABAdAABuAAAAegAAAHAAAABxAAAAdgAAAHsAAAB8AAAAfQAAAE4xMF9fY3h4YWJpdjEyMF9fc2lfY2xhc3NfdHlwZV9pbmZvRQAAAADIHAAA6BwAAGQaAAAAAAAAbB0AAG4AAAB+AAAAcAAAAHEAAAB2AAAAfwAAAIAAAACBAAAATjEwX19jeHhhYml2MTIxX192bWlfY2xhc3NfdHlwZV9pbmZvRQAAAMgcAABEHQAAZBoAAAAAAADEGgAAbgAAAIIAAABwAAAAcQAAAIM=");e(d,7572,"sB9Q");return q({Int8Array:Int8Array,Int16Array:Int16Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:Infinity,Math:Math},i,k.buffer)}(Nb,D,E)}function ja(){return{then:function(c){c({instance:new ia()})}}}var ka=Error,C={};A=[];"object"!==typeof C&&L("no native wasm support detected");var D,E=new(function(c){var d=Array(c.initial);d.set=function(c,e){d[c]=e};d.get=function(c){return d[c]};return d})({initial:132,maximum:132,element:"anyfunc"}),la=!1;function ma(c,d){c||L("Assertion failed: "+d)}var na="undefined"!==typeof TextDecoder?new TextDecoder("utf8"):void 0;function oa(c,d,e){var g=G;if(0<e){e=d+e-1;for(var i=0;i<c.length;++i){var k=c.charCodeAt(i);if(55296<=k&&57343>=k){var l=c.charCodeAt(++i);k=65536+((k&1023)<<10)|l&1023}if(127>=k){if(d>=e)break;g[d++]=k}else{if(2047>=k){if(d+1>=e)break;g[d++]=192|k>>6}else{if(65535>=k){if(d+2>=e)break;g[d++]=224|k>>12}else{if(d+3>=e)break;g[d++]=240|k>>18;g[d++]=128|k>>12&63}g[d++]=128|k>>6&63}g[d++]=128|k&63}}g[d]=0}}var pa="undefined"!==typeof TextDecoder?new TextDecoder("utf-16le"):void 0;function qa(c,d){var e=c>>1;for(var g=e+d/2;!(e>=g)&&xa[e];)++e;e<<=1;if(32<e-c&&pa)return pa.decode(G.subarray(c,e));e=0;for(g="";;){var i=H[c+2*e>>1];if(0==i||e==d/2)return g;++e;g+=String.fromCharCode(i)}}function ra(c,d,e){void 0===e&&(e=2147483647);if(2>e)return 0;e-=2;var g=d;e=e<2*c.length?e/2:c.length;for(var i=0;i<e;++i)H[d>>1]=c.charCodeAt(i),d+=2;H[d>>1]=0;return d-g}function sa(c){return 2*c.length}function ta(c,d){for(var e=0,g="";!(e>=d/4);){var i=I[c+4*e>>2];if(0==i)break;++e;65536<=i?(i-=65536,g+=String.fromCharCode(55296|i>>10,56320|i&1023)):g+=String.fromCharCode(i)}return g}function ua(c,d,e){void 0===e&&(e=2147483647);if(4>e)return 0;var g=d;e=g+e-4;for(var i=0;i<c.length;++i){var k=c.charCodeAt(i);if(55296<=k&&57343>=k){var l=c.charCodeAt(++i);k=65536+((k&1023)<<10)|l&1023}I[d>>2]=k;d+=4;if(d+4>e)break}I[d>>2]=0;return d-g}function va(c){for(var d=0,e=0;e<c.length;++e){var g=c.charCodeAt(e);55296<=g&&57343>=g&&++e;d+=4}return d}var wa,F,G,H,xa,I,J,ya,za,K=i.INITIAL_MEMORY||16777216;i.wasmMemory?D=i.wasmMemory:D=new B();D&&(wa=D.buffer);K=wa.byteLength;t=wa;wa=t;i.HEAP8=F=new Int8Array(t);i.HEAP16=H=new Int16Array(t);i.HEAP32=I=new Int32Array(t);i.HEAPU8=G=new Uint8Array(t);i.HEAPU16=xa=new Uint16Array(t);i.HEAPU32=J=new Uint32Array(t);i.HEAPF32=ya=new Float32Array(t);i.HEAPF64=za=new Float64Array(t);var Aa=[],Ba=[],Ca=[],Da=[];function Ea(){var c=i.preRun.shift();Aa.unshift(c)}var Fa=0,Ga=null,Ha=null;i.preloadedImages={};i.preloadedAudios={};function L(c){i.onAbort&&i.onAbort(c);z(c);la=!0;c=new ka("abort("+c+"). Build with -s ASSERTIONS=1 for more info.");m(c);throw c}function Ia(c,d){return String.prototype.startsWith?c.startsWith(d):0===c.indexOf(d)}var Ja="data:application/octet-stream;base64,",M="DGWCppBridge.wasm";if(!Ia(M,Ja)){o=M;M=i.locateFile?i.locateFile(o,u):u+o}function Ka(){try{if(A)return new Uint8Array(A);var c=Y(M);if(c)return c;if(w)return w(M);throw"both async and sync fetching of the wasm failed"}catch(c){L(c)}}function La(){return A||!q&&!r||"function"!==typeof fetch||Ia(M,"file://")?d("Promise").resolve().then(Ka):fetch(M,{credentials:"same-origin"}).then(function(c){if(!c.ok)throw"failed to load wasm binary file at '"+M+"'";return c.arrayBuffer()})["catch"](function(){return Ka()})}function Ma(c){for(;0<c.length;){var d=c.shift();if("function"==typeof d)d(i);else{var e=d.ga;"number"===typeof e?void 0===d.Y?E.get(e)():E.get(e)(d.Y):e(void 0===d.Y?null:d.Y)}}}function Na(c){this.G=c-16,this.ta=function(c){I[this.G+8>>2]=c},this.qa=function(c){I[this.G+0>>2]=c},this.ra=function(){I[this.G+4>>2]=0},this.pa=function(){F[this.G+12>>0]=0},this.sa=function(){F[this.G+13>>0]=0},this.ka=function(c,d){this.ta(c),this.qa(d),this.ra(),this.pa(),this.sa()}}function Oa(){return 0<Oa.aa}function Pa(c){switch(c){case 1:return 0;case 2:return 1;case 4:return 2;case 8:return 3;default:throw new TypeError("Unknown type size: "+c)}}var Qa=void 0;function N(c){for(var d="";G[c];)d+=Qa[G[c++]];return d}var Ra={},Sa={},Ta={};function Ua(c){if(void 0===c)return"_unknown";c=c.replace(/[^a-zA-Z0-9_]/g,"$");var d=c.charCodeAt(0);return 48<=d&&57>=d?"_"+c:c}function Va(c,d){c=Ua(c);return new Function("body","return function "+c+'() {\n    "use strict";    return body.apply(this, arguments);\n};\n')(d)}function Wa(c){var d=Error,e=Va(c,function(d){this.name=c,this.message=d,d=Error(d).stack,void 0!==d&&(this.stack=this.toString()+"\n"+d.replace(/^Error(:[^\n]*)?\n/,""))});e.prototype=Object.create(d.prototype);e.prototype.constructor=e;e.prototype.toString=function(){return void 0===this.message?this.name:this.name+": "+this.message};return e}var Xa=void 0;function O(c){throw new Xa(c)}var Ya=void 0;function Za(c){throw new Ya(c)}function P(c,d,e){function g(d){d=e(d);d.length!==c.length&&Za("Mismatched type converter count");for(var g=0;g<c.length;++g)Q(c[g],d[g])}c.forEach(function(c){Ta[c]=d});var i=Array(d.length),k=[],l=0;d.forEach(function(c,d){Object.prototype.hasOwnProperty.call(Sa,c)?i[d]=Sa[c]:(k.push(c),Object.prototype.hasOwnProperty.call(Ra,c)||(Ra[c]=[]),Ra[c].push(function(){i[d]=Sa[c],++l,l===k.length&&g(i)}))});0===k.length&&g(i)}function Q(c,d,e){e=e||{};if(!("argPackAdvance"in d))throw new TypeError("registerType registeredInstance requires argPackAdvance");var g=d.name;c||O('type "'+g+'" must have a positive integer typeid pointer');if(Object.prototype.hasOwnProperty.call(Sa,c)){if(e.ja)return;O("Cannot register type '"+g+"' twice")}Sa[c]=d;delete Ta[c];Object.prototype.hasOwnProperty.call(Ra,c)&&(d=Ra[c],delete Ra[c],d.forEach(function(c){c()}))}function $a(c){return{count:c.count,R:c.R,T:c.T,G:c.G,I:c.I,K:c.K,L:c.L}}function ab(c){O(c.F.I.H.name+" instance already deleted")}var bb=!1;function cb(){}function db(c){--c.count.value,0===c.count.value&&(c.K?c.L.P(c.K):c.I.H.P(c.G))}function eb(c){if("undefined"===typeof FinalizationGroup)return eb=function(c){return c},c;bb=new FinalizationGroup(function(c){for(var d=c.next();!d.done;d=c.next())d=d.value,d.G?db(d):!1});eb=function(c){bb.register(c,c.F,c.F);return c};cb=function(c){bb.unregister(c.F)};return eb(c)}var fb=void 0,gb=[];function hb(){for(;gb.length;){var c=gb.pop();c.F.R=!1;c["delete"]()}}function R(){}var ib={};function jb(c,d,e){if(void 0===c[d].J){var g=c[d];c[d]=function(){Object.prototype.hasOwnProperty.call(c[d].J,arguments.length)||O("Function '"+e+"' called with an invalid number of arguments ("+arguments.length+") - expects one of ("+c[d].J+")!");return c[d].J[arguments.length].apply(this,arguments)};c[d].J=[];c[d].J[g.V]=g}}function kb(c,d,e){Object.prototype.hasOwnProperty.call(i,c)?((void 0===e||void 0!==i[c].J&&void 0!==i[c].J[e])&&O("Cannot register public name '"+c+"' twice"),jb(i,c,c),Object.prototype.hasOwnProperty.call(i,e)&&O("Cannot register multiple overloads of a function with the same number of arguments ("+e+")!"),i[c].J[e]=d):(i[c]=d,void 0!==e&&(i[c].wa=e))}function lb(c,d,e,g,i,k,l,m){this.name=c,this.constructor=d,this.S=e,this.P=g,this.M=i,this.ha=k,this.U=l,this.fa=m,this.ma=[]}function mb(c,d,e){for(;d!==e;)d.U||O("Expected null or instance of "+e.name+", got an instance of "+d.name),c=d.U(c),d=d.M;return c}function nb(c,d){if(null===d)return this.Z&&O("null is not a valid "+this.name),0;d.F||O('Cannot pass "'+V(d)+'" as a '+this.name);d.F.G||O("Cannot pass deleted object as a pointer of type "+this.name);return mb(d.F.G,d.F.I.H,this.H)}function ob(c,d){if(null===d){this.Z&&O("null is not a valid "+this.name);if(this.X){var e=this.na();null!==c&&c.push(this.P,e);return e}return 0}d.F||O('Cannot pass "'+V(d)+'" as a '+this.name);d.F.G||O("Cannot pass deleted object as a pointer of type "+this.name);!this.W&&d.F.I.W&&O("Cannot convert argument of type "+(d.F.L?d.F.L.name:d.F.I.name)+" to parameter type "+this.name);e=mb(d.F.G,d.F.I.H,this.H);if(this.X)switch(void 0===d.F.K&&O("Passing raw pointer to smart pointer is illegal"),this.ua){case 0:d.F.L===this?e=d.F.K:O("Cannot convert argument of type "+(d.F.L?d.F.L.name:d.F.I.name)+" to parameter type "+this.name);break;case 1:e=d.F.K;break;case 2:if(d.F.L===this)e=d.F.K;else{var g=d.clone();e=this.oa(e,Gb(function(){g["delete"]()}));null!==c&&c.push(this.P,e)}break;default:O("Unsupporting sharing policy")}return e}function pb(c,d){if(null===d)return this.Z&&O("null is not a valid "+this.name),0;d.F||O('Cannot pass "'+V(d)+'" as a '+this.name);d.F.G||O("Cannot pass deleted object as a pointer of type "+this.name);d.F.I.W&&O("Cannot convert argument of type "+d.F.I.name+" to parameter type "+this.name);return mb(d.F.G,d.F.I.H,this.H)}function qb(c){return this.fromWireType(J[c>>2])}function rb(c,d,e){if(d===e)return c;if(void 0===e.M)return null;c=rb(c,d,e.M);return null===c?null:e.fa(c)}var sb={};function tb(c,d){for(void 0===d&&O("ptr should not be undefined");c.M;)d=c.U(d),c=c.M;return sb[d]}function ub(c,d){d.I&&d.G||Za("makeClassHandle requires ptr and ptrType");!!d.L!==!!d.K&&Za("Both smartPtrType and smartPtr must be specified");d.count={value:1};return eb(Object.create(c,{F:{value:d}}))}function S(c,d,e,g){this.name=c,this.H=d,this.Z=e,this.W=g,this.X=!1,this.P=this.oa=this.na=this.da=this.ua=this.la=void 0,void 0!==d.M?this.toWireType=ob:(this.toWireType=g?nb:pb,this.N=null)}function vb(c,d,e){Object.prototype.hasOwnProperty.call(i,c)||Za("Replacing nonexistant public symbol"),void 0!==i[c].J&&void 0!==e?i[c].J[e]=d:(i[c]=d,i[c].V=e)}function wb(c,d){ma(0<=c.indexOf("j"),"getDynCaller should only be called with i64 sigs");var e=[];return function(){e.length=arguments.length;for(var g=0;g<arguments.length;g++)e[g]=arguments[g];var k;-1!=c.indexOf("j")?k=e&&e.length?i["dynCall_"+c].apply(null,[d].concat(e)):i["dynCall_"+c].call(null,d):k=E.get(d).apply(null,e);return k}}function T(c,d){c=N(c);var e=-1!=c.indexOf("j")?wb(c,d):E.get(d);"function"!==typeof e&&O("unknown function pointer with signature "+c+": "+d);return e}var xb=void 0;function yb(c){c=Qb(c);var d=N(c);Z(c);return d}function zb(c,d){function e(c){i[c]||Sa[c]||(Ta[c]?Ta[c].forEach(e):(g.push(c),i[c]=!0))}var g=[],i={};d.forEach(e);throw new xb(c+": "+g.map(yb).join([", "]))}function Ab(c,d){for(var e=[],g=0;g<c;g++)e.push(I[(d>>2)+g]);return e}function Bb(c){for(;c.length;){var d=c.pop();c.pop()(d)}}function Cb(c){var d=Function;if(!(d instanceof Function))throw new TypeError("new_ called with constructor type "+typeof d+" which is not a function");var e=Va(d.name||"unknownFunctionName",function(){});e.prototype=d.prototype;e=new e();c=d.apply(e,c);return c instanceof Object?c:e}function Db(c,d,e,g,i){var k=d.length;2>k&&O("argTypes array size mismatch! Must at least get return value and 'this' types!");var l=null!==d[1]&&null!==e,m=!1;for(e=1;e<d.length;++e)if(null!==d[e]&&void 0===d[e].N){m=!0;break}var n="void"!==d[0].name,o="",q="";for(e=0;e<k-2;++e)o+=(0!==e?", ":"")+"arg"+e,q+=(0!==e?", ":"")+"arg"+e+"Wired";c="return function "+Ua(c)+"("+o+") {\nif (arguments.length !== "+(k-2)+") {\nthrowBindingError('function "+c+" called with ' + arguments.length + ' arguments, expected "+(k-2)+" args!');\n}\n";m&&(c+="var destructors = [];\n");var r=m?"destructors":"null";o="throwBindingError invoker fn runDestructors retType classParam".split(" ");g=[O,g,i,Bb,d[0],d[1]];l&&(c+="var thisWired = classParam.toWireType("+r+", this);\n");for(e=0;e<k-2;++e)c+="var arg"+e+"Wired = argType"+e+".toWireType("+r+", arg"+e+"); // "+d[e+2].name+"\n",o.push("argType"+e),g.push(d[e+2]);l&&(q="thisWired"+(0<q.length?", ":"")+q);c+=(n?"var rv = ":"")+"invoker(fn"+(0<q.length?", ":"")+q+");\n";if(m)c+="runDestructors(destructors);\n";else for(e=l?1:2;e<d.length;++e)k=1===e?"thisWired":"arg"+(e-2)+"Wired",null!==d[e].N&&(c+=k+"_dtor("+k+"); // "+d[e].name+"\n",o.push(k+"_dtor"),g.push(d[e].N));n&&(c+="var ret = retType.fromWireType(rv);\nreturn ret;\n");o.push(c+"}\n");return Cb(o).apply(null,g)}var Eb=[],U=[{},{value:void 0},{value:null},{value:!0},{value:!1}];function Fb(c){4<c&&0===--U[c].$&&(U[c]=void 0,Eb.push(c))}function Gb(c){switch(c){case void 0:return 1;case null:return 2;case!0:return 3;case!1:return 4;default:var d=Eb.length?Eb.pop():U.length;U[d]={$:1,value:c};return d}}function Hb(c,d,e){switch(d){case 0:return function(c){return this.fromWireType((e?F:G)[c])};case 1:return function(c){return this.fromWireType((e?H:xa)[c>>1])};case 2:return function(c){return this.fromWireType((e?I:J)[c>>2])};default:throw new TypeError("Unknown integer type: "+c)}}function Ib(c,d){var e=Sa[c];void 0===e&&O(d+" has unknown type "+yb(c));return e}function V(c){if(null===c)return"null";var d=typeof c;return"object"===d||"array"===d||"function"===d?c.toString():""+c}function Jb(c,d){switch(d){case 2:return function(c){return this.fromWireType(ya[c>>2])};case 3:return function(c){return this.fromWireType(za[c>>3])};default:throw new TypeError("Unknown float type: "+c)}}function Kb(c,d,e){switch(d){case 0:return e?function(c){return F[c]}:function(c){return G[c]};case 1:return e?function(c){return H[c>>1]}:function(c){return xa[c>>1]};case 2:return e?function(c){return I[c>>2]}:function(c){return J[c>>2]};default:throw new TypeError("Unknown integer type: "+c)}}for(var n=Array(256),B=0;256>B;++B)n[B]=String.fromCharCode(B);Qa=n;Xa=i.BindingError=Wa("BindingError");Ya=i.InternalError=Wa("InternalError");R.prototype.isAliasOf=function(c){if(!(this instanceof R&&c instanceof R))return!1;var d=this.F.I.H,e=this.F.G,g=c.F.I.H;for(c=c.F.G;d.M;)e=d.U(e),d=d.M;for(;g.M;)c=g.U(c),g=g.M;return d===g&&e===c};R.prototype.clone=function(){this.F.G||ab(this);if(this.F.T)return this.F.count.value+=1,this;var c=eb(Object.create(Object.getPrototypeOf(this),{F:{value:$a(this.F)}}));c.F.count.value+=1;c.F.R=!1;return c};R.prototype["delete"]=function(){this.F.G||ab(this),this.F.R&&!this.F.T&&O("Object already scheduled for deletion"),cb(this),db(this.F),this.F.T||(this.F.K=void 0,this.F.G=void 0)};R.prototype.isDeleted=function(){return!this.F.G};R.prototype.deleteLater=function(){this.F.G||ab(this);this.F.R&&!this.F.T&&O("Object already scheduled for deletion");gb.push(this);1===gb.length&&fb&&fb(hb);this.F.R=!0;return this};S.prototype.ia=function(c){this.da&&(c=this.da(c));return c};S.prototype.ba=function(c){this.P&&this.P(c)};S.prototype.argPackAdvance=8;S.prototype.readValueFromPointer=qb;S.prototype.deleteObject=function(c){null!==c&&c["delete"]()};S.prototype.fromWireType=function(c){function d(){return this.X?ub(this.H.S,{I:this.la,G:e,L:this,K:c}):ub(this.H.S,{I:this,G:c})}var e=this.ia(c);if(!e)return this.ba(c),null;var g=tb(this.H,e);if(void 0!==g){if(0===g.F.count.value)return g.F.G=e,g.F.K=c,g.clone();g=g.clone();this.ba(c);return g}g=this.H.ha(e);g=ib[g];if(!g)return d.call(this);g=this.W?g.ea:g.pointerType;var i=rb(e,this.H,g.H);return null===i?d.call(this):this.X?ub(g.H.S,{I:g,G:i,L:this,K:c}):ub(g.H.S,{I:g,G:i})};i.getInheritedInstanceCount=function(){return Object.keys(sb).length};i.getLiveInheritedInstances=function(){var c=[],d;for(d in sb)Object.prototype.hasOwnProperty.call(sb,d)&&c.push(sb[d]);return c};i.flushPendingDeletes=hb;i.setDelayFunction=function(c){fb=c,gb.length&&fb&&fb(hb)};xb=i.UnboundTypeError=Wa("UnboundTypeError");i.count_emval_handles=function(){for(var c=0,d=5;d<U.length;++d)void 0!==U[d]&&++c;return c};i.get_first_emval=function(){for(var c=5;c<U.length;++c)if(void 0!==U[c])return U[c];return null};var Lb=!1;function W(c){for(var d=[],e=0;e<c.length;e++){var g=c[e];255<g&&(Lb&&ma(!1,"Character code "+g+" ("+String.fromCharCode(g)+")  at offset "+e+" not in 0x00-0xFF."),g&=255);d.push(String.fromCharCode(g))}return d.join("")}var Mb="function"===typeof atob?atob:function(c){var d="",e=0;c=c.replace(/[^A-Za-z0-9\+\/=]/g,"");do{var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(e++)),i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(e++)),k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(e++)),l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(c.charAt(e++));g=g<<2|i>>4;i=(i&15)<<4|k>>2;var m=(k&3)<<6|l;d+=String.fromCharCode(g);64!==k&&(d+=String.fromCharCode(i));64!==l&&(d+=String.fromCharCode(m))}while(e<c.length);return d};function Y(c){if(Ia(c,Ja)){c=c.slice(Ja.length);if("boolean"===typeof s&&s){try{var d=Buffer.from(c,"base64")}catch(e){d=new Buffer(c,"base64")}var e=new Uint8Array(d.buffer,d.byteOffset,d.byteLength)}else try{c=Mb(c);var g=new Uint8Array(c.length);for(d=0;d<c.length;++d)g[d]=c.charCodeAt(d);e=g}catch(c){throw Error("Converting base64 string to bytes failed.")}return e}}Ba.push({ga:function(){Ob()}});var Nb={q:function(c){return Pb(c+16)+16},p:function(c,d,e){new Na(c).ka(d,e);"uncaught_exception"in Oa?Oa.aa++:Oa.aa=1;throw c},b:E,v:function(c,d,e,g,i){var k=Pa(e);d=N(d);Q(c,{name:d,fromWireType:function(c){return!!c},toWireType:function(c,d){return d?g:i},argPackAdvance:8,readValueFromPointer:function(c){if(1===e)var g=F;else if(2===e)g=H;else if(4===e)g=I;else throw new TypeError("Unknown boolean type size: "+d);return this.fromWireType(g[c>>k])},N:null})},f:function(c,d,e,g,i,k,l,m,n,o,q,r,s){q=N(q);k=T(i,k);m&&(m=T(l,m));o&&(o=T(n,o));s=T(r,s);var t=Ua(q);kb(t,function(){zb("Cannot construct "+q+" due to unbound types",[g])});P([c,d,e],g?[g]:[],function(d){d=d[0];if(g)var e=d.H,i=e.S;else i=R.prototype;d=Va(t,function(){if(Object.getPrototypeOf(this)!==l)throw new Xa("Use 'new' to construct "+q);if(void 0===n.O)throw new Xa(q+" has no accessible constructor");var c=n.O[arguments.length];if(void 0===c)throw new Xa("Tried to invoke ctor of "+q+" with invalid number of parameters ("+arguments.length+") - expected ("+Object.keys(n.O).toString()+") parameters instead!");return c.apply(this,arguments)});var l=Object.create(i,{constructor:{value:d}});d.prototype=l;var n=new lb(q,d,l,s,e,k,m,o);e=new S(q,n,!0,!1);i=new S(q+"*",n,!1,!1);var r=new S(q+" const*",n,!1,!0);ib[c]={pointerType:i,ea:r};vb(t,d);return[e,i,r]})},h:function(c,d,e,g,i,k){ma(0<d);var l=Ab(d,e);i=T(g,i);var m=[k],n=[];P([],[c],function(c){c=c[0];var e="constructor "+c.name;void 0===c.H.O&&(c.H.O=[]);if(void 0!==c.H.O[d-1])throw new Xa("Cannot register multiple constructors with identical number of parameters ("+(d-1)+") for class '"+c.name+"'! Overload resolution is currently only performed using the parameter count, not actual type info!");c.H.O[d-1]=function(){zb("Cannot construct "+c.name+" due to unbound types",l)};P([],l,function(g){c.H.O[d-1]=function(){arguments.length!==d-1&&O(e+" called with "+arguments.length+" arguments, expected "+(d-1));n.length=0;m.length=d;for(var c=1;c<d;++c)m[c]=g[c].toWireType(n,arguments[c-1]);c=i.apply(null,m);Bb(n);return g[0].fromWireType(c)};return[]});return[]})},c:function(c,d,e,g,i,k,l,m){var n=Ab(e,g);d=N(d);k=T(i,k);P([],[c],function(c){function g(){zb("Cannot call "+i+" due to unbound types",n)}c=c[0];var i=c.name+"."+d;m&&c.H.ma.push(d);var o=c.H.S,q=o[d];void 0===q||void 0===q.J&&q.className!==c.name&&q.V===e-2?(g.V=e-2,g.className=c.name,o[d]=g):(jb(o,d,i),o[d].J[e-2]=g);P([],n,function(g){g=Db(i,g,c,k,l);void 0===o[d].J?(g.V=e-2,o[d]=g):o[d].J[e-2]=g;return[]});return[]})},m:function(c,d,e){c=N(c),P([],[d],function(d){d=d[0];i[c]=d.fromWireType(e);return[]})},u:function(c,d){d=N(d),Q(c,{name:d,fromWireType:function(c){var d=U[c].value;Fb(c);return d},toWireType:function(c,d){return Gb(d)},argPackAdvance:8,readValueFromPointer:qb,N:null})},k:function(c,d,e,g){function i(){}e=Pa(e);d=N(d);i.values={};Q(c,{name:d,constructor:i,fromWireType:function(c){return this.constructor.values[c]},toWireType:function(c,d){return d.value},argPackAdvance:8,readValueFromPointer:Hb(d,e,g),N:null});kb(d,i)},j:function(c,d,e){var g=Ib(c,"enum");d=N(d);c=g.constructor;g=Object.create(g.constructor.prototype,{value:{value:e},constructor:{value:Va(g.name+"_"+d,function(){})}});c.values[e]=g;c[d]=g},n:function(c,d,e){e=Pa(e),d=N(d),Q(c,{name:d,fromWireType:function(c){return c},toWireType:function(c,d){if("number"!==typeof d&&"boolean"!==typeof d)throw new TypeError('Cannot convert "'+V(d)+'" to '+this.name);return d},argPackAdvance:8,readValueFromPointer:Jb(d,e),N:null})},g:function(c,d,e,g,i,k){var l=Ab(d,e);c=N(c);i=T(g,i);kb(c,function(){zb("Cannot call "+c+" due to unbound types",l)},d-1);P([],l,function(e){e=[e[0],null].concat(e.slice(1));vb(c,Db(c,e,null,i,k),d-1);return[]})},e:function(c,d,e,g,i){function k(c){return c}d=N(d);-1===i&&(i=4294967295);var l=Pa(e);if(0===g){var m=32-8*e;k=function(c){return c<<m>>>m}}var n=-1!=d.indexOf("unsigned");Q(c,{name:d,fromWireType:k,toWireType:function(c,e){if("number"!==typeof e&&"boolean"!==typeof e)throw new TypeError('Cannot convert "'+V(e)+'" to '+this.name);if(e<g||e>i)throw new TypeError('Passing a number "'+V(e)+'" from JS side to C/C++ side to an argument of type "'+d+'", which is outside the valid range ['+g+", "+i+"]!");return n?e>>>0:e|0},argPackAdvance:8,readValueFromPointer:Kb(d,l,0!==g),N:null})},d:function(c,d,e){function g(c){c>>=2;return new i(wa,J[c+1],J[c])}var i=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array][d];e=N(e);Q(c,{name:e,fromWireType:g,argPackAdvance:8,readValueFromPointer:g},{ja:!0})},o:function(c,d){d=N(d);var e="std::string"===d;Q(c,{name:d,fromWireType:function(c){var d=J[c>>2];if(e)for(var g=c+4,i=0;i<=d;++i){var k=c+4+i;if(i==d||0==G[k]){if(g){var l=g,m=G,n=l+(k-g);for(g=l;m[g]&&!(g>=n);)++g;if(16<g-l&&m.subarray&&na)l=na.decode(m.subarray(l,g));else{for(n="";l<g;){var o=m[l++];if(o&128){var q=m[l++]&63;if(192==(o&224))n+=String.fromCharCode((o&31)<<6|q);else{var r=m[l++]&63;o=224==(o&240)?(o&15)<<12|q<<6|r:(o&7)<<18|q<<12|r<<6|m[l++]&63;65536>o?n+=String.fromCharCode(o):(o-=65536,n+=String.fromCharCode(55296|o>>10,56320|o&1023))}}else n+=String.fromCharCode(o)}l=n}}else l="";if(void 0===s)var s=l;else s+=String.fromCharCode(0),s+=l;g=k+1}}else{s=Array(d);for(i=0;i<d;++i)s[i]=String.fromCharCode(G[c+4+i]);s=s.join("")}Z(c);return s},toWireType:function(c,d){d instanceof ArrayBuffer&&(d=new Uint8Array(d));var g="string"===typeof d;g||d instanceof Uint8Array||d instanceof Uint8ClampedArray||d instanceof Int8Array||O("Cannot pass non-string to std::string");var i=(e&&g?function(){for(var c=0,e=0;e<d.length;++e){var g=d.charCodeAt(e);55296<=g&&57343>=g&&(g=65536+((g&1023)<<10)|d.charCodeAt(++e)&1023);127>=g?++c:c=2047>=g?c+2:65535>=g?c+3:c+4}return c}:function(){return d.length})(),k=Pb(4+i+1);J[k>>2]=i;if(e&&g)oa(d,k+4,i+1);else if(g)for(g=0;g<i;++g){var l=d.charCodeAt(g);255<l&&(Z(k),O("String has UTF-16 code units that do not fit in 8 bits"));G[k+4+g]=l}else for(g=0;g<i;++g)G[k+4+g]=d[g];null!==c&&c.push(Z,k);return k},argPackAdvance:8,readValueFromPointer:qb,N:function(c){Z(c)}})},l:function(c,d,e){e=N(e);if(2===d)var g=qa,i=ra,k=sa,l=function(){return xa},m=1;else 4===d&&(g=ta,i=ua,k=va,l=function(){return J},m=2);Q(c,{name:e,fromWireType:function(c){for(var e=J[c>>2],i=l(),k,n=c+4,o=0;o<=e;++o){var q=c+4+o*d;(o==e||0==i[q>>m])&&(n=g(n,q-n),void 0===k?k=n:(k+=String.fromCharCode(0),k+=n),n=q+d)}Z(c);return k},toWireType:function(c,g){"string"!==typeof g&&O("Cannot pass non-string to C++ string type "+e);var l=k(g),n=Pb(4+l+d);J[n>>2]=l>>m;i(g,n+4,l+d);null!==c&&c.push(Z,n);return n},argPackAdvance:8,readValueFromPointer:qb,N:function(c){Z(c)}})},w:function(c,d){d=N(d),Q(c,{va:!0,name:d,argPackAdvance:0,fromWireType:function(){},toWireType:function(){}})},x:Fb,y:function(c){4<c&&(U[c].$+=1)},i:function(c,d){c=Ib(c,"_emval_take_value");c=c.readValueFromPointer(d);return Gb(c)},t:function(){L()},r:function(c,d,e){G.copyWithin(c,d,d+e)},s:function(){L("OOM")},a:D};(function(){function c(c){i.asm=c.exports,Fa--,i.monitorRunDependencies&&i.monitorRunDependencies(Fa),0==Fa&&(null!==Ga&&(clearInterval(Ga),Ga=null),Ha&&(c=Ha,Ha=null,c()))}function d(d){c(d.instance)}function e(c){return La().then(function(){return ja()}).then(c,function(c){z("failed to asynchronously prepare wasm: "+c),L(c)})}var g={a:Nb};Fa++;i.monitorRunDependencies&&i.monitorRunDependencies(Fa);if(i.instantiateWasm)try{return i.instantiateWasm(g,c)}catch(c){return z("Module.instantiateWasm callback failed with error: "+c),!1}(function(){if(A||"function"!==typeof C.instantiateStreaming||Ia(M,Ja)||Ia(M,"file://")||"function"!==typeof fetch)return e(d);fetch(M,{credentials:"same-origin"}).then(function(c){return C.instantiateStreaming(c,g).then(d,function(c){z("wasm streaming compile failed: "+c);z("falling back to ArrayBuffer instantiation");return e(d)})})})();return{}})();var Ob=i.___wasm_call_ctors=function(){return(Ob=i.___wasm_call_ctors=i.asm.z).apply(null,arguments)},Z=i._free=function(){return(Z=i._free=i.asm.A).apply(null,arguments)},Pb=i._malloc=function(){return(Pb=i._malloc=i.asm.B).apply(null,arguments)},Qb=i.___getTypeName=function(){return(Qb=i.___getTypeName=i.asm.C).apply(null,arguments)};i.___embind_register_native_and_builtin_types=function(){return(i.___embind_register_native_and_builtin_types=i.asm.D).apply(null,arguments)};var Rb=i.__growWasmMemory=function(){return(Rb=i.__growWasmMemory=i.asm.E).apply(null,arguments)},Sb;Ha=function c(){Sb||Tb(),Sb||(Ha=c)};function Tb(){function c(){if(!Sb&&(Sb=!0,i.calledRun=!0,!la)){Ma(Ba);Ma(Ca);k(i);i.onRuntimeInitialized&&i.onRuntimeInitialized();if(i.postRun)for("function"==typeof i.postRun&&(i.postRun=[i.postRun]);i.postRun.length;){var c=i.postRun.shift();Da.unshift(c)}Ma(Da)}}if(!(0<Fa)){if(i.preRun)for("function"==typeof i.preRun&&(i.preRun=[i.preRun]);i.preRun.length;)Ea();Ma(Aa);0<Fa||(i.setStatus?(i.setStatus("Running..."),setTimeout(function(){setTimeout(function(){i.setStatus("")},1),c()},1)):c())}}i.run=Tb;if(i.preInit)for("function"==typeof i.preInit&&(i.preInit=[i.preInit]);0<i.preInit.length;)i.preInit.pop()();Tb();return g.ready}}();typeof k==="object"&&typeof i==="object"?i.exports=l:typeof define==="function"&&define.amd?define([],function(){return l}):typeof k==="object"&&(k.DGWCppBridge=l)}),null);
__d("DGWUtils",["regeneratorRuntime","DGWCppBridge","DGWLoggingContext","Random","URI"],(function(a,b,c,d,e,f){"use strict";f.uuidv4=a;var g;function a(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var c=b("Random").random()*16|0;a=a=="x"?c:c&3|8;return a.toString(16)})}var h=null;c=function(){function a(){}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!(h!=null)){a.next=2;break}return a.abrupt("return");case 2:a.next=4;return b("regeneratorRuntime").awrap(b("DGWCppBridge")());case 4:h=a.sent;case 5:case"end":return a.stop()}},null,this)};a.constructConnectUrl=function(a){var c,d=a.appId,e=a.appVersion,f=a.authType,i=a.dgwVersion,j=a.fbId,k=a.tier,l=a.loggingId,m=a.headers,n=a.endpoint;a=a.serviceId;var o=(c={},c[h.HEADER_APPID]=d,c[h.HEADER_APPVERSION]=e,c[h.HEADER_AUTHTYPE]=f,c[h.HEADER_DGW_VERSION]=i,c[h.HEADER_UUID]=j,c[h.HEADER_TARGET_TIER]=k,c);l!==void 0&&(o[h.HEADER_LOGGING_ID]=l);Object.keys(m).forEach(function(a){var b=h.APPHEADER_PREFIX+a;Object.prototype.hasOwnProperty.call(o,b)||(o[b]=m[a])});d=new(g||(g=b("URI")))(n);d.setQueryData(o);d.setPath(d.getPath()+"/"+a);return d.toString()};return a}();f.DGWUtils=c;d=function(){function a(a,b){this.$1=null,this.$2=a,this.$3=b}a.initialize=function(){return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!(h!=null)){a.next=2;break}return a.abrupt("return");case 2:a.next=4;return b("regeneratorRuntime").awrap(b("DGWCppBridge")());case 4:h=a.sent;case 5:case"end":return a.stop()}},null,this)};a.getDrainReasons=function(){return{DrainReason_ELB:h.DrainReason.DrainReason_ELB,DrainReason_SLB:h.DrainReason.DrainReason_ELB,DrainReason_AppServerPush:h.DrainReason.DrainReason_ELB,DrainReason_GracePeriodExpired:h.DrainReason.DrainReason_ELB,DrainReason_Unknown:h.DrainReason.DrainReason_ELB}};var c=a.prototype;c.append=function(a){if(this.$1==null){this.$1=a;return}var b=this.$1.length,c=new Uint8Array(b+a.length);c.set(this.$1,0);c.set(a,b);this.$1=c};c.processData=function(){var a=h.decodeDGWFrame(this.$1);if(this.$1==null)return;var c=this.$1.length-a.getBufRemainderSize();this.$1&&this.$1.length>c?this.$1=new Uint8Array(this.$1.slice(c)):this.$1=null;if(a.getRc()!==h.DgwCodecReturnCode.DgwCodecReturnCode_Success){(c=this.$2)==null?void 0:c.logError(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Codec Decode Failure","Failed to decode Frame(s). Received error code "+a.getRc().constructor.name);return}if(a.getCountFrames()>0){for(var c=0;c<a.getDataFrames().size();c++){var d,e;(d=this.$2)==null?void 0:d.logEvent(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Data Frame from server");d=a.getDataFrames().get(c);(e=this.$3)==null?void 0:e.onDataReceived(Uint8Array.from(d.getData()),d.getRequiresAck()?d.getAckId():null)}for(var e=0;e<a.getAckFrames().size();e++){(d=this.$2)==null?void 0:d.logEvent(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received ACK Frame from server");(c=this.$3)==null?void 0:c.handleAckReceived(a.getAckFrames().get(e).getAckId())}for(var d=0;d<a.getDrainFrames().size();d++){c=a.getDrainFrames().get(d).getDrainReason().constructor.name;(e=this.$2)==null?void 0:e.logEvent(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Received Drain Frame from server","DrainReason: "+c);(e=this.$3)==null?void 0:e.receivedDrainSignal(c)}}};c.encodeData=function(a,c,d){c=h.encodeDGWDataFrame(c,d,a);if(c.getRc()!==h.DgwCodecReturnCode.DgwCodecReturnCode_Success){(d=this.$2)==null?void 0:d.logError(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Data Frame encode failure","Failed to decode DGW Data Frame. Received error code "+c.getRc().constructor.name);return null}return c.getRawFrame()};c.encodeAck=function(a){a=h.encodeDGWAckFrame(a);if(a.getRc()!==h.DgwCodecReturnCode.DgwCodecReturnCode_Success){var c;(c=this.$2)==null?void 0:c.logError(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"ACK Frame encode failure","Failed to encode ACK Frame. Received error code "+a.getRc().constructor.name);return null}return a.getRawFrame()};c.encodeDrain=function(a){a=h.encodeDGWDrainFrame(a);if(a.getRc()!==h.DgwCodecReturnCode.DgwCodecReturnCode_Success){var c;(c=this.$2)==null?void 0:c.logError(b("DGWLoggingContext").DGWLoggingComponent.CODEC_COMPONENT,"Drain Frame encode failure","Failed to encode Drain Frame. Received error code "+a.getRc().constructor.name);return null}return a.getRawFrame()};return a}();f.DGWCodec=d}),null);
__d("DGWWebSocketTransport",[],(function(a,b,c,d,e,f){"use strict";f.getWebSocketConnection=a;function a(a){a=new WebSocket(a);a.binaryType="arraybuffer";return a}}),null);
__d("DGWStream",["regeneratorRuntime","Promise","DGWAckManager","DGWExponentialBackoff","DGWLoggingContext","DGWStreamEvents","DGWUtils","DGWWebSocketTransport","err","$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=3e4,h="prod",i=128,j="DGW closing websocket connection",k=b("$InternalEnum")({NORMAL_CLOSURE:1e3,GOING_AWAY:1001,ABNORMAL_CLOSURE:1006,SERVER_INTERNAL_ERROR:1011,DGW_NORMAL_CLOSURE:4e3}),l=b("$InternalEnum").Mirrored(["ABNORMAL_CLOSURE","SERVER_INTERNAL_ERROR","UNKNOWN_ERROR"]);f.StreamError=l;a=function(){function a(a){var c=this,d=a.loggingContext,e=a.serviceId,f=a.streamCallbacks,g=a.streamEvents,h=a.streamOptions;a=a.ws;this.$4=!1;this.$2=!0;this.$5=d;this.$1=new(b("DGWAckManager").DGWAckManager)(this.$5);this.$6=1;this.$7=e;this.$8=g;this.$9=f;this.$10=h;this.$3=new(b("DGWUtils").DGWCodec)(this.$5,{onDataReceived:function(a,b){c.$9.onDataReceived(a),b!=null&&c.$12(b)},handleAckReceived:function(a){c.$1.handleAckReceived(a)},receivedDrainSignal:function(a){c.$4===!1&&(c.$9.onStreamMustDrain(c,a),c.$4=!0)}});this.$11=a}a.getDGWStream=function(c){var d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;return b("regeneratorRuntime").async(function(x){while(1)switch(x.prev=x.next){case 0:g=c.appId,i=c.appVersion,j=c.authType,k=c.dgwVersion,l=c.endpoint,m=c.fbId,n=c.headers,o=c.serviceId,p=c.streamCallbacks,q=c.streamOptions;x.next=3;return b("regeneratorRuntime").awrap(b("DGWUtils").DGWCodec.initialize());case 3:x.next=5;return b("regeneratorRuntime").awrap(b("DGWUtils").DGWUtils.initialize());case 5:r=(d=q.overrideUrl)!=null?d:l;s=(e=q.loggingId)!=null?e:b("DGWUtils").uuidv4();t=b("DGWUtils").DGWUtils.constructConnectUrl({appId:g,appVersion:i,authType:j,dgwVersion:k,fbId:m,headers:n,loggingId:s,tier:(f=q.serviceTier)!=null?f:h,serviceId:o,endpoint:r});u=new(b("DGWLoggingContext").DGWLoggingContext)(k,s,o,m);v=new(b("DGWStreamEvents").DGWStreamEvents)(u);w=function(){return a.$13({connectUrl:t,loggingContext:u,serviceId:o,streamCallbacks:p,streamEvents:v,streamOptions:q})};x.prev=11;x.next=14;return b("regeneratorRuntime").awrap(b("DGWExponentialBackoff").callWithExponentialBackoff(w));case 14:return x.abrupt("return",x.sent);case 17:x.prev=17;x.t0=x["catch"](11);v.streamEstablishmentFailure(x.t0,"Could not establish stream with exponential backoff");throw x.t0;case 21:case"end":return x.stop()}},null,this,[[11,17]])};a.$13=function(c){var d=c.connectUrl,e=c.loggingContext,f=c.serviceId,g=c.streamEvents,h=c.streamCallbacks;c=c.streamOptions;d=b("DGWWebSocketTransport").getWebSocketConnection(d);var i=new a({loggingContext:e,serviceId:f,streamCallbacks:h,streamEvents:g,streamOptions:c,ws:d});i.$8.streamEstablishmentPending();i.$11.onmessage=a.$14(i);i.$11.onclose=a.$15(i);i.$11.onerror=function(){i.$2=!0};i.$11.onopen=function(){i.$8.streamEstablished(),i.$2=!1};return a.getStreamPromise(i)};a.getStreamPromise=function(a){return new(b("Promise"))(function(c,d){var e=a.$11.onerror;a.$11.onerror=function(){e(),d(b("err")("Stream could not be initialized"))};var f=a.$11.onopen;a.$11.onopen=function(){f(),c(a)}})};a.$15=function(a){return function(b){if(a.$2===!0){a.$8.connectionEstablishmentFailure(b.code);return}a.$2=!0;if(b.code!==k.DGW_NORMAL_CLOSURE&&b.code!==k.NORMAL_CLOSURE){a.$8.streamClosed(!1,"Websocket connection failure with code "+b.code);switch(b.code){case k.ABNORMAL_CLOSURE:a.$9.onError(l.ABNORMAL_CLOSURE);break;case k.SERVER_INTERNAL_ERROR:a.$9.onError(l.SERVER_INTERNAL_ERROR);break;default:a.$9.onError(l.UNKNOWN_ERROR);break}}else a.$8.streamClosed(!0,""),a.$9.onClose(a);a.$1.clearPendingAcks()}};a.$14=function(a){return function(b){if(!(b.data instanceof ArrayBuffer)){a.$8.error("Incorrect Data Protocol","Received "+typeof b.data+" instead of ArrayBuffer");return}a.$3.append(new Uint8Array(b.data));a.$3.processData()}};var c=a.prototype;c.send=function(a,c){var d,e,f;return b("regeneratorRuntime").async(function(h){while(1)switch(h.prev=h.next){case 0:c===void 0&&(c=g);d=this.$6++%i;e=this.$16(a,!0,d);if(!(e===!1)){h.next=5;break}return h.abrupt("return",!1);case 5:h.next=7;return b("regeneratorRuntime").awrap(this.$1.waitForAck(d,c));case 7:f=h.sent;return h.abrupt("return",f);case 9:case"end":return h.stop()}},null,this)};c.$12=function(a){var b=this.$17("Error sending ACK");if(b===!1)return!1;b=this.$3.encodeAck(a);if(b==null||this.$11==null)return!1;this.$8.ackSent(a);this.$11.send(b);return!0};c.sendAndForget=function(a){return this.$16(a,!1,0)};c.$16=function(a,b,c){b===void 0&&(b=!1);c===void 0&&(c=0);var d=this.$17("Error sending data");if(d===!1)return!1;d=this.$3.encodeData(a,b,c);if(d==null||this.$11==null)return!1;this.$11.send(d);this.$8.dataSent(c,d.length,b);return!0};c.close=function(){this.$5.logEvent(b("DGWLoggingContext").DGWLoggingComponent.STREAM_COMPONENT,"Client called close on stream"),this.$11.close(k.DGW_NORMAL_CLOSURE,j)};c.$17=function(a){if(this.$11==null){this.$8.error(a,"Error sending message when websocket was uninitialized");return!1}if(this.$11.readyState!==WebSocket.OPEN){this.$8.error(a,"Error sending message when stream state is "+this.$11.readyState);return!1}if(this.$2){this.$8.error(a,"Error sending message when stream was closed locally");return!1}return!0};return a}();f.DGWStream=a}),null);
__d("DGWStreamCallbacks",[],(function(a,b,c,d,e,f){"use strict"}),null);
__d("DGWAuth",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";f.fromStringToDGWAuth=a;f.fromDGWAuthToString=c;var g=b("$InternalEnum")({TEST:"0:0",FACEBOOK:"1:0"});f.DGWAuth=g;function a(a){if(a==="TEST")return g.TEST;else if(a==="FACEBOOK")return g.FACEBOOK;else{a=new Error("failed to convert string ("+a+") to DGWAuth Type");a.stack;throw a}}function c(a){if(a===g.FACEBOOK)return"FACEBOOK";else return"TEST"}}),null);
__d("RawDGWClient",["DGWStream"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var b=a.appId,c=a.appVersion,d=a.authType,e=a.dgwVersion,f=a.endpoint;a=a.fbId;this.$1=b;this.$2=c;this.$3=d;this.$4=e;this.$5=f;this.$6=a}var c=a.prototype;c.establishDGWStream=function(a,c,d,e){return b("DGWStream").DGWStream.getDGWStream({appId:this.$1,appVersion:this.$2,authType:this.$3,dgwVersion:this.$4,endpoint:this.$5,headers:a,fbId:this.$6,serviceId:c,streamCallbacks:d,streamOptions:e})};c.establishDGWStreamWithInitialData=function(a,b,c,d,e){a=this.establishDGWStream(a,c,d,e);c=a.then(function(a){return a.send(b)});return{sendPromise:c,streamPromise:a}};return a}();f.RawDGWClient=a}),null);
__d("FBDGWClient",["DGWAuth","DGWWebConfig","RawDGWClient"],(function(a,b,c,d,e,f){"use strict";e.exports=a;var g=new(b("RawDGWClient").RawDGWClient)({appId:(c=b("DGWWebConfig")).appId,appVersion:c.appVersion,authType:b("DGWAuth").DGWAuth.FACEBOOK,dgwVersion:c.dgwVersion,endpoint:c.endpoint,fbId:c.fbId});function a(){return g}}),null);
__d("RequestStreamCommonRequestStreamCommonTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";c=(a=b("$InternalEnum"))({Accepted:1,Started:2,Stopped:3});d=a({Rejected:40,Error:50,TryAgain:80,Closed:99});f=a({BestEffort:0,Socket:10,Device:20});b=a({Flow_status:"flow_status",Log:"log",Rewrite:"rewrite",Data:"data",Termination:"termination",Amend_ack:"amend_ack"});e.exports={AckLevel:f,FlowStatus:c,StreamResponseDelta$Types:b,TerminationReason:d}}),null);
__d("jsbi",[],(function(a,b,c,d,e,f){(function(a,b){"object"==typeof f&&"undefined"!=typeof e?e.exports=b():"function"==typeof define&&define.amd?define(b):a.JSBI=b()})(this,function(){"use strict";function a(b){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},a(b)}function b(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function c(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function d(a,b,d){return b&&c(a.prototype,b),d&&c(a,d),a}function e(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&g(a,b)}function f(a){return f=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},f(a)}function g(a,b){return g=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},g(a,b)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function i(){return i=h()?Reflect.construct:function(a,b,c){var d=[null];d.push.apply(d,b);b=Function.bind.apply(a,d);a=new b();return c&&g(a,c.prototype),a},i.apply(null,arguments)}function j(a){return-1!==Function.toString.call(a).indexOf("[native code]")}function k(a){var b="function"==typeof Map?new Map():void 0;return k=function(a){function c(){return i(a,arguments,f(this).constructor)}if(null===a||!j(a))return a;if("function"!=typeof a)throw new TypeError("Super expression must either be null or a function");if("undefined"!=typeof b){if(b.has(a))return b.get(a);b.set(a,c)}return c.prototype=Object.create(a.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),g(c,a)},k(a)}function l(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function m(a,b){return b&&("object"==typeof b||"function"==typeof b)?b:l(a)}var n=function(c){var h=Math.abs,i=Math.max,j=Math.imul,k=Math.clz32;function g(a,c){if(b(this,g),a>g.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return a=m(this,f(g).call(this,a)),a.sign=c,a}return e(g,c),d(g,[{key:"toDebugString",value:function(){var a=["BigInt["],b=!0,c=!1,d=void 0;try{for(var e,e,f=this[Symbol.iterator]();!(b=(e=f.next()).done);b=!0)e=e.value,a.push((e?(e>>>0).toString(16):e)+", ")}catch(a){c=!0,d=a}finally{try{b||null==f["return"]||f["return"]()}finally{if(c)throw d}}return a.push("]"),a.join("")}},{key:"toString",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:10;if(2>a||36<a)throw new RangeError("toString() radix argument must be between 2 and 36");return 0===this.length?"0":0==(a&a-1)?g.__toStringBasePowerOfTwo(this,a):g.__toStringGeneric(this,a,!1)}},{key:"__copy",value:function(){for(var a=new g(this.length,this.sign),b=0;b<this.length;b++)a[b]=this[b];return a}},{key:"__trim",value:function(){for(var a=this.length,b=this[a-1];0===b;)a--,b=this[a-1],this.pop();return 0===a&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var a=0;a<this.length;a++)this[a]=0}},{key:"__clzmsd",value:function(){return k(this[this.length-1])}},{key:"__inplaceMultiplyAdd",value:function(a,b,c){c>this.length&&(c=this.length);for(var d=65535&a,a=a>>>16,e=0,f=65535&b,b=b>>>16,i=0;i<c;i++){var n=this.__digit(i),m=65535&n;n=n>>>16;var o=j(m,d);m=j(m,a);var p=j(n,d);n=j(n,a);var q=f+(65535&o);o=b+e+(q>>>16)+(o>>>16)+(65535&m)+(65535&p);f=(m>>>16)+(p>>>16)+(65535&n)+(o>>>16),e=f>>>16,f&=65535,b=n>>>16;this.__setDigit(i,65535&q|o<<16)}if(0!==e||0!==f||0!==b)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(a,b,c){for(var d,e=0,f=0;f<c;f++)d=this.__halfDigit(b+f)+a.__halfDigit(f)+e,e=d>>>16,this.__setHalfDigit(b+f,d);return e}},{key:"__inplaceSub",value:function(a,b,c){var d=0;if(1&b){b>>=1;for(var e=this.__digit(b),f=65535&e,k=0;k<c-1>>>1;k++){var l=a.__digit(k),m=(e>>>16)-(65535&l)-d;d=1&m>>>16,this.__setDigit(b+k,m<<16|65535&f),e=this.__digit(b+k+1),f=(65535&e)-(l>>>16)-d,d=1&f>>>16}m=a.__digit(k);l=(e>>>16)-(65535&m)-d;d=1&l>>>16,this.__setDigit(b+k,l<<16|65535&f);if(b+k+1>=this.length)throw new RangeError("out of bounds");0==(1&c)&&(e=this.__digit(b+k+1),f=(65535&e)-(m>>>16)-d,d=1&f>>>16,this.__setDigit(b+a.length,4294901760&e|65535&f))}else{b>>=1;for(var l=0;l<a.length-1;l++){k=this.__digit(b+l);m=a.__digit(l);e=(65535&k)-(65535&m)-d;d=1&e>>>16;f=(k>>>16)-(m>>>16)-d;d=1&f>>>16,this.__setDigit(b+l,f<<16|65535&e)}k=this.__digit(b+l);m=a.__digit(l);f=(65535&k)-(65535&m)-d;d=1&f>>>16;e=0;0==(1&c)&&(e=(k>>>16)-(m>>>16)-d,d=1&e>>>16),this.__setDigit(b+l,e<<16|65535&f)}return d}},{key:"__inplaceRightShift",value:function(a){if(0!==a){for(var b,c=this.__digit(0)>>>a,d=this.length-1,e=0;e<d;e++)b=this.__digit(e+1),this.__setDigit(e,b<<32-a|c),c=b>>>a;this.__setDigit(d,c)}}},{key:"__digit",value:function(a){return this[a]}},{key:"__unsignedDigit",value:function(a){return this[a]>>>0}},{key:"__setDigit",value:function(a,b){this[a]=0|b}},{key:"__setDigitGrow",value:function(a,b){this[a]=0|b}},{key:"__halfDigitLength",value:function(){var a=this.length;return 65535>=this.__unsignedDigit(a-1)?2*a-1:2*a}},{key:"__halfDigit",value:function(a){return 65535&this[a>>>1]>>>((1&a)<<4)}},{key:"__setHalfDigit",value:function(a,b){var c=a>>>1,d=this.__digit(c);a=1&a?65535&d|b<<16:4294901760&d|65535&b;this.__setDigit(c,a)}}],[{key:"BigInt",value:function(b){var c=Math.floor,d=Number.isFinite;if("number"==typeof b){if(0===b)return g.__zero();if((0|b)===b)return 0>b?g.__oneDigit(-b,!0):g.__oneDigit(b,!1);if(!d(b)||c(b)!==b)throw new RangeError("The number "+b+" cannot be converted to BigInt because it is not an integer");return g.__fromDouble(b)}if("string"==typeof b){d=g.__fromString(b);if(null===d)throw new SyntaxError("Cannot convert "+b+" to a BigInt");return d}if("boolean"==typeof b)return!0===b?g.__oneDigit(1,!1):g.__zero();if("object"===a(b)){if(b.constructor===g)return b;c=g.__toPrimitive(b);return g.BigInt(c)}throw new TypeError("Cannot convert "+b+" to a BigInt")}},{key:"toNumber",value:function(a){var b=a.length;if(0===b)return 0;if(1===b){var c=a.__unsignedDigit(0);return a.sign?-c:c}c=a.__digit(b-1);var d=k(c),e=32*b-d;if(1024<e)return a.sign?-Infinity:1/0;e=e-1;c=c;b=b-1;d=d+1;var f=32===d?0:c<<d;f>>>=12;var h=d-12,i=12<=d?0:c<<20+d;d=20+d;0<h&&0<b&&(b--,c=a.__digit(b),f|=c>>>32-h,i=c<<h,d=h),0<d&&0<b&&(b--,c=a.__digit(b),i|=c>>>32-d,d-=32);h=g.__decideRounding(a,d,b,c);if((1===h||0===h&&1==(1&i))&&(i=i+1>>>0,0===i&&(f++,0!=f>>>20&&(f=0,e++,1023<e))))return a.sign?-Infinity:1/0;d=a.sign?-2147483648:0;return e=e+1023<<20,g.__kBitConversionInts[1]=d|e|f,g.__kBitConversionInts[0]=i,g.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(a){if(0===a.length)return a;var b=a.__copy();return b.sign=!a.sign,b}},{key:"bitwiseNot",value:function(a){return a.sign?g.__absoluteSubOne(a).__trim():g.__absoluteAddOne(a,!0)}},{key:"exponentiate",value:function(a,b){if(b.sign)throw new RangeError("Exponent must be positive");if(0===b.length)return g.__oneDigit(1,!1);if(0===a.length)return a;if(1===a.length&&1===a.__digit(0))return a.sign&&0==(1&b.__digit(0))?g.unaryMinus(a):a;if(1<b.length)throw new RangeError("BigInt too big");b=b.__unsignedDigit(0);if(1===b)return a;if(b>=g.__kMaxLengthBits)throw new RangeError("BigInt too big");if(1===a.length&&2===a.__digit(0)){var c=1+(b>>>5),d=a.sign&&0!=(1&b);d=new g(c,d);d.__initializeDigits();var e=1<<(31&b);return d.__setDigit(c-1,e),d}c=null;e=a;for(0!=(1&b)&&(c=a),b>>=1;0!==b;b>>=1)e=g.multiply(e,e),0!=(1&b)&&(null===c?c=e:c=g.multiply(c,e));return c}},{key:"multiply",value:function(a,b){if(0===a.length)return a;if(0===b.length)return b;var c=a.length+b.length;32<=a.__clzmsd()+b.__clzmsd()&&c--;c=new g(c,a.sign!==b.sign);c.__initializeDigits();for(var d=0;d<a.length;d++)g.__multiplyAccumulate(b,a.__digit(d),c,d);return c.__trim()}},{key:"divide",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return g.__zero();var c=a.sign!==b.sign,d=b.__unsignedDigit(0);if(1===b.length&&65535>=d){if(1===d)return c===a.sign?a:g.unaryMinus(a);d=g.__absoluteDivSmall(a,d,null)}else d=g.__absoluteDivLarge(a,b,!0,!1);return d.sign=c,d.__trim()}},{key:"remainder",value:function(a,b){if(0===b.length)throw new RangeError("Division by zero");if(0>g.__absoluteCompare(a,b))return a;var c=b.__unsignedDigit(0);if(1===b.length&&65535>=c){if(1===c)return g.__zero();c=g.__absoluteModSmall(a,c);return 0===c?g.__zero():g.__oneDigit(c,a.sign)}c=g.__absoluteDivLarge(a,b,!1,!0);return c.sign=a.sign,c.__trim()}},{key:"add",value:function(a,b){var c=a.sign;return c===b.sign?g.__absoluteAdd(a,b,c):0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c)}},{key:"subtract",value:function(a,b){var c=a.sign;return c===b.sign?0<=g.__absoluteCompare(a,b)?g.__absoluteSub(a,b,c):g.__absoluteSub(b,a,!c):g.__absoluteAdd(a,b,c)}},{key:"leftShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__rightShiftByAbsolute(a,b):g.__leftShiftByAbsolute(a,b)}},{key:"signedRightShift",value:function(a,b){return 0===b.length||0===a.length?a:b.sign?g.__leftShiftByAbsolute(a,b):g.__rightShiftByAbsolute(a,b)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(a,b){return 0>g.__compareToBigInt(a,b)}},{key:"lessThanOrEqual",value:function(a,b){return 0>=g.__compareToBigInt(a,b)}},{key:"greaterThan",value:function(a,b){return 0<g.__compareToBigInt(a,b)}},{key:"greaterThanOrEqual",value:function(a,b){return 0<=g.__compareToBigInt(a,b)}},{key:"equal",value:function(a,b){if(a.sign!==b.sign)return!1;if(a.length!==b.length)return!1;for(var c=0;c<a.length;c++)if(a.__digit(c)!==b.__digit(c))return!1;return!0}},{key:"notEqual",value:function(a,b){return!g.equal(a,b)}},{key:"bitwiseAnd",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteAnd(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length)+1;c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return c=g.__absoluteOr(c,d,c),g.__absoluteAddOne(c,!0,c).__trim()}if(a.sign){d=[b,a];a=d[0],b=d[1]}return g.__absoluteAndNot(a,g.__absoluteSubOne(b)).__trim()}},{key:"bitwiseXor",value:function(a,b){if(!a.sign&&!b.sign)return g.__absoluteXor(a,b).__trim();if(a.sign&&b.sign){var c=i(a.length,b.length);c=g.__absoluteSubOne(a,c);var d=g.__absoluteSubOne(b);return g.__absoluteXor(c,d,c).__trim()}d=i(a.length,b.length)+1;if(a.sign){c=[b,a];a=c[0],b=c[1]}c=g.__absoluteSubOne(b,d);return c=g.__absoluteXor(c,a,c),g.__absoluteAddOne(c,!0,c).__trim()}},{key:"bitwiseOr",value:function(a,b){var c=i(a.length,b.length);if(!a.sign&&!b.sign)return g.__absoluteOr(a,b).__trim();if(a.sign&&b.sign){var d=g.__absoluteSubOne(a,c),e=g.__absoluteSubOne(b);return d=g.__absoluteAnd(d,e,d),g.__absoluteAddOne(d,!0,d).__trim()}if(a.sign){e=[b,a];a=e[0],b=e[1]}d=g.__absoluteSubOne(b,c);return d=g.__absoluteAndNot(d,a,d),g.__absoluteAddOne(d,!0,d).__trim()}},{key:"asIntN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=b.__unsignedDigit(c-1),e=1<<(31&a-1);if(b.length===c&&d<e)return b;if(!((d&e)===e))return g.__truncateToNBits(a,b);if(!b.sign)return g.__truncateAndSubFromPowerOfTwo(a,b,!0);if(0==(d&e-1)){for(var f=c-2;0<=f;f--)if(0!==b.__digit(f))return g.__truncateAndSubFromPowerOfTwo(a,b,!1);return b.length===c&&d===e?b:g.__truncateToNBits(a,b)}return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}},{key:"asUintN",value:function(a,b){if(0===b.length)return b;if(0===a)return g.__zero();if(b.sign){if(a>g.__kMaxLengthBits)throw new RangeError("BigInt too big");return g.__truncateAndSubFromPowerOfTwo(a,b,!1)}if(a>=g.__kMaxLengthBits)return b;var c=a+31>>>5;if(b.length<c)return b;var d=31&a;if(b.length==c){if(0==d)return b;c=b.__digit(c-1);if(0==c>>>d)return b}return g.__truncateToNBits(a,b)}},{key:"ADD",value:function(a,b){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a)return"string"!=typeof b&&(b=b.toString()),a+b;if("string"==typeof b)return a.toString()+b;if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)&&g.__isBigInt(b))return g.add(a,b);if("number"==typeof a&&"number"==typeof b)return a+b;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(a,b){return g.__compare(a,b,0)}},{key:"LE",value:function(a,b){return g.__compare(a,b,1)}},{key:"GT",value:function(a,b){return g.__compare(a,b,2)}},{key:"GE",value:function(a,b){return g.__compare(a,b,3)}},{key:"EQ",value:function(b,c){for(;;){if(g.__isBigInt(b))return g.__isBigInt(c)?g.equal(b,c):g.EQ(c,b);if("number"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("string"==typeof b){if(g.__isBigInt(c))return b=g.__fromString(b),null!==b&&g.equal(b,c);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("boolean"==typeof b){if(g.__isBigInt(c))return g.__equalToNumber(c,+b);if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("symbol"===a(b)){if(g.__isBigInt(c))return!1;if("object"!==a(c))return b==c;c=g.__toPrimitive(c)}else if("object"===a(b)){if("object"===a(c)&&c.constructor!==g)return b==c;b=g.__toPrimitive(b)}else return b==c}}},{key:"NE",value:function(a,b){return!g.EQ(a,b)}},{key:"__zero",value:function(){return new g(0,!1)}},{key:"__oneDigit",value:function(a,b){b=new g(1,b);return b.__setDigit(0,a),b}},{key:"__decideRounding",value:function(a,b,c,d){if(0<b)return-1;if(0>b)b=-b-1;else{if(0===c)return-1;c--,d=a.__digit(c),b=31}b=1<<b;if(0==(d&b))return-1;if(b-=1,0!=(d&b))return 1;for(;0<c;)if(c--,0!==a.__digit(c))return 1;return 0}},{key:"__fromDouble",value:function(a){g.__kBitConversionDouble[0]=a;var b,c=2047&g.__kBitConversionInts[1]>>>20;c=c-1023;var d=(c>>>5)+1;a=new g(d,0>a);var e=1048575&g.__kBitConversionInts[1]|1048576,f=g.__kBitConversionInts[0],k=20;c=31&c;var n=0;if(c<k){var m=k-c;n=m+32,b=e>>>m,e=e<<32-m|f>>>m,f<<=32-m}else if(c===k)n=32,b=e,e=f;else{m=c-k;n=32-m,b=e<<m|f>>>32-m,e=f<<m}a.__setDigit(d-1,b);for(var c=d-2;0<=c;c--)0<n?(n-=32,b=e,e=f):b=0,a.__setDigit(c,b);return a.__trim()}},{key:"__isWhitespace",value:function(a){return!!(13>=a&&9<=a)||(159>=a?32==a:131071>=a?160==a||5760==a:196607>=a?(a&=131071,10>=a||40==a||41==a||47==a||95==a||4096==a):65279==a)}},{key:"__fromString",value:function(a){var b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,c=0,d=a.length,e=0;if(e===d)return g.__zero();for(var f=a.charCodeAt(e);g.__isWhitespace(f);){if(++e===d)return g.__zero();f=a.charCodeAt(e)}if(43===f){if(++e===d)return null;f=a.charCodeAt(e),c=1}else if(45===f){if(++e===d)return null;f=a.charCodeAt(e),c=-1}if(0===b){if(b=10,48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(b=16,++e===d)return null;f=a.charCodeAt(e)}else if(79===f||111===f){if(b=8,++e===d)return null;f=a.charCodeAt(e)}else if(66===f||98===f){if(b=2,++e===d)return null;f=a.charCodeAt(e)}}}else if(16===b&&48===f){if(++e===d)return g.__zero();if(f=a.charCodeAt(e),88===f||120===f){if(++e===d)return null;f=a.charCodeAt(e)}}for(;48===f;){if(++e===d)return g.__zero();f=a.charCodeAt(e)}var m=d-e,i=g.__kMaxBitsPerChar[b],j=g.__kBitsPerCharTableMultiplier-1;if(m>1073741824/i)return null;var k=i*m+j>>>g.__kBitsPerCharTableShift,l=new g(k+31>>>5,!1),n=10>b?b:10,o=10<b?b-10:0;if(0==(b&b-1)){i>>=g.__kBitsPerCharTableShift;var p=[],q=[],r=!1;do{for(var s,t=0,u=0;;){if(void 0,f-48>>>0<n)s=f-48;else if((32|f)-97>>>0<o)s=(32|f)-87;else{r=!0;break}if(u+=i,t=t<<i|s,++e===d){r=!0;break}if(f=a.charCodeAt(e),32<u+i)break}p.push(t),q.push(u)}while(!r);g.__fillFromParts(l,p,q)}else{l.__initializeDigits();var v=!1,w=0;do{for(var x,y=0,z=1;;){if(void 0,f-48>>>0<n)x=f-48;else if((32|f)-97>>>0<o)x=(32|f)-87;else{v=!0;break}var A=z*b;if(4294967295<A)break;if(z=A,y=y*b+x,w++,++e===d){v=!0;break}f=a.charCodeAt(e)}j=32*g.__kBitsPerCharTableMultiplier-1;var B=i*w+j>>>g.__kBitsPerCharTableShift+5;l.__inplaceMultiplyAdd(z,y,B)}while(!v)}if(e!==d){if(!g.__isWhitespace(f))return null;for(e++;e<d;e++)if(f=a.charCodeAt(e),!g.__isWhitespace(f))return null}return 0!==c&&10!==b?null:(l.sign=-1===c,l.__trim())}},{key:"__fillFromParts",value:function(a,b,c){for(var d=0,e=0,f=0,k=b.length-1;0<=k;k--){var l=b[k],m=c[k];e|=l<<f,f+=m,32===f?(a.__setDigit(d++,e),f=0,e=0):32<f&&(a.__setDigit(d++,e),f-=32,e=l>>>m-f)}if(0!==e){if(d>=a.length)throw new Error("implementation bug");a.__setDigit(d++,e)}for(;d<a.length;d++)a.__setDigit(d,0)}},{key:"__toStringBasePowerOfTwo",value:function(a,b){var c=a.length,d=b-1;d=(85&d>>>1)+(85&d),d=(51&d>>>2)+(51&d),d=(15&d>>>4)+(15&d);d=d;b=b-1;var e=a.__digit(c-1),f=k(e);f=0|(32*c-f+d-1)/d;if(a.sign&&f++,268435456<f)throw new Error("string too long");for(var h=Array(f),f=f-1,l=0,n=0,o=0;o<c-1;o++){var p=a.__digit(o),q=(l|p<<n)&b;h[f--]=g.__kConversionChars[q];q=d-n;for(l=p>>>q,n=32-q;n>=d;)h[f--]=g.__kConversionChars[l&b],l>>>=d,n-=d}p=(l|e<<n)&b;for(h[f--]=g.__kConversionChars[p],l=e>>>d-n;0!==l;)h[f--]=g.__kConversionChars[l&b],l>>>=d;if(a.sign&&(h[f--]="-"),-1!==f)throw new Error("implementation bug");return h.join("")}},{key:"__toStringGeneric",value:function(a,b,c){var d=a.length;if(0===d)return"";if(1===d){var e=a.__unsignedDigit(0).toString(b);return!1===c&&a.sign&&(e="-"+e),e}e=32*d-k(a.__digit(d-1));d=g.__kMaxBitsPerChar[b];d=d-1;e=e*g.__kBitsPerCharTableMultiplier;e+=d-1,e=0|e/d;var f;d=e+1>>1;e=g.exponentiate(g.__oneDigit(b,!1),g.__oneDigit(d,!1));var h=e.__unsignedDigit(0);if(1===e.length&&65535>=h){f=new g(a.length,!1),f.__initializeDigits();for(var i,j=0,l=2*a.length-1;0<=l;l--)i=j<<16|a.__halfDigit(l),f.__setHalfDigit(l,0|i/h),j=0|i%h;i=j.toString(b)}else{h=g.__absoluteDivLarge(a,e,!0,!0);f=h.quotient;l=h.remainder.__trim();i=g.__toStringGeneric(l,b,!0)}f.__trim();for(var j=g.__toStringGeneric(f,b,!0);i.length<d;)i="0"+i;return!1===c&&a.sign&&(j="-"+j),j+i}},{key:"__unequalSign",value:function(a){return a?-1:1}},{key:"__absoluteGreater",value:function(a){return a?-1:1}},{key:"__absoluteLess",value:function(a){return a?1:-1}},{key:"__compareToBigInt",value:function(a,b){var c=a.sign;if(c!==b.sign)return g.__unequalSign(c);a=g.__absoluteCompare(a,b);return 0<a?g.__absoluteGreater(c):0>a?g.__absoluteLess(c):0}},{key:"__compareToNumber",value:function(a,b){if(!0|b){var c=a.sign,d=0>b;if(c!==d)return g.__unequalSign(c);if(0===a.length){if(d)throw new Error("implementation bug");return 0===b?0:-1}if(1<a.length)return g.__absoluteGreater(c);d=h(b);var e=a.__unsignedDigit(0);return e>d?g.__absoluteGreater(c):e<d?g.__absoluteLess(c):0}return g.__compareToDouble(a,b)}},{key:"__compareToDouble",value:function(a,b){if(b!==b)return b;if(b===1/0)return-1;if(b===-Infinity)return 1;var c=a.sign;if(c!==0>b)return g.__unequalSign(c);if(0===b)throw new Error("implementation bug: should be handled elsewhere");if(0===a.length)return-1;g.__kBitConversionDouble[0]=b;b=2047&g.__kBitConversionInts[1]>>>20;if(2047==b)throw new Error("implementation bug: handled elsewhere");b=b-1023;if(0>b)return g.__absoluteGreater(c);var d=a.length,e=a.__digit(d-1),f=k(e),l=32*d-f;b=b+1;if(l<b)return g.__absoluteLess(c);if(l>b)return g.__absoluteGreater(c);b=1048576|1048575&g.__kBitConversionInts[1];var m=g.__kBitConversionInts[0],o=20;f=31-f;if(f!==(l-1)%31)throw new Error("implementation bug");var p;l=0;if(f<o){var q=o-f;l=q+32,p=b>>>q,b=b<<32-q|m>>>q,m<<=32-q}else if(f===o)l=32,p=b,b=m;else{q=f-o;l=32-q,p=b<<q|m>>>32-q,b=m<<q}if(e>>>=0,p>>>=0,e>p)return g.__absoluteGreater(c);if(e<p)return g.__absoluteLess(c);for(var f=d-2;0<=f;f--){0<l?(l-=32,p=b>>>0,b=m,m=0):p=0;o=a.__unsignedDigit(f);if(o>p)return g.__absoluteGreater(c);if(o<p)return g.__absoluteLess(c)}if(0!==b||0!==m){if(0===l)throw new Error("implementation bug");return g.__absoluteLess(c)}return 0}},{key:"__equalToNumber",value:function(a,b){return b|0===b?0===b?0===a.length:1===a.length&&a.sign===0>b&&a.__unsignedDigit(0)===h(b):0===g.__compareToDouble(a,b)}},{key:"__comparisonResultToBool",value:function(a,b){switch(b){case 0:return 0>a;case 1:return 0>=a;case 2:return 0<a;case 3:return 0<=a}throw new Error("unreachable")}},{key:"__compare",value:function(a,b,c){if(a=g.__toPrimitive(a),b=g.__toPrimitive(b),"string"==typeof a&&"string"==typeof b)switch(c){case 0:return a<b;case 1:return a<=b;case 2:return a>b;case 3:return a>=b}if(g.__isBigInt(a)&&"string"==typeof b)return b=g.__fromString(b),null!==b&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("string"==typeof a&&g.__isBigInt(b))return a=g.__fromString(a),null!==a&&g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if(a=g.__toNumeric(a),b=g.__toNumeric(b),g.__isBigInt(a)){if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToBigInt(a,b),c);if("number"!=typeof b)throw new Error("implementation bug");return g.__comparisonResultToBool(g.__compareToNumber(a,b),c)}if("number"!=typeof a)throw new Error("implementation bug");if(g.__isBigInt(b))return g.__comparisonResultToBool(g.__compareToNumber(b,a),2^c);if("number"!=typeof b)throw new Error("implementation bug");return 0===c?a<b:1===c?a<=b:2===c?a>b:3===c?a>=b:void 0}},{key:"__absoluteAdd",value:function(a,b,c){if(a.length<b.length)return g.__absoluteAdd(b,a,c);if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);var d=a.length;(0===a.__clzmsd()||b.length===a.length&&0===b.__clzmsd())&&d++;for(var d=new g(d,c),c=0,e=0;e<b.length;e++){var f=b.__digit(e),h=a.__digit(e),m=(65535&h)+(65535&f)+c;h=(h>>>16)+(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}for(;e<a.length;e++){f=a.__digit(e);m=(65535&f)+c;h=(f>>>16)+(m>>>16);c=h>>>16,d.__setDigit(e,65535&m|h<<16)}return e<d.length&&d.__setDigit(e,c),d.__trim()}},{key:"__absoluteSub",value:function(a,b,c){if(0===a.length)return a;if(0===b.length)return a.sign===c?a:g.unaryMinus(a);for(var c=new g(a.length,c),d=0,e=0;e<b.length;e++){var f=a.__digit(e),l=b.__digit(e),m=(65535&f)-(65535&l)-d;d=1&m>>>16;f=(f>>>16)-(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}for(;e<a.length;e++){l=a.__digit(e);m=(65535&l)-d;d=1&m>>>16;f=(l>>>16)-d;d=1&f>>>16,c.__setDigit(e,65535&m|f<<16)}return c.__trim()}},{key:"__absoluteAddOne",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length;null===c?c=new g(d,b):c.sign=b;for(var e=!0,f=0;f<d;f++){var k=a.__digit(f),l=-1===k;e&&(k=0|k+1),e=l,c.__setDigit(f,k)}return e&&c.__setDigitGrow(d,1),c}},{key:"__absoluteSubOne",value:function(a,b){var c=a.length;b=b||c;for(var d=new g(b,!1),e=!0,f=0;f<c;f++){var k=a.__digit(f),l=0===k;e&&(k=0|k-1),e=l,d.__setDigit(f,k)}for(var l=c;l<b;l++)d.__setDigit(l,0);return d}},{key:"__absoluteAnd",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,e,b=m,n}var k=f;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&b.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteAndNot",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;d<e&&(f=d);var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)&~b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteOr",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)|b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteXor",value:function(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,d=a.length,e=b.length,f=e;if(d<e){f=d;var m=a,n=d;a=b,d=e,b=m,n}var k=d;null===c?c=new g(k,!1):k=c.length;for(var l=0;l<f;l++)c.__setDigit(l,a.__digit(l)^b.__digit(l));for(;l<d;l++)c.__setDigit(l,a.__digit(l));for(;l<k;l++)c.__setDigit(l,0);return c}},{key:"__absoluteCompare",value:function(a,b){var c=a.length-b.length;if(0!=c)return c;for(var c=a.length-1;0<=c&&a.__digit(c)===b.__digit(c);)c--;return 0>c?0:a.__unsignedDigit(c)>b.__unsignedDigit(c)?1:-1}},{key:"__multiplyAccumulate",value:function(a,b,c,d){if(0!==b){for(var e=65535&b,b=b>>>16,f=0,g=0,k=0,l=0;l<a.length;l++,d++){var m=c.__digit(d),n=65535&m,o=m>>>16,p=a.__digit(l),q=65535&p;p=p>>>16;var r=j(q,e);q=j(q,b);var s=j(p,e);p=j(p,b);n+=g+(65535&r),o+=k+f+(n>>>16)+(r>>>16)+(65535&q)+(65535&s),f=o>>>16,g=(q>>>16)+(s>>>16)+(65535&p)+f,f=g>>>16,g&=65535,k=p>>>16,m=65535&n|o<<16,c.__setDigit(d,m)}for(;0!==f||0!==g||0!==k;d++){r=c.__digit(d);q=(65535&r)+g;s=(r>>>16)+(q>>>16)+k+f;g=0,k=0,f=s>>>16,r=65535&q|s<<16,c.__setDigit(d,r)}}}},{key:"__internalMultiplyAdd",value:function(a,b,c,d,e){for(var c=c,f=0,h=0;h<d;h++){var l=a.__digit(h),m=j(65535&l,b),n=(65535&m)+f+c;c=n>>>16;l=j(l>>>16,b);m=(65535&l)+(m>>>16)+c;c=m>>>16,f=l>>>16,e.__setDigit(h,m<<16|65535&n)}if(e.length>d)for(e.__setDigit(d++,c+f);d<e.length;)e.__setDigit(d++,0);else if(0!==c+f)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(a,b,c){null===c&&(c=new g(a.length,!1));for(var d=0,e=2*a.length-1;0<=e;e-=2){var f=(d<<16|a.__halfDigit(e))>>>0,k=0|f/b;d=0|f%b,f=(d<<16|a.__halfDigit(e-1))>>>0;var l=0|f/b;d=0|f%b,c.__setDigit(e>>>1,k<<16|l)}return c}},{key:"__absoluteModSmall",value:function(a,b){for(var c,d=0,e=2*a.length-1;0<=e;e--)c=(d<<16|a.__halfDigit(e))>>>0,d=0|c%b;return d}},{key:"__absoluteDivLarge",value:function(a,b,c,d){var f=b.__halfDigitLength(),e=b.length,n=a.__halfDigitLength()-f,i=null;c&&(i=new g(n+2>>>1,!1),i.__initializeDigits());var l=new g(f+2>>>1,!1);l.__initializeDigits();var m=g.__clz16(b.__halfDigit(f-1));0<m&&(b=g.__specialLeftShift(b,m,0));for(var a=g.__specialLeftShift(a,m,1),k=b.__halfDigit(f-1),o=0,n=n;0<=n;n--){var p=65535,q=a.__halfDigit(n+f);if(q!==k){q=(q<<16|a.__halfDigit(n+f-1))>>>0;p=0|q/k;for(var q=0|q%k,r=b.__halfDigit(f-2),s=a.__halfDigit(n+f-2);j(p,r)>>>0>(q<<16|s)>>>0&&(p--,q+=k,!(65535<q)););}g.__internalMultiplyAdd(b,p,0,e,l);r=a.__inplaceSub(l,n,f+1);0!==r&&(r=a.__inplaceAdd(b,n,f),a.__setHalfDigit(n+f,a.__halfDigit(n+f)+r),p--),c&&(1&n?o=p<<16:i.__setDigit(n>>>1,o|p))}return d?(a.__inplaceRightShift(m),c?{quotient:i,remainder:a}:a):c?i:void 0}},{key:"__clz16",value:function(a){return k(a)-16}},{key:"__specialLeftShift",value:function(a,b,c){var e=a.length,d=new g(e+c,!1);if(0===b){for(var f=0;f<e;f++)d.__setDigit(f,a.__digit(f));return 0<c&&d.__setDigit(e,0),d}for(var j,f=0,l=0;l<e;l++)j=a.__digit(l),d.__setDigit(l,j<<b|f),f=j>>>32-b;return 0<c&&d.__setDigit(e,f),d}},{key:"__leftShiftByAbsolute",value:function(a,b){b=g.__toShiftAmount(b);if(0>b)throw new RangeError("BigInt too big");var c=b>>>5;b=31&b;var d=a.length,e=0!==b&&0!=a.__digit(d-1)>>>32-b,f=d+c+(e?1:0),m=new g(f,a.sign);if(0===b){for(var n=0;n<c;n++)m.__setDigit(n,0);for(;n<f;n++)m.__setDigit(n,a.__digit(n-c))}else{for(var n=0,f=0;f<c;f++)m.__setDigit(f,0);for(var o,f=0;f<d;f++)o=a.__digit(f),m.__setDigit(f+c,o<<b|n),n=o>>>32-b;if(e)m.__setDigit(d+c,n);else if(0!==n)throw new Error("implementation bug")}return m.__trim()}},{key:"__rightShiftByAbsolute",value:function(a,b){var c=a.length,d=a.sign;b=g.__toShiftAmount(b);if(0>b)return g.__rightShiftByMaximum(d);var e=b>>>5;b=31&b;var f=c-e;if(0>=f)return g.__rightShiftByMaximum(d);var i=!1;if(d)if(0!=(a.__digit(e)&(1<<b)-1))i=!0;else for(var m=0;m<e;m++)if(0!==a.__digit(m)){i=!0;break}if(i&&0===b){m=a.__digit(c-1);0==~m&&f++}m=new g(f,d);if(0===b)for(var f=e;f<c;f++)m.__setDigit(f-e,a.__digit(f));else{for(var n,d=a.__digit(e)>>>b,f=c-e-1,c=0;c<f;c++)n=a.__digit(c+e+1),m.__setDigit(c,n<<32-b|d),d=n>>>b;m.__setDigit(f,d)}return i&&(m=g.__absoluteAddOne(m,!0,m)),m.__trim()}},{key:"__rightShiftByMaximum",value:function(a){return a?g.__oneDigit(1,!0):g.__zero()}},{key:"__toShiftAmount",value:function(a){if(1<a.length)return-1;a=a.__unsignedDigit(0);return a>g.__kMaxLengthBits?-1:a}},{key:"__toPrimitive",value:function(b){var c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default";if("object"!==a(b))return b;if(b.constructor===g)return b;var d=b[Symbol.toPrimitive];if(d){var e=d(c);if("object"!==a(e))return e;throw new TypeError("Cannot convert object to primitive value")}var f=b.valueOf;if(f){var k=f.call(b);if("object"!==a(k))return k}var l=b.toString;if(l){var m=l.call(b);if("object"!==a(m))return m}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(a){return g.__isBigInt(a)?a:+a}},{key:"__isBigInt",value:function(b){return"object"===a(b)&&b.constructor===g}},{key:"__truncateToNBits",value:function(a,b){for(var c=a+31>>>5,d=new g(c,b.sign),c=c-1,e=0;e<c;e++)d.__setDigit(e,b.__digit(e));e=b.__digit(c);if(0!=(31&a)){b=32-(31&a);e=e<<b>>>b}return d.__setDigit(c,e),d.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(a,b,c){for(var d=Math.min,e=a+31>>>5,c=new g(e,c),f=0,e=e-1,h=0,d=d(e,b.length);f<d;f++){var j=b.__digit(f),l=0-(65535&j)-h;h=1&l>>>16;j=0-(j>>>16)-h;h=1&j>>>16,c.__setDigit(f,65535&l|j<<16)}for(;f<e;f++)c.__setDigit(f,0|-h);l=e<b.length?b.__digit(e):0;j=31&a;if(0===j){d=0-(65535&l)-h;h=1&d>>>16;f=0-(l>>>16)-h;b=65535&d|f<<16}else{a=32-j;l=l<<a>>>a;d=1<<32-a;f=(65535&d)-(65535&l)-h;h=1&f>>>16;j=(d>>>16)-(l>>>16)-h;b=65535&f|j<<16,b&=d-1}return c.__setDigit(e,b),c.__trim()}},{key:"__digitPow",value:function(a,b){for(var c=1;0<b;)1&b&&(c*=a),b>>>=1,a*=a;return c}}]),g}(k(Array));return n.__kMaxLength=33554432,n.__kMaxLengthBits=n.__kMaxLength<<5,n.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],n.__kBitsPerCharTableShift=5,n.__kBitsPerCharTableMultiplier=1<<n.__kBitsPerCharTableShift,n.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],n.__kBitConversionBuffer=new ArrayBuffer(8),n.__kBitConversionDouble=new Float64Array(n.__kBitConversionBuffer),n.__kBitConversionInts=new Int32Array(n.__kBitConversionBuffer),n})}),null);
__d("RequestStreamCommonRequestStreamCommonSerializers",["RequestStreamCommonRequestStreamCommonTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f){"use strict";a=function(){return{}};c=function(){return{bytes:Uint8Array.of()}};d=function(){return{message:""}};f=function(){return{reason:b("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0)}};var g=function(){return{}},h=function(){return{stream_id:"0",last_sequencer:0,amendment_count:0,last_status:b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0)}},i=function(){return{caller_timestamp_ms:"0"}},j=function(){return{original_ping_timestamp_ms:"0"}},k=function(){return{}},l=function(a,c){c.writeStructBegin("ResponseRewriteRequest"),a.new_headers!=null&&(c.writeFieldBegin({fname:"new_headers",ftype:b("ThriftTypes").STRING,fid:1}),c.writeString(a.new_headers)),a.new_body!=null&&(c.writeFieldBegin({fname:"new_body",ftype:b("ThriftTypes").STRING,fid:2}),c.writeBinary(a.new_body)),a.patch_headers!=null&&(c.writeFieldBegin({fname:"patch_headers",ftype:b("ThriftTypes").STRING,fid:3}),c.writeString(a.patch_headers)),a.kill_body!=null&&(c.writeFieldBegin({fname:"kill_body",ftype:b("ThriftTypes").BOOL,fid:4}),c.writeBool(a.kill_body)),a.temporary!=null&&(c.writeFieldBegin({fname:"temporary",ftype:b("ThriftTypes").BOOL,fid:5}),c.writeBool(a.temporary)),c.writeFieldStop(),c.writeStructEnd()},m=function(a,c){c.writeStructBegin("ResponseData");c.writeFieldBegin({fname:"bytes",ftype:b("ThriftTypes").STRING,fid:1});if(a.bytes!=null)c.writeBinary(a.bytes);else{var d=Uint8Array.of();c.writeBinary(d)}a.metadata!=null&&(c.writeFieldBegin({fname:"metadata",ftype:b("ThriftTypes").STRING,fid:2}),c.writeString(a.metadata));c.writeFieldStop();c.writeStructEnd()},n=function(a,c){c.writeStructBegin("LogMessage");c.writeFieldBegin({fname:"message",ftype:b("ThriftTypes").STRING,fid:1});if(a.message!=null)c.writeString(a.message);else{a="";c.writeString(a)}c.writeFieldStop();c.writeStructEnd()},o=function(a,c){c.writeStructBegin("Termination");c.writeFieldBegin({fname:"reason",ftype:b("ThriftTypes").I32,fid:1});if(a.reason!=null){var d;c.writeI32((d=a.reason)!=null?d:0)}else{d=b("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0);c.writeI32((d=d)!=null?d:0)}a.message!=null&&(c.writeFieldBegin({fname:"message",ftype:b("ThriftTypes").STRING,fid:2}),c.writeString(a.message));a.retry_delay_ms!=null&&(c.writeFieldBegin({fname:"retry_delay_ms",ftype:b("ThriftTypes").I64,fid:3}),c.writeI64(b("jsbi").BigInt(a.retry_delay_ms)));c.writeFieldStop();c.writeStructEnd()},p=function(a,c){c.writeStructBegin("AmendStreamAck"),a.amendment_id!=null&&(c.writeFieldBegin({fname:"amendment_id",ftype:b("ThriftTypes").I64,fid:1}),c.writeI64(b("jsbi").BigInt(a.amendment_id))),a.accepted!=null&&(c.writeFieldBegin({fname:"accepted",ftype:b("ThriftTypes").BOOL,fid:2}),c.writeBool(a.accepted)),a.result!=null&&(c.writeFieldBegin({fname:"result",ftype:b("ThriftTypes").STRING,fid:3}),c.writeBinary(a.result)),c.writeFieldStop(),c.writeStructEnd()},q=function(a,c){c.writeStructBegin("StreamCheck");c.writeFieldBegin({fname:"stream_id",ftype:b("ThriftTypes").I64,fid:1});if(a.stream_id!=null)c.writeI64(b("jsbi").BigInt(a.stream_id));else{var d="0";c.writeI64(b("jsbi").BigInt(d))}c.writeFieldBegin({fname:"last_sequencer",ftype:b("ThriftTypes").I32,fid:2});if(a.last_sequencer!=null)c.writeI32(a.last_sequencer);else{d=0;c.writeI32(d)}c.writeFieldBegin({fname:"amendment_count",ftype:b("ThriftTypes").I32,fid:4});if(a.amendment_count!=null)c.writeI32(a.amendment_count);else{d=0;c.writeI32(d)}c.writeFieldBegin({fname:"last_status",ftype:b("ThriftTypes").I32,fid:3});if(a.last_status!=null){c.writeI32((d=a.last_status)!=null?d:0)}else{a=b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0);c.writeI32((d=a)!=null?d:0)}c.writeFieldStop();c.writeStructEnd()},r=function(a,c){c.writeStructBegin("Ping");c.writeFieldBegin({fname:"caller_timestamp_ms",ftype:b("ThriftTypes").I64,fid:1});if(a.caller_timestamp_ms!=null)c.writeI64(b("jsbi").BigInt(a.caller_timestamp_ms));else{var d="0";c.writeI64(b("jsbi").BigInt(d))}if(a.streams_to_check!=null){c.writeFieldBegin({fname:"streams_to_check",ftype:b("ThriftTypes").LIST,fid:2});c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.streams_to_check.length});for(var d=a.streams_to_check,a=Array.isArray(d),e=0,d=a?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(a){if(e>=d.length)break;f=d[e++]}else{e=d.next();if(e.done)break;f=e.value}f=f;q(f,c)}}c.writeFieldStop();c.writeStructEnd()},s=function(a,c){c.writeStructBegin("Pong");c.writeFieldBegin({fname:"original_ping_timestamp_ms",ftype:b("ThriftTypes").I64,fid:1});if(a.original_ping_timestamp_ms!=null)c.writeI64(b("jsbi").BigInt(a.original_ping_timestamp_ms));else{var d="0";c.writeI64(b("jsbi").BigInt(d))}if(a.stream_ids_missing!=null){c.writeFieldBegin({fname:"stream_ids_missing",ftype:b("ThriftTypes").LIST,fid:2});c.writeListBegin({etype:b("ThriftTypes").I64,size:a.stream_ids_missing.length});for(var d=a.stream_ids_missing,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeI64(b("jsbi").BigInt(g))}}if(a.stream_ids_behind!=null){c.writeFieldBegin({fname:"stream_ids_behind",ftype:b("ThriftTypes").LIST,fid:3});c.writeListBegin({etype:b("ThriftTypes").I64,size:a.stream_ids_behind.length});for(var g=a.stream_ids_behind,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}d=d;c.writeI64(b("jsbi").BigInt(d))}}if(a.stream_ids_with_lost_amendments!=null){c.writeFieldBegin({fname:"stream_ids_with_lost_amendments",ftype:b("ThriftTypes").LIST,fid:4});c.writeListBegin({etype:b("ThriftTypes").I64,size:a.stream_ids_with_lost_amendments.length});for(var d=a.stream_ids_with_lost_amendments,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;c.writeI64(b("jsbi").BigInt(g))}}if(a.stream_ids_with_wrong_status!=null){c.writeFieldBegin({fname:"stream_ids_with_wrong_status",ftype:b("ThriftTypes").LIST,fid:5});c.writeListBegin({etype:b("ThriftTypes").I64,size:a.stream_ids_with_wrong_status.length});for(var g=a.stream_ids_with_wrong_status,f=Array.isArray(g),e=0,g=f?g:g[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){if(f){if(e>=g.length)break;d=g[e++]}else{e=g.next();if(e.done)break;d=e.value}a=d;c.writeI64(b("jsbi").BigInt(a))}}c.writeFieldStop();c.writeStructEnd()},t=function(a,c){c.writeStructBegin("StreamResponseDelta");if(a.flow_status!=null){var d;c.writeFieldBegin({fname:"flow_status",ftype:b("ThriftTypes").I32,fid:1});c.writeI32((d=a.flow_status)!=null?d:0);c.writeFieldStop();c.writeStructEnd();return}if(a.log!=null){c.writeFieldBegin({fname:"log",ftype:b("ThriftTypes").STRUCT,fid:2});n(a.log,c);c.writeFieldStop();c.writeStructEnd();return}if(a.rewrite!=null){c.writeFieldBegin({fname:"rewrite",ftype:b("ThriftTypes").STRUCT,fid:3});l(a.rewrite,c);c.writeFieldStop();c.writeStructEnd();return}if(a.data!=null){c.writeFieldBegin({fname:"data",ftype:b("ThriftTypes").STRUCT,fid:4});m(a.data,c);c.writeFieldStop();c.writeStructEnd();return}if(a.termination!=null){c.writeFieldBegin({fname:"termination",ftype:b("ThriftTypes").STRUCT,fid:5});o(a.termination,c);c.writeFieldStop();c.writeStructEnd();return}if(a.amend_ack!=null){c.writeFieldBegin({fname:"amend_ack",ftype:b("ThriftTypes").STRUCT,fid:6});p(a.amend_ack,c);c.writeFieldStop();c.writeStructEnd();return}c.writeFieldStop();c.writeStructEnd()},u=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.new_headers=a.readString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.new_body=a.readBinary():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.patch_headers=a.readString():a.skip(e);break;case 4:e===b("ThriftTypes").BOOL?c.kill_body=a.readBool():a.skip(e);break;case 5:e===b("ThriftTypes").BOOL?c.temporary=a.readBool():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},v=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.bytes=a.readBinary():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.metadata=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.bytes===void 0&&(c.bytes=Uint8Array.of());return c},w=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.message=a.readString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.message===void 0&&(c.message="");return c},x=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I32?c.reason=b("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(a.readI32()):a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.message=a.readString():a.skip(e);break;case 3:e===b("ThriftTypes").I64?c.retry_delay_ms=a.readI64().toString():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.reason===void 0&&(c.reason=b("RequestStreamCommonRequestStreamCommonTypes").TerminationReason.cast(0));return c},y=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").BOOL?c.accepted=a.readBool():a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.result=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},z=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.stream_id=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").I32?c.last_sequencer=a.readI32():a.skip(e);break;case 4:e===b("ThriftTypes").I32?c.amendment_count=a.readI32():a.skip(e);break;case 3:e===b("ThriftTypes").I32?c.last_status=b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()):a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.stream_id===void 0&&(c.stream_id="0");c.last_sequencer===void 0&&(c.last_sequencer=0);c.amendment_count===void 0&&(c.amendment_count=0);c.last_status===void 0&&(c.last_status=b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(0));return c},A=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.caller_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===b("ThriftTypes").LIST){c.streams_to_check=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=z(a);c.streams_to_check.push(g)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.caller_timestamp_ms===void 0&&(c.caller_timestamp_ms="0");return c},B=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.original_ping_timestamp_ms=a.readI64().toString():a.skip(e);break;case 2:if(e===b("ThriftTypes").LIST){c.stream_ids_missing=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=a.readI64().toString();c.stream_ids_missing.push(g)}}else a.skip(e);break;case 3:if(e===b("ThriftTypes").LIST){c.stream_ids_behind=[];g=a.readListBegin();for(var f=0;f<g.size;f++){d=a.readI64().toString();c.stream_ids_behind.push(d)}}else a.skip(e);break;case 4:if(e===b("ThriftTypes").LIST){c.stream_ids_with_lost_amendments=[];d=a.readListBegin();for(var f=0;f<d.size;f++){g=a.readI64().toString();c.stream_ids_with_lost_amendments.push(g)}}else a.skip(e);break;case 5:if(e===b("ThriftTypes").LIST){c.stream_ids_with_wrong_status=[];g=a.readListBegin();for(var f=0;f<g.size;f++){d=a.readI64().toString();c.stream_ids_with_wrong_status.push(d)}}else a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.original_ping_timestamp_ms===void 0&&(c.original_ping_timestamp_ms="0");return c},C=function(a){var c,d={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===b("ThriftTypes").STOP)break;switch(e){case 1:if(f===b("ThriftTypes").I32)if(c==null)d.flow_status=b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.cast(a.readI32()),c="flow_status";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: flow_status, previous deserialized field: "+c);else a.skip(f);break;case 2:if(f===b("ThriftTypes").STRUCT)if(c==null)d.log=w(a),c="log";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: log, previous deserialized field: "+c);else a.skip(f);break;case 3:if(f===b("ThriftTypes").STRUCT)if(c==null)d.rewrite=u(a),c="rewrite";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: rewrite, previous deserialized field: "+c);else a.skip(f);break;case 4:if(f===b("ThriftTypes").STRUCT)if(c==null)d.data=v(a),c="data";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: data, previous deserialized field: "+c);else a.skip(f);break;case 5:if(f===b("ThriftTypes").STRUCT)if(c==null)d.termination=x(a),c="termination";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: termination, previous deserialized field: "+c);else a.skip(f);break;case 6:if(f===b("ThriftTypes").STRUCT)if(c==null)d.amend_ack=y(a),c="amend_ack";else throw new Error("more than one field have been deserialized in union type: StreamResponseDelta; current field: amend_ack, previous deserialized field: "+c);else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return d};e.exports={AmendStreamAck$DefaultConstructor:g,LogMessage$DefaultConstructor:d,Ping$DefaultConstructor:i,Pong$DefaultConstructor:j,ResponseData$DefaultConstructor:c,ResponseRewriteRequest$DefaultConstructor:a,StreamCheck$DefaultConstructor:h,StreamResponseDelta$DefaultConstructor:k,Termination$DefaultConstructor:f,deserializeAmendStreamAck:y,deserializeLogMessage:w,deserializePing:A,deserializePong:B,deserializeResponseData:v,deserializeResponseRewriteRequest:u,deserializeStreamCheck:z,deserializeStreamResponseDelta:C,deserializeTermination:x,serializeAmendStreamAck:p,serializeLogMessage:n,serializePing:r,serializePong:s,serializeResponseData:m,serializeResponseRewriteRequest:l,serializeStreamCheck:q,serializeStreamResponseDelta:t,serializeTermination:o}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamTypes",["$InternalEnum"],(function(a,b,c,d,e,f){"use strict";a=b("$InternalEnum")({Ignored:100,Success:200,Queued:250,UnknownStream:400,HandledUnknownResult:450,Failure:500});c=b("$InternalEnum")({Request_headers:"request_headers",Request_body:"request_body",Amend:"amend",Ack:"ack",Response:"response",Ping:"ping",Pong:"pong"});e.exports={Ack:a,Payload$Types:c}}),null);
__d("RequestStreamSingleChannelSingleChannelRequestStreamSerializers",["RequestStreamCommonRequestStreamCommonSerializers","RequestStreamCommonRequestStreamCommonTypes","RequestStreamSingleChannelSingleChannelRequestStreamTypes","ThriftTypes","jsbi"],(function(a,b,c,d,e,f){"use strict";a=function(){return{}};c=function(){return{body:Uint8Array.of()}};d=function(){return{amendment:Uint8Array.of()}};f=function(){return{ack:b("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0)}};var g=function(){return{delta:[]}},h=function(){return{}},i=function(a,c){c.writeStructBegin("RequestStreamHeaders"),a.headers!=null&&(c.writeFieldBegin({fname:"headers",ftype:b("ThriftTypes").STRING,fid:1}),c.writeBinary(a.headers)),a.instrumentation_data!=null&&(c.writeFieldBegin({fname:"instrumentation_data",ftype:b("ThriftTypes").STRING,fid:2}),c.writeBinary(a.instrumentation_data)),c.writeFieldStop(),c.writeStructEnd()},j=function(a,c){c.writeStructBegin("RequestStreamBody");c.writeFieldBegin({fname:"body",ftype:b("ThriftTypes").STRING,fid:1});if(a.body!=null)c.writeBinary(a.body);else{a=Uint8Array.of();c.writeBinary(a)}c.writeFieldStop();c.writeStructEnd()},k=function(a,c){c.writeStructBegin("AmendStream");a.amendment_id!=null&&(c.writeFieldBegin({fname:"amendment_id",ftype:b("ThriftTypes").I64,fid:1}),c.writeI64(b("jsbi").BigInt(a.amendment_id)));c.writeFieldBegin({fname:"amendment",ftype:b("ThriftTypes").STRING,fid:2});if(a.amendment!=null)c.writeBinary(a.amendment);else{var d=Uint8Array.of();c.writeBinary(d)}a.is_query!=null&&(c.writeFieldBegin({fname:"is_query",ftype:b("ThriftTypes").BOOL,fid:3}),c.writeBool(a.is_query));a.instrumentation_data!=null&&(c.writeFieldBegin({fname:"instrumentation_data",ftype:b("ThriftTypes").STRING,fid:4}),c.writeBinary(a.instrumentation_data));c.writeFieldStop();c.writeStructEnd()},l=function(a,c){c.writeStructBegin("StreamResponseAck");a.response_id!=null&&(c.writeFieldBegin({fname:"response_id",ftype:b("ThriftTypes").I64,fid:1}),c.writeI64(b("jsbi").BigInt(a.response_id)));c.writeFieldBegin({fname:"ack",ftype:b("ThriftTypes").I32,fid:2});if(a.ack!=null){var d;c.writeI32((d=a.ack)!=null?d:0)}else{d=b("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0);c.writeI32((d=d)!=null?d:0)}a.query_result!=null&&(c.writeFieldBegin({fname:"query_result",ftype:b("ThriftTypes").STRING,fid:3}),c.writeBinary(a.query_result));c.writeFieldStop();c.writeStructEnd()},m=function(a,c){c.writeStructBegin("StreamResponse");a.response_id!=null&&(c.writeFieldBegin({fname:"response_id",ftype:b("ThriftTypes").I64,fid:1}),c.writeI64(b("jsbi").BigInt(a.response_id)));c.writeFieldBegin({fname:"delta",ftype:b("ThriftTypes").LIST,fid:2});if(a.delta!=null){c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:a.delta.length});for(var d=a.delta,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var g;if(e){if(f>=d.length)break;g=d[f++]}else{f=d.next();if(f.done)break;g=f.value}g=g;b("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(g,c)}}else{g=[];c.writeListBegin({etype:b("ThriftTypes").STRUCT,size:g.length});for(var f=0;f<g.length;f++){e=g[f];b("RequestStreamCommonRequestStreamCommonSerializers").serializeStreamResponseDelta(e,c)}}if(a.ack_level!=null){c.writeFieldBegin({fname:"ack_level",ftype:b("ThriftTypes").I32,fid:3});c.writeI32((d=a.ack_level)!=null?d:0)}a.query_request!=null&&(c.writeFieldBegin({fname:"query_request",ftype:b("ThriftTypes").STRING,fid:4}),c.writeBinary(a.query_request));a.instrumentation_data!=null&&(c.writeFieldBegin({fname:"instrumentation_data",ftype:b("ThriftTypes").STRING,fid:5}),c.writeBinary(a.instrumentation_data));c.writeFieldStop();c.writeStructEnd()},n=function(a,c){c.writeStructBegin("Payload");if(a.request_headers!=null){c.writeFieldBegin({fname:"request_headers",ftype:b("ThriftTypes").STRUCT,fid:1});i(a.request_headers,c);c.writeFieldStop();c.writeStructEnd();return}if(a.request_body!=null){c.writeFieldBegin({fname:"request_body",ftype:b("ThriftTypes").STRUCT,fid:2});j(a.request_body,c);c.writeFieldStop();c.writeStructEnd();return}if(a.amend!=null){c.writeFieldBegin({fname:"amend",ftype:b("ThriftTypes").STRUCT,fid:3});k(a.amend,c);c.writeFieldStop();c.writeStructEnd();return}if(a.ack!=null){c.writeFieldBegin({fname:"ack",ftype:b("ThriftTypes").STRUCT,fid:4});l(a.ack,c);c.writeFieldStop();c.writeStructEnd();return}if(a.response!=null){c.writeFieldBegin({fname:"response",ftype:b("ThriftTypes").STRUCT,fid:5});m(a.response,c);c.writeFieldStop();c.writeStructEnd();return}if(a.ping!=null){c.writeFieldBegin({fname:"ping",ftype:b("ThriftTypes").STRUCT,fid:6});b("RequestStreamCommonRequestStreamCommonSerializers").serializePing(a.ping,c);c.writeFieldStop();c.writeStructEnd();return}if(a.pong!=null){c.writeFieldBegin({fname:"pong",ftype:b("ThriftTypes").STRUCT,fid:7});b("RequestStreamCommonRequestStreamCommonSerializers").serializePong(a.pong,c);c.writeFieldStop();c.writeStructEnd();return}c.writeFieldStop();c.writeStructEnd()},o=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.headers=a.readBinary():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();return c},p=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").STRING?c.body=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.body===void 0&&(c.body=Uint8Array.of());return c},q=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.amendment_id=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").STRING?c.amendment=a.readBinary():a.skip(e);break;case 3:e===b("ThriftTypes").BOOL?c.is_query=a.readBool():a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.amendment===void 0&&(c.amendment=Uint8Array.of());return c},r=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.response_id=a.readI64().toString():a.skip(e);break;case 2:e===b("ThriftTypes").I32?c.ack=b("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(a.readI32()):a.skip(e);break;case 3:e===b("ThriftTypes").STRING?c.query_result=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.ack===void 0&&(c.ack=b("RequestStreamSingleChannelSingleChannelRequestStreamTypes").Ack.cast(0));return c},s=function(a){var c={};a.readStructBegin();while(!0){var d=a.readFieldBegin(),e=d.ftype;d=d.fid;if(e===b("ThriftTypes").STOP)break;switch(d){case 1:e===b("ThriftTypes").I64?c.response_id=a.readI64().toString():a.skip(e);break;case 2:if(e===b("ThriftTypes").LIST){c.delta=[];d=a.readListBegin();for(var f=0;f<d.size;f++){var g=b("RequestStreamCommonRequestStreamCommonSerializers").deserializeStreamResponseDelta(a);c.delta.push(g)}}else a.skip(e);break;case 3:e===b("ThriftTypes").I32?c.ack_level=b("RequestStreamCommonRequestStreamCommonTypes").AckLevel.cast(a.readI32()):a.skip(e);break;case 4:e===b("ThriftTypes").STRING?c.query_request=a.readBinary():a.skip(e);break;case 5:e===b("ThriftTypes").STRING?c.instrumentation_data=a.readBinary():a.skip(e);break;default:a.skip(e)}a.readFieldEnd()}a.readStructEnd();c.delta===void 0&&(c.delta=[]);return c},t=function(a){var c,d={};a.readStructBegin();while(!0){var e=a.readFieldBegin(),f=e.ftype;e=e.fid;if(f===b("ThriftTypes").STOP)break;switch(e){case 1:if(f===b("ThriftTypes").STRUCT)if(c==null)d.request_headers=o(a),c="request_headers";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_headers, previous deserialized field: "+c);else a.skip(f);break;case 2:if(f===b("ThriftTypes").STRUCT)if(c==null)d.request_body=p(a),c="request_body";else throw new Error("more than one field have been deserialized in union type: Payload; current field: request_body, previous deserialized field: "+c);else a.skip(f);break;case 3:if(f===b("ThriftTypes").STRUCT)if(c==null)d.amend=q(a),c="amend";else throw new Error("more than one field have been deserialized in union type: Payload; current field: amend, previous deserialized field: "+c);else a.skip(f);break;case 4:if(f===b("ThriftTypes").STRUCT)if(c==null)d.ack=r(a),c="ack";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ack, previous deserialized field: "+c);else a.skip(f);break;case 5:if(f===b("ThriftTypes").STRUCT)if(c==null)d.response=s(a),c="response";else throw new Error("more than one field have been deserialized in union type: Payload; current field: response, previous deserialized field: "+c);else a.skip(f);break;case 6:if(f===b("ThriftTypes").STRUCT)if(c==null)d.ping=b("RequestStreamCommonRequestStreamCommonSerializers").deserializePing(a),c="ping";else throw new Error("more than one field have been deserialized in union type: Payload; current field: ping, previous deserialized field: "+c);else a.skip(f);break;case 7:if(f===b("ThriftTypes").STRUCT)if(c==null)d.pong=b("RequestStreamCommonRequestStreamCommonSerializers").deserializePong(a),c="pong";else throw new Error("more than one field have been deserialized in union type: Payload; current field: pong, previous deserialized field: "+c);else a.skip(f);break;default:a.skip(f)}a.readFieldEnd()}a.readStructEnd();return d};e.exports={AmendStream$DefaultConstructor:d,Payload$DefaultConstructor:h,RequestStreamBody$DefaultConstructor:c,RequestStreamHeaders$DefaultConstructor:a,StreamResponse$DefaultConstructor:g,StreamResponseAck$DefaultConstructor:f,deserializeAmendStream:q,deserializePayload:t,deserializeRequestStreamBody:p,deserializeRequestStreamHeaders:o,deserializeStreamResponse:s,deserializeStreamResponseAck:r,serializeAmendStream:k,serializePayload:n,serializeRequestStreamBody:j,serializeRequestStreamHeaders:i,serializeStreamResponse:m,serializeStreamResponseAck:l}}),null);
__d("DGWStreamSetup",["regeneratorRuntime","CompactSerializer","DGWStream","DGWStreamCallbacks","FBDGWClient","FBLogger","RequestStreamSingleChannelSingleChannelRequestStreamSerializers"],(function(a,b,c,d,e,f){"use strict";f.setupRequestStream=a;function g(a,b){var c={};a=Object.entries(a);for(var d=0;d<a.length;d++){var e=a[d],f=e[0];e=e[1];typeof e=="string"?c["XRSS-"+f]=e:typeof e=="number"&&(c["XRSN-"+f]=e.toString())}b&&(c["xrs-body"]="true");return c}var h=function(){function a(a){this.$2=!1,this.$1=a}var c=a.prototype;c.onDataReceived=function(a){var c=this;if(this.$2){b("FBLogger")("requeststream-web").warn("get data after socket closed");return}a=b("CompactSerializer").deserialize(a,b("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").deserializePayload);if(a.response){a=a.response.delta;a.forEach(function(a){if(a.data)c.$1.onData(new TextDecoder("utf-8").decode(a.data.bytes));else if(a.flow_status)c.$1.onFlowStatus(a.flow_status);else if(a.termination){var d;d=(d=a.termination.message)!=null?d:"unknown termination msg";c.$1.onTermination(d)}else a.log?c.$1.onLog(a.log.message):b("FBLogger")("requeststream-web").warn("not support other delta type now")})}else b("FBLogger")("requeststream-web").warn("not support other Payload type now")};c.onError=function(a){this.$2=!0;switch(a){case b("DGWStream").StreamError.ABNORMAL_CLOSURE:this.$1.onTermination("Received error for abnormal closure");break;case b("DGWStream").StreamError.SERVER_INTERNAL_ERROR:this.$1.onTermination("Received error for internal server error");break;default:this.$1.onTermination("Received unknown error")}};c.onClose=function(a){this.$2||(a.close(),this.$2=!0,this.$1.onTermination("Client receive OnClose and Server will not send more data"))};c.onStreamMustDrain=function(a,c){!this.$2?(a.close(),this.$2=!0,this.$1.onTermination("onStreamMustDrain for RS Client: "+c)):b("FBLogger")("requeststream-web").warn("got onStreamMustDrain, but Stream has already been closed")};return a}();f.RSDGWStreamCallback=h;function a(a,c,d,e){var f,i,j,k,l;return b("regeneratorRuntime").async(function(m){while(1)switch(m.prev=m.next){case 0:f=g(c,d!=null);i=new h(a);j={};e!=null&&(j=(k=e.dgwStreamOptions)!=null?k:{});m.next=6;return b("regeneratorRuntime").awrap(b("FBDGWClient")().establishDGWStream(f,"realtime",i,j));case 6:l=m.sent;return m.abrupt("return",l);case 8:case"end":return m.stop()}},null,this)}}),null);
__d("StreamRef",["regeneratorRuntime","CompactSerializer","DGWStreamSetup","FBLogger","RequestStreamSingleChannelSingleChannelRequestStreamSerializers","$InternalEnum"],(function(a,b,c,d,e,f){"use strict";var g=b("$InternalEnum").Mirrored(["CREATED","STARTED","DISCONNECTED"]);f.StreamState=g;a=function(){function a(a,b,c,d,e){this.$1=g.CREATED,this.$3=a,this.$4=b,this.$5=c,this.$6=e,this.$7=d}var c=a.prototype;c.start=function(){var a;return b("regeneratorRuntime").async(function(c){while(1)switch(c.prev=c.next){case 0:if(!(this.$1===g.CREATED)){c.next=19;break}c.prev=1;c.next=4;return b("regeneratorRuntime").awrap(b("DGWStreamSetup").setupRequestStream(this.$5,this.$3,this.$4,this.$7));case 4:this.$2=c.sent;c.next=11;break;case 7:c.prev=7;c.t0=c["catch"](1);b("FBLogger")("requeststream-web").warn("establishDGWStream failed");return c.abrupt("return",!1);case 11:if(!(this.$1===g.DISCONNECTED)){c.next=15;break}b("FBLogger")("requeststream-web").warn("already cancle stream before establishing it");this.$2&&this.$2.close();return c.abrupt("return",!1);case 15:this.$1=g.STARTED;a={};this.$4!=null&&(a={request_body:{body:new TextEncoder().encode(this.$4)}});return c.abrupt("return",this.$2.send(b("CompactSerializer").serialize(a,b("RequestStreamSingleChannelSingleChannelRequestStreamSerializers").serializePayload)));case 19:if(!(this.$1===g.STARTED)){c.next=24;break}b("FBLogger")("requeststream-web").warn("stream was already started");return c.abrupt("return",!1);case 24:b("FBLogger")("requeststream-web").warn("stream has not started");return c.abrupt("return",!1);case 26:case"end":return c.stop()}},null,this,[[1,7]])};c.amendwithoutAck=function(a){this.$1===g.STARTED&&this.$2?this.$2.send(a):b("FBLogger")("requeststream-web").warn("amendwithoutAck when stream has not started")};c.cancel=function(){this.$1===g.STARTED?this.$2&&this.$2.close():b("FBLogger")("requeststream-web").warn("cancel when stream has not started"),this.$1=g.DISCONNECTED};c.isActive=function(){return this.$1===g.STARTED};c.getState=function(){return this.$1};return a}();f.StreamRef=a}),null);
__d("DGWRequestStreamClient",["regeneratorRuntime","StreamRef"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){}var c=a.prototype;c.requestStream=function(a,c,d,e,f){var g,h;return b("regeneratorRuntime").async(function(i){while(1)switch(i.prev=i.next){case 0:g=new(b("StreamRef").StreamRef)(a,c,d,e,f);i.next=3;return b("regeneratorRuntime").awrap(g.start());case 3:h=i.sent;if(!h){i.next=8;break}return i.abrupt("return",g);case 8:throw new Error("failed to start request stream");case 9:case"end":return i.stop()}},null,this)};return a}();f.DGWRequestStreamClient=a}),null);
__d("RequestStreamHandler",["RequestStreamCommonRequestStreamCommonTypes"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a,b,c,d){this.$1=a,this.$2=b,this.$3=c||function(a){},this.$4=d,this.$5=!1}var c=a.prototype;c.onFlowStatus=function(a){this.$4(a),a===b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started&&(this.$5=!0)};c.onData=function(a){this.$1!=null&&this.$5&&this.$1(a)};c.onTermination=function(a){this.$2(new Error(""+a))};c.onLog=function(a){this.$3(a)};return a}();e.exports=a}),null);
__d("RtiRequestStreamPulsarClientFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1745999");c=b("FalcoLoggerInternal").create("rti_request_stream_pulsar_client",a);e.exports=c}),null);
__d("PulsarLogger",["CurrentUser","RtiRequestStreamPulsarClientFalcoEvent"],(function(a,b,c,d,e,f){a=function(){function a(){}var c=a.prototype;c.log=function(a,c){b("RtiRequestStreamPulsarClientFalcoEvent").log(function(){return{test_id:c.testId,user_id:b("CurrentUser").getID(),request_id:c.requestId,test_name:a.testName,test_result:c.testResult,failure_reason:c.failureReason,transport:a.transport,payload_interval_ms:a.payloadIntervalMs.toString(),subscribe_issued:c.subscribeIssued,subscribe_success:c.subscribeSuccess,subscribe_latency_ms:c.subscribeLatencyMs.toString(),subscribe_timeout_interval_ms:a.timeoutIntervalMs.toString(),publish_timeout_interval_ms:c.publishTimeoutIntervalMs.toString(),num_flow_status_started:c.numFlowStatusStarted.toString(),num_flow_status_accepted:c.numFlowStatusAccepted.toString(),num_flow_status_stopped:c.numFlowStatusStopped.toString(),num_payloads_expected:a.numPayloadsExpected.toString(),num_payloads_received:c.numPayloadsReceived.toString(),test_duration_ms:c.testDurationMs.toString(),test_end_time_ms:c.testEndTimeMs.toString()}})};return a}();c=new a();f.pulsarLogger=c}),null);
__d("TestStateMachine",["BladeRunnerLogger","PulsarLogger","$InternalEnum"],(function(a,b,c,d,e,f){var g=b("$InternalEnum").Mirrored(["INITIAL","START","REQUEST_LANDED","SUCCESS","FAILURE","ABORT"]),h="Request timeout",i="Publish timeout",j="Payload integrity check failure",k="Stream terminate";a=function(){function a(a,b,c){this.$1=b,this.$2=c,this.$3=a,this.$4=g.INITIAL,this.$5=0,this.$6=0,this.$7=0,this.$8=Date.now(),this.$12=0,this.$13=0,this.$14=0,this.$15=0,this.$9=0,this.$10=0,this.$11=0}var c=a.prototype;c.hasTestEnd=function(){return this.$4===g.SUCCESS||this.$4===g.ABORT||this.$4===g.FAILURE};c.updatePublishTimeoutIntervalMs=function(){this.$5==0&&(this.$15=this.$3.payloadIntervalMs),this.$15=this.$3.timeoutIntervalMs+this.$3.payloadIntervalMs};c.getFailureReason=function(){return this.$16!=null?this.$17!=null?this.$16+" lastSeenError: "+this.$17:this.$16:""};c.logTestResult=function(){this.$11=Date.now(),b("BladeRunnerLogger").info("Pulsar test concluded. Number of expected payloads = "+this.$3.numPayloadsExpected+" , Number of received payload = "+this.$5+" , Test Result = "+this.$4+", Failure reason: "+(this.$16!=null?this.$16:"")),b("PulsarLogger").pulsarLogger.log(this.$3,{testId:this.$1,requestId:this.$2,testResult:this.hasTestEnd()?this.$4:"Unknown",numFlowStatusAccepted:this.$12,numFlowStatusStarted:this.$13,numFlowStatusStopped:this.$14,numPayloadsReceived:this.$5,publishTimeoutIntervalMs:this.$15,subscribeIssued:this.$6>0,subscribeLatencyMs:this.$10,subscribeSuccess:this.$7>0,testDurationMs:this.$11-this.$8,testEndTimeMs:this.$11,failureReason:this.$4===g.SUCCESS?"":this.getFailureReason()})};c.onStart=function(){var a=this;b("BladeRunnerLogger").info("Pulsar starts testId:"+this.$1+"requestId: "+this.$2);if(this.$4!==g.INITIAL){b("BladeRunnerLogger").warn("Drop Pulsar request");return}this.$4=g.START;this.$6++;this.$10==0&&(this.$9=Date.now());this.$18=setTimeout(function(){a.onTimeOut()},this.$3.timeoutIntervalMs)};c.onRequestLanded=function(){var a=this;b("BladeRunnerLogger").info("Pulsar request Landed");if(this.$4!==g.START){b("BladeRunnerLogger").warn("drop the request ack");return}clearTimeout(this.$18);this.updatePublishTimeoutIntervalMs();this.$4=g.REQUEST_LANDED;this.$7++;this.$10==0&&(this.$10=Date.now()-this.$9);this.$18=setTimeout(function(){a.onTimeOut()},this.$15)};c.onPayloadReceived=function(a){var c=this;b("BladeRunnerLogger").info("Pulsar payload received");if(this.$4!==g.REQUEST_LANDED){b("BladeRunnerLogger").warn("drop the received payload");return}clearTimeout(this.$18);this.$5++;this.updatePublishTimeoutIntervalMs();if(!this.payloadIntegrityCheck(a)){this.$16=j;this.$4=g.FAILURE;this.logTestResult();return}this.$3.numPayloadsExpected<=this.$5?(this.$4=g.SUCCESS,this.logTestResult()):this.$18=setTimeout(function(){c.onTimeOut()},this.$15)};c.onTerminate=function(a){b("BladeRunnerLogger").info("Pulsar on terminate");if(this.hasTestEnd()){b("BladeRunnerLogger").info("stream gets terminated after test ends "+a);return}clearTimeout(this.$18);this.$4=g.FAILURE;this.$16=k;this.$17=a;this.logTestResult()};c.onFlowStatusAccepted=function(){this.$12++};c.onFlowStatusStarted=function(){b("BladeRunnerLogger").info("Pulsar on flow status started"),this.$13++};c.onFlowStatusStopped=function(){this.$14++};c.onTimeOut=function(){b("BladeRunnerLogger").info("Pulsar timeout");if(this.hasTestEnd()){b("BladeRunnerLogger").warn("Timer not stopped after test ends");return}this.$4===g.REQUEST_LANDED?this.$16=i:this.$16=h;this.$4=g.FAILURE;this.logTestResult()};c.payloadIntegrityCheck=function(a){a=JSON.parse(a);a=a.payload||"";return a.length==this.$3.payloadSize+(this.$7-1)};return a}();e.exports=a}),null);
__d("PulsarClient",["BladeRunnerDeferredClient","BladeRunnerLogger","BladeRunnerStreamHandler","BladeRunnerTypes","DGWRequestStreamClient","Random","RequestStreamCommonRequestStreamCommonTypes","RequestStreamHandler","TestStateMachine","promiseDone","qex","uuid","$InternalEnum"],(function(a,b,c,d,e,f){var g=b("$InternalEnum").Mirrored(["WEB_BR_MQTT","WEB_RS_MQTT","WEB_RS_STARGATE"]);a=function(){function a(){var a;this.$1=(a=b("qex")._("1814429"))!=null?a:"web_pulsar_qe";a=(a=b("qex")._("1814371"))!=null?a:"WEB_BR_MQTT";this.$2=[];for(var a=a.split(","),c=Array.isArray(a),d=0,a=c?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=a.length)break;e=a[d++]}else{d=a.next();if(d.done)break;e=d.value}e=e;switch(e){case"WEB_BR_MQTT":this.$2.push(g.WEB_BR_MQTT);break;case"WEB_RS_MQTT":this.$2.push(g.WEB_RS_MQTT);break;case"WEB_RS_STARGATE":this.$2.push(g.WEB_RS_STARGATE);break;default:b("BladeRunnerLogger").info("Pulsar test unknown transport");break}}this.$3=(e=b("qex")._("1787520"))!=null?e:0;this.$4=(d=b("qex")._("1841667"))!=null?d:2;this.$5=(c=b("qex")._("1841668"))!=null?c:100;this.$6=(a=b("qex")._("1841669"))!=null?a:1e5;this.$7=(e=b("qex")._("1841670"))!=null?e:1e4}var c=a.prototype;c.getBodyString=function(a){a={number_of_payloads:a.numPayloadsExpected,payload_size_in_bytes:a.payloadSize,time_interval_in_seconds:a.payloadIntervalMs/1e3,test_name:a.testName,time_span_mode:"fixed",publish_mode:"direct"};return JSON.stringify({input:a})};c.startSinglePulsarTest=function(){if(!b("Random").coinflip(this.$3)||window.document.location.href.includes("intern")||!window.document.location.href.includes("facebook.com"))return;var a=b("uuid")(),c=a;for(var d=this.$2,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(e){if(f>=d.length)break;h=d[f++]}else{f=d.next();if(f.done)break;h=f.value}h=h;var i={testName:this.$1,transport:h,numPayloadsExpected:this.$4,payloadIntervalMs:this.$6,payloadSize:this.$5,timeoutIntervalMs:this.$7};h===g.WEB_BR_MQTT?this.runMQTTTest(a,c,i):this.runRSClientTest(h,a,c,i)}};c.runMQTTTest=function(a,c,d){b("BladeRunnerLogger").info("Running MQTT pulsar test");var e=b("BladeRunnerDeferredClient"),f=new(b("TestStateMachine"))(d,a,c),g=new(b("BladeRunnerStreamHandler"))(function(a){f.onPayloadReceived(a)},null,function(a){switch(a){case b("BladeRunnerTypes").StreamStatus.ACCEPTED:f.onFlowStatusAccepted();break;case b("BladeRunnerTypes").StreamStatus.STARTED:f.onFlowStatusStarted();f.onRequestLanded();break;case b("BladeRunnerTypes").StreamStatus.PAUSED:f.onFlowStatusStopped();break;case b("BladeRunnerTypes").StreamStatus.REJECTED:f.onTerminate("StreamUpdate: REJECTED");break;case b("BladeRunnerTypes").StreamStatus.CLOSED:f.onTerminate("StreamUpdate: CLOSED");break;default:b("BladeRunnerLogger").info("Pulsar Received statusUpdate unknown?")}},function(a){b("BladeRunnerLogger").info(" Pulsar Received log: "+a)},function(a){b("BladeRunnerLogger").info("Pulsar Received batch: "+JSON.stringify(a))});f.onStart();e.requestStream({method:"Pulsar",test_id:a},this.getBodyString(d),g,{requestId:c,forceLogContext:"pulsar"})};c.runRSClientTest=function(a,c,d,e){b("BladeRunnerLogger").info("Running SG pulsar test");a=new(b("DGWRequestStreamClient").DGWRequestStreamClient)();var f=new(b("TestStateMachine"))(e,c,d),g=new(b("RequestStreamHandler"))(function(a){f.onPayloadReceived(a)},function(a){f.onTerminate(a.message)},function(a){b("BladeRunnerLogger").info(" Pulsar Received log: "+a)},function(a){switch(a){case b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Accepted:f.onFlowStatusAccepted();break;case b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Started:f.onFlowStatusStarted();f.onRequestLanded();break;case b("RequestStreamCommonRequestStreamCommonTypes").FlowStatus.Stopped:f.onFlowStatusStopped();break}});f.onStart();var h={dgwStreamOptions:{loggingId:d}};b("promiseDone")(a.requestStream({method:"Pulsar",test_id:c},this.getBodyString(e),g,h,{requestId:d,forceLogContext:"pulsar"}).then(function(){b("BladeRunnerLogger").info("DGW create stream successfully")})["catch"](function(a){b("BladeRunnerLogger").info("DGW failed to create stream, with exception msg: "+a.message)}))};return a}();c=new a();e.exports=c}),null);
__d("ClientConsistencyFalcoEvent",["FalcoLoggerInternal","getFalcoLogPolicy_DO_NOT_USE"],(function(a,b,c,d,e,f){"use strict";a=b("getFalcoLogPolicy_DO_NOT_USE")("1764786");c=b("FalcoLoggerInternal").create("client_consistency",a);e.exports=c}),null);
__d("FleetBeaconStates",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a}var b=a.prototype;b.getName=function(){return"initial"};b.getFleetBeaconRunner=function(){return this.$1};b.prepareFleetBeaconSucceed=function(){throw new Error("Invalid transition")};b.prepareFleetBeaconFailed=function(){throw new Error("Invalid transition")};b.subscribeIssued=function(){throw new Error("Invalid transition")};b.subscribeSuccessSignalReceived=function(){throw new Error("Invalid transition")};b.publishIssued=function(){throw new Error("Invalid transition")};b.publishFailed=function(){throw new Error("Invalid transition")};b.payloadReceived=function(){throw new Error("Invalid transition")};b.waitForPublishTimeout=function(){throw new Error("Invalid transition")};b.subscribeTimeout=function(){throw new Error("Invalid transition")};b.payloadTimeout=function(){throw new Error("Invalid transition")};b.cleanUpFinish=function(){throw new Error("Invalid transition")};return a}();f.FleetBeaconState=a;b=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}var c=b.prototype;c.getName=function(){return"preparing"};c.prepareFleetBeaconSucceed=function(){var b=this;return{newState:new g(a.prototype.getFleetBeaconRunner.call(this)),action:function(){a.prototype.getFleetBeaconRunner.call(b).runFleetBeaconTest()}}};c.prepareFleetBeaconFailed=function(){var b=this;return{newState:new m(a.prototype.getFleetBeaconRunner.call(this)),action:function(){b.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return b}(a);f.FleetBeaconPreparingState=b;var g=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"before_subscribe"};c.subscribeIssued=function(){var a=this;return{newState:new h(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).startSubscribeTimer()}}};return a}(a);f.FleetBeaconBeforeSubscribeState=g;var h=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"subscribe_issued"};c.subscribeSuccessSignalReceived=function(){var a=this;return{newState:new i(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).waitForNextPublish()}}};c.subscribeTimeout=function(){var a=this;return{newState:new k(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return a}(a);f.FleetBeaconSubscribedIssuedState=h;var i=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"waiting_to_publish"};c.waitForPublishTimeout=function(){var a=this;return{newState:new j(b.prototype.getFleetBeaconRunner.call(this)),action:function(){b.prototype.getFleetBeaconRunner.call(a).publish(),b.prototype.getFleetBeaconRunner.call(a).startPayloadTimer()}}};return a}(a);f.FleetBeaconWaitingToPublishState=i;var j=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"publish_issued"};c.publishFailed=function(){var a=this;return{newState:new m(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};c.payloadReceived=function(){var a=this,c,d;(function(){});b.prototype.getFleetBeaconRunner.call(this).isLastPayload()?(c=new l(b.prototype.getFleetBeaconRunner.call(this)),d=function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}):(c=new i(b.prototype.getFleetBeaconRunner.call(this)),d=function(){b.prototype.getFleetBeaconRunner.call(a).waitForNextPublish()});return{newState:c,action:d}};c.payloadTimeout=function(){var a=this;return{newState:new k(b.prototype.getFleetBeaconRunner.call(this)),action:function(){a.getFleetBeaconRunner().cleanUpFleetBeacon()}}};return a}(a);f.FleetBeaconPublishIssuedState=j;var k=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"failed"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a);f.FleetBeaconFailedState=k;var l=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"succeed"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a);f.FleetBeaconSucceedState=l;var m=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"aborted"};c.cleanUpFinish=function(){return{newState:new n(b.prototype.getFleetBeaconRunner.call(this)),action:function(){}}};return a}(a);f.FleetBeaconAbortedState=m;var n=function(b){babelHelpers.inheritsLoose(a,b);function a(){return b.apply(this,arguments)||this}var c=a.prototype;c.getName=function(){return"finish"};return a}(a);f.FleetBeaconFinishState=n}),null);
__d("FleetBeaconRunner",["FleetBeaconStates","clearTimeout","setTimeout"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a;this.$2=new(b("FleetBeaconStates").FleetBeaconState)(this);var c=new(b("FleetBeaconStates").FleetBeaconPreparingState)(this);this.$1.cleanPreviousFleetBeaconResult();this.$6(function(){return{newState:c,action:function(){}}});this.$3=0;this.$1.setFleetBeaconRunner(this)}var c=a.prototype;c.getPublishTimes=function(){return this.$3};c.prepareFleetBeaconTest=function(){this.$1.prepareFleetBeaconTest()};c.runFleetBeaconTest=function(){var a=this;this.$6(function(){return a.$2.subscribeIssued()});this.$7()};c.$7=function(){this.$1.subscribe()};c.publish=function(){this.$1.publish()};c.isLastPayload=function(){return this.$3>=this.$1.publishWaitIntervalsMS().length};c.waitForNextPublish=function(){var a=this,c=this.$1.publishWaitIntervalsMS()[this.$3];this.$3+=1;c===0?this.$8():b("setTimeout")(function(){a.$8()},c)};c.startSubscribeTimer=function(){var a=this,c=this.$1.subscribeTimeoutIntervalMS();this.$4=b("setTimeout")(function(){a.$9()},c)};c.startPayloadTimer=function(){var a=this,c=this.$1.payloadTimeoutIntervalMS();this.$5=b("setTimeout")(function(){a.$10()},c)};c.cleanUpFleetBeacon=function(){this.$1.cleanUpFleetBeacon()};c.onCleanUpFinish=function(){var a=this;this.$6(function(){return a.$2.cleanUpFinish()})};c.$8=function(){var a=this;this.$6(function(){return a.$2.waitForPublishTimeout()})};c.$9=function(){var a=this;this.$6(function(){return a.$2.subscribeTimeout()})};c.$10=function(){var a=this;this.$6(function(){return a.$2.payloadTimeout()})};c.onPrepareFleetBeaconSuccess=function(){var a=this;this.$6(function(){return a.$2.prepareFleetBeaconSucceed()})};c.onPrepareFleetBeaconFailed=function(){var a=this;this.$6(function(){return a.$2.prepareFleetBeaconFailed()})};c.onSubscribe=function(){var a=this;b("clearTimeout")(this.$4);this.$6(function(){return a.$2.subscribeSuccessSignalReceived()})};c.onPayloadReceived=function(){var a=this;b("clearTimeout")(this.$5);this.$6(function(){return a.$2.payloadReceived()})};c.onPublishFailed=function(){var a=this;b("clearTimeout")(this.$5);this.$6(function(){return a.$2.publishFailed()})};c.$6=function(a){a=a();var b=this.$2;this.$2=a.newState;var c=this.$2;this.$11(b,c);a.action()};c.$11=function(a,b){this.$1.onFleetBeaconStateTransition(a,b)};return a}();e.exports=a}),null);
__d("FleetBeaconStateTransitionListener",[],(function(a,b,c,d,e,f){a=function(){function a(){}var b=a.prototype;b.onFleetBeaconStateTransition=function(a,b,c,d){throw new Error("Require implementation")};b.cleanState=function(){throw new Error("Require implementation")};return a}();e.exports=a}),null);
__d("FleetBeaconTestBase",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=null,this.$2=[]}var b=a.prototype;b.addStateTransitionListener=function(a){this.$2.push(a)};b.cleanPreviousFleetBeaconResult=function(){this.$2.forEach(function(a){a.cleanState()})};b.getNumberOfPublishers=function(){var a;return(a=(a=this.$1)==null?void 0:a.getPublishTimes())!=null?a:-1};b.getTestID=function(){throw new Error("Require implementation")};b.setFleetBeaconRunner=function(a){this.$1=a};b.prepareFleetBeaconTest=function(){throw new Error("Require implementation")};b.onPrepareFleetBeaconSuccess=function(){var a;(a=this.$1)==null?void 0:a.onPrepareFleetBeaconSuccess()};b.onPrepareFleetBeaconFailed=function(){var a;(a=this.$1)==null?void 0:a.onPrepareFleetBeaconFailed()};b.subscribe=function(){throw new Error("Require implementation")};b.onSubscribe=function(){var a;(a=this.$1)==null?void 0:a.onSubscribe()};b.publish=function(){throw new Error("Require implementation")};b.cleanUpFleetBeacon=function(){throw new Error("Require implementation")};b.onCleanUpFinish=function(){var a;(a=this.$1)==null?void 0:a.onCleanUpFinish()};b.onPublishFailed=function(){var a;(a=this.$1)==null?void 0:a.onPublishFailed()};b.onPayloadReceived=function(){var a;(a=this.$1)==null?void 0:a.onPayloadReceived()};b.subscribeTimeoutIntervalMS=function(){return 1e4};b.payloadTimeoutIntervalMS=function(){return 2e4};b.publishWaitIntervalsMS=function(){return[1e4,5e3]};b.shouldStartTime=function(){return!0};b.onFleetBeaconStateTransition=function(a,b){var c=this,d=Date.now();this.$2.forEach(function(e){e.onFleetBeaconStateTransition(a,b,d,c)})};return a}();e.exports=a}),null);
__d("FleetBeaconTestUIAnnouncer",["FleetBeaconStateTransitionListener"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(b,a);function b(){var b;b=a.call(this)||this;b.$FleetBeaconTestUIAnnouncer1=[];b.$FleetBeaconTestUIAnnouncer3=!1;b.$FleetBeaconTestUIAnnouncer4=!1;b.$FleetBeaconTestUIAnnouncer5=!1;b.$FleetBeaconTestUIAnnouncer6=!1;b.$FleetBeaconTestUIAnnouncer7=-1;b.$FleetBeaconTestUIAnnouncer8=-1;b.$FleetBeaconTestUIAnnouncer9=0;b.$FleetBeaconTestUIAnnouncer10=0;b.$FleetBeaconTestUIAnnouncer11=[];b.$FleetBeaconTestUIAnnouncer12=-1;b.$FleetBeaconTestUIAnnouncer13=-1;b.$FleetBeaconTestUIAnnouncer14=-1;return b}var c=b.prototype;c.cleanState=function(){this.$FleetBeaconTestUIAnnouncer3=!1,this.$FleetBeaconTestUIAnnouncer4=!1,this.$FleetBeaconTestUIAnnouncer5=!1,this.$FleetBeaconTestUIAnnouncer6=!1,this.$FleetBeaconTestUIAnnouncer7=-1,this.$FleetBeaconTestUIAnnouncer8=-1,this.$FleetBeaconTestUIAnnouncer9=0,this.$FleetBeaconTestUIAnnouncer10=0,this.$FleetBeaconTestUIAnnouncer11=[],this.$FleetBeaconTestUIAnnouncer12=-1,this.$FleetBeaconTestUIAnnouncer13=-1,this.$FleetBeaconTestUIAnnouncer14=-1};c.addSubscriber=function(a){this.$FleetBeaconTestUIAnnouncer1.push(a)};c.onFleetBeaconStateTransition=function(a,b,c,d){var e=d.getTestID(),f={oldState:a,newState:b,testID:e,timestamp:c,extra:{}};this.$FleetBeaconTestUIAnnouncer2==null&&(this.$FleetBeaconTestUIAnnouncer2=d);e="NONE";switch(b.getName()){case"initial":break;case"preparing":this.$FleetBeaconTestUIAnnouncer12=Date.now();this.$FleetBeaconTestUIAnnouncer3=!0;f.extra=babelHelpers["extends"]({},f.extra,{createIssued:!0});break;case"before_subscribe":this.$FleetBeaconTestUIAnnouncer13=Date.now();this.$FleetBeaconTestUIAnnouncer4=!0;f.extra=babelHelpers["extends"]({},f.extra,{createSuccess:!0});break;case"subscribe_issued":this.$FleetBeaconTestUIAnnouncer5=!0;f.extra=babelHelpers["extends"]({},f.extra,{subscribeIssued:!0,subscribeTimestamp:this.$FleetBeaconTestUIAnnouncer13,subscribeTimeoutIntervalMS:(d=(c=this.$FleetBeaconTestUIAnnouncer2)==null?void 0:c.subscribeTimeoutIntervalMS())!=null?d:-1});break;case"waiting_to_publish":a.getName()==="subscribe_issued"&&(this.$FleetBeaconTestUIAnnouncer6=!0,this.$FleetBeaconTestUIAnnouncer7=Date.now()-this.$FleetBeaconTestUIAnnouncer13,f.extra=babelHelpers["extends"]({},f.extra,{subscribeSuccess:!0,subscribeLatencyMS:this.$FleetBeaconTestUIAnnouncer7}));a.getName()==="publish_issued"&&this.$FleetBeaconTestUIAnnouncer15(f);break;case"publish_issued":this.$FleetBeaconTestUIAnnouncer9+=1;this.$FleetBeaconTestUIAnnouncer14=Date.now();f.extra=babelHelpers["extends"]({},f.extra,{publishIssued:!0,payloadTimeoutInterval:(c=(b=this.$FleetBeaconTestUIAnnouncer2)==null?void 0:b.payloadTimeoutIntervalMS())!=null?c:-1});break;case"failed":a.getName()==="subscribe_issued"&&(e="SUBSCRIBE_FAILED");a.getName()==="publish_issued"&&(e="RECEIVE_PUBLISH_FAILED");this.$FleetBeaconTestUIAnnouncer16(f,"FAILURE",e);break;case"succeed":a.getName()==="publish_issued"&&this.$FleetBeaconTestUIAnnouncer15(f);this.$FleetBeaconTestUIAnnouncer16(f,"SUCCESS","NONE");break;case"aborted":a.getName()==="preparing"&&(e="CREATE_TEST_FAILED");a.getName()==="publish_issued"&&(e="MUTATE_FIELD_FAILED");this.$FleetBeaconTestUIAnnouncer16(f,"ABORT",e);break;case"finish":f.extra=babelHelpers["extends"]({},f.extra,{cleanUpFinish:!0});break;default:}this.$FleetBeaconTestUIAnnouncer1.forEach(function(a){a(f)})};c.$FleetBeaconTestUIAnnouncer15=function(a){this.$FleetBeaconTestUIAnnouncer10+=1;var b=Date.now()-this.$FleetBeaconTestUIAnnouncer14;this.$FleetBeaconTestUIAnnouncer11.push(b);a.extra=babelHelpers["extends"]({},a.extra,{payloadSuccess:!0,payloadSuccessCnt:this.$FleetBeaconTestUIAnnouncer10,payloadLatency:b})};c.$FleetBeaconTestUIAnnouncer16=function(a,b,c){a.extra=babelHelpers["extends"]({},a.extra,{testResult:b,failureReason:c})};return b}(b("FleetBeaconStateTransitionListener"));e.exports=a}),null);
__d("FleetBeaconSubscriptionNetwork",["regeneratorRuntime","Promise","CurrentUser","RelayModern","uuid","FleetBeaconSubscriptionNetwork_Subscription.graphql","FleetBeaconSubscriptionNetwork_PublishMutation.graphql","FleetBeaconSubscriptionNetwork_LogMutation.graphql"],(function(a,b,c,d,e,f){"use strict";var g,h,i;a=function(){function a(a){this.environment=a}var c=a.prototype;c.subscribe=function(a,c){return b("RelayModern").requestSubscription(this.environment,{subscription:g!==void 0?g:g=b("FleetBeaconSubscriptionNetwork_Subscription.graphql"),variables:{input:{test_id:a}},onError:c.onError,onNext:c.onNext})};c.publish=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:return d.abrupt("return",new(b("Promise"))(function(d,e){b("RelayModern").commitMutation(c.environment,{mutation:h!==void 0?h:h=b("FleetBeaconSubscriptionNetwork_PublishMutation.graphql"),variables:{input:{client_mutation_id:b("uuid")(),actor_id:b("CurrentUser").getAccountID(),test_id:a}},onCompleted:function(a){return d()},onError:e})}));case 1:case"end":return d.stop()}},null,this)};c.log=function(a){var c=this;return b("regeneratorRuntime").async(function(d){while(1)switch(d.prev=d.next){case 0:return d.abrupt("return",new(b("Promise"))(function(d,e){b("RelayModern").commitMutation(c.environment,{mutation:i!==void 0?i:i=b("FleetBeaconSubscriptionNetwork_LogMutation.graphql"),variables:{input:a},onCompleted:function(a){return d()},onError:e})}));case 1:case"end":return d.stop()}},null,this)};return a}();e.exports=a}),null);
__d("FleetBeaconTestSubscriptionLogger",["CurrentUser","FleetBeaconStateTransitionListener","RelayRTIUtils","uuid"],(function(a,b,c,d,e,f){a=function(a){babelHelpers.inheritsLoose(c,a);function c(b,c,d){var e;e=a.call(this)||this;e.$FleetBeaconTestSubscriptionLogger1=null;e.$FleetBeaconTestSubscriptionLogger2=b;e.$FleetBeaconTestSubscriptionLogger3=!1;e.$FleetBeaconTestSubscriptionLogger4=!1;e.$FleetBeaconTestSubscriptionLogger5=!1;e.$FleetBeaconTestSubscriptionLogger6=!1;e.$FleetBeaconTestSubscriptionLogger7=-1;e.$FleetBeaconTestSubscriptionLogger8=-1;e.$FleetBeaconTestSubscriptionLogger9=0;e.$FleetBeaconTestSubscriptionLogger10=0;e.$FleetBeaconTestSubscriptionLogger11=[];e.$FleetBeaconTestSubscriptionLogger12=-1;e.$FleetBeaconTestSubscriptionLogger13=-1;e.$FleetBeaconTestSubscriptionLogger14=-1;e.$FleetBeaconTestSubscriptionLogger15=c;e.$FleetBeaconTestSubscriptionLogger16=d;return e}var d=c.prototype;d.cleanState=function(){this.$FleetBeaconTestSubscriptionLogger3=!1,this.$FleetBeaconTestSubscriptionLogger4=!1,this.$FleetBeaconTestSubscriptionLogger5=!1,this.$FleetBeaconTestSubscriptionLogger6=!1,this.$FleetBeaconTestSubscriptionLogger7=-1,this.$FleetBeaconTestSubscriptionLogger8=-1,this.$FleetBeaconTestSubscriptionLogger9=0,this.$FleetBeaconTestSubscriptionLogger10=0,this.$FleetBeaconTestSubscriptionLogger11=[],this.$FleetBeaconTestSubscriptionLogger12=-1,this.$FleetBeaconTestSubscriptionLogger13=-1,this.$FleetBeaconTestSubscriptionLogger14=-1};d.onFleetBeaconStateTransition=function(a,b,c,d){this.$FleetBeaconTestSubscriptionLogger1==null&&(this.$FleetBeaconTestSubscriptionLogger1=d);c="NONE";switch(b.getName()){case"initial":break;case"preparing":this.$FleetBeaconTestSubscriptionLogger12=Date.now();this.$FleetBeaconTestSubscriptionLogger3=!0;break;case"before_subscribe":this.$FleetBeaconTestSubscriptionLogger13=Date.now();this.$FleetBeaconTestSubscriptionLogger4=!0;break;case"subscribe_issued":this.$FleetBeaconTestSubscriptionLogger5=!0;break;case"waiting_to_publish":a.getName()==="subscribe_issued"&&(this.$FleetBeaconTestSubscriptionLogger6=!0,this.$FleetBeaconTestSubscriptionLogger7=Date.now()-this.$FleetBeaconTestSubscriptionLogger13);a.getName()==="publish_issued"&&this.$FleetBeaconTestSubscriptionLogger17();break;case"publish_issued":this.$FleetBeaconTestSubscriptionLogger9+=1;this.$FleetBeaconTestSubscriptionLogger14=Date.now();break;case"failed":a.getName()==="subscribe_issued"&&(c="SUBSCRIBE_FAILED");a.getName()==="publish_issued"&&(c="RECEIVE_PUBLISH_FAILED");this.$FleetBeaconTestSubscriptionLogger18("FAILURE",c);break;case"succeed":a.getName()==="publish_issued"&&this.$FleetBeaconTestSubscriptionLogger17();this.$FleetBeaconTestSubscriptionLogger18("SUCCESS","NONE");break;case"aborted":a.getName()==="preparing"&&(c="CREATE_TEST_FAILED");a.getName()==="publish_issued"&&(c="MUTATE_FIELD_FAILED");this.$FleetBeaconTestSubscriptionLogger18("ABORT",c);break;default:}};d.$FleetBeaconTestSubscriptionLogger17=function(){this.$FleetBeaconTestSubscriptionLogger10+=1;var a=Date.now()-this.$FleetBeaconTestSubscriptionLogger14;this.$FleetBeaconTestSubscriptionLogger11.push(a)};d.$FleetBeaconTestSubscriptionLogger18=function(a,c){var d,e=this,f=this.$FleetBeaconTestSubscriptionLogger12=Date.now()-this.$FleetBeaconTestSubscriptionLogger12,g=parseInt(this.$FleetBeaconTestSubscriptionLogger11.reduce(function(a,b){return a+b},0)/this.$FleetBeaconTestSubscriptionLogger10,10);d=(d=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:d.getTestID();if(d==null)return;this.$FleetBeaconTestSubscriptionLogger2.log({client_mutation_id:b("uuid")(),actor_id:b("CurrentUser").getAccountID(),test_id:d,test_name:"Web_Manual",test_result:a,failure_reason:c,subscribe_issued:this.$FleetBeaconTestSubscriptionLogger5,subscribe_success:this.$FleetBeaconTestSubscriptionLogger6,subscribe_latency_ms:this.$FleetBeaconTestSubscriptionLogger7,subscribe_timeout_interval_ms:(d=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:d.subscribeTimeoutIntervalMS(),publish_success:this.$FleetBeaconTestSubscriptionLogger10>0,publish_latency_ms:g,publish_timeout_interval_ms:(a=this.$FleetBeaconTestSubscriptionLogger1)==null?void 0:a.payloadTimeoutIntervalMS(),test_duration_ms:f,triggering_subscription:(c=this.$FleetBeaconTestSubscriptionLogger15)!=null?c:"manual",app_id:b("RelayRTIUtils").GRAPH_SERVICES_SDK_APP_ID}).then(function(a){e.$FleetBeaconTestSubscriptionLogger16(!0)})["catch"](function(a){e.$FleetBeaconTestSubscriptionLogger16(!1)})};return c}(b("FleetBeaconStateTransitionListener"));e.exports=a}),null);
__d("FleetBeaconTestSubscription",["FleetBeaconTestBase","FleetBeaconTestSubscriptionLogger","FleetBeaconTestUIAnnouncer","uuid"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(c,a);function c(c,d,e){var f;f=a.call(this)||this;f.onCleanUpFleetBeaconFinish=function(a){f.onCleanUpFinish()};f.$FleetBeaconTestSubscription1=c;f.$FleetBeaconTestSubscription3=null;f.$FleetBeaconTestSubscription4=e;f.$FleetBeaconTestSubscription6=new(b("FleetBeaconTestSubscriptionLogger"))(c,d,f.onCleanUpFleetBeaconFinish);f.$FleetBeaconTestSubscription5=new(b("FleetBeaconTestUIAnnouncer"))();a.prototype.addStateTransitionListener.call(babelHelpers.assertThisInitialized(f),f.$FleetBeaconTestSubscription6);a.prototype.addStateTransitionListener.call(babelHelpers.assertThisInitialized(f),f.$FleetBeaconTestSubscription5);f.cleanPreviousFleetBeaconResult();return f}var d=c.prototype;d.cleanPreviousFleetBeaconResult=function(){a.prototype.cleanPreviousFleetBeaconResult.call(this),this.$FleetBeaconTestSubscription2=b("uuid")()};d.getTestID=function(){return this.$FleetBeaconTestSubscription2};d.getFleetBeaconUIAnnouncer=function(){return this.$FleetBeaconTestSubscription5};d.prepareFleetBeaconTest=function(){this.onPrepareFleetBeaconSuccess()};d.subscribe=function(){var a=this,b=this.$FleetBeaconTestSubscription2;if(b==null)return;this.$FleetBeaconTestSubscription3=this.$FleetBeaconTestSubscription1.subscribe(b,{onNext:function(){a.onPayloadReceived()},onError:function(){}});this.onSubscribe()};d.publish=function(){var b=this,c=this.$FleetBeaconTestSubscription2;if(c==null)return;this.$FleetBeaconTestSubscription1.publish(c)["catch"](function(c){a.prototype.onPublishFailed.call(b)})};d.cleanUpFleetBeacon=function(){};d.$FleetBeaconTestSubscription7=function(){var a;(a=this.$FleetBeaconTestSubscription3)==null?void 0:a.dispose()};d.onFleetBeaconStateTransition=function(b,c){a.prototype.onFleetBeaconStateTransition.call(this,b,c);b=c.getName();b==="finish"&&(this.$FleetBeaconTestSubscription4(),this.$FleetBeaconTestSubscription7())};return c}(b("FleetBeaconTestBase"));e.exports=a}),null);
__d("FleetBeaconSubscriptionLauncher",["FleetBeaconRunner","FleetBeaconSubscriptionNetwork","FleetBeaconTestSubscription"],(function(a,b,c,d,e,f){"use strict";f.CreateFleetBeaconTestSubscription=a;f.LaunchFleetBeaconTestSubscription=c;function a(a,c,d){a=new(b("FleetBeaconTestSubscription"))(new(b("FleetBeaconSubscriptionNetwork"))(a),c,d);return a}function c(a){var c=new(b("FleetBeaconRunner"))(a);a.setFleetBeaconRunner(c);c.prepareFleetBeaconTest()}}),null);
__d("MqttLongPollingHookCollection",[],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1=new Set()}var b=a.prototype;b.addHook=function(a){this.$1.add(a)};b.removeHook=function(a){this.$1["delete"](a)};b.onPollRequestSent=function(){this.$1.forEach(function(a){a.onPollRequestSent()})};b.onPollRequestSuccess=function(){this.$1.forEach(function(a){a.onPollRequestSuccess()})};b.onPollResponse=function(a){this.$1.forEach(function(b){b.onPollResponse(a)})};b.onPollFinish=function(){this.$1.forEach(function(a){a.onPollFinish()})};b.onPollRequestFailed=function(a){this.$1.forEach(function(b){b.onPollRequestFailed(a)})};return a}();e.exports=a}),null);
__d("PromiseResult",["Promise"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){var a=this;this.promise=new(b("Promise"))(function(b,c){a.$1=b,a.$2=c})}var c=a.prototype;c.resolve=function(a){this.$1(a)};c.reject=function(a){this.$2(a)};return a}();e.exports=a}),null);
__d("MqttFetchClient",["Promise","MqttEnv","MqttProtocolCodec","MqttUtils","PromiseResult"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttProtocolCodec").WireMessage,i=b("MqttProtocolCodec").decodeByteMessages,j=b("MqttProtocolCodec").MESSAGE_TYPE,k="fetch_pull",l="fetch_pull_finish",m="fetch_",n=6e4,o="action",p="chunked",q="send",r="true",s=5,t=20,u=10,v=5e3;a=function(){function a(){this.$1="",this.$2=g.getLoggerInstance(),this.$3=0,this.$4="",this.$6=function(){},this.$7=function(a){},this.$8=function(){},this.$9=function(a){},this.$10=0,this.$11=0,this.$12=0,this.$13=0,this.$14="Ready",this.$15=[],this.$16=[],this.$17=null,this.$18=!1,this.$19=0}a.isSupported=function(){return typeof fetch==="function"};var c=a.prototype;c.run=function(a,c,d,e,f,g,h,i){this.$1=b("MqttUtils").endpointWithSessionId(a,c),this.$3=c,this.$4=d,this.$5=e,this.$6=f,this.$7=g,this.$8=h,this.$9=i,this.$20()};c.isTopicSupported=function(a){return!0};c.publish=function(a,c){if(this.$14!=="ReceivingData"){this.$2.bumpCounter(m+"publish."+a+".invalidstate");return b("Promise").reject("not connected")}else{this.$2.bumpCounter(m+"publish."+a+".publish");var d=new(b("PromiseResult"))();a={topic:a,payload:c,promiseResult:d};this.$15.push(a);this.$21();return d.promise}};c.abort=function(){this.$6=function(){},this.$7=function(a){},this.$8=function(){},this.$9=function(a){}};c.$22=function(a){var b=this;a.forEach(function(a){b.$2.bumpCounter(m+"publish."+a.topic+".resolved"),a.promiseResult.resolve()});this.$12+=a.length};c.$23=function(a,b){var c=this;a.forEach(function(a){c.$2.bumpCounter(m+"publish."+a.topic+".rejected"),a.promiseResult.reject(b)})};c.$24=function(a,b,c,d){var e=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request failed. Publishes:"+e+", retry:"+c);this.$2.bumpCounter(m+"publish_request_failed");this.$14!="ReceivingData"||c===s?(this.$23(a,d),this.$18=!1,this.$2.bumpCounter(m+"publish_request_failed_final"),this.$21()):this.$25(a,b,c+1)};c.$26=function(a,b,c,d){if(!d.ok){this.$2.bumpCounter(m+"publish_request_failed.http."+d.status);if(d.status===409){this.$19++;if(this.$19>=u){this.$2.bumpCounter(m+"409_reset");this.$27(new Error("Too many 409 errors"));return}}this.$24(a,b,c,this.$28(d));return}this.$2.bumpCounter(m+"publish_request_success");b=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request success. Publishes:"+b+", retry:"+c);this.$22(a);this.$18=!1;this.$21()};c.$21=function(){if(this.$14!="ReceivingData")return;if(this.$18)return;if(this.$15.length==0&&this.$16.length==0)return;this.$18=!0;var a=this.$15.slice(0,t);this.$15=this.$15.slice(t,this.$15.length);clearTimeout(this.$17);this.$17=null;var b=this.$16.slice(0,t);this.$16=this.$16.slice(t,this.$16.length);this.$25(a,b,0)};c.$25=function(a,c,d){var e=this,f=a.map(function(a){return a.topic}).join(",");this.$2.debugTrace("FetchClient","Fetch publish request sent. Publishes:"+f+", retry:"+d);f=b("MqttUtils").endpointWithExtraParameter(this.$1,o,q);var h=a.map(function(a){return{topic:a.topic,payload:a.payload,qos:0,messageId:g.random()}});h=this.$5.gen(this.$3,[],h,c);this.$2.bumpCounter(m+"publish_request");b("MqttUtils").promiseDoneWithTimeout(fetch(f,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:h,keepalive:!1}),function(b){return e.$26(a,c,d,b)},function(b){return e.$24(a,c,d,b)},n)};c.$29=function(a){a=a.message;this.$2.debugTrace("FetchClient","Fetch request failed with error:"+a);this.$9(a);this.$30(!1,a);this.$2.bumpCounter(m+"error");this.$14="Error"};c.$31=function(a){var b=this;this.$2.debugTrace("FetchClient","Fetch response data received");a=i(new Uint8Array(a));a=a.messages;var c=a.filter(function(a){return a.messageType===j.PINGREQ});a=a.filter(function(a){return a.messageType===j.PUBLISH}).map(function(a){if(!(a instanceof h.Publish))return{};a=a;a.qos===1&&a.messageIdentifier!=null&&(b.$16.push(a.messageIdentifier),b.$17==null&&(b.$17=g.setTimeout(function(){b.$21()},v)));return{topic:a.topic,payload:a.payloadMessage.payloadString,qos:a.qos}});for(var d=a,e=Array.isArray(d),f=0,d=e?d:d[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(e){if(f>=d.length)break;k=d[f++]}else{f=d.next();if(f.done)break;k=f.value}k=k;this.$2.bumpCounter(m+"response_"+k.topic)}a&&a.length>0&&(this.$13+=a.length,this.$7(a));c&&c.length>0&&this.$32()};c.$32=function(){this.$2.debugTrace("FetchClient","Got server ping request"),this.$2.bumpCounter(m+"ping")};c.$27=function(a){this.$2.debugTrace("FetchClient","Fetch request ended: "+a.toString()),this.$2.bumpCounter(m+"done"),this.$33(a.message),this.$8(),this.$14="Done"};c.$34=function(a,c,d){var e=this;if(d!==null&&d!==void 0)try{this.$31(d)}catch(a){this.$27(a);this.$2.bumpCounter(m+"dataDecodeException");return}if(c){this.$27(new Error("EOF"));return}b("MqttUtils").promiseDone(a.read(),function(c){var b=c.done;c=c.value;return e.$34(a,b,c)},function(a){return e.$27(a)})};c.$35=function(a){if(!a.ok){this.$2.bumpCounter(m+"error.http."+a.status);this.$29(this.$28(a));return}a=a.body;if(!a){this.$29(new Error("Empty body"));return}a=a.getReader();this.$6();this.$2.bumpCounter(m+"success");this.$30(!0,null);this.$11=Date.now();this.$14="ReceivingData";this.$2.debugTrace("FetchClient","Fetch request success");this.$34(a,!1,null)};c.$33=function(a){this.$2.eventLogPullFinish({pullEventName:l,sessionID:this.$3,duration:Date.now()-this.$11,errorMessage:a,publishReceived:this.$13,publishSent:this.$12})};c.$30=function(a,b){this.$2.eventLogPull({pullEventName:k,sessionID:this.$3,status:a,duration:Date.now()-this.$10,hostname:this.$1,errorMessage:b})};c.$20=function(){var a=this;if(this.$14!="Ready")return;this.$2.debugTrace("FetchClient","Sending fetch request");this.$2.bumpCounter(m+"request");this.$10=Date.now();var c=b("MqttUtils").endpointWithExtraParameter(this.$1,p,r);b("MqttUtils").promiseDoneWithTimeout(fetch(c,{method:"POST",mode:"cors",cache:"no-cache",credentials:"include",referrer:"no-referrer",body:this.$4,keepalive:!1}),function(b){return a.$35(b)},function(b){return a.$29(b)},n)};c.$28=function(a){return new Error("Http error, status="+a.status)};return a}();e.exports=a}),null);
__d("MqttLongPollingClient",["Promise","MqttEnv","MqttProtocolCodec","XHRRequest","getCrossOriginTransport"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttProtocolCodec").WireMessage,i=b("MqttProtocolCodec").decodeByteMessages,j=120*1e3,k="simple_pull";a=function(){function a(){this.$3="",this.$4=0,this.$2=g.getLoggerInstance(),this.$1="Ready",this.$5="",this.$7=function(){},this.$8=function(a){},this.$9=function(){},this.$10=function(a){},this.$11=0,this.$12=null,this.$13=new Set(["/t_ms","/messenger_sync_get_diffs","/messenger_sync_create_queue","/webrtc","/rtc_multi"])}var c=a.prototype;c.run=function(a,b,c,d,e,f,g,h){this.$3=a,this.$4=b,this.$5=c,this.$6=d,this.$7=e,this.$8=f,this.$9=g,this.$10=h,this.$14(this.$5)};c.isTopicSupported=function(a){return this.$13.has(a)};c.publish=function(a,c){return b("Promise").reject("not supported")};c.abort=function(){this.$12!=null&&this.$12.abort("Disconnected")};c.$15=function(a,b){if(this.$1===a)return;this.$1=a;a=="Error"&&b!=null&&this.$10(b)};c.$16=function(a){if(this.$1!="RequestSend")return;if(!a){this.$17("EmptyResponse",null);return}this.$7();this.$18(!0,null);this.$15("ResponseReceived");a=i(new Uint8Array(a));a=a.messages.filter(function(a){return a instanceof h.Publish}).map(function(a){if(a instanceof h.Publish){a=a;return{topic:a.topic,payload:a.payloadMessage.payloadString,qos:a.qos}}else return{}});this.$8(a);this.$9()};c.$17=function(a,b){b=b!=null?b.message:"null";this.$2.debugTrace("LongPollingClient Error","Poll failed with error:"+a+", errorMsg:"+b);this.$18(!1,a+":"+b);this.$15("Error",a)};c.$18=function(a,b){this.$2.eventLogPull({pullEventName:k,sessionID:this.$4,status:a,duration:Date.now()-this.$11,hostname:this.$3,errorMessage:b})};c.$14=function(a){var c=this;if(this.$1!="Ready"||this.$12)return;try{this.$11=Date.now(),this.$12=new(b("XHRRequest"))(this.$3).setResponseType("arraybuffer").setRawData(a).setTransportBuilder(b("getCrossOriginTransport").withCredentials).setResponseHandler(function(a){return c.$16(a)}).setNetworkFailureHandler(function(a){c.$17("Network",a)}).setErrorHandler(function(a){c.$17("Error",a)}).setAbortHandler(function(a){c.$17("Abort",null)}).setTimeoutHandler(function(){c.$17("Timeout",null)}).setTimeout(j).send(),this.$15("RequestSend")}catch(a){this.$17("Error",a)}};return a}();e.exports=a}),null);
__d("exponentialBackoff",["MqttEnv"],(function(a,b,c,d,e,f){var g=b("MqttEnv").Env;function a(a,b){b===void 0&&(b=null);var c=null,d=0;function e(){for(var e=arguments.length,f=new Array(e),h=0;h<e;h++)f[h]=arguments[h];var i=function(){a.apply(b,f)};if(c===null){var j=Math.max(0,Math.pow(2,Math.min(d,6))*(1e3+g.random()*100)-2e3);c=g.setTimeout(function(){i(),c=null},j)}d++}e.reset=function(){d=0,c!=null&&(g.clearTimeout(c),c=null)};e.isPending=function(){return c!=null};return e}e.exports=a}),null);
__d("MqttLongPollingRunner",["Promise","MqttEnv","MqttFetchClient","MqttLongPollingClient","MqttLongPollingHookCollection","MqttTypes","MqttUtils","exponentialBackoff"],(function(a,b,c,d,e,f){"use strict";var g=b("MqttEnv").Env,h=b("MqttEnv").MqttGkNames,i=b("MqttTypes").MqttChannelError,j=4,k=1e3,l=3e3,m="mqtt_should_longpoll",n="last_lp",o="yes",p="no";a=function(){function a(a,c,d,e,f,j,k,l,m){var n=this;this.$23=function(){try{if(!n.$29())return;var a=n.$30();n.$14=a;var c=n.$9(),d=n.$10();c=c.filter(function(b){return a.isTopicSupported(b)});d=d.filter(function(b){return a.isTopicSupported(b.topic)});if(c.length==0&&d.length==0){n.$5.debugTrace("LongPollingRunner","Poll skipped, nothing to do");n.$14=null;g.setTimeout(function(){n.$23()},1e3);return}var e=b("MqttUtils").generateSessionId();a.run(n.$6,e,n.$7.gen(e,c,d),n.$7,function(){return n.$31()},function(a){return n.$32(a)},function(){return n.$33()},function(a){return n.$34(a)});n.$19.onPollRequestSent();e=c.join(",");c=d.map(function(a){return a.topic}).join(",");n.$5.debugTrace("LongPollingRunner","Making a poll request to "+n.$6+". SubscribedTopics:"+e+". Publishes:"+c)}catch(a){a&&n.$5.logErrorWarn(a,"lp_js_error"),n.$11(new i(!1,"js error lp",a)),n.$34("lp_js_error")}};this.$6=a;this.$7=c;this.$1=e;this.$2=0;this.$3=d;this.$4=b("MqttUtils").hasWSSupport();this.$5=g.getLoggerInstance();this.$8=f;this.$9=j;this.$10=k;this.$11=l;this.$12=m;this.$13=!1;this.$14=null;this.$15="LPInactive";this.$16="NotSent";this.$17=0;this.$19=new(b("MqttLongPollingHookCollection"))();this.$18=new(b("exponentialBackoff"))(this.$23,this);this.$20=0;this.$21=p;a=g.genGk(h.mqtt_lp_use_fetch);c=b("MqttFetchClient").isSupported();a?this.$5.bumpCounter("fetch_gk_pass"):this.$5.bumpCounter("fetch_gk_fail");c?this.$5.bumpCounter("fetch_api_supported"):this.$5.bumpCounter("fetch_api_not_supported");this.$22=a&&c}var c=a.prototype;c.addHook=function(a){this.$19.addHook(a)};c.start=function(){var a=this;this.$21=g.configRead(n,p);this.$5.debugTrace("LongPollingRunner","Runner loaded, last status "+this.$21);this.$20=Date.now();this.$23();g.setTimeout(function(){a.$23()},k+100);g.setTimeout(function(){a.$23()},l+100)};c.canPublish=function(){return this.$15==="LPActive"&&this.$16==="ReceivingData"};c.publish=function(a,c,d){return g.genGk(h.mqtt_enable_publish_over_polling)&&(this.$14&&this.$14.isTopicSupported(a))?this.$14.publish(a,c):b("Promise").reject()};c.onConnectAttempt=function(){};c.onConnectFailure=function(){this.$2++,this.$23()};c.onConnected=function(){};c.onConnectSuccess=function(){this.$1=!0,g.configWrite(n,null)};c.onConnectionLost=function(){};c.onSubscribe=function(a){};c.onUnsubscribe=function(a){};c.onPublish=function(a){};c.onMessage=function(a){};c.onWSFatal=function(){this.$3=!0,this.$23()};c.getStatus=function(){return this.$15};c.getRequestStatus=function(){return this.$16};c.$24=function(a){a!=this.$15&&(this.$5.debugTrace("LongPollingRunner","status changed to "+a+" from "+this.$15),this.$15=a,this.$12(this.$15,this.$16))};c.$25=function(a){if(!this.$22)return;a!==this.$16&&(this.$5.debugTrace("LongPollingRunner","request status changed to "+a+" from "+this.$16),this.$16=a,this.$12(this.$15,this.$16))};c.$26=function(){this.$17=0};c.$27=function(){this.$17++,this.$17>=j&&this.$24("LPError")};c.$28=function(){var a=g.genGk(h.mqtt_lp_no_delay),b=g.genGk(h.mqtt_ws_polling_enabled),c=g.genGk(h.mqtt_fast_lp);this.$5.debugTrace("LongPollingRunner","_shouldPoll? pollNow:"+String(a)+" enabled:"+String(b)+" fastPoll:"+String(c)+" hasWSSupport:"+String(this.$4)+" hasSuccess:"+String(this.$1)+" failureCount:"+this.$2+" wsFatal:"+String(this.$3));if(!b)return!1;if(a){this.$5.bumpCounter(m+".nd");return!0}if(!this.$4){this.$5.bumpCounter(m+".na");return!0}if(this.$3){this.$5.bumpCounter(m+".fatal");return!0}if(this.$1)return!1;if(c){b=Date.now()-this.$20;if(this.$21===o){if(this.$2>=1)return!0;if(b>k){this.$5.bumpCounter(m+".fastdelay");return!0}}else if(b>l){this.$5.bumpCounter(m+".regulardelay");return!0}}if(this.$2>=3){this.$5.bumpCounter(m+".failure");return!0}return!1};c.$29=function(){if(this.$14!=null)return!1;var a=this.$28();!this.$13&&a&&(this.$5.bumpCounter("polling_kickin"),this.$13=!0,this.$24("LPActive"),this.$26());this.$13&&!a&&(this.$5.bumpCounter("polling_stopped"),this.$13=!1,this.$24("LPInactive"),this.$26());return a};c.$30=function(){if(this.$22){this.$5.debugTrace("LongPollingRunner","Creating polling client using Fetch API");return new(b("MqttFetchClient"))()}else{this.$5.debugTrace("LongPollingRunner","Creating regular Polling client");return new(b("MqttLongPollingClient"))()}};c.$31=function(){this.$5.debugTrace("LongPollingRunner","Poll success"),this.$19.onPollRequestSuccess(),this.$18.reset(),this.$24("LPActive"),this.$26(),g.configWrite(n,o),this.$25("ReceivingData")};c.$32=function(a){var b=a.map(function(a){return a.topic}).join(",");this.$5.debugTrace("LongPollingRunner","Poll response received, message received:"+b);for(var b=0;b<a.length;b++){var c=a[b];this.$19.onPollResponse(c.topic);this.$8(c.topic,c.payload,c.qos)}};c.$33=function(){this.$5.debugTrace("LongPollingRunner","Poll finish"),this.$19.onPollFinish(),this.$14&&this.$14.abort(),this.$14=null,this.$23(),this.$25("NotSent")};c.$34=function(a){this.$19.onPollRequestFailed(a),this.$14&&this.$14.abort(),this.$14=null,this.$18(),this.$27(),this.$25("NotSent")};return a}();e.exports=a}),null);
__d("MercuryAPIArgsSource",[],(function(a,b,c,d,e,f){e.exports={CHAT:"chat",JEWEL:"jewel",MERCURY:"mercury",MERCURYSYNC:"mercury_sync",WEBMESSENGER:"web_messenger",MESSENGER:"messenger"}}),null);
__d("MercuryAudioType",[],(function(a,b,c,d,e,f){e.exports={FileAttachment:"file_attachment",AudioClip:"fb_voice_message",VoiceMessageWithTranscript:"fb_voice_message_with_transcript"}}),null);
__d("MessageLiveLocationClientSyncProtocolStopReason",[],(function(a,b,c,d,e,f){e.exports={EXPIRED:1,CANCELED:2,ARRIVED:3}}),null);
__d("PageCommItemStatus",[],(function(a,b,c,d,e,f){e.exports={FOLLOW_UP:"FOLLOW_UP",DONE:"DONE",TODO:"TODO",SPAM:"SPAM",DELETED:"DELETED"}}),null);
__d("MercurySyncHolesTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(){this.$1={}}var c=a.prototype;c.log=function(a){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").BASIC,a)};c.logVital=function(a){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,b("Banzai").VITAL,a)};c.logImmediately=function(a){b("GeneratedLoggerUtils").log("logger:MercurySyncHolesLoggerConfig",this.$1,{signal:!0},a)};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setDifference=function(a){this.$1.difference=a;return this};c.setSeqID=function(a){this.$1.seq_id=a;return this};c.setTopicType=function(a){this.$1.topic_type=a;return this};return a}();c={difference:!0,seq_id:!0,topic_type:!0};e.exports=a}),null);
__d("MessengerSharedMediaActionsLoader",["JSResource"],(function(a,b,c,d,e,f){"use strict";f.deletePhotos=a;function a(a,c){b("JSResource").loadAll([b("JSResource")("MessengerSharedMediaActions").__setRef("MessengerSharedMediaActionsLoader")],function(b){b.deletePhotos(a,c)})}}),null);
__d("MercuryMessageIDs.bs",["bs_curry","bs_js_dict","KeyedCallbackManager"],(function(a,b,c,d,e,f){"use strict";var g=new(b("KeyedCallbackManager"))();function a(a,c){var d=a.filter(function(a){return a.indexOf("id")===-1}),e=function(d){return b("bs_curry")._1(c,a.map(function(a){var c=b("bs_js_dict").get(d,a);if(c!==void 0)return c;else return a}))};return g.executeOrEnqueue(d,e)}function c(a,b){g.setResource(a,b)}f.getServerIDs=a;f.addServerID=c}),null);
__d("MessengerAttachmentTransformerForSend.bs",["MercuryAttachmentType","MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d,e){c=c.node;if(c==null)return{attach_type:b("MercuryAttachmentType").ERROR};if(c.__typename==="ExtensibleMessageAttachment"){var f=c.story_attachment,g=c.genie_attachment,h;if(g==null)h=null;else{g=g.genie_message;var i;if(g==null)i=null;else{g=g.story_attachment;i={story_attachment:g==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(g)}}h={genie_message:i}}g={legacy_attachment_id:c.legacy_attachment_id,story_attachment:f==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(f),genie_attachment:h}}else g=null;i=c.__typename==="Sticker"?c:null;f=c.__typename;var j;switch(f){case"MessageAnimatedImage":case"MessageAudio":case"MessageFile":case"MessageImage":case"MessageVideo":j=[c];break;default:j=null}h=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments({blob_attachments:j});f=b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:g,blob_attachments:h,sticker:i},d,e);if(f.length!==0)return f[0];else return{}}function a(a,b,c,d){return b.map(function(b){return g(a,b,c,d)})}f._transform=g;f.transform=a}),null);
__d("MessengerFolders.bs",["gkx","qex","MessagingThreadType","MercuryFoldersConfig","MessengerEnvironment"],(function(a,b,c,d,e,f){"use strict";d=b("qex")._("998180")&&b("MessengerEnvironment").messengerdotcom?["inbox","pending","other","action:archived","marketplace_folder"]:["inbox","pending","other","action:archived"];var g=d.filter(function(a){if(a==="pending")return!b("MercuryFoldersConfig").hide_message_filtered;else if(a==="other")return!b("MercuryFoldersConfig").hide_message_requests;else return!0});function a(a){return[].concat(g)}function c(a){if(a.is_archived)return"action:archived";var c=a.thread_type;if(!(c==null)&&c===b("MessagingThreadType").MARKETPLACE&&b("gkx")("965951"))return"marketplace_folder";else return a.folder}f.getSupportedFolders=a;f.getFromMeta=c}),null);
__d("MercuryActionStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNSENT:0,SUCCESS:1,UNCONFIRMED:3,FAILED_UNKNOWN_REASON:4,UNABLE_TO_CONFIRM:5,RESENT:6,RESENDING:7,ERROR:10});e.exports=a}),null);
__d("MercuryMessageDeliveryState",[],(function(a,b,c,d,e,f){"use strict";a=Object.freeze({SENDING:1,SENT:2,DELIVERED:3,ERROR:0,UNKNOWN:-1});e.exports=a}),null);
__d("MercuryPayloadSource",[],(function(a,b,c,d,e,f){a=Object.freeze({UNKNOWN:"unknown",CLIENT_CHANNEL_MESSAGE:"client_channel_message",CLIENT_SEND_MESSAGE:"client_send_message",CLIENT_CHANGE_ARCHIVED_STATUS:"client_change-archived_status",CLIENT_CHANGE_PINNED_MESSAGES:"client_change-pinned_messages",CLIENT_CHANGE_PINNED_STATUS:"client_change-pinned_status",CLIENT_CHANGE_PAGE_FOLLOW_UP_STATUS:"client_change_page_follow_up_status",CLIENT_CHANGE_FOLDER:"client_change_folder",CLIENT_CHANGE_MUTE_SETTINGS:"client_change_mute_settings",CLIENT_CHANGE_READ_STATUS:"client_change_read_status",CLIENT_CHANGE_CUSTOM_LIKE:"client_change_custom_like",CLIENT_MARK_THREAD_SEEN:"client_mark_thread_seen",CLIENT_ADD_PARTICIPANTS:"client_add_participants",CLIENT_FETCH_PARTICIPANTS:"client_fetch_participants",CLIENT_DELETE_MESSAGES:"client_delete_messages",CLIENT_DELETE_THREAD:"client_delete_thread",CLIENT_UPDATE_SNIPPET:"client_update_snippet",CLIENT_HANDLE_ERROR:"client_handle_error",CLIENT_CHANGE_FLAG:"client_change_flag",CLIENT_MOVE_PENDING_TO_INBOX:"client_move_pending_to_inbox",CLIENT_CREATE_PAGE_ADMIN_NOTE:"client_create_page_admin_note",CLIENT_UNWRAP_MESSAGE:"client_unwrap_message",CLIENT_UPDATE_COMM_STATUS:"client_update_comm_status",CLIENT_UPDATE_COMM_ITEM_OWNER:"client_update_comm_item_owner",CLIENT_CHANGE_SAVED_MESSAGE_STATUS:"client_update_saved_message_status",SERVER_INITIAL_DATA:"server_initial_data",SERVER_SEND_MESSAGE:"server_send_message",SERVER_CHANGE_ARCHIVED_STATUS:"server_change_archived_status",SERVER_CHANGE_PINNED_MESSAGES:"server_change-pinned_messages",SERVER_CHANGE_PINNED_STATUS:"server_change_pinned_status",SERVER_CHANGE_PAGE_FOLLOW_UP_STATUS:"server_change_page_follow_up_status",SERVER_CHANGE_READ_STATUS:"server_change_read_status",SERVER_MARK_FOLDER_READ:"server_mark_folder_read",SERVER_MARK_SEEN:"server_mark_seen",SERVER_FETCH_PARTICIPANTS:"server_fetch_participants",SERVER_FETCH_THREAD_INFO:"server_fetch_thread_info",SERVER_FETCH_THREADLIST_INFO:"server_fetch_threadlist_info",SERVER_STANDALONE_NOTIFICATIONS:"server_standalone_notifications",SERVER_THREAD_SYNC:"server_thread_sync",SERVER_TAB_PRESENCE:"server_tab_presence",SERVER_UNREAD_THREADS:"server_unread_threads",SERVER_UNSEEN_THREADS:"server_unseen_threads",SERVER_SEARCH:"server_search",SERVER_CHANGE_FLAG:"server_change_flag",SERVER_INVALIDATE_THREAD_STATE:"server_invalidate_thread_state",SERVER_INVALIDATE_GLOBAL_STATE:"server_invalidate_global_state"});e.exports=a}),null);
__d("MercuryViewer",["CurrentUser","MercuryAssert"],(function(a,b,c,d,e,f){"use strict";f.getID=a;f.isViewer=c;var g="fbid:"+b("CurrentUser").getID();function a(){return g}function c(a){b("MercuryAssert").isParticipantID(a);return a===g}}),null);
__d("MessengerMessage.bs",["URI","Utils.bs","bs_js_dict","bs_js_json","bs_caml_obj","bs_caml_option","MercuryViewer","bs_caml_primitive","MercuryActionType","MercuryActionStatus","MercuryPayloadSource","isMessengerDotComURI","MercuryLogMessageType","MercuryMessageDeliveryState"],(function(a,b,c,d,e,f){"use strict";var g;function a(a,b,c,d,e,f){b={thread_id:b,thread_fbid:null,other_user_fbid:null,action_type:d,message_id:a,threading_id:null,offline_threading_id:null,author:c,author_email:"",ephemeral_ttl_mode:null,timestamp:e,is_unread:null,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,is_sponsored:!1,is_one_way_sent:!1,ad_id:null,ad_client_token:null,commerce_message_type:null,customizations:[],source:"",source_tags:[],m_suggestions:null,tags:[],is_spoof_warning:!1,folder:"inbox",platform_xmd:null,message_source:null,montage_reply_data:null,replied_to_message:null,skip_bump_thread:!1,profile_ranges:null,reactions:null,attachments:null,ranges:null,meta_ranges:null,status:null,log_message_type:null,log_message_data:null,log_message_body:null,raw_attachments:null,body:null,subject:null,has_attachment:null,creator_info:null,error_data:null,removed_timestamp:null,unsender:null,verse_group_role_xmd:null,message_unsendability_status:null,is_forwarded:!1,preview_attachments:null,sticker_id:null,mib_direct_message_data:null};return Object.assign(b,f)}function c(a){var b=a.offline_threading_id;if(b==null)return!1;else return b===a.message_id}function d(a){if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE))return!0;a=a.log_message_type;if(a==null)return!0;else return!(b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").SUBSCRIBE)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").UNSUBSCRIBE)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").SERVER_ERROR)||b("bs_caml_obj").caml_equal(a,b("MercuryLogMessageType").LIVE_LISTEN))}function e(a){var c=a.ranges;if(c==null)return;c=c.map(function(a){var c=a.entity;if(c==null)return a;var d=b("Utils.bs").isTruthy(c.external),e=c.url;if(d)return a;if(e==null)return a;d=new(g||(g=b("URI")))(e);e=b("isMessengerDotComURI")(g.getRequestURI());var f=d.getDomain();if(!e)return a;return!(f==null)&&f!==""?a:Object.assign(Object.assign({},a),{entity:Object.assign(Object.assign({},c),{url:d.setProtocol("https").setDomain("www.facebook.com").toString()})})});Object.assign(a,{ranges:c})}function h(a){if(b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").UNKNOWN)||b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_INITIAL_DATA)||b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO))return!0;else return b("bs_caml_obj").caml_equal(a,b("MercuryPayloadSource").SERVER_THREAD_SYNC)}function i(a){a=a.author;if(a==null)return!1;else return a===b("MercuryViewer").getID()}function j(a){a=a.author;if(a==null)return!1;else return a!==b("MercuryViewer").getID()}function k(a){a=a.status;if(a==null)return!1;else if(b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").UNSENT)||b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").UNCONFIRMED)||b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").UNABLE_TO_CONFIRM))return!0;else return b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").RESENDING)}function l(a){a=a.status;if(a==null)return!0;else return b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").SUCCESS)}function m(a,c){return b("bs_caml_primitive").caml_float_compare(a.timestamp,c.timestamp)}function n(a){a=a.status;if(a==null)return!1;else if(b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").FAILED_UNKNOWN_REASON)||b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").UNABLE_TO_CONFIRM))return!0;else return b("bs_caml_obj").caml_equal(a,b("MercuryActionStatus").ERROR)}function o(a){a=a.error_data;if(!(a==null))return b("bs_caml_option").nullable_to_opt(a.description)}function p(a,c){if(n(a))return b("MercuryMessageDeliveryState").ERROR;else if(k(a))return b("MercuryMessageDeliveryState").SENDING;else if(l(a))if(a.is_one_way_sent||a.timestamp>c)return b("MercuryMessageDeliveryState").SENT;else return b("MercuryMessageDeliveryState").DELIVERED;else return b("MercuryMessageDeliveryState").UNKNOWN}function q(a,b){if(n(a))return 4;else if(k(a))return 1;else if(l(a))if(a.timestamp<=b&&!a.is_one_way_sent)return 3;else return 2;else return 0}function r(a){try{a=b("bs_caml_option").some(JSON.parse(a))}catch(b){a=void 0}if(a===void 0)return;a=b("bs_js_json").classify(b("bs_caml_option").valFromOption(a));if(typeof a==="number")return;if(a.TAG!==2)return;a=b("bs_js_dict").get(a._0,"persona");if(a===void 0)return;a=b("bs_js_json").classify(b("bs_caml_option").valFromOption(a));if(typeof a==="number"||a.TAG!==2)return;else return b("bs_caml_option").some(a._0)}function s(a){if(a==null)return null;a=a.platform_xmd;if(a==null)return null;a=r(a);if(a===void 0)return null;a=b("bs_caml_option").valFromOption(a);var c=b("bs_js_dict").get(a,"id"),d=b("bs_js_dict").get(a,"name");a=b("bs_js_dict").get(a,"profile_picture_url");if(c!==void 0&&d!==void 0&&a!==void 0)return{id:b("bs_caml_option").valFromOption(c),name:b("bs_caml_option").valFromOption(d),profile_picture_url:b("bs_caml_option").valFromOption(a)};else return null}function t(a){var c=a.log_message_type;if(!(c==null)&&b("bs_caml_obj").caml_equal(c,b("MercuryLogMessageType").SERVER_ERROR))return b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").LOG_MESSAGE);else return!1}function u(a,b){var c=a.thread_fbid,d=a.other_user_fbid;a=a.is_from_iris;if(!(b==null)&&b)return!1;if(!(c==null)||!(d==null)||a)return!0;else return!1}f.makeFakeMessage=a;f.isLocalMessage=c;f.isTitanMessage=d;f.finalizeRanges=e;f.shouldSortForPayloadSource=h;f.isOutbound=i;f.isInbound=j;f.isSending=k;f.isSent=l;f.compare=m;f.hasError=n;f.getError=o;f.getDeliveryState=p;f.getGutterItemStatus=q;f.getPersonaData=r;f.getPersona=s;f.isErrorLogMessage=t;f.hasServerTimestamp=u}),null);
__d("MessengerPersonas.bs",["bs_js_dict","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";var g={};function a(a){if(a==null)return;var c=b("bs_js_dict").get(g,a.id);if(c!==void 0)return;else{g[a.id]=a;return}}function c(a){return b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(g,a))}f.personas=g;f.addPersona=a;f.getNow=c}),null);
__d("MessengerRealtimeAttachmentTransformer.bs",["MessengerMessageTransformer.bs","MessengerAttachmentTransformer.bs"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){var e=b("MessengerMessageTransformer.bs").unsafeCastBlobAttachments(c),f=c.extensible_attachment,g;if(f==null)g=null;else{var h=f.story_attachment,i=f.genie_attachment,j;if(i==null)j=null;else{i=i.genie_message;var k;if(i==null)k=null;else{i=i.story_attachment;k={story_attachment:i==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(i)}}j={genie_message:k}}g={legacy_attachment_id:f.legacy_attachment_id,story_attachment:h==null?null:b("MessengerMessageTransformer.bs").unsafeCastExtensibleAttachment(h),genie_attachment:j}}return b("MessengerAttachmentTransformer.bs").transformAttachment(a,{extensible_attachment:g,blob_attachments:e,sticker:c.sticker},null,d)}f.transform=a}),null);
__d("MessengerSharedPhotosVideosBaseData.bs",["bs_js_dict"],(function(a,b,c,d,e,f){"use strict";var g={};function a(a){return b("bs_js_dict").get(g,a)}function h(a,b){g[a]=b}function c(a,c){var d=b("bs_js_dict").get(g,a);if(d===void 0)return;var e=d.actualData;if(e===void 0)return;var f=e.edges;if(f.length===0)return;f=f.filter(function(a){return!c.some(function(b){return b===a.node.legacy_attachment_id})});d=d.fetchingState;f={edges:f,newestItemCursor:e.newestItemCursor,oldestItemCursor:e.oldestItemCursor,hasNextPage:e.hasNextPage};e={fetchingState:d,actualData:f};return h(a,e)}f.data=g;f.get=a;f.set=h;f.localRemove=c}),null);
__d("MessengerThreadFetcher.bs",["Promise","bs_curry","gkx","FBIDCheck","bs_belt_Array","LogHistory","MercuryIDs","bs_caml_option","MercuryDispatcher","MercuryThreadIDMap","MercuryPayloadSource","setTimeoutAcrossTransitions","MessengerGraphQLThreadFetcher.bs"],(function(a,b,c,d,e,f){"use strict";var g=new Map();function h(a,c){var d=c.other_user_fbid;if(d==null){c=c.thread_fbid;if(c==null)throw{RE_EXN_ID:"Invalid_argument",_1:"Encountered thread with no server identifier",Error:new Error()};c=[c,b("MercuryIDs").getThreadIDFromThreadFBID(c)]}else c=[d,b("MercuryIDs").getThreadIDFromUserID(d)];d=c[1];c=c[0];a=b("MercuryThreadIDMap").getForFBID(a);var e={},f=a.getClientIDFromServerIDNow(c);if(f==null){b("gkx")("1199097")&&b("LogHistory").getInstance("MessengerThreadFetcher").debug("setServerIDToClientID",d);a.setServerIDToClientID(c,d);e[c]=d;return[d,e]}else return[f,e]}function i(a,c,d){var e=!b("FBIDCheck").isUser_deprecated(a);return b("MessengerGraphQLThreadFetcher.bs").fetchAll(a,[{id:c,limit:0,loadReadReceipts:!1,loadDeliveryReceipts:!1,timestamp:null,isCanonical:d}],e).then(function(c){c=b("bs_belt_Array").get(c,0);if(c===void 0)return b("Promise").resolve(!1);c=b("bs_caml_option").valFromOption(c).thread;if(c==null)return b("Promise").resolve(!1);var d=h(a,c);b("MercuryDispatcher").getForFBID(a).handleUpdate({threads:[Object.assign(c,{thread_id:d[0]})],pinned_thread_ids:[],newlyAddedClientIDs:d[1],actions:[],preprocessed:!0,payload_source:b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO});return b("Promise").resolve(!0)})}function j(a,c,d){return i(a,c,d).then(function(d){var e=g.get(a);if(e==null)return b("Promise").resolve(!1);var f=e.get(c);if(f==null)return b("Promise").resolve(!1);else{b("bs_belt_Array").forEach(f[1],function(a){return b("bs_curry")._1(a,d)});e["delete"](c);return b("Promise").resolve(d)}})["catch"](function(e){var f=g.get(a);if(f==null)return b("Promise").resolve(!1);e=f.get(c);if(e==null)return b("Promise").resolve(!1);var h=e[1];e=e[0];if(e<5||b("gkx")("678666")){var k=Math.imul(Math.pow(2,Math.min(e,5))|0,1e3),l=new(b("Promise"))(function(e,g){b("setTimeoutAcrossTransitions")(function(g){i(a,c,d).then(function(a){e(a);b("bs_belt_Array").forEach(h,function(c){return b("bs_curry")._1(c,a)});f["delete"](c);return b("Promise").resolve(a)})["catch"](function(b){return j(a,c,d)})},k)});f.set(c,[e+1|0,h]);return l}f["delete"](c);return b("Promise").resolve(!1)})}function a(a,b,c,d){var e=g.get(a);if(e==null){var f=new Map();f.set(b,[0,[d]]);g.set(a,f);j(a,b,c);return}f=e.get(b);f==null?(e.set(b,[0,[d]]),j(a,b,c)):f[1].push(d)}f.$$fetch=a}),null);
__d("ClientSyncProtocol_GroupsSyncAction",[],(function(a,b,c,d,e,f){a=Object.freeze({OPT_IN:0,OPT_OUT:1,UPDATE_EMOJI:2});e.exports=a}),null);
__d("IrisProtocolMessageLifetime",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({TTL_OFF:0,TTL_ON_UNKNOWN:1,TTL_30SECONDS:3e4,TTL_1MINUTE:6e4,TTL_3MINUTES:18e4,TTL_5MINUTES:3e5,TTL_10MINUTES:6e5,TTL_15MINUTES:9e5,TTL_30MINUTES:18e5,TTL_1HOUR:36e5,TTL_2HOURS:72e5,TTL_4HOURS:144e5,TTL_8HOURS:288e5,TTL_12HOURS:432e5,TTL_24HOURS:864e5,TTL_36HOURS:1296e5,TTL_72HOURS:2592e5})}),null);
__d("MSuggestionDispatcher",["ExplicitRegistrationDispatcher"],(function(a,b,c,d,e,f){"use strict";a=new(b("ExplicitRegistrationDispatcher"))({strict:!1});e.exports=a}),null);
__d("MSuggestionActions",["MSuggestionDispatcher","keyMirror"],(function(a,b,c,d,e,f){"use strict";f.saveAllSuggestions=a;f.removeAllSuggestions=c;f.removeSuggestionsByType=d;var g=b("keyMirror")({SAVE_ALL_SUGGESTIONS:null,REMOVE_ALL_SUGGESTIONS:null,REMOVE_SUGGESTIONS_BY_TYPE:null});f.Types=g;function a(a,c){b("MSuggestionDispatcher").dispatch({type:g.SAVE_ALL_SUGGESTIONS,threadID:a,suggestions:c})}function c(a){a&&b("MSuggestionDispatcher").dispatch({type:g.REMOVE_ALL_SUGGESTIONS,threadID:a})}function d(a,c){b("MSuggestionDispatcher").dispatch({type:g.REMOVE_SUGGESTIONS_BY_TYPE,threadID:a,typeID:c})}}),null);
__d("MercuryGlobalActionType",[],(function(a,b,c,d,e,f){a=Object.freeze({MARK_ALL_READ:"mga-type:mark-all-read",MARK_ALL_SEEN:"mga-type:mark-all-seen"});e.exports=a}),null);
__d("MercuryMessageCustomizations",[],(function(a,b,c,d,e,f){"use strict";f.parseCustomizations=a;function a(a){var b=JSON.parse(a),c=[];Object.keys(b).forEach(function(a){c.push({customization_type:a,customization_value:b[a]})});return c}}),null);
__d("MercuryProfileRanges",[],(function(a,b,c,d,e,f){"use strict";function g(a){return!a.id&&a.i?{id:a.i,offset:a.o,length:a.l,type:a.t}:a}e.exports={extractFromDelta:function(a){a=(a=a)!=null?(a=a.data)!=null?a.prng:a:a;if(!a)return[];var b=[];try{b=JSON.parse(a);if(b.length>0)return b.map(g)}catch(a){}return b}}}),null);
__d("MessageThreadReadState",[],(function(a,b,c,d,e,f){"use strict";a={MARK_READ:1,MARK_UNREAD:2,KEEP_AS_IS:3};b=a;e.exports=b}),null);
__d("MessageThreadReadStateEffect",["MessageThreadReadState"],(function(a,b,c,d,e,f){"use strict";f.extractThreadStateEffectFromDelta=a;function a(a,c){var d=c.messageMetadata.threadReadStateEffect;if(d!=null){var e=b("MessageThreadReadState")[d];return e===void 0&&typeof d==="number"?d:e}d=c.messageMetadata.skipBumpThread;return d===!0?b("MessageThreadReadState").KEEP_AS_IS:a!==c.messageMetadata.actorFbId?b("MessageThreadReadState").MARK_UNREAD:b("MessageThreadReadState").KEEP_AS_IS}}),null);
__d("MessagingThreadAction",[],(function(a,b,c,d,e,f){a=Object.freeze({ACTION_INVALID:"ACTION_INVALID",ACTION_ARCHIVED:"ACTION_ARCHIVED",ACTION_UNARCHIVED:"ACTION_UNARCHIVED"});e.exports=a}),null);
__d("MessengerApprovalModeTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({OPEN:0,APPROVALS:1});e.exports=a}),null);
__d("MessengerApprovalQueueTypes",[],(function(a,b,c,d,e,f){a=Object.freeze({REQUESTED:"REQUESTED",REMOVED:"REMOVED"});e.exports=a}),null);
__d("MessengerGroupRequestSource",[],(function(a,b,c,d,e,f){a=Object.freeze({ADD:0,JOIN_THROUGH_LINK:1});e.exports=a}),null);
__d("MessengerWebDeltaEvents",[],(function(a,b,c,d,e,f){a=Object.freeze({DELTA_RECEIVED:"DELTA_RECEIVED",DELTA_IGNORED:"DELTA_IGNORED"});e.exports=a}),null);
__d("PagesMessagingEventType",[],(function(a,b,c,d,e,f){a=Object.freeze({FLAG:1,CREATE_ADMIN_NOTE:2,PRIORITY_UPDATE:3});e.exports=a}),null);
__d("RepliedToMessageStatusForGraphQL",[],(function(a,b,c,d,e,f){a=Object.freeze({VALID:"VALID",DELETED:"DELETED",TEMPORARILY_UNAVAILABLE:"TEMPORARILY_UNAVAILABLE"});e.exports=a}),null);
__d("MessengerDeltaTransformer.bs",["Promise","FBID.bs","bs_curry","gkx","bs_js_dict","bs_js_json","bs_caml_obj","FBIDCheck","bs_belt_Array","Bootloader","bs_caml_array","DateConsts","MercuryIDs","bs_belt_Option","bs_caml_option","MessengerState.bs","MontageActions","bs_js_null_undefined","MercuryActionType","MercuryDispatcher","MSuggestionActions","MercuryThreadIDMap","PageCommItemStatus","MercuryPayloadSource","MercuryProfileRanges","MercuryLogMessageType","MercuryServerRequests","MercurySyncDeltaTypes","MessagingThreadAction","MessageThreadReadState","MessengerThreadFetcher.bs","MercuryGlobalActionType","MessengerWebDeltaEvents","PagesMessagingEventType","MessengerGroupsSyncStatus.bs","MessengerGroupsSyncStatus","MessageUnsendabilityStatus.bs","MessengerApprovalModeTypes","MessengerMessageDFFFetcher.bs","IrisProtocolMessageLifetime","MessengerApprovalQueueTypes","MessengerGroupRequestSource","MercuryMessageCustomizations","MessageThreadReadStateEffect","MessengerParticipantsFetcher.bs","RepliedToMessageStatusForGraphQL","ClientSyncProtocol_GroupsSyncAction","MessengerRealtimeAttachmentTransformer.bs","MessageLiveLocationClientSyncProtocolStopReason"],(function(a,b,c,d,e,f){"use strict";function g(a){try{return JSON.parse(a)}catch(a){return{}}}var h=b("gkx")("780647")?0:1;function i(a,c){var d=b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.otherUserFbId),function(a){return a.toString()});c=b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(c.threadFbId),function(a){return a.toString()});a=b("MercuryThreadIDMap").getForFBID(a);d=d!==void 0?[b("bs_caml_option").some(b("MercuryIDs").getThreadIDFromUserID(b("FBID.bs").ofStringExn(d))),d]:c!==void 0?[b("bs_caml_option").some(b("MercuryIDs").getThreadIDFromThreadFBID(b("FBID.bs").ofStringExn(c))),c]:[void 0,void 0];c=d[1];d=d[0];if(c!==void 0&&d!==void 0)if(a.hasClientIDForServerID(c))return b("bs_caml_option").nullable_to_opt(a.getClientIDFromServerIDNow(c));else return b("bs_caml_option").valFromOption(d)}function j(a,b,c,d){if(!(a==null))return[a.toString(),{otherUserFbId:null,threadFbId:a}];if(b==null)return[void 0,void 0];a=c.toString()!==d?c:b;return[a.toString(),{otherUserFbId:a,threadFbId:null}]}function k(a,c){var d=parseInt(c.messageMetadata.timestamp,10),e=b("MessageThreadReadStateEffect").extractThreadStateEffectFromDelta(a,c),f={contents:c.messageMetadata.actorFbId.toString()},h=!b("FBIDCheck").isUser_deprecated(a),j=c.attachments;j=j==null?[]:b("bs_belt_Array").keepMapU(j,function(c){var d=c.mercury;if(d==null){c=c.mercuryJSON;c=c==null?null:g(c)}else c=d;if(c==null)return;d=c.extensible_attachment;var e=c.blob_attachment;c=c.sticker_attachment;c=d==null?e==null?c==null?[]:b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{extensible_attachment:null,blob_attachments:null,sticker:c},h):b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{extensible_attachment:null,blob_attachments:[e],sticker:null},h):b("MessengerRealtimeAttachmentTransformer.bs").transform(a,{extensible_attachment:b("bs_js_null_undefined").fromOption(d==null?void 0:b("bs_caml_option").some(d)),blob_attachments:null,sticker:null},h);e=b("bs_belt_Array").get(c,0);if(e!==void 0){d=b("bs_caml_option").valFromOption(e).share;if(d==null)c=f.contents;else{d=d.target;if(d==null)c=f.contents;else{d=d.genie_id;c=d==null?f.contents:d}}}else c=f.contents;f.contents=c;return e});var k=c.messageMetadata.tags;k=k==null?void 0:b("bs_js_null_undefined").fromOption(b("bs_belt_Array").get(k,0));var l=c.data,m;if(l==null)m=null;else{var n=b("bs_js_dict").get(l,"adminSignatureCreatorID");m=n!==void 0?{creatorID:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignatureCreatorID")),creatorName:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignatureCreatorName")),creatorType:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignatureCreatorType")),labelType:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignatureLabelType")),pageID:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignaturePageID")),profileURI:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(l,"adminSignatureProfileURI"))}:null}n=f.contents;l=b("bs_caml_obj").caml_equal(e,b("MessageThreadReadState").MARK_UNREAD)&&a!==n;var o=i(a,c.messageMetadata.threadKey);if(o!==void 0){var p=c.ttl,q=c.messageMetadata.threadKey.threadFbId,r=c.messageMetadata.threadKey.otherUserFbId,s=c.body,t=c.data;if(t==null){var u=c.untypedData;u=u==null?!1:b("bs_belt_Option").getWithDefault(b("bs_js_dict").get(u,"is_sponsored"),"false")==="true"}else u=b("bs_belt_Option").getWithDefault(b("bs_js_dict").get(t,"is_sponsored"),"false")==="true";t=c.data;var v=c.data,w;if(v==null)w=null;else{v=b("bs_js_dict").get(v,"customization");w=v!==void 0?b("MercuryMessageCustomizations").parseCustomizations(v):null}v=c.data;var x=c.data,y=c.data,z;if(y==null)z=null;else{y=b("bs_js_dict").get(y,"mib_direct_message_data");z=y!==void 0?g(y):null}y=c.data;var A;if(y==null)A=null;else{y=b("bs_js_dict").get(y,"message_source_data");if(y!==void 0){y=g(y);y=b("bs_js_json").classify(y);if(typeof y==="number"||y.TAG!==2)A=null;else{y=b("bs_js_dict").get(y._0,"message_source");A=y!==void 0?b("bs_js_null_undefined").fromOption(y):null}}else A=null}y=c.messageMetadata.skipBumpThread;var B=c.data,C;if(B==null)C=null;else{B=b("bs_js_dict").get(B,"montage_reply_data");C=B!==void 0?g(B):null}B=c.data;var D;if(B==null)D=null;else{B=b("bs_js_dict").get(B,"meta_ranges");D=B!==void 0?g(B):null}return{message_id:c.messageMetadata.messageId,threading_id:null,offline_threading_id:c.messageMetadata.offlineThreadingId,author:b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(n)),author_email:n+"@facebook.com",ephemeral_ttl_mode:p==null?0:b("bs_belt_Option").getWithDefault(b("bs_js_dict").get(b("IrisProtocolMessageLifetime"),p),0),timestamp:d,is_unread:l,is_filtered_content:!1,is_filtered_content_bh:!1,is_filtered_content_account:!1,is_filtered_content_quasar:!1,is_filtered_content_invalid_app:!1,is_one_way_sent:b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(c.messageMetadata.tags),[]).some(function(a){return a==="one_way_message"}),is_forwarded:b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(c.messageMetadata.tags),[]).some(function(a){if(a==="action:copy_message"||a==="copy_self_message"||a==="action:copy_attachment")return!0;else return a==="copy_self_attachment"}),source:k,tags:c.messageMetadata.tags,is_spoof_warning:!1,folder:null,thread_fbid:q==null?null:q.toString(),other_user_fbid:r==null?null:r.toString(),body:s==null?"":s,html_body:null,subject:null,has_attachment:j.length!==0,attachments:j,ranges:void 0,thread_id:o,action_type:b("MercuryActionType").USER_GENERATED_MESSAGE,is_from_iris:!0,is_sponsored:u,commerce_message_type:t==null?null:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(t,"commerce_message_type")),customizations:w,platform_xmd:v==null?null:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(v,"platform_xmd")),profile_ranges:b("MercuryProfileRanges").extractFromDelta(c),verse_group_role_xmd:x==null?null:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(x,"verse_group_role_id")),mib_direct_message_data:z,message_source:A,skip_bump_thread:y==null?!1:y,thread_read_state_effect:e,montage_reply_data:C,meta_ranges:D,creator_info:m,message_unsendability_status:b("MessageUnsendabilityStatus.bs").fromNullableString(c.messageMetadata.unsendType),comm_status:h?b("PageCommItemStatus").TODO:null}}throw{RE_EXN_ID:"Invalid_argument",_1:"invalid thread id",Error:new Error()}}function l(a,c,d,e){b("Bootloader").loadModules(["MessengerWebDeltasTypedLogger.bs"],function(f){f=b("bs_curry")._1(f.messengerWebDeltasTypedLogger,void 0);f=f.setDeltaEvent(a).setDeltaType(c).setIgnoreReason(d).setSyncSeqID(e);f.log()},"MessengerDeltaTransformer.bs")}function m(a){return l(b("MessengerWebDeltaEvents").DELTA_RECEIVED,a,null,null)}function n(a,c){return l(b("MessengerWebDeltaEvents").DELTA_IGNORED,a,c,null)}function o(a,c,d,e,f){return b("MessengerThreadFetcher.bs").$$fetch(a,c,d,function(c){if(c){b("MercuryDispatcher").getForFBID(a).handleUpdate({actions:[e],pinned_thread_ids:[],newlyAddedClientIDs:{},preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});return m(f)}else return n(f,"thread fetch failed")})}function p(a,c,d,e){var f=c.other_user_fbid;if(f==null){var g=c.thread_fbid;if(g==null)throw{RE_EXN_ID:"Invalid_argument",_1:"invalid thread id",Error:new Error()};g=[g,!1]}else g=[f,!0];f=g[1];g=g[0];var h=b("MercuryThreadIDMap").getForFBID(a);h=h.getClientIDFromServerIDNow(g);var i=h==null?null:b("MessengerState.bs").getThreadMetaNow(a,h),j=b("gkx")("1143875");if(h==null)if(e)return o(a,g,f,c,d);else return n(d,"thread not already loaded, not required to be loaded");if(i==null)if(e){if(j)return o(a,g,f,c,d);if(j)return n(d,"thread not already loaded, not required to be loaded")}else if(j)return n(d,"thread not already loaded, not required to be loaded");b("MercuryDispatcher").getForFBID(a).handleUpdate({actions:[c],pinned_thread_ids:[],newlyAddedClientIDs:{},preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});return m(d)}function q(a,c){var d=c.threadKey.threadFbId,e=d==null?void 0:b("bs_caml_option").some(d);if(d==null){d=c.threadKey.otherUserFbId;var f=d==null?void 0:b("bs_caml_option").some(d);d=d==null?[void 0,void 0]:[f,{otherUserFbId:b("bs_js_null_undefined").fromOption(f),threadFbId:null}]}else d=[e,{otherUserFbId:null,threadFbId:b("bs_js_null_undefined").fromOption(e)}];f=d[1];e=d[0];if(e===void 0)return;if(f===void 0)return;d=i(a,b("bs_caml_option").valFromOption(f));if(d!==void 0)return{thread_id:d,action_type:b("MercuryActionType").REACTION_UPDATE,messageId:c.messageId,offlineThreadingId:c.offlineThreadingId,reaction:c.reaction,senderId:c.senderId.toString(),thread_fbid:e.toString(),other_user_fbid:null,userId:c.userId.toString()}}function r(a){return a/Math.pow(10,8)}function s(a,c){var d=c.threadKey.threadFbId,e=d==null?void 0:b("bs_caml_option").some(d),f=c.threadKey.otherUserFbId,g=f==null?void 0:b("bs_caml_option").some(f);d=d==null?f==null?[void 0,void 0]:[g,{otherUserFbId:null,threadFbId:b("bs_js_null_undefined").fromOption(g)}]:[e,{otherUserFbId:b("bs_js_null_undefined").fromOption(e),threadFbId:null}];f=d[1];g=d[0];if(g===void 0)return;if(f===void 0)return;e=i(a,b("bs_caml_option").valFromOption(f));if(e===void 0)return;if(c.messageLiveLocations.length!==1)return;d=b("bs_caml_array").get(c.messageLiveLocations,0);a=d.expirationTime;f=d.stopReason;c=f==null?Date.now()/b("DateConsts").MS_PER_SEC>a:!0;f=d.coordinate;f=f==null?null:{latitude:r(f.latitude),longitude:r(f.longitude)};var h=d.destination;h=h==null?null:{latitude:r(h.latitude),longitude:r(h.longitude),label:h.label};var j=d.stopReason;j=j==null?null:j===b("MessageLiveLocationClientSyncProtocolStopReason").EXPIRED||j===b("MessageLiveLocationClientSyncProtocolStopReason").CANCELED?"EXPIRED":j===b("MessageLiveLocationClientSyncProtocolStopReason").ARRIVED?"ARRIVED":null;return{thread_id:e,action_type:b("MercuryActionType").LIVE_LOCATION_UPDATE,thread_fbid:g.toString(),other_user_fbid:null,messageId:d.messageId,liveLocation:{live_location_id:d.id.toString(),is_expired:c,expiration_time:a,sender:{id:d.senderId.toString()},coordinate:f,location_title:d.locationTitle,sender_destination:h,stop_reason:j}}}function t(a,c){var d=c.threadKey.threadFbId;if(d==null)return;a=i(a,{otherUserFbId:null,threadFbId:d});if(a!==void 0)return{action_type:b("MercuryActionType").EVENT_RSVP_CHANGED,actor_fbid:c.actorFbId.toString(),rsvp_status:c.rsvpStatus,thread_fbid:d.toString(),other_user_fbid:null,thread_id:a}}function u(a,c){var d=c.threadKey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").UPDATE_COMM_STATUS,comm_status:c.isFollowUp?b("PageCommItemStatus").FOLLOW_UP:b("PageCommItemStatus").TODO,thread_fbid:d.toString(),other_user_fbid:null,thread_id:a}}function v(a,c){var d=[];c.forEach(function(a){a=b("MercuryIDs").getUserIDFromParticipantID(a);if(!(a==null)){d.push(a);return}});return b("MessengerParticipantsFetcher.bs").$$fetch({ids:d}).then(function(c){var d=[],e=[];c.forEach(function(a){var b=a.id;a.is_messenger_blocked||a.is_facebook_blocked?d.push(b):e.push(b)});b("MercuryDispatcher").getForFBID(a).handleUpdate({from_client:!0,message_blocked_ids:d,message_unblocked_ids:e});return b("Promise").resolve(void 0)})["catch"](function(a){return b("Promise").resolve(void 0)})}function w(a,c){var d=c.actorFbid.toString(),e=b("FBID.bs").ofStringExn(d);if(b("bs_caml_obj").caml_notequal(e,a))e=b("bs_caml_option").some(b("MercuryIDs").getParticipantIDFromUserID(a));else{var f=c.threadKey.otherUserFbId;if(f==null)e=void 0;else{f=b("FBID.bs").ofString(f.toString());e=f!==void 0?b("bs_caml_option").some(b("MercuryIDs").getParticipantIDFromUserID(b("bs_caml_option").valFromOption(f))):void 0}}if(e===void 0)return;f=b("bs_caml_option").valFromOption(e);e=c.threadKey.otherUserFbId;if(e==null)return;v(a,[f]);a=i(a,{otherUserFbId:e,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").BLOCK_STATUS_CHANGED,actorFbid:d,canViewerReply:c.canViewerReply,reason:c.reason,message_blocked_ids:[f],other_user_fbid:e.toString(),thread_fbid:null,thread_id:a}}function x(a,c){var d=c.threadKey.threadFbId;if(d==null){var e=c.threadKey.otherUserFbId;e=e==null?[void 0,void 0]:[e.toString(),{otherUserFbId:e,threadFbId:null}]}else e=[d.toString(),{otherUserFbId:null,threadFbId:d}];d=e[1];e=e[0];if(e===void 0)return;if(d===void 0)return;a=i(a,b("bs_caml_option").valFromOption(d));if(a!==void 0)return{action_type:b("MercuryActionType").MONTAGE_DIRECT_EXPIRE,messageId:c.messageId,timestamp:c.timestamp,thread_fbid:e,other_user_fbid:null,keep_expiry_timestamp:c.keepExpiryTimestamp,thread_id:a}}function y(a,c){var d=k(a,c.message),e=c.repliedToMessage;if(e==null)return b("bs_caml_option").some(d);a=k(a,e);e=c.status;var f;if(e==null)f=void 0;else switch(e){case 0:f=b("bs_caml_option").some(b("RepliedToMessageStatusForGraphQL").VALID);break;case 1:f=b("bs_caml_option").some(b("RepliedToMessageStatusForGraphQL").DELETED);break;case 2:f=b("bs_caml_option").some(b("RepliedToMessageStatusForGraphQL").TEMPORARILY_UNAVAILABLE);break;default:f=void 0}if(f!==void 0)return b("bs_caml_option").some(Object.assign(d,{replied_to_message:{status:b("bs_caml_option").valFromOption(f),message:a}}))}function z(a,c){var d=c.threadKey.threadFbId,e=d==null?void 0:b("bs_caml_option").some(d);if(d==null){d=c.threadKey.otherUserFbId;var f=d==null?void 0:b("bs_caml_option").some(d);d=d==null?[void 0,void 0]:[f,{otherUserFbId:b("bs_js_null_undefined").fromOption(f),threadFbId:null}]}else d=[e,{otherUserFbId:null,threadFbId:b("bs_js_null_undefined").fromOption(e)}];f=d[1];e=d[0];if(e===void 0)return;if(f===void 0)return;d=i(a,b("bs_caml_option").valFromOption(f));if(d!==void 0)return{action_type:b("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED,thread_fbid:e.toString(),other_user_fbid:null,actor_fbid:c.actorFbid.toString(),groups_sync_status_string:b("MessengerGroupsSyncStatus.bs").fromNullableString(c.groupsSyncStatus),thread_id:d}}function A(a,c){var d=c.threadKey.threadFbId,e=d==null?void 0:b("bs_caml_option").some(d);if(d==null){d=c.threadKey.otherUserFbId;var f=d==null?void 0:b("bs_caml_option").some(d);d=d==null?[void 0,void 0]:[f,{otherUserFbId:b("bs_js_null_undefined").fromOption(f),threadFbId:null}]}else d=[e,{otherUserFbId:null,threadFbId:b("bs_js_null_undefined").fromOption(e)}];f=d[1];e=d[0];d=c.syncAction===b("ClientSyncProtocol_GroupsSyncAction").OPT_IN?b("bs_caml_option").some(b("MessengerGroupsSyncStatus").OPT_IN):c.syncAction===b("ClientSyncProtocol_GroupsSyncAction").OPT_OUT?b("bs_caml_option").some(b("MessengerGroupsSyncStatus").OPT_OUT):void 0;if(e===void 0)return;if(d===void 0)return;if(f===void 0)return;a=i(a,b("bs_caml_option").valFromOption(f));if(a===void 0)return;f=c.syncedFbGroupId;return{action_type:b("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE,thread_fbid:e.toString(),other_user_fbid:null,actor_fbid:c.actorFbid.toString(),groups_sync_action:b("bs_caml_option").valFromOption(d),source_surface:c.sourceSurface,fb_group_id:f==null?null:f.toString(),thread_id:a,emoji_codepoints:c.emojiCodePoints}}function B(a,c){var d=c.threadKey.threadFbId;if(d==null)return;a=i(a,{otherUserFbId:null,threadFbId:d});if(a!==void 0)return{action_type:b("MercuryActionType").DESCRIPTION_CHANGED,thread_fbid:d.toString(),other_user_fbid:null,group_thread_description_string:c.threadDescription,thread_id:a}}function C(a){return"#"+a.slice(2)}function D(a,c){var d=c.threadKey.threadFbId,e=d==null?void 0:b("bs_caml_option").some(d);if(d==null){d=c.threadKey.otherUserFbId;var f=d==null?void 0:b("bs_caml_option").some(d);d=d==null?[void 0,void 0]:[f,{otherUserFbId:b("bs_js_null_undefined").fromOption(f),threadFbId:null}]}else d=[e,{otherUserFbId:null,threadFbId:b("bs_js_null_undefined").fromOption(e)}];f=d[1];e=d[0];if(e===void 0)return;if(f===void 0)return;d=i(a,b("bs_caml_option").valFromOption(f));if(d===void 0)return;a=c.fallbackColor!==""?C(c.fallbackColor):"";f=c.reactionPack;var g;if(f==null)g=[void 0,void 0];else{var h=f.reactionAssets;f=f.fontAsset;g=[h==null?void 0:h.map(function(a){return{reactionName:a.reactionName,reactionEmoji:a.reactionEmoji,keyframeAssetUri:a.keyframeAssetUri}}),f==null?void 0:f.assetUri]}h=g[1];f=g[0];g=c.gradientColors;if(!(g==null)&&g.length!==0){g=b("bs_belt_Array").map(g,C);return{action_type:b("MercuryActionType").UPDATE_THREAD_THEME,thread_fbid:e.toString(),other_user_fbid:null,theme_id:c.themeId.toString(),solid_color:a,header_color:b("bs_caml_array").get(g,0),footer_color:b("bs_caml_array").get(g,g.length-1|0),gradient_colors:g,thread_id:d,reactions:f,reactionFont:h}}return{action_type:b("MercuryActionType").UPDATE_THREAD_THEME,thread_fbid:e.toString(),other_user_fbid:null,theme_id:c.themeId.toString(),solid_color:a,header_color:a,footer_color:a,gradient_colors:[],thread_id:d,reactions:f,reactionFont:h}}function E(a,c,d,e,f,g){d={action_type:b("MercuryActionType").PIN_MESSAGE,thread_fbid:d.threadFbId===null?null:c,other_user_fbid:d.otherUserFbId===null?null:c,thread_id:e,actor_fbid:f.actorFbid.toString(),pin_message_action:{message:{message_id:f.pinnedMessage.pinnedMessageId,pinning_time:f.pinnedMessage.timestamp,message:g}}};return p(a,d,"DeltaClientDelta.deltaUpdatePinnedMessage",h)}function F(a,c,d){var e=j(c.threadKey.threadFbId,c.threadKey.otherUserFbId,c.actorFbid,a),f=e[1],g=e[0];if(g===void 0){d.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedMessage",_1:"transform failed"};return}if(f===void 0){d.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedMessage",_1:"transform failed"};return}var h=b("bs_caml_option").valFromOption(f),k=i(a,h);if(k===void 0){d.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedMessage",_1:"transform failed"};return}e=c.pinnedMessage.pinnedMessageId;f=b("MessengerState.bs").getMessageFromID(a,e);if(f!==void 0)return E(a,g,h,k,c,b("bs_caml_option").valFromOption(f));else{b("MessengerMessageDFFFetcher.bs").fetch_(a,{message_id:e,thread_id:g},!1).then(function(d){E(a,g,h,k,c,d);return b("Promise").resolve(void 0)})["catch"](function(a){d.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedMessage",_1:"error on fetching pinned message payload"};return b("Promise").resolve(void 0)});return}}function G(a,c){var d=j(c.threadKey.threadFbId,c.threadKey.otherUserFbId,c.actorFbid,a),e=d[1];d=d[0];if(d===void 0)return;if(e===void 0)return;e=b("bs_caml_option").valFromOption(e);a=i(a,e);if(a!==void 0)return{action_type:b("MercuryActionType").UNPIN_MESSAGE,thread_fbid:e.threadFbId===null?null:d,other_user_fbid:e.otherUserFbId===null?null:d,thread_id:a,unpin_message_action:{message_id:c.pinnedMessage.pinnedMessageId},actor_fbid:c.actorFbid.toString()}}function H(a,c){var d=c.threadKey.threadFbId;if(d==null){var e=c.threadKey.otherUserFbId;e=e==null?[void 0,void 0]:[e.toString(),{otherUserFbId:e,threadFbId:null}]}else e=[d.toString(),{otherUserFbId:null,threadFbId:d}];d=e[1];e=e[0];if(e===void 0)return;if(d===void 0)return;a=i(a,b("bs_caml_option").valFromOption(d));if(a!==void 0)return{action_type:b("MercuryActionType").CHANGE_PINNED_STATUS,thread_fbid:e,other_user_fbid:null,is_pinned:c.isPinned,thread_id:a,thread_pin_timestamp:c.timestamp}}function I(a,c){var d=c.threadKey.threadFbId,e=c.threadKey.otherUserFbId;e=d==null?e==null?[void 0,void 0]:[e.toString(),{otherUserFbId:e,threadFbId:null}]:[d.toString(),{otherUserFbId:null,threadFbId:d}];d=e[1];e=e[0];if(e===void 0)return;if(d===void 0)return;a=i(a,b("bs_caml_option").valFromOption(d));if(a!==void 0)return{action_type:b("MercuryActionType").MUTATE_TAGS,thread_fbid:e,other_user_fbid:null,thread_id:a,messageId:c.messageId,tags_to_add:c.isSaved?["message:save"]:[],tags_to_delete:c.isSaved?[]:["message:save"]}}function J(a,c){var d=c.threadKey.threadFbId;if(d==null)return;a=i(a,{otherUserFbId:null,threadFbId:d});if(a!==void 0)return{action_type:b("MercuryActionType").UPDATE_JOINABLE_LINK,joinable_link:c.privateGroupLink,thread_fbid:d.toString(),other_user_fbid:null,thread_id:a}}function K(a){a=a.directives;if(a==null)return;a=b("bs_belt_Array").get(a,0);if(a===void 0)return;a=b("bs_caml_option").valFromOption(a).data;if(a==null)return;a=a.add_actions;if(a==null)return;var c=a.actions;if(c==null)return;c=b("bs_belt_Array").get(c,0);if(c===void 0)return;c=b("bs_caml_option").valFromOption(c).thread_key;if(c==null)return;var d=c.thread_fbid;c=c.other_user_fbid;if(d==null){if(c==null)return;c=c}else c=d;return{action_type:b("MercuryActionType").CREATE_OMNI_M_SUGGESTIONS,thread_fbid:b("MercuryIDs").getThreadIDFromThreadFBID(b("FBID.bs").ofStringExn(c)),other_user_fbid:null,thread_id:c,suggestions:a}}function L(a,c){var d=c.threadKey.threadFbId;if(d==null)return;a=i(a,{otherUserFbId:null,threadFbId:d});if(a!==void 0)return{action_type:b("MercuryActionType").PROMOTE_GROUP_ADMINS,thread_fbid:d.toString(),other_user_fbid:null,promoted_admins:b("bs_belt_Array").map(c.promotedAdmins,function(a){return{admin_fbid:a.adminFbId.toString(),admin_type:a.adminType}}),thread_id:a}}function M(a,c){var d=c.threadKey.threadFbId,e=c.threadKey.otherUserFbId;if(d==null){if(e==null)return;var f=i(a,{otherUserFbId:e,threadFbId:null});if(f!==void 0)return{action_type:b("MercuryActionType").REMOVE_MESSAGE,thread_fbid:null,messageId:c.messageID,other_user_fbid:e.toString(),removed_timestamp:c.deletionTimestamp,thread_id:f,author:b("MercuryIDs").getParticipantIDFromUserID(c.senderID)};else return}e=i(a,{otherUserFbId:null,threadFbId:d});if(e!==void 0)return{action_type:b("MercuryActionType").REMOVE_MESSAGE,thread_fbid:d.toString(),messageId:c.messageID,other_user_fbid:null,removed_timestamp:c.deletionTimestamp,thread_id:e,author:b("MercuryIDs").getParticipantIDFromUserID(c.senderID)}}function N(a,c){var d=c.threadKey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").UNSUBSCRIBE_STATUS_UPDATE,page_unsubscribe_status:c.unSubscribeStatus,thread_fbid:d.toString(),other_user_fbid:null,thread_id:a}}function O(a,c){var d=c.threadKey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").BLURRED_IMAGE_STATUS,blurred_image_uri:c.blurredImageUri,image_message_id:c.messageId,image_id:c.imageId,should_show:c.shouldShow,thread_fbid:d.toString(),other_user_fbid:null,thread_id:a}}function P(a,c){var d=c.threadKey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").IS_PIN_PROTECTED,thread_fbid:d.toString(),other_user_fbid:null,is_pin_protected:c.isPinProtected,thread_id:a}}function Q(a,c){var d=c.threadKey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").UPDATE_CONNECTIVITY_STATUS,other_user_fbid:d.toString(),subtitle_type:c.subtitleType,thread_connectivity_status:c.threadConnectivityStatus,thread_fbid:d.toString(),thread_id:a}}function R(a,c){var d=c.threadkey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").ADS_CONVERSION_UPDATE,other_user_fbid:d.toString(),thread_fbid:d.toString(),thread_id:a,conversion_detection_data:{is_eligible:c.isEligible,conversion_type:c.conversionType,currency_code:c.currencyCode,currency_amount:c.currencyAmount,timestamp:c.timestamp,classifier:c.classifier,page_reply:c.pageReply,icebreaker_key:c.icebreakerKey,icebreaker_message:c.icebreakerMessage,trigger_id:c.triggerId}}}function S(a,c){var d=c.threadkey.otherUserFbId;if(d==null)return;a=i(a,{otherUserFbId:d,threadFbId:null});if(a!==void 0)return{action_type:b("MercuryActionType").SUGGESTED_REPLY_UPDATE,other_user_fbid:d.toString(),thread_fbid:d.toString(),thread_id:a,suggested_reply_data:{suggestion_type:c.suggestionType,suggestion_content:c.suggestionContent,triggered_timestamp:c.triggeredTimestamp}}}var T=function(a){return String.fromCharCode.apply(null,a)};function U(a,c){c=JSON.parse(T(c.payload));c=b("bs_js_json").classify(c);if(typeof c==="number")return{TAG:1,_0:"DeltaClientDelta",_1:"malformed payload"};if(c.TAG!==2)return{TAG:1,_0:"DeltaClientDelta",_1:"malformed payload"};c=b("bs_js_dict").get(c._0,"deltas");if(c===void 0)return{TAG:1,_0:"DeltaClientDelta",_1:"client delta has no deltas"};c=b("bs_js_json").classify(b("bs_caml_option").valFromOption(c));if(typeof c==="number")return{TAG:1,_0:"DeltaClientDelta",_1:"delta is not an array"};if(c.TAG!==3)return{TAG:1,_0:"DeltaClientDelta",_1:"delta is not an array"};c=b("bs_belt_Array").get(c._0,0);if(c===void 0)return{TAG:1,_0:"DeltaClientDelta",_1:"client delta is missing"};c=b("bs_js_json").classify(b("bs_caml_option").valFromOption(c));if(typeof c==="number")return{TAG:1,_0:"DeltaClientDelta",_1:"client delta is not an object"};if(c.TAG!==2)return{TAG:1,_0:"DeltaClientDelta",_1:"client delta is not an object"};c=c._0;var d=!1,e={contents:0},f=b("bs_js_dict").get(c,"deltaMessageReaction");if(f!==void 0){d=!0;f=q(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaMessageReaction",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaMessageReaction",_1:"transform failed"}}f=b("bs_js_dict").get(c,"liveLocationData");if(f!==void 0&&!d){d=!0;f=s(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.liveLocationData",h):e.contents={TAG:1,_0:"DeltaClientDelta.liveLocationData",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdateGroupEventRSVPStatus");if(f!==void 0&&!d){d=!0;f=t(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdateGroupEventRSVPStatus",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdateGroupEventRSVPStatus",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaPageThreadFollowUpData");if(f!==void 0&&!d){d=!0;f=u(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaPageThreadFollowUpData",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaPageThreadFollowUpData",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaChangeViewerStatus");if(f!==void 0&&!d){d=!0;f=w(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaChangeViewerStatus",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaChangeViewerStatus",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaMontageDirectExpire");if(f!==void 0&&!d){d=!0;f=x(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaMontageDirectExpire",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaMontageDirectExpire",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaMessageReply");if(f!==void 0&&!d){d=!0;f=y(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaMessageReply",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaMessageReply",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdateGroupsSyncStatus");if(f!==void 0&&!d){d=!0;f=z(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdateGroupsSyncStatus",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdateGroupsSyncStatus",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdateGroupsSyncMetadata");if(f!==void 0&&!d){d=!0;f=A(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdateGroupsSyncMetadata",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdateGroupsSyncMetadata",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaGroupThreadDescription");if(f!==void 0&&!d){d=!0;f=B(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaGroupThreadDescription",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaGroupThreadDescription",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdateThreadTheme");if(f!==void 0&&!d){d=!0;f=D(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdateThreadTheme",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdateThreadTheme",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdateSavedMessage");if(f!==void 0&&!d){d=!0;f=I(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdateSavedMessage",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdateSavedMessage",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdatePinnedThread");if(f!==void 0&&!d){d=!0;f=H(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdatePinnedThread",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedThread",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaUpdatePinnedMessage");if(f!==void 0&&!d){f=b("bs_caml_option").valFromOption(f);d=!0;if(f.pinnedMessageAction===0)F(a,f,e);else{f=G(a,f);f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdatePinnedMessage",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePinnedMessage",_1:"transform failed"}}}f=b("bs_js_dict").get(c,"deltaUpdatePrivateGroupJoinableLink");if(f!==void 0&&!d){d=!0;f=J(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaUpdatePrivateGroupJoinableLink",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaUpdatePrivateGroupJoinableLink",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaOmniMDirectivesV2");if(f!==void 0&&!d){d=!0;f=K(b("bs_caml_option").valFromOption(f));if(f!==void 0){f=b("bs_caml_option").valFromOption(f);e.contents={TAG:0,_0:"DeltaClientDelta.deltaOmniMDirectivesV2"};b("MSuggestionActions").saveAllSuggestions(f.thread_id,f.suggestions)}else e.contents={TAG:1,_0:"DeltaClientDelta.deltaOmniMDirectivesV2",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaPromoteGroupThreadAdmin");if(f!==void 0&&!d){d=!0;f=L(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaPromoteGroupThreadAdmin",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaPromoteGroupThreadAdmin",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaRecallMessageData");if(f!==void 0&&!d){d=!0;f=M(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaRecallMessageData",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaRecallMessageData",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaPageUnSubscribeStatus");if(f!==void 0&&!d){d=!0;f=N(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaPageUnSubscribeStatus",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaPageUnSubscribeStatus",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaPageBlurredImageStatus");if(f!==void 0&&!d){d=!0;f=O(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaPageBlurredImageStatus",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaPageBlurredImageStatus",_1:"transform failed"}}f=b("bs_js_dict").get(c,"deltaPaymentPinProtectionStatusData");if(f!==void 0){if(!d){d=!0;f=P(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaPaymentPinProtectionStatusData",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaPaymentPinProtectionStatusData",_1:"transform failed"}}}else d||(e.contents={TAG:1,_0:"DeltaClientDelta",_1:"unknown delta type: "+Object.keys(c).join(",")});f=b("bs_js_dict").get(c,"deltaThreadConnectivityStatusUpdate");if(f!==void 0){if(!d){d=!0;f=Q(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaThreadConnectivityStatusUpdateData",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaThreadConnectivityStatusUpdateData",_1:"transform failed"}}}else d||(e.contents={TAG:1,_0:"DeltaClientDelta",_1:"unknown delta type: "+Object.keys(c).join(",")});f=b("bs_js_dict").get(c,"deltaMessengerAdsConversionUpdate");if(f!==void 0){if(!d){d=!0;f=R(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaMessengerAdsConversionUpdate",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaMessengerAdsConversionUpdate",_1:"transform failed"}}}else d||(e.contents={TAG:1,_0:"DeltaClientDelta",_1:"unknown delta type: "+Object.keys(c).join(",")});f=b("bs_js_dict").get(c,"deltaMessengerBusinessSuggestedReplyUpdate");if(f!==void 0){if(!d){d=!0;f=S(a,b("bs_caml_option").valFromOption(f));f!==void 0?p(a,b("bs_caml_option").valFromOption(f),"DeltaClientDelta.deltaMessengerBusinessSuggestedReplyUpdate",h):e.contents={TAG:1,_0:"DeltaClientDelta.deltaMessengerBusinessSuggestedReplyUpdate",_1:"transform failed"}}}else d||(e.contents={TAG:1,_0:"DeltaClientDelta",_1:"unknown delta type: "+Object.keys(c).join(",")});return e.contents}function V(a,c){var d=[],e=[],f=c.folders,g=0;f==null||f.length===0?g=1:b("bs_belt_Array").forEachU(f,function(a){d.push({action_type:b("MercuryGlobalActionType").MARK_ALL_READ,action_id:null,folder:b("bs_js_dict").get(b("MessengerState.bs").irisMapping,a),timestamp:parseInt(c.watermarkTimestamp,10)})});g===1&&b("bs_belt_Array").forEachU(c.threadKeys,function(d){var f=i(a,d);if(f===void 0)return;var g=parseInt(c.watermarkTimestamp,10);b("MercuryServerRequests").getForFBID(a).updateLastActionTimestamp(g);e.push({thread_id:f,action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:d.otherUserFbId,thread_fbid:d.threadFbId,mark_as_read:!0,timestamp:g,folder:"inbox"})});return[d,e]}function W(a){if(a==null)return null;else return a.toString()}function X(a){a=a.skipBumpThread;if(!(a==null)&&a)return h;else return 1}function Y(a,c){var d;switch(c.TAG|0){case 0:var e=c._0,f=k(a,e);p(a,f,"deltaNewMessage",X(e.messageMetadata));d=0;break;case 1:f=c._0;p(a,Object.assign(k(a,f.newMessage),{action_type:b("MercuryActionType").REPLACE_MESSAGE,replaced_message_id:f.replacedMessageId}),"deltaReplaceMessage",h);d=0;break;case 2:e=c._0;f=e.threadKey.otherUserFbId;var g;if(f==null){var j=e.threadKey.threadFbId;if(j==null)g=void 0;else{var l=b("MercuryThreadIDMap").getForFBID(a);l=l.getClientIDFromServerIDNow(j.toString());g=l==null?void 0:b("bs_caml_option").some(l)}}else{j=b("FBID.bs").ofString(f.toString());g=j!==void 0?b("bs_caml_option").some(b("MercuryIDs").getThreadIDFromUserID(b("bs_caml_option").valFromOption(j))):void 0}if(g!==void 0){l={};f=parseInt(e.deliveredWatermarkTimestampMs,10);l[b("bs_caml_option").valFromOption(g)]=f;b("MercuryDispatcher").getForFBID(a).handleUpdate({delivery_receipts:l,pinned_thread_ids:[],newlyAddedClientIDs:{},actions:[],preprocessed:!0});d={TAG:0,_0:"DeltaDeliveryReceipt"}}else d={TAG:1,_0:"DeltaDeliveryReceipt",_1:"no thread id"};break;case 3:j=V(a,c._0);e=j[1];g=j[0];g.length!==0&&b("MercuryDispatcher").getForFBID(a).handleUpdate({actions:[],global_actions:g,pinned_thread_ids:[],newlyAddedClientIDs:{},preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});e.length!==0&&b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:e,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d=g.length===0&&e.length===0?{TAG:1,_0:"DeltaMarkRead",_1:"no local or global action"}:{TAG:0,_0:"DeltaMarkRead"};break;case 4:var o=c._0;f=b("bs_belt_Array").keepMapU(o.threadKeys,function(c){var d=i(a,c);if(d===void 0)return;var e=parseInt(o.watermarkTimestamp,10);b("MercuryServerRequests").getForFBID(a).updateLastActionTimestamp(e);return{thread_id:d,action_type:b("MercuryActionType").CHANGE_READ_STATUS,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId,mark_as_read:!1,timestamp:e,folder:"inbox"}});b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:f,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaMarkUnread"};break;case 5:l=c._0;p(a,Object.assign(k(a,l),{action_type:b("MercuryActionType").LOG_MESSAGE,log_message_body:l.messageMetadata.adminText,log_message_data:{removed_participants:[b("MercuryIDs").getParticipantIDFromUserID(l.leftParticipantFbId)]},log_message_type:b("MercuryLogMessageType").UNSUBSCRIBE}),"DeltaParticipantLeftGroupThread",X(l.messageMetadata));d=0;break;case 6:j=c._0;p(a,Object.assign(k(a,j),{action_type:b("MercuryActionType").LOG_MESSAGE,log_message_body:j.messageMetadata.adminText,log_message_data:{added_participants:b("bs_belt_Array").map(j.addedParticipants,function(a){return b("MercuryIDs").getParticipantIDFromUserID(a.userFbId)})},log_message_type:b("MercuryLogMessageType").SUBSCRIBE}),"DeltaParticipantsAddedToGroupThread",X(j.messageMetadata));d=0;break;case 7:g=c._0;p(a,Object.assign(k(a,g),{action_type:b("MercuryActionType").LOG_MESSAGE,log_message_body:g.messageMetadata.adminText,log_message_data:{name:g.name},log_message_type:b("MercuryLogMessageType").THREAD_NAME}),"DeltaThreadName",X(g.messageMetadata));d=0;break;case 8:e=c._0;f={watermark:parseInt(e.watermarkTimestampMs,10),action:parseInt(e.actionTimestampMs,10)};l=e.threadKey.otherUserFbId;j=l==null?b("bs_caml_option").nullable_to_opt(e.actorFbId):l.toString();g=e.threadKey.otherUserFbId;if(g==null){l=e.threadKey.threadFbId;e=l==null?void 0:l.toString()}else e=g.toString();if(j!==void 0)if(e!==void 0){l=b("MercuryThreadIDMap").getForFBID(a);g=l.getClientIDFromServerIDNow(e);if(g==null)d={TAG:1,_0:"DeltaReadReceipt",_1:"No clientID for serverID: "+e};else{l={};e={};j=b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(j));e[j]=f;l[g]=e;b("MercuryDispatcher").getForFBID(a).handleUpdate({roger:l,pinned_thread_ids:[],newlyAddedClientIDs:{},actions:[],preprocessed:!0});d={TAG:0,_0:"DeltaReadReceipt"}}}else d={TAG:1,_0:"DeltaReadReceipt",_1:"serverID is invalid"};else d={TAG:1,_0:"DeltaReadReceipt",_1:"userID is invalid"};break;case 9:j=c._0;p(a,Object.assign(k(a,j),{action_type:b("MercuryActionType").LOG_MESSAGE,log_message_body:j.messageMetadata.adminText,log_message_data:{message_type:j.type,untypedData:j.untypedData},log_message_type:b("MercuryLogMessageType").GENERIC_ADMIN_TEXT,message_unsendability_status:b("MessageUnsendabilityStatus.bs").fromNullableString(j.messageMetadata.unsendType)}),"DeltaAdminTextMessage",X(j.messageMetadata));d=0;break;case 10:f=c._0;g=i(a,{otherUserFbId:f.threadKey.otherUserFbId,threadFbId:f.threadKey.threadFbId});e=g!==void 0?{action_type:b("MercuryActionType").DELETE_MESSAGES,message_ids:f.messageIds,other_user_fbid:W(f.threadKey.otherUserFbId),thread_fbid:W(f.threadKey.threadFbId),thread_id:g}:void 0;l=f.threadKey.threadFbId;j=f.folder;if(e!==void 0){g=b("bs_caml_option").valFromOption(e);l==null||j==null?(p(a,g,"DeltaMessageDelete",h),d=0):(j==="FOLDER_MONTAGE"?b("MontageActions").requestUpdate(l.toString()):p(a,g,"DeltaMessageDelete",h),d=0)}else d={TAG:1,_0:"DeltaMessageDelete",_1:"transform failed"};break;case 11:f=c._0;e=i(a,{otherUserFbId:f.threadKey.otherUserFbId,threadFbId:f.threadKey.threadFbId});if(e!==void 0){j=f.action;p(a,{action_type:b("MercuryActionType").CHANGE_ARCHIVED_STATUS,thread_fbid:W(f.threadKey.threadFbId),other_user_fbid:W(f.threadKey.otherUserFbId),archived:j==null?!1:j===b("MessagingThreadAction").ACTION_ARCHIVED,thread_id:e},"DeltaThreadAction",h);d=0}else d={TAG:1,_0:"DeltaThreadAction",_1:"transform failed"};break;case 12:l=b("bs_belt_Array").keepMapU(c._0.threadKeys,function(c){var d=i(a,c);if(d!==void 0)return{thread_id:d,action_type:b("MercuryActionType").DELETE_THREAD,other_user_fbid:c.otherUserFbId,thread_fbid:c.threadFbId}});b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:l,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaThreadDelete"};break;case 13:g=c._0;f=i(a,{otherUserFbId:null,threadFbId:g.messageMetadata.threadKey.threadFbId});f!==void 0?(p(a,{action_type:b("MercuryActionType").REMOVE_GROUP_ADMINS,action_id:null,thread_fbid:W(g.messageMetadata.threadKey.threadFbId),other_user_fbid:null,removed_admin_ids:g.removedAdminFbIds,thread_id:f},"DeltaAdminRemovedFromGroupThread",h),d=0):d={TAG:1,_0:"DeltaAdminRemovedFromGroupThread",_1:"transform failed"};break;case 14:j=c._0;e=i(a,j.threadKey);if(e!==void 0){l=[{thread_id:e,action_type:b("MercuryActionType").CHANGE_MUTE_SETTINGS,thread_fbid:j.threadKey.threadFbId,other_user_fbid:j.threadKey.otherUserFbId,mute_until:parseInt(j.expireTime,10)}];b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:l,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaThreadMuteSettings"}}else d={TAG:1,_0:"DeltaThreadMuteSettings",_1:"invalid thread ID"};break;case 15:g=c._0;f=g.jsonBlob;if(f==null)d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"no jsonBlob"};else{try{e=JSON.parse(f)}catch(a){e={}}j=b("bs_js_json").classify(e);if(typeof j==="number"||j.TAG!==2)d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"jsonBlob is not an object"};else{l=j._0;f=b("bs_js_dict").get(l,"type");if(f!==void 0){e=b("bs_js_json").classify(b("bs_caml_option").valFromOption(f));if(typeof e==="number"||e.TAG!==1)d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"type is not a number"};else if(e._0===b("PagesMessagingEventType").FLAG){j=b("bs_js_dict").get(l,"flagData");if(j!==void 0){f=b("bs_js_json").classify(b("bs_caml_option").valFromOption(j));if(typeof f==="number"||f.TAG!==2)e=!1;else{l=b("bs_js_dict").get(f._0,"state");if(l!==void 0){j=b("bs_js_json").classify(b("bs_caml_option").valFromOption(l));e=typeof j==="number"?j===1:!1}else e=!1}}else e=!1;f=i(a,g.threadKey);if(f!==void 0){l=[{thread_id:f,action_type:b("MercuryActionType").CHANGE_FLAG,mark_as_flag:e,other_user_fbid:g.threadKey.otherUserFbId,thread_fbid:g.threadKey.threadFbId}];b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:l,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaPagesManagerEvent"}}else d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"threadID is invalid"}}else d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"type is not pagesFlag"}}else d={TAG:1,_0:"DeltaPagesManagerEvent",_1:"no type on jsonBlob"}}}break;case 16:j=c._0;f=i(a,{otherUserFbId:null,threadFbId:j.messageMetadata.threadKey.threadFbId});f!==void 0?(p(a,{action_type:b("MercuryActionType").APPROVAL_MODE,action_id:null,thread_fbid:W(j.messageMetadata.threadKey.threadFbId),other_user_fbid:null,approval_mode:b("bs_js_null_undefined").fromOption(b("bs_js_dict").get(b("MessengerApprovalModeTypes"),j.mode)),thread_id:f},"DeltaApprovalMode",h),d=0):d={TAG:1,_0:"DeltaApprovalMode",_1:"transform failed"};break;case 17:e=c._0;g=i(a,{otherUserFbId:e.messageMetadata.threadKey.otherUserFbId,threadFbId:e.messageMetadata.threadKey.threadFbId});if(g!==void 0){l=e.inviterFbId;if(l==null){j=e.recipientFbId;if(!(j==null)){f=b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(j));p(a,{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:W(e.messageMetadata.threadKey.threadFbId),other_user_fbid:W(e.messageMetadata.threadKey.otherUserFbId),removed_id:e.action===b("MessengerApprovalQueueTypes").REMOVED?f:null,added_id:e.action===b("MessengerApprovalQueueTypes").REQUESTED?f:null,thread_id:g},"DeltaApprovalQueue",h)}}else{if(e.action===b("MessengerApprovalQueueTypes").REQUESTED){j=e.requestSource;var q;if(j==null)q=b("MessengerGroupRequestSource").ADD;else switch(j){case"ADD":q=b("MessengerGroupRequestSource").ADD;break;case"JOIN_THROUGH_LINK":q=b("MessengerGroupRequestSource").JOIN_THROUGH_LINK;break;default:q=b("MessengerGroupRequestSource").ADD}f={requester:{id:e.recipientFbId},inviter:{id:l},request_source:q,request_timestamp:e.requestTimestamp}}else f=null;p(a,{action_type:b("MercuryActionType").APPROVAL_QUEUE,action_id:null,thread_fbid:W(e.messageMetadata.threadKey.threadFbId),other_user_fbid:W(e.messageMetadata.threadKey.otherUserFbId),removed_group_id:e.action===b("MessengerApprovalQueueTypes").REMOVED?e.recipientFbId:null,added_group_id:f,thread_id:g},"DeltaApprovalQueue",h)}d=0}else d={TAG:1,_0:"DeltaApprovalQueue",_1:"transform failed"};break;case 18:j=c._0;p(a,k(a,j.deltaNewMessage),"DeltaGenieMessage",X(j.deltaNewMessage.messageMetadata));d=0;break;case 19:l=c._0;e=l.messageMetadata.threadKey;if(e==null)f=void 0;else{g=e.threadFbId;f=g==null?void 0:g}j=l.initiator;if(j==null)e=void 0;else{g=j.userFbId;e=g==null?void 0:g.toString()}j=i(a,{otherUserFbId:null,threadFbId:f});j!==void 0?(p(a,{action_type:b("MercuryActionType").UPDATE_RTC_CALL_DATA,thread_fbid:W(f),other_user_fbid:null,call_state:l.callState,server_info_data:l.serverInfoData,initiator_fbid:e,thread_id:j},"DeltaRTCCallData",h),d=0):d={TAG:1,_0:"DeltaRTCCallData",_1:"transform failed"};break;case 20:g=c._0;f=i(a,g.threadKey);if(f!==void 0){l=[{thread_id:f,action_type:b("MercuryActionType").CHANGE_FOLDER,other_user_fbid:g.threadKey.otherUserFbId,new_folder:b("bs_js_dict").get(b("MessengerState.bs").irisMapping,g.folder)}];b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:l,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaThreadFolder"}}else d={TAG:1,_0:"DeltaThreadFolder",_1:"threadID is invalid"};break;case 21:e=c._0;j=i(a,e.threadKey);if(j!==void 0){f=[{thread_id:j,action_type:b("MercuryActionType").MUTATE_TAGS,messageId:e.messageId,tags_to_add:e.tagsToAdd,tags_to_delete:e.tagsToDelete}];b("MercuryDispatcher").getForFBID(a).handleUpdate({pinned_thread_ids:[],newlyAddedClientIDs:{},actions:f,preprocessed:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE});d={TAG:0,_0:"DeltaMutateMessageTags"}}else d={TAG:1,_0:"DeltaMutateMessageTags",_1:"threadID is invalid"};break;case 22:d=U(a,c._0);break}if(typeof d==="number")return;else if(d.TAG)return n(d._0,d._1);else return m(d._0)}function a(a,c){if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").NewMessage))return Y(a,{TAG:0,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ReplaceMessage))return Y(a,{TAG:1,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").DeliveryReceipt))return Y(a,{TAG:2,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").MarkRead))return Y(a,{TAG:3,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").MarkUnread))return Y(a,{TAG:4,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ParticipantLeftGroupThread))return Y(a,{TAG:5,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ParticipantsAddedToGroupThread))return Y(a,{TAG:6,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ThreadName))return Y(a,{TAG:7,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ReadReceipt))return Y(a,{TAG:8,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").AdminTextMessage))return Y(a,{TAG:9,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").MessageDelete))return Y(a,{TAG:10,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ThreadAction))return Y(a,{TAG:11,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ThreadDelete))return Y(a,{TAG:12,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").AdminRemovedFromGroupThread))return Y(a,{TAG:13,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ThreadMuteSettings))return Y(a,{TAG:14,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").PagesManagerEvent))return Y(a,{TAG:15,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ApprovalMode))return Y(a,{TAG:16,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ApprovalQueue))return Y(a,{TAG:17,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ClientPayload))return Y(a,{TAG:22,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").GenieMessage))return Y(a,{TAG:18,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").RtcCallData))return Y(a,{TAG:19,_0:c});else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").MarkFolderSeen)){m("DeltaMarkFolderSeen");return b("MessengerState.bs").send(b("bs_caml_option").some(a),[{TAG:0,_0:{TAG:66,_0:c}}])}else if(b("bs_caml_obj").caml_equal(c["class"],b("MercurySyncDeltaTypes").ThreadFolder))return Y(a,{TAG:20,_0:c});else return}f.transform=a}),null);
__d("JSSet.bs",[],(function(a,b,c,d,e,f){"use strict";function a(a){return Array.from(a.values())}f.values=a}),null);
__d("MercuryTagHelper",[],(function(a,b,c,d,e,f){"use strict";f.get=a;function a(a,b){a=a.find(function(a){return a!=null?a.startsWith(b):!1});return a==null?a:a.substr(a.indexOf(":")+1)}}),null);
__d("EmojiLikeUtils",["EmojiLikeConstants","MercuryTagHelper"],(function(a,b,c,d,e,f){"use strict";f.setEmojiSize=a;f.setEmojiSource=c;f.isEmojiLike=d;f.getEmojiSize=i;function a(a,b){!a.tags?a.tags=[g(b)]:a.tags.push(g(b));return a}function g(a){var c=b("EmojiLikeConstants").TAG_PREFIX_NEW;return c+":"+a}function c(a,b){!a.tags?a.tags=[h(b)]:a.tags.push(h(b));return a}function h(a){return b("EmojiLikeConstants").SOURCE_TAG_PREFIX+":"+a}function d(a){return i(a)!=null}function i(a){if(!a.tags)return null;var c=b("MercuryTagHelper").get(a.tags,b("EmojiLikeConstants").TAG_PREFIX_NEW);return c?c:b("MercuryTagHelper").get(a.tags,b("EmojiLikeConstants").TAG_PREFIX_OLD)}}),null);
__d("MercuryAttachment",["cx","EmojiLikeUtils","MercuryAudioType"],(function(a,b,c,d,e,f,g){"use strict";var h=function(a){return a===Object(a)},i="_1c_u",j=new Set(["animated_image","photo","video","third_party_sticker"]),k={getAttachIconClass:function(a){switch(a){case"attach:image":return"_y2-";case"attach:video":return"_y2_";case"attach:music":return"_y30";case"attach:voice":return"_y31";case"attach:text":return"_y32";case"attach:pdf":return"_1k9k";case"attach:richtext":return"_1k9l";case"attach:spreadsheet":return"_1k9p";case"attach:presentation":return"_1k9r";case"attach:archive":return"_1k9s";case"attach:ms:word":return"_y33";case"attach:ms:xls":return"_y34";case"attach:ms:ppt":return"_y35"}return"_y36"},getAttachIconClassByMime:function(a){return this.getAttachIconClass(this.getAttachTypeByMime(a))},getAttachTypeByMime:function(a){if(!a)return"attach:unknown";if(a.startsWith("image"))return"attach:image";else if(a.startsWith("video"))return"attach:video";else if(a.startsWith("audio"))return"attach:music";else if(a.startsWith("text/plain"))return"attach:text";else if(a=="text/pdf"||a=="application/pdf"||a=="application/vnd.pdf"||a=="application/x-pdf")return"attach:pdf";else if(a=="text/richtext"||a=="application/rtf"||a=="application/x-iwork-pages-sffkey")return"attach:richtext";else if(a=="text/csv"||a=="application/x-iwork-numbers-sffkey")return"attach:spreadsheet";else if(a=="application/x-iwork-keynote-sffkey")return"attach:presentation";else if(a=="application/vnd.ms-cab-compressed"||a=="application/x-7z-compressed"||a=="application/x-ace-compressed"||a=="application/x-apple-diskimage"||a=="application/x-compress"||a=="application/x-compressed"||a=="application/x-gzip"||a=="application/x-rar-compressed"||a=="application/x-tar"||a=="application/x-zip-compressed"||a=="application/zip")return"attach:archive";else if(a=="application/msword"||a.startsWith("application/vnd.ms-word")||a.startsWith("application/vnd.openxmlformats-officedocument.wordprocessingml"))return"attach:ms:word";else if(a.startsWith("application/vnd.ms-excel")||a.startsWith("application/vnd.openxmlformats-officedocument.spreadsheetml"))return"attach:ms:xls";else if(a.startsWith("application/vnd.ms-powerpoint")||a.startsWith("application/vnd.openxmlformats-officedocument.presentationml"))return"attach:ms:ppt";else return"attach:unknown"},convertRaw:function(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];if(d.attach_type==="photo")b.push(d);else if(d.filename){var e=k.getAttachTypeByMime(d.filetype),f={};f.attach_type="file";f.name=d.filename;f.icon_type=e;f.url="";b.push(f)}}return b},get:function(a){var c=[];a.attachments?c=a.attachments:a.raw_attachments&&(c=this.convertRaw(a.raw_attachments));var d=b("EmojiLikeUtils").getEmojiSize(a);d&&(c=c.concat([{attach_type:"emoji_like",size:d}]));if(!(a.attachments&&a.attachments.length>0)){if(a.sticker_id)return c.concat([{attach_type:"sticker"}]);if(a.preview_attachments&&a.preview_attachments.length>0)return c.concat(a.preview_attachments)}return c},resizeContain:function(a,b){var c=a.width/a.height,d=b.width/b.height;if(d<c)return{width:Math.ceil(Math.min(a.height*d,b.width)),height:Math.ceil(Math.min(a.height,b.height))};else return{width:Math.ceil(Math.min(a.width,b.width)),height:Math.ceil(Math.min(a.width/d,b.height))}},isBubblePreferred:function(a){return this.isFileAttachment(a)},isPhotoAttachment:function(a){return(this==null?void 0:this.getAttachTypeByMime)&&this.getAttachTypeByMime(a.mime_type)==="attach:pdf"?!1:!!(a.attach_type=="photo"||a.attach_type=="animated_image"||a.attach_type=="third_party_sticker"||a.attach_type=="file"&&a.preview_url)},isPhotoGroupAttachment:function(a){return j.has(a.attach_type)},isSinglePhotoGroupAttachment:function(a){return!!(a.attachments&&a.attachments.length===1&&a.attachments[0]&&this.isPhotoGroupAttachment(a.attachments[0]))},isVideoAttachment:function(a){return a.attach_type=="video"},isShareAttachment:function(a){return a.attach_type=="share"},isFileAttachment:function(a){return a.attach_type=="file"},isErrorAttachment:function(a){return a.attach_type=="error"},isStickerAttachment:function(a){return a.attach_type=="sticker"},isEmojiLikeAttachment:function(a){return a.attach_type==="emoji_like"},isVoiceAttachment:function(a){return!a.metadata?!1:a.metadata.type===b("MercuryAudioType").AudioClip||a.metadata.type===b("MercuryAudioType").VoiceMessageWithTranscript},hasAttribution:function(a){return!!a.app_attribution},isLightweightActionAttachment:function(a){return!!(k.isShareAttachment(a)&&a.share&&a.share.target!=null&&a.share.target.lwa_type!=null)},isSingleVideoAttachment:function(a){var b=this;a=this.get(a).filter(h).filter(function(a){return b.isVideoAttachment(a)});return a.length===1},isSharedVideoAttachment:function(a){a=a.attach_type==="share"&&a.share&&a.share.subattachments&&a.share.subattachments[0];return!!(a&&a.target&&a.target.video_id)},isGenieSharedVideoAttachment:function(a){return!!(a.attach_type==="share"&&a.share&&a.share.style_list.indexOf("genie_message")>-1&&a.share.target&&a.share.target.attachment&&this.isSharedVideoAttachment(a.share.target.attachment))},isSharedVideoAttachmentMessage:function(a){var b=this;a=this.get(a).filter(h).filter(function(a){return b.isSharedVideoAttachment(a)||b.isGenieSharedVideoAttachment(a)});return a.length===1},getVideoElem:function(a,b){b=b.getMessageElement(a);if(!b)return null;a=b.getElementsByClassName(i);return a&&a.length?a[0]:b}};e.exports=k}),null);
__d("MercuryDisplayTimeFilterMessageRenderer",["fbt"],(function(a,b,c,d,e,f,g){"use strict";a={renderFilteredContent:function(a){if(a.is_filtered_content_bh)return g._("Ce message a \u00e9t\u00e9 supprim\u00e9 car il contient un lien qui est contraire \u00e0 nos Standards de la communaut\u00e9.");if(a.is_filtered_content_account)return g._("Ce message a \u00e9t\u00e9 supprim\u00e9 temporairement car le compte de l\u2019exp\u00e9diteur n\u00e9cessite une v\u00e9rification.");if(a.is_filtered_content_quasar)return g._("Ce message a \u00e9t\u00e9 supprim\u00e9 car il contient du contenu bloqu\u00e9 ou dangereux.");return a.is_filtered_content_invalid_app?g._("Ce message a \u00e9t\u00e9 supprim\u00e9, car l\u2019app dont il provient n\u2019a pas l\u2019autorisation d\u2019envoyer des messages."):g._("Ce message a \u00e9t\u00e9 temporairement supprim\u00e9, car le compte de l\u2019exp\u00e9diteur doit \u00eatre v\u00e9rifi\u00e9 ou a \u00e9t\u00e9 identifi\u00e9 comme \u00e9tant abusif.")}};e.exports=a}),null);
__d("MercuryMessageClientState",[],(function(a,b,c,d,e,f){a=Object.freeze({DO_NOT_SEND_TO_SERVER:"do_not_send_to_server",SEND_TO_SERVER:"send_to_server"});b=a;e.exports=b}),null);
__d("MercurySyncEventsProxy",["Arbiter","ChannelConstants","LogHistory","MercuryMessagingLightswitch","MercurySingletonProvider","MessengerMQTTConnectionEvents"],(function(a,b,c,d,e,f){"use strict";var g=b("LogHistory").getInstance("mercury_event_proxy"),h={DELTA:"DELTA",FAKE_DFF:"FAKE_DFF",FLOW:"FLOW",FLOW_REJECT:"FLOW_REJECT",INIT:"MercurySyncDeltaHandler/initSeqID",CONNECTED:"CONNECTED",RECONNECTING:"RECONNECTING",SHUTDOWN:"SHUTDOWN",TYP:"TYP"};a=function(){a.getArbiterTypeForFBID=function(a,b){return a+"/"+b};a.getForFBID=function(a){return i.getForFBID(a)};a.get=function(){return i.get()};function a(a){this.$2=[],this.$1=a,this.init()}var c=a.prototype;c.getArbiterType=function(b){return a.getArbiterTypeForFBID(this.$1,b)};c.init=function(){var a=this,c,d;this.$2.forEach(function(a){return b("Arbiter").unsubscribe(a)});this.$2=[(c=b("Arbiter")).subscribe((d=b("MessengerMQTTConnectionEvents")).DELTA_EVENT,function(c){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.DELTA)].concat(e))}),c.subscribe(d.STREAM_CONNECT,function(c){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.CONNECTED)].concat(e))}),c.subscribe(d.STREAM_DISCONNECT,function(c){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.SHUTDOWN)].concat(e))}),c.subscribe(d.STREAM_CONNECTING,function(c){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];return b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.RECONNECTING)].concat(e))}),c.subscribe(b("ChannelConstants").getArbiterType(b("ChannelConstants").FAKE_DFF),function(c){b("MercuryMessagingLightswitch").guard(function(){g.debug("fakedff",JSON.stringify({fbid:a.$1}))});for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.FAKE_DFF)].concat(e))}),c.subscribe(d.TYP,function(c){for(var d=arguments.length,e=new Array(d>1?d-1:0),f=1;f<d;f++)e[f-1]=arguments[f];b("Arbiter").inform.apply(b("Arbiter"),[a.getArbiterType(h.TYP)].concat(e))})]};return a}();e.exports=a;a.Events=h;var i=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercuryThreadInfo",["MercuryIDs"],(function(a,b,c,d,e,f){"use strict";f.canReply=a;f.getMuteSetting=g;f.isEmptyLocalThread=h;f.isMuted=c;f.areMentionsMuted=d;f.areReactionsMuted=e;f.isNewEmptyLocalThread=i;f.showSettingsMenu=j;f.isColdOpen=k;function a(a){return!!(a.is_subscribed&&(a.can_reply===void 0||a.can_reply)&&!a.has_email_participant&&!a.read_only)}function g(a){return a.mute_until==null?void 0:a.mute_until}function h(a){return b("MercuryIDs").tokenize(a.thread_id).type==="root"&&!a.timestamp}function c(a){a=g(a);return a!=null&&(a>Date.now()/1e3||a===-1)}function d(a){return a.mentions_mute_mode===1}function e(a){return a.reactions_mute_mode===1}function i(a){return!!(h(a)&&a.participants&&a.participants.length===0)}function j(a){return!!((a.can_reply||!a.cannot_reply_reason||a.cannot_reply_reason.toLowerCase()==="blocked"||a.cannot_reply_reason.toLowerCase()==="messenger_blockee")&&!a.has_email_participant&&!a.read_only&&a.is_subscribed)}function k(a){return!!(a.is_canonical_user&&(a.message_count===0||!a.timestamp))}}),null);
__d("ThreadConnectivityStatusGraphQLType.bs",[],(function(a,b,c,d,e,f){"use strict";a="UNCONNECTED";b="IMPLICIT_OR_TWO_WAY_MESSAGING";f.unconnected=a;f.implicitOrTwoWayMessaging=b}),null);
__d("ThreadConnectivityStatusGraphQLType.re",["ThreadConnectivityStatusGraphQLType.bs"],(function(a,b,c,d,e,f){a=b("ThreadConnectivityStatusGraphQLType.bs").unconnected;f.unconnected=a;c=b("ThreadConnectivityStatusGraphQLType.bs").implicitOrTwoWayMessaging;f.implicitOrTwoWayMessaging=c}),null);
__d("getPageIDFromThreadID",["FBIDCheck","MercuryIDs"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){a=b("MercuryIDs").getUserIDFromThreadID(a);return!a||b("FBIDCheck").isUser_deprecated(a)?null:a}}),null);
__d("MessageRequestUtils",["CurrentUser","MercuryIDs","MessagingTag","ThreadConnectivityStatusGraphQLType.re","getPageIDFromThreadID"],(function(a,b,c,d,e,f){"use strict";f.isMessageRequest=a;f.isFiltered=c;f.shouldShowComposerPendingActions=d;f.shouldShowUnconnectedThreadInfoText=e;f.shouldSendTypingIndicators=g;function a(a){return(a.folder===b("MessagingTag").PENDING||a.folder===b("MessagingTag").OTHER)&&a.can_reply}function c(a){return a.folder===b("MessagingTag").OTHER}function d(a){return this.isMessageRequest(a)&&(b("MercuryIDs").isGroupChat(a.thread_id)||!!b("getPageIDFromThreadID")(a.thread_id)||b("CurrentUser").isWorkUser())}function e(a){var c;return!b("CurrentUser").isWorkUser()&&b("CurrentUser").getID()!==a.other_user_fbid&&((c=a.thread_connectivity_data)==null?void 0:c.connectivity_status)===b("ThreadConnectivityStatusGraphQLType.re").unconnected&&((c=a.thread_connectivity_data)==null?void 0:c.first_sender_id)===a.other_user_fbid}function g(a){if(!a)return!1;if(this.isMessageRequest(a))return!1;return b("CurrentUser").isWorkUser()||b("MercuryIDs").isGroupChat(a.thread_id)?!0:((a=a.thread_connectivity_data)==null?void 0:a.connectivity_status)===b("ThreadConnectivityStatusGraphQLType.re").implicitOrTwoWayMessaging}}),null);
__d("MessengerJoinableModeType",[],(function(a,b,c,d,e,f){a=Object.freeze({PRIVATE:0,JOINABLE:1});e.exports=a}),null);
__d("MessengerThreadUtils.bs",["FBID.bs","bs_caml_obj","MercuryIDs","CurrentUser","ImmutableObject","MessengerParticipants.bs","MercuryParticipantTypes","MessengerJoinableModeType","MessengerObjectAssociationType","MessengerThreadCannotReplyReason"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return c.filter(function(c){return b("bs_caml_obj").caml_notequal(c,a)}).length<=1}function h(a,c,d,e){var f=b("MercuryIDs").tokenize(c),h=f.type;f=f.value;var i=d.find(function(b){return b!==a});i=i!==void 0?b("MessengerParticipants.bs").getNow(i):null;var j=b("CurrentUser").isWorkUser();j=!(i==null)&&j&&i.work_foreign_entity_info==null&&i.user_type===b("MercuryParticipantTypes").USER?[!1,b("MessengerThreadCannotReplyReason").RECIPIENTS_INVALID]:[!0,null];return new(b("ImmutableObject"))({thread_id:c,participants:Array.from(d),preloaded_participants:[],admins:{},name:"",snippet:"",snippet_sender:null,unread_count:e==null?0:e,message_count:0,image_src:null,square_image_src:null,timestamp:0,other_user_fbid:h==="user"?b("FBID.bs").ofStringExn(f):null,is_canonical_user:h==="user",is_canonical:g(a,d),is_subscribed:!0,is_other_recipient_page:!1,folder:"inbox",is_archived:!1,is_page_follow_up:!1,is_page_unresponded_thread:!1,admin_model_status:null,approval_mode:0,approval_queue_ids:[],associated_object:null,can_reply:j[0],cannot_reply_reason:j[1],can_viewer_report:!1,comm_item_owners:null,comm_source_id:null,comm_status:null,comm_icon_type:[],composer_input_disabled:null,custom_like_icon:null,custom_nickname:null,customization_enabled:!1,description:null,ephemeral_ttl_mode:0,footer_color:null,game_id:null,group_approval_queue:null,work_associated_group:null,pinned_messages:null,groups_sync_status:null,group_thread_subtype:null,has_email_participant:!1,has_montage:!1,unread_mentions_count:0,header_color:null,is_canonical_neo_user:!1,is_from_weak_entry_point:!1,is_pin_protected:!1,is_pinned:!1,is_thread_queue_enabled:!1,joinable_mode:{mode:0,link:""},last_message_timestamp:0,last_message_id:null,last_message_type:null,last_read_timestamp:0,last_message_admin_text_type:null,last_message_unsendability_status:null,lightweight_event:null,lightweight_events:{},marketplace_thread_data:null,mentions_mute_mode:0,mute_until:null,object_association_type:null,page_comm_item_id:null,page_thread_info:null,page_unsubscribe_status:!1,participant_add_mode:null,participants_event_status:null,reactions_mute_mode:0,read_only:!1,recipients_loadable:!1,rtc_call_data:null,server_timestamp:0,snippet_attachments:[],solid_color:null,subtitle:null,theme_id:null,reactions:void 0,thread_connectivity_data:null,thread_fbid:null,thread_pin_timestamp:null,thread_type:null,thread_unsendability_status:null,gradient_colors:[],accessibility_label:null,reverse_gradients_for_radial:null,joinable_link:null,linked_mentorship_programs:null,is_business_page_active:!1,thread_associated_job_applications:null,thread_associated_page_admin:null,graphql_token:null,conversion_detection_data:null,suggested_reply_data:null})}function a(a,c,d,e){a=h(a,c,d,null);return b("ImmutableObject").set(a,{associated_object:e,name:e.name,joinable_mode:{mode:b("MessengerJoinableModeType").JOINABLE,link:""},object_association_type:b("MessengerObjectAssociationType").GENERAL_CHAT})}f.isCanonicalFromInitialParticipants=g;f.createNewLocalThread=h;f.createNewLocalGroupGeneralThread=a}),null);
__d("ParticipantId.bs",["bs_string","bs_belt_Id"],(function(a,b,c,d,e,f){"use strict";a=b("bs_string").compare;c=b("bs_belt_Id").MakeComparable({cmp:a});d=c.cmp;f.cmp=d}),null);
__d("RemoteAction.bs",["bs_curry"],(function(a,b,c,d,e,f){"use strict";function g(a){}function a(a){return{send:g}}function c(a,b){if(b.send===g){b.send=a;return b}}function d(a){a.send=g}function e(a,c){return b("bs_curry")._1(a.send,c)}f.create=a;f.subscribe=c;f.unsubscribe=d;f.send=e}),null);
__d("ThreadConnectivityStatus",[],(function(a,b,c,d,e,f){a=Object.freeze({UNCONNECTED:0,IMPLICIT_OR_TWO_WAY_MESSAGING:1});e.exports=a}),null);
__d("ThreadConnectivityStatus.bs",["bs_caml_obj","ThreadConnectivityStatus","ThreadConnectivityStatusGraphQLType.bs"],(function(a,b,c,d,e,f){"use strict";function a(a){if(b("bs_caml_obj").caml_equal(a,b("ThreadConnectivityStatus").UNCONNECTED))return b("ThreadConnectivityStatusGraphQLType.bs").unconnected;else return b("ThreadConnectivityStatusGraphQLType.bs").implicitOrTwoWayMessaging}f.toGraphQLValue=a}),null);
__d("ThreadId.bs",["bs_string","bs_belt_Id"],(function(a,b,c,d,e,f){"use strict";a=b("bs_string").compare;c=b("bs_belt_Id").MakeComparable({cmp:a});d=c.cmp;f.cmp=d}),null);
__d("TypingStates",[],(function(a,b,c,d,e,f){a=Object.freeze({INACTIVE:0,TYPING:1,QUITTING:2});e.exports=a}),null);
__d("XMercuryThreadLikeIconController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/like_icon/",{emoji:{type:"String",defaultValue:""}})}),null);
__d("bs_belt_internalAVLtree",["bs_curry","bs_caml_option","bs_belt_SortArray"],(function(a,b,c,d,e,f){"use strict";function g(a){if(a!==void 0)return a.h;else return 0}function h(a){if(a!==void 0)return{k:a.k,v:a.v,h:a.h,l:h(a.l),r:h(a.r)};else return a}function i(a,b,c,d){var e=g(a),f=g(d);return{k:b,v:c,h:e>=f?e+1|0:f+1|0,l:a,r:d}}function j(a,b){return{k:a,v:b,h:1,l:void 0,r:void 0}}function k(a,b){if(b!==void 0)if(a!==void 0)return a.h>=b.h;else return!1;else return!0}function a(a,b){if(a.v===b)return a;else return{k:a.k,v:b,h:a.h,l:a.l,r:a.r}}function l(a,b,c,d){var e=a!==void 0?a.h:0,f=d!==void 0?d.h:0;if(e>(f+2|0)){var h=a.l,j=a.r;if(g(h)>=g(j))return i(h,a.k,a.v,i(j,b,c,d));else return i(i(h,a.k,a.v,j.l),j.k,j.v,i(j.r,b,c,d))}if(f<=(e+2|0))return{k:b,v:c,h:e>=f?e+1|0:f+1|0,l:a,r:d};h=d.l;j=d.r;if(g(j)>=g(h))return i(i(a,b,c,h),d.k,d.v,j);else return i(i(a,b,c,h.l),h.k,h.v,i(h.r,d.k,d.v,j))}function m(a){while(!0){var b=a,c=b.l;if(c===void 0)return b.k;a=c;continue}}function c(a){if(a!==void 0)return b("bs_caml_option").some(m(a))}function d(a){if(a!==void 0)return m(a)}function n(a){while(!0){var b=a,c=b.r;if(c===void 0)return b.k;a=c;continue}}function e(a){if(a!==void 0)return b("bs_caml_option").some(n(a))}function o(a){if(a!==void 0)return n(a)}function p(a){while(!0){var b=a,c=b.l;if(c===void 0)return[b.k,b.v];a=c;continue}}function q(a){if(a!==void 0)return p(a)}function r(a){if(a!==void 0)return p(a)}function s(a){while(!0){var b=a,c=b.r;if(c===void 0)return[b.k,b.v];a=c;continue}}function t(a){if(a!==void 0)return s(a)}function aa(a){if(a!==void 0)return s(a)}function u(a,b,c){var d=a.l;if(d!==void 0)return l(u(d,b,c),a.k,a.v,a.r);else{b.contents=a.k;c.contents=a.v;return a.r}}function ba(a){return a===void 0}function v(a,b){while(!0){var c=b,d=a;if(d===void 0)return c;b={hd:d,tl:c};a=d.l;continue}}function w(a,b){if(a===void 0)return;var c=w(a.l,b);if(c!==void 0)return c;c=a.k;var d=a.v,e=b(c,d);if(e)return[c,d];e=w(a.r,b);if(e!==void 0)return e}function ca(a,c){return w(a,b("bs_curry").__2(c))}function x(a,b){while(!0){var c=a;if(c===void 0)return;x(c.l,b);b(c.k,c.v);a=c.r;continue}}function da(a,c){return x(a,b("bs_curry").__2(c))}function y(a,b){if(a===void 0)return;var c=y(a.l,b),d=b(a.v);b=y(a.r,b);return{k:a.k,v:d,h:a.h,l:c,r:b}}function ea(a,c){return y(a,b("bs_curry").__1(c))}function z(a,b){if(a===void 0)return;var c=a.k,d=z(a.l,b),e=b(c,a.v);b=z(a.r,b);return{k:c,v:e,h:a.h,l:d,r:b}}function fa(a,c){return z(a,b("bs_curry").__2(c))}function A(a,b,c){while(!0){var d=b,e=a;if(e===void 0)return d;var f=e.k,g=e.v,h=e.l;e=e.r;b=c(A(h,d,c),f,g);a=e;continue}}function ga(a,c,d){return A(a,c,b("bs_curry").__3(d))}function B(a,b){while(!0){var c=a;if(c===void 0)return!0;if(!b(c.k,c.v))return!1;if(!B(c.l,b))return!1;a=c.r;continue}}function ha(a,c){return B(a,b("bs_curry").__2(c))}function C(a,b){while(!0){var c=a;if(c===void 0)return!1;if(b(c.k,c.v))return!0;if(C(c.l,b))return!0;a=c.r;continue}}function ia(a,c){return C(a,b("bs_curry").__2(c))}function D(a,b,c){if(a!==void 0)return l(D(a.l,b,c),a.k,a.v,a.r);else return j(b,c)}function E(a,b,c){if(a!==void 0)return l(a.l,a.k,a.v,E(a.r,b,c));else return j(b,c)}function F(a,b,c,d){if(a===void 0)return D(d,b,c);if(d===void 0)return E(a,b,c);var e=a.k,f=a.v,g=a.h,h=a.l,j=a.r,k=d.k,m=d.v,n=d.h,o=d.l,p=d.r;if(g>(n+2|0))return l(h,e,f,F(j,b,c,d));else if(n>(g+2|0))return l(F(a,b,c,o),k,m,p);else return i(a,b,c,d)}function G(a,b){if(a===void 0)return b;if(b===void 0)return a;var c={contents:b.k},d={contents:b.v};b=u(b,c,d);return F(a,c.contents,d.contents,b)}function ja(a,c,d,e){if(d!==void 0)return F(a,c,b("bs_caml_option").valFromOption(d),e);else return G(a,e)}function H(a,b){if(a===void 0)return;var c=a.k,d=a.v,e=H(a.l,b),f=b(c,d);a=H(a.r,b);if(f)return F(e,c,d,a);else return G(e,a)}function ka(a,c){return H(a,b("bs_curry").__2(c))}function I(a,c){if(a===void 0)return;var d=a.k,e=a.v,f=I(a.l,c);e=c(d,e);a=I(a.r,c);if(e!==void 0)return F(f,d,b("bs_caml_option").valFromOption(e),a);else return G(f,a)}function la(a,c){return I(a,b("bs_curry").__2(c))}function J(a,b){if(a===void 0)return[void 0,void 0];var c=a.k,d=a.v,e=J(a.l,b),f=e[1];e=e[0];var g=b(c,d);a=J(a.r,b);b=a[1];a=a[0];if(g)return[F(e,c,d,a),G(f,b)];else return[G(e,a),F(f,c,d,b)]}function ma(a,c){return J(a,b("bs_curry").__2(c))}function K(a){var b=a.l;a=a.r;b=b!==void 0?K(b):0;a=a!==void 0?K(a):0;return(1+b|0)+a|0}function L(a){if(a!==void 0)return K(a);else return 0}function M(a,b){while(!0){var c=b,d=a;if(d===void 0)return c;var e=d.k,f=d.v,g=d.l;d=d.r;b={hd:[e,f],tl:M(d,c)};a=g;continue}}function na(a){return M(a,0)}function N(a){while(!0){var b=a;if(b===void 0)return;var c=b.l;b=b.r;var d=g(c)-g(b)|0;if(!(d<=2&&d>=-2))throw{RE_EXN_ID:"Assert_failure",_1:["belt_internalAVLtree.ml",373,4],Error:new Error()};N(c);a=b;continue}}function O(a,b,c){while(!0){var d=b,e=a,f=e.k,g=e.l;e=e.r;g=g!==void 0?O(g,d,c):d;c[g]=f;d=g+1|0;if(e===void 0)return d;b=d;a=e;continue}}function P(a,b,c){while(!0){var d=b,e=a,f=e.l,g=e.r;f=f!==void 0?P(f,d,c):d;c[f]=e.v;d=f+1|0;if(g===void 0)return d;b=d;a=g;continue}}function Q(a,b,c){while(!0){var d=b,e=a,f=e.l,g=e.k,h=e.r;f=f!==void 0?Q(f,d,c):d;c[f]=[g,e.v];d=f+1|0;if(h===void 0)return d;b=d;a=h;continue}}function oa(b){if(b===void 0)return[];var a=K(b);a=new Array(a);Q(b,0,a);return a}function pa(b){if(b===void 0)return[];var a=K(b);a=new Array(a);O(b,0,a);return a}function qa(b){if(b===void 0)return[];var a=K(b);a=new Array(a);P(b,0,a);return a}function R(a,b,c){switch(c){case 0:return;case 1:var d=a[b];return j(d[0],d[1]);case 2:d=a[b];var e=a[b-1|0];e=e;d=d;return{k:e[0],v:e[1],h:2,l:j(d[0],d[1]),r:void 0};case 3:e=a[b];d=a[b-1|0];var f=a[b-2|0];f=f;d=d;e=e;return{k:d[0],v:d[1],h:2,l:j(e[0],e[1]),r:j(f[0],f[1])};default:d=c/2|0;e=R(a,b,d);f=a[b-d|0];a=R(a,(b-d|0)-1|0,(c-d|0)-1|0);return i(e,f[0],f[1],a)}}function S(a,b,c){switch(c){case 0:return;case 1:var d=a[b];return j(d[0],d[1]);case 2:d=a[b];var e=a[b+1|0];e=e;d=d;return{k:e[0],v:e[1],h:2,l:j(d[0],d[1]),r:void 0};case 3:e=a[b];d=a[b+1|0];var f=a[b+2|0];f=f;d=d;e=e;return{k:d[0],v:d[1],h:2,l:j(e[0],e[1]),r:j(f[0],f[1])};default:d=c/2|0;e=S(a,b,d);f=a[b+d|0];a=S(a,(b+d|0)+1|0,(c-d|0)-1|0);return i(e,f[0],f[1],a)}}function ra(a){return S(a,0,a.length)}function T(a,b,c,d){var e=L(a),f=L(b);if(e===f){a=v(a,0);b=v(b,0);while(!0){var g=b,h=a;if(!h)return 0;if(!g)return 0;var i=g.hd,j=h.hd,k=c(j.k,i.k);if(k!==0)return k;k=d(j.v,i.v);if(k!==0)return k;b=v(i.r,g.tl);a=v(j.r,h.tl);continue}}else if(e<f)return-1;else return 1}function sa(a,c,d,e){return T(a,c,d,b("bs_curry").__2(e))}function U(a,b,c,d){var e=L(a),f=L(b);if(e===f){e=v(a,0);f=v(b,0);while(!0){a=f;b=e;if(!b)return!0;if(!a)return!0;var g=a.hd,h=b.hd;if(!(c(h.k,g.k)===0&&d(h.v,g.v)))return!1;f=v(g.r,a.tl);e=v(h.r,b.tl);continue}}else return!1}function ta(a,c,d,e){return U(a,c,d,b("bs_curry").__2(e))}function ua(c,d,a){while(!0){var e=c;if(e===void 0)return;var f=e.k;f=a(d,f);if(f===0)return b("bs_caml_option").some(e.v);c=f<0?e.l:e.r;continue}}function va(b,c,a){while(!0){var d=b;if(d===void 0)return;var e=d.k;e=a(c,e);if(e===0)return d.v;b=e<0?d.l:d.r;continue}}function wa(b,c,a){while(!0){var d=b;if(d!==void 0){var e=d.k;e=a(c,e);if(e===0)return d.v;b=e<0?d.l:d.r;continue}throw{RE_EXN_ID:"Not_found",Error:new Error()}}}function xa(b,c,d,a){while(!0){var e=b;if(e===void 0)return d;var f=e.k;f=a(c,f);if(f===0)return e.v;b=f<0?e.l:e.r;continue}}function ya(b,c,a){while(!0){var d=b;if(d===void 0)return!1;var e=d.k;e=a(c,e);if(e===0)return!0;b=e<0?d.l:d.r;continue}}function V(a){var b=a.l;a.l=b.r;b.r=a;var c=g(a.l),d=g(a.r);a.h=(c>d?c:d)+1|0;c=g(b.l);d=a.h;b.h=(c>d?c:d)+1|0;return b}function W(a){var b=a.r;a.r=b.l;b.l=a;var c=g(a.l),d=g(a.r);a.h=(c>d?c:d)+1|0;c=g(b.r);d=a.h;b.h=(c>d?c:d)+1|0;return b}function za(a){var b=a.l;b=W(b);a.l=b;return V(a)}function Aa(a){var b=a.r;b=V(b);a.r=b;return W(a)}function X(a){var b=g(a.l),c=g(a.r);a.h=(b>c?b:c)+1|0;return a}function Y(a){var b=a.l,c=a.r,d=g(b),e=g(c);if(d>(2+e|0)){var f=b.l;b=b.r;if(k(f,b))return X(V(a));else return X(za(a))}if(e>(2+d|0)){f=c.l;b=c.r;if(k(b,f))return X(W(a));else return X(Aa(a))}a.h=(d>e?d:e)+1|0;return a}function Z(b,c,d,a){if(b===void 0)return j(c,d);var e=b.k;e=a(c,e);if(e===0){b.v=d;return b}var f=b.l,g=b.r;if(e<0){e=Z(f,c,d,a);b.l=e}else b.r=Z(g,c,d,a);return Y(b)}function Ba(c,a){var d=c.length;if(d===0)return;var e=b("bs_belt_SortArray").strictlySortedLengthU(c,function(b,c){return a(b[0],c[0])<0}),f;e>=0?f=S(c,0,e):(e=-e|0,f=R(c,e-1|0,e));for(var e=e;e<d;++e){var g=c[e];f=Z(f,g[0],g[1],a)}return f}function $(a,b){var c=b.r,d=b.l;if(d!==void 0){b.l=$(a,d);return Y(b)}else{a.k=b.k;a.v=b.v;return c}}f.copy=h;f.create=i;f.bal=l;f.singleton=j;f.updateValue=a;f.minKey=c;f.minKeyUndefined=d;f.maxKey=e;f.maxKeyUndefined=o;f.minimum=q;f.minUndefined=r;f.maximum=t;f.maxUndefined=aa;f.removeMinAuxWithRef=u;f.isEmpty=ba;f.stackAllLeft=v;f.findFirstByU=w;f.findFirstBy=ca;f.forEachU=x;f.forEach=da;f.mapU=y;f.map=ea;f.mapWithKeyU=z;f.mapWithKey=fa;f.reduceU=A;f.reduce=ga;f.everyU=B;f.every=ha;f.someU=C;f.some=ia;f.join=F;f.concat=G;f.concatOrJoin=ja;f.keepSharedU=H;f.keepShared=ka;f.keepMapU=I;f.keepMap=la;f.partitionSharedU=J;f.partitionShared=ma;f.lengthNode=K;f.size=L;f.toList=na;f.checkInvariantInternal=N;f.fillArray=Q;f.toArray=oa;f.keysToArray=pa;f.valuesToArray=qa;f.fromSortedArrayAux=S;f.fromSortedArrayRevAux=R;f.fromSortedArrayUnsafe=ra;f.cmpU=T;f.cmp=sa;f.eqU=U;f.eq=ta;f.get=ua;f.getUndefined=va;f.getWithDefault=xa;f.getExn=wa;f.has=ya;f.fromArray=Ba;f.updateMutate=Z;f.balMutate=Y;f.removeMinAuxWithRootMutate=$}),null);
__d("bs_belt_MapDict",["bs_curry","bs_caml_option","bs_belt_internalAVLtree"],(function(a,b,c,d,e,f){"use strict";var g;function h(c,d,e,a){if(c===void 0)return b("bs_belt_internalAVLtree").singleton(d,e);var f=c.k,g=a(d,f);if(g===0)return b("bs_belt_internalAVLtree").updateValue(c,e);var i=c.l,j=c.r;c=c.v;if(g<0)return b("bs_belt_internalAVLtree").bal(h(i,d,e,a),f,c,j);else return b("bs_belt_internalAVLtree").bal(i,f,c,h(j,d,e,a))}function i(c,d,e,a){if(c!==void 0){var f=c.k,g=a(d,f);if(g===0){var h=e(b("bs_caml_option").some(c.v));if(h!==void 0)return b("bs_belt_internalAVLtree").updateValue(c,b("bs_caml_option").valFromOption(h));h=c.l;var j=c.r;if(h===void 0)return j;if(j===void 0)return h;var k={contents:j.k},l={contents:j.v};j=b("bs_belt_internalAVLtree").removeMinAuxWithRef(j,k,l);return b("bs_belt_internalAVLtree").bal(h,k.contents,l.contents,j)}h=c.l;k=c.r;l=c.v;if(g<0){j=i(h,d,e,a);if(h===j)return c;else return b("bs_belt_internalAVLtree").bal(j,f,l,k)}g=i(k,d,e,a);if(k===g)return c;else return b("bs_belt_internalAVLtree").bal(h,f,l,g)}j=e(void 0);if(j!==void 0)return b("bs_belt_internalAVLtree").singleton(d,b("bs_caml_option").valFromOption(j));else return c}function a(c,d,e,a){return i(c,d,b("bs_curry").__1(e),a)}function j(c,d,a){var e=c.k,f=c.l,g=c.r,h=a(d,e);if(h===0){if(f===void 0)return g;if(g===void 0)return f;var i={contents:g.k},k={contents:g.v},l=b("bs_belt_internalAVLtree").removeMinAuxWithRef(g,i,k);return b("bs_belt_internalAVLtree").bal(f,i.contents,k.contents,l)}if(h<0){if(f===void 0)return c;i=j(f,d,a);if(i===f)return c;else return b("bs_belt_internalAVLtree").bal(i,e,c.v,g)}if(g===void 0)return c;k=j(g,d,a);if(k===g)return c;else return b("bs_belt_internalAVLtree").bal(f,e,c.v,k)}function c(b,c,a){if(b!==void 0)return j(b,c,a)}function d(b,c,a){var d=c.length;b=b;for(var e=0;e<d;++e){var f=c[e];b=h(b,f[0],f[1],a)}return b}function k(c,d,e,a){var f=c.k,g=c.v,h=c.l,i=c.r,j=a(d,f);if(j===0){e.contents=b("bs_caml_option").some(g);return[h,i]}if(j<0){if(h===void 0)return[void 0,c];j=k(h,d,e,a);return[j[0],b("bs_belt_internalAVLtree").join(j[1],f,g,i)]}if(i===void 0)return[c,void 0];j=k(i,d,e,a);return[b("bs_belt_internalAVLtree").join(h,f,g,j[0]),j[1]]}function e(b,c,a){if(b===void 0)return[[void 0,void 0],void 0];var d={contents:void 0};b=k(b,c,d,a);return[b,d.contents]}function l(c,d,e,a){if(c===void 0)if(d!==void 0)return b("bs_belt_internalAVLtree").keepMapU(d,function(a,c){return e(a,void 0,b("bs_caml_option").some(c))});else return;if(d===void 0)return b("bs_belt_internalAVLtree").keepMapU(c,function(a,c){return e(a,b("bs_caml_option").some(c),void 0)});if(c.h>=d.h){var f=c.k,g=c.v,h=c.l,i=c.r,j={contents:void 0},m=k(d,f,j,a);j=j.contents;h=l(h,m[0],e,a);g=e(f,b("bs_caml_option").some(g),j);j=l(i,m[1],e,a);return b("bs_belt_internalAVLtree").concatOrJoin(h,f,g,j)}i=d.k;m=d.v;h=d.l;f=d.r;g={contents:void 0};j=k(c,i,g,a);d=g.contents;c=l(j[0],h,e,a);g=e(i,d,b("bs_caml_option").some(m));h=l(j[1],f,e,a);return b("bs_belt_internalAVLtree").concatOrJoin(c,i,g,h)}function m(c,d,e,a){return l(c,d,b("bs_curry").__3(e),a)}function n(b,c,a){var d=c.length;if(b!==void 0){b=b;var e=0;while(!0){var f=e,g=b;if(f>=d)return g;var h=c[f];g=j(g,h,a);if(g===void 0)return g;e=f+1|0;b=g;continue}}}var o,p=(g=b("bs_belt_internalAVLtree")).isEmpty,q=g.has,r=g.cmpU,s=g.cmp,t=g.eqU,u=g.eq,v=g.findFirstByU,w=g.findFirstBy,x=g.forEachU,y=g.forEach,z=g.reduceU,A=g.reduce,B=g.everyU,C=g.every,D=g.someU,E=g.some,F=g.size,G=g.toList,H=g.toArray,I=g.fromArray,J=g.keysToArray,K=g.valuesToArray,L=g.minKey,M=g.minKeyUndefined,N=g.maxKey,O=g.maxKeyUndefined,P=g.minimum,Q=g.minUndefined,R=g.maximum,S=g.maxUndefined,T=g.get,U=g.getUndefined,V=g.getWithDefault,W=g.getExn,X=g.checkInvariantInternal,Y=g.keepSharedU,Z=g.keepShared,$=g.partitionSharedU,aa=g.partitionShared,ba=g.mapU,ca=g.map,da=g.mapWithKeyU;g=g.mapWithKey;f.empty=o;f.isEmpty=p;f.has=q;f.cmpU=r;f.cmp=s;f.eqU=t;f.eq=u;f.findFirstByU=v;f.findFirstBy=w;f.forEachU=x;f.forEach=y;f.reduceU=z;f.reduce=A;f.everyU=B;f.every=C;f.someU=D;f.some=E;f.size=F;f.toList=G;f.toArray=H;f.fromArray=I;f.keysToArray=J;f.valuesToArray=K;f.minKey=L;f.minKeyUndefined=M;f.maxKey=N;f.maxKeyUndefined=O;f.minimum=P;f.minUndefined=Q;f.maximum=R;f.maxUndefined=S;f.get=T;f.getUndefined=U;f.getWithDefault=V;f.getExn=W;f.checkInvariantInternal=X;f.remove=c;f.removeMany=n;f.set=h;f.updateU=i;f.update=a;f.mergeU=l;f.merge=m;f.mergeMany=d;f.keepU=Y;f.keep=Z;f.partitionU=$;f.partition=aa;f.split=e;f.mapU=ba;f.map=ca;f.mapWithKeyU=da;f.mapWithKey=g}),null);
__d("bs_belt_Map",["bs_curry","bs_belt_MapDict"],(function(a,b,c,d,e,f){"use strict";function a(a,c){c=c.cmp;return{cmp:c,data:b("bs_belt_MapDict").fromArray(a,c)}}function c(c,d){var e=c.data,a=c.cmp;d=b("bs_belt_MapDict").remove(e,d,a);if(d===e)return c;else return{cmp:a,data:d}}function d(c,d){var a=c.cmp;c=b("bs_belt_MapDict").removeMany(c.data,d,a);return{cmp:a,data:c}}function e(c,d,e){var a=c.cmp;return{cmp:a,data:b("bs_belt_MapDict").set(c.data,d,e,a)}}function g(c,d){var a=c.cmp;return{cmp:a,data:b("bs_belt_MapDict").mergeMany(c.data,d,a)}}function h(c,d,e){var a=c.cmp;return{cmp:a,data:b("bs_belt_MapDict").updateU(c.data,d,e,a)}}function i(a,c,d){return h(a,c,b("bs_curry").__1(d))}function j(c,d){var a=c.cmp;c=b("bs_belt_MapDict").split(c.data,d,a);d=c[0];return[[{cmp:a,data:d[0]},{cmp:a,data:d[1]}],c[1]]}function k(c,d,e){var a=c.cmp;return{cmp:a,data:b("bs_belt_MapDict").mergeU(c.data,d.data,e,a)}}function l(a,c,d){return k(a,c,b("bs_curry").__3(d))}function m(a){return{cmp:a.cmp,data:void 0}}function n(a){return b("bs_belt_MapDict").isEmpty(a.data)}function o(a,c){return b("bs_belt_MapDict").findFirstByU(a.data,c)}function p(a,c){return b("bs_belt_MapDict").findFirstByU(a.data,b("bs_curry").__2(c))}function q(a,c){return b("bs_belt_MapDict").forEachU(a.data,c)}function r(a,c){return b("bs_belt_MapDict").forEachU(a.data,b("bs_curry").__2(c))}function s(a,c,d){return b("bs_belt_MapDict").reduceU(a.data,c,d)}function t(a,c,d){return s(a,c,b("bs_curry").__3(d))}function u(a,c){return b("bs_belt_MapDict").everyU(a.data,c)}function v(a,c){return b("bs_belt_MapDict").everyU(a.data,b("bs_curry").__2(c))}function w(a,c){return b("bs_belt_MapDict").someU(a.data,c)}function x(a,c){return b("bs_belt_MapDict").someU(a.data,b("bs_curry").__2(c))}function y(a,c){return{cmp:a.cmp,data:b("bs_belt_MapDict").keepU(a.data,c)}}function z(a,c){return y(a,b("bs_curry").__2(c))}function A(c,d){var a=c.cmp;c=b("bs_belt_MapDict").partitionU(c.data,d);return[{cmp:a,data:c[0]},{cmp:a,data:c[1]}]}function B(a,c){return A(a,b("bs_curry").__2(c))}function C(a,c){return{cmp:a.cmp,data:b("bs_belt_MapDict").mapU(a.data,c)}}function D(a,c){return C(a,b("bs_curry").__1(c))}function E(a,c){return{cmp:a.cmp,data:b("bs_belt_MapDict").mapWithKeyU(a.data,c)}}function F(a,c){return E(a,b("bs_curry").__2(c))}function G(a){return b("bs_belt_MapDict").size(a.data)}function H(a){return b("bs_belt_MapDict").toList(a.data)}function I(a){return b("bs_belt_MapDict").toArray(a.data)}function J(a){return b("bs_belt_MapDict").keysToArray(a.data)}function K(a){return b("bs_belt_MapDict").valuesToArray(a.data)}function L(a){return b("bs_belt_MapDict").minKey(a.data)}function M(a){return b("bs_belt_MapDict").minKeyUndefined(a.data)}function N(a){return b("bs_belt_MapDict").maxKey(a.data)}function O(a){return b("bs_belt_MapDict").maxKeyUndefined(a.data)}function P(a){return b("bs_belt_MapDict").minimum(a.data)}function Q(a){return b("bs_belt_MapDict").minUndefined(a.data)}function R(a){return b("bs_belt_MapDict").maximum(a.data)}function S(a){return b("bs_belt_MapDict").maxUndefined(a.data)}function T(a,c){return b("bs_belt_MapDict").get(a.data,c,a.cmp)}function U(a,c){return b("bs_belt_MapDict").getUndefined(a.data,c,a.cmp)}function V(a,c,d){return b("bs_belt_MapDict").getWithDefault(a.data,c,d,a.cmp)}function W(a,c){return b("bs_belt_MapDict").getExn(a.data,c,a.cmp)}function X(a,c){return b("bs_belt_MapDict").has(a.data,c,a.cmp)}function Y(a){return b("bs_belt_MapDict").checkInvariantInternal(a.data)}function Z(a,c,d){return b("bs_belt_MapDict").eqU(a.data,c.data,a.cmp,d)}function aa(a,c,d){return Z(a,c,b("bs_curry").__2(d))}function $(a,c,d){return b("bs_belt_MapDict").cmpU(a.data,c.data,a.cmp,d)}function ba(a,c,d){return $(a,c,b("bs_curry").__2(d))}function ca(a){return a.data}function da(a){a=a.cmp;return{cmp:a}}function ea(a,b){return{cmp:a.cmp,data:b}}var fa,ga,ha;f.Int=fa;f.$$String=ga;f.Dict=ha;f.make=m;f.isEmpty=n;f.has=X;f.cmpU=$;f.cmp=ba;f.eqU=Z;f.eq=aa;f.findFirstByU=o;f.findFirstBy=p;f.forEachU=q;f.forEach=r;f.reduceU=s;f.reduce=t;f.everyU=u;f.every=v;f.someU=w;f.some=x;f.size=G;f.toArray=I;f.toList=H;f.fromArray=a;f.keysToArray=J;f.valuesToArray=K;f.minKey=L;f.minKeyUndefined=M;f.maxKey=N;f.maxKeyUndefined=O;f.minimum=P;f.minUndefined=Q;f.maximum=R;f.maxUndefined=S;f.get=T;f.getUndefined=U;f.getWithDefault=V;f.getExn=W;f.remove=c;f.removeMany=d;f.set=e;f.updateU=h;f.update=i;f.mergeMany=g;f.mergeU=k;f.merge=l;f.keepU=y;f.keep=z;f.partitionU=A;f.partition=B;f.split=j;f.mapU=C;f.map=D;f.mapWithKeyU=E;f.mapWithKey=F;f.getData=ca;f.getId=da;f.packIdData=ea;f.checkInvariantInternal=Y}),null);
__d("bs_belt_internalMapString",["bs_curry","bs_caml_option","bs_belt_SortArray","bs_caml_primitive","bs_belt_internalAVLtree"],(function(a,b,c,d,e,f){"use strict";function g(a,c,d){if(a===void 0)return b("bs_belt_internalAVLtree").singleton(c,d);var e=a.k;if(c===e)return b("bs_belt_internalAVLtree").updateValue(a,d);var f=a.v;if(c<e)return b("bs_belt_internalAVLtree").bal(g(a.l,c,d),e,f,a.r);else return b("bs_belt_internalAVLtree").bal(a.l,e,f,g(a.r,c,d))}function a(a,c){while(!0){var d=a;if(d===void 0)return;var e=d.k;if(c===e)return b("bs_caml_option").some(d.v);a=c<e?d.l:d.r;continue}}function c(a,b){while(!0){var c=a;if(c===void 0)return;var d=c.k;if(b===d)return c.v;a=b<d?c.l:c.r;continue}}function d(a,b){while(!0){var c=a;if(c!==void 0){var d=c.k;if(b===d)return c.v;a=b<d?c.l:c.r;continue}throw{RE_EXN_ID:"Not_found",Error:new Error()}}}function e(a,b,c){while(!0){var d=a;if(d===void 0)return c;var e=d.k;if(b===e)return d.v;a=b<e?d.l:d.r;continue}}function h(a,b){while(!0){var c=a;if(c===void 0)return!1;var d=c.k;if(b===d)return!0;a=b<d?c.l:c.r;continue}}function i(a,c){if(a===void 0)return a;var d=a.k,e=a.l,f=a.r;if(c!==d)if(c<d)return b("bs_belt_internalAVLtree").bal(i(e,c),d,a.v,f);else return b("bs_belt_internalAVLtree").bal(e,d,a.v,i(f,c));if(e===void 0)return f;if(f===void 0)return e;d={contents:f.k};a={contents:f.v};c=b("bs_belt_internalAVLtree").removeMinAuxWithRef(f,d,a);return b("bs_belt_internalAVLtree").bal(e,d.contents,a.contents,c)}function j(a,c){var d=c.k,e=c.v,f=c.l,g=c.r;if(a===d)return[f,b("bs_caml_option").some(e),g];if(a<d){if(f===void 0)return[void 0,void 0,c];var h=j(a,f);return[h[0],h[1],b("bs_belt_internalAVLtree").join(h[2],d,e,g)]}if(g===void 0)return[c,void 0,void 0];h=j(a,g);return[b("bs_belt_internalAVLtree").join(f,d,e,h[0]),h[1],h[2]]}function k(a,b){if(b!==void 0)return j(a,b);else return[void 0,void 0,void 0]}function l(a,c,d){if(a!==void 0){if(a.h>=(c!==void 0?c.h:0)){var e=a.k,f=a.v,g=a.l,h=a.r,i=k(e,c);return b("bs_belt_internalAVLtree").concatOrJoin(l(g,i[0],d),e,d(e,b("bs_caml_option").some(f),i[1]),l(h,i[2],d))}}else if(c===void 0)return;g=c.k;e=c.v;f=c.l;h=c.r;i=k(g,a);return b("bs_belt_internalAVLtree").concatOrJoin(l(i[0],f,d),g,d(g,i[1],b("bs_caml_option").some(e)),l(i[2],h,d))}function m(a,c,d){return l(a,c,b("bs_curry").__3(d))}function n(a,c,d){while(!0){var e=c,f=a;if(!f)return 0;if(!e)return 0;var g=e.hd,h=f.hd,i=b("bs_caml_primitive").caml_string_compare(h.k,g.k);if(i!==0)return i;i=d(h.v,g.v);if(i!==0)return i;c=b("bs_belt_internalAVLtree").stackAllLeft(g.r,e.tl);a=b("bs_belt_internalAVLtree").stackAllLeft(h.r,f.tl);continue}}function o(c,d,a){var e=b("bs_belt_internalAVLtree").size(c),f=b("bs_belt_internalAVLtree").size(d);if(e===f)return n(b("bs_belt_internalAVLtree").stackAllLeft(c,0),b("bs_belt_internalAVLtree").stackAllLeft(d,0),a);else if(e<f)return-1;else return 1}function p(a,c,d){return o(a,c,b("bs_curry").__2(d))}function q(c,d,a){while(!0){var e=d,f=c;if(!f)return!0;if(!e)return!0;var g=e.hd,h=f.hd;if(!(h.k===g.k&&a(h.v,g.v)))return!1;d=b("bs_belt_internalAVLtree").stackAllLeft(g.r,e.tl);c=b("bs_belt_internalAVLtree").stackAllLeft(h.r,f.tl);continue}}function r(c,d,a){var e=b("bs_belt_internalAVLtree").size(c),f=b("bs_belt_internalAVLtree").size(d);if(e===f)return q(b("bs_belt_internalAVLtree").stackAllLeft(c,0),b("bs_belt_internalAVLtree").stackAllLeft(d,0),a);else return!1}function s(a,c,d){return r(a,c,b("bs_curry").__2(d))}function t(a,c,d){if(a===void 0)return b("bs_belt_internalAVLtree").singleton(c,d);var e=a.k;if(c===e){a.k=c;a.v=d;return a}var f=a.l,g=a.r;if(c<e){e=t(f,c,d);a.l=e}else a.r=t(g,c,d);return b("bs_belt_internalAVLtree").balMutate(a)}function u(a){var c=a.length;if(c===0)return;var d=b("bs_belt_SortArray").strictlySortedLengthU(a,function(a,b){return a[0]<b[0]}),e;d>=0?e=b("bs_belt_internalAVLtree").fromSortedArrayAux(a,0,d):(d=-d|0,e=b("bs_belt_internalAVLtree").fromSortedArrayRevAux(a,d-1|0,d));for(var d=d;d<c;++d){var f=a[d];e=t(e,f[0],f[1])}return e}var v,w,x;f.N=v;f.A=w;f.S=x;f.add=g;f.get=a;f.getUndefined=c;f.getExn=d;f.getWithDefault=e;f.has=h;f.remove=i;f.splitAux=j;f.split=k;f.mergeU=l;f.merge=m;f.compareAux=n;f.cmpU=o;f.cmp=p;f.eqAux=q;f.eqU=r;f.eq=s;f.addMutate=t;f.fromArray=u}),null);
__d("bs_belt_MapString",["bs_curry","bs_caml_option","bs_belt_internalAVLtree","bs_belt_internalMapString"],(function(a,b,c,d,e,f){"use strict";var g,h;function i(a,c,d){if(a===void 0)return b("bs_belt_internalAVLtree").singleton(c,d);var e=a.k;if(c===e)return b("bs_belt_internalAVLtree").updateValue(a,d);var f=a.v;if(c<e)return b("bs_belt_internalAVLtree").bal(i(a.l,c,d),e,f,a.r);else return b("bs_belt_internalAVLtree").bal(a.l,e,f,i(a.r,c,d))}function j(a,c,d){if(a!==void 0){var e=a.k;if(c===e){var f=d(b("bs_caml_option").some(a.v));if(f!==void 0)return b("bs_belt_internalAVLtree").updateValue(a,b("bs_caml_option").valFromOption(f));f=a.l;var g=a.r;if(f===void 0)return g;if(g===void 0)return f;var h={contents:g.k},i={contents:g.v};g=b("bs_belt_internalAVLtree").removeMinAuxWithRef(g,h,i);return b("bs_belt_internalAVLtree").bal(f,h.contents,i.contents,g)}f=a.v;h=a.l;i=a.r;if(c<e){g=j(h,c,d);if(h===g)return a;else return b("bs_belt_internalAVLtree").bal(g,e,f,i)}g=j(i,c,d);if(i===g)return a;else return b("bs_belt_internalAVLtree").bal(h,e,f,g)}i=d(void 0);if(i!==void 0)return b("bs_belt_internalAVLtree").singleton(c,b("bs_caml_option").valFromOption(i));else return a}function a(a,c,d){return j(a,c,b("bs_curry").__1(d))}function k(a,c){var d=a.k,e=a.l,f=a.r;if(c===d){if(e===void 0)return f;if(f===void 0)return e;var g={contents:f.k},h={contents:f.v},i=b("bs_belt_internalAVLtree").removeMinAuxWithRef(f,g,h);return b("bs_belt_internalAVLtree").bal(e,g.contents,h.contents,i)}if(c<d){if(e===void 0)return a;g=k(e,c);if(g===e)return a;else return b("bs_belt_internalAVLtree").bal(g,d,a.v,f)}if(f===void 0)return a;h=k(f,c);return b("bs_belt_internalAVLtree").bal(e,d,a.v,h)}function c(a,b){if(a!==void 0)return k(a,b)}function d(a,b){var c=b.length;if(a!==void 0){a=a;var d=0;while(!0){var e=d,f=a;if(e>=c)return f;var g=b[e];f=k(f,g);if(f===void 0)return f;d=e+1|0;a=f;continue}}}function e(a,b){var c=b.length;a=a;for(var d=0;d<c;++d){var e=b[d];a=i(a,e[0],e[1])}return a}var l,m=(g=b("bs_belt_internalAVLtree")).isEmpty,n=(h=b("bs_belt_internalMapString")).has,o=h.cmpU,p=h.cmp,q=h.eqU,r=h.eq,s=g.findFirstByU,t=g.findFirstBy,u=g.forEachU,v=g.forEach,w=g.reduceU,x=g.reduce,y=g.everyU,z=g.every,A=g.someU,B=g.some,C=g.size,D=g.toList,E=g.toArray,F=h.fromArray,G=g.keysToArray,H=g.valuesToArray,I=g.minKey,J=g.minKeyUndefined,K=g.maxKey,L=g.maxKeyUndefined,M=g.minimum,N=g.minUndefined,O=g.maximum,P=g.maxUndefined,Q=h.get,R=h.getUndefined,S=h.getWithDefault,T=h.getExn,U=g.checkInvariantInternal,V=h.mergeU,W=h.merge,X=g.keepSharedU,Y=g.keepShared,Z=g.partitionSharedU,$=g.partitionShared;h=h.split;var aa=g.mapU,ba=g.map,ca=g.mapWithKeyU;g=g.mapWithKey;f.empty=l;f.isEmpty=m;f.has=n;f.cmpU=o;f.cmp=p;f.eqU=q;f.eq=r;f.findFirstByU=s;f.findFirstBy=t;f.forEachU=u;f.forEach=v;f.reduceU=w;f.reduce=x;f.everyU=y;f.every=z;f.someU=A;f.some=B;f.size=C;f.toList=D;f.toArray=E;f.fromArray=F;f.keysToArray=G;f.valuesToArray=H;f.minKey=I;f.minKeyUndefined=J;f.maxKey=K;f.maxKeyUndefined=L;f.minimum=M;f.minUndefined=N;f.maximum=O;f.maxUndefined=P;f.get=Q;f.getUndefined=R;f.getWithDefault=S;f.getExn=T;f.checkInvariantInternal=U;f.remove=c;f.removeMany=d;f.set=i;f.updateU=j;f.update=a;f.mergeU=V;f.merge=W;f.mergeMany=e;f.keepU=X;f.keep=Y;f.partitionU=Z;f.partition=$;f.split=h;f.mapU=aa;f.map=ba;f.mapWithKeyU=ca;f.mapWithKey=g}),null);
__d("MessengerState.bs",["invariant","URI","FBID.bs","bs_array","bs_curry","JSSet.bs","React","Utils.bs","FBJSON","Arbiter","gkx","bs_js_dict","qex","bs_belt_Map","bs_belt_Set","bs_caml_obj","ThreadId.bs","FBIDCheck","immutable","bs_belt_Array","bs_caml_array","ChatConfig","MercuryIDs","bs_pervasives","bs_belt_Option","bs_caml_option","CurrentUser","requireCond","AsyncRequest","MessagingTag","RemoteAction.bs","TypingStates","MercuryAssert","MercuryViewer","ParticipantId.bs","bs_belt_MapString","bs_caml_primitive","MercuryFilters.bs","ImmutableObject","MercuryLocalIDs","ChannelConstants","MessengerFolders.bs","MessengerMessage.bs","bs_js_null_undefined","MercuryActionType","MercuryAttachment","MercuryDispatcher","MercuryMessageIDs.bs","MercuryThreadInfo","MessengerPersonas.bs","MessengerWebEvent","XGroupsController","MercuryThreadIDMap","PageCommItemStatus","MercuryActionStatus","MessageRequestUtils","MessagingThreadType","MercuryPayloadSource","MessengerEnvironment","MessengerThreadUtils.bs","recoverableViolation","MercuryLogMessageType","MercuryServerRequests","MercuryThreadInformer","MercurySyncEventsProxy","unrecoverableViolation","MercuryGlobalActionType","MessageProfileRangeType","ThreadConnectivityStatus.bs","MercuryMessageClientState","MessengerGroupsSyncStatus","MercuryThreadlistConstants","MessageUnsendabilityStatus","setTimeoutAcrossTransitions","MessagingGenericAdminTextType","MessengerDesktopNotifications","ChatReliabilityInstrumentation","RemovedMessageTombstoneContent","MWChatDeleteMessageEventEmitter","MessengerThreadCannotReplyReason.bs","RepliedToMessageStatusForGraphQL","XMercuryThreadLikeIconController","MessengerSharedMediaActionsLoader","MessengerSharedPhotosVideosBaseData.bs","MercuryDisplayTimeFilterMessageRenderer","cr:1299779"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("React"),j=b("MessagingTag").IRIS_MAPPING;function k(a){var c={};b("bs_belt_Map").forEach(a,function(b,a){c[b]=a});return c}function a(a){return k(a.threads)}function l(a,c){return b("bs_js_null_undefined").fromOption(b("bs_belt_Map").get(a.threads,c))}function c(a){return a.fbid}function d(a){return a.deliveryReceipts}function e(a){return a.readReceiptsPerThread}function m(a){return a.ignoredIds}function n(a){return a.blockedIds}function o(a){return a.pendingFolderUnseenCount}function aa(a){return a.typing}function p(a){return a.pendingReadStatusThreads}function q(a){return a.messages}function r(a){return a.localIDsMap}function s(a){return a.messagesWithUploadsInFlight}function ba(a){return a.threadlistOrderMap}function ca(a){return a.pinnedThreads}function t(a){return a.montage}function da(a){return a.orderedMessageLists}function ea(a){return a.unreadCounts}function fa(a){return a.initialUnreadCounts}function ga(a){return a.unseenTimestamp}function ha(a){b("ChatReliabilityInstrumentation").logMESSAGE_RECEIVED(b("FBJSON").stringify({otid:a.offline_threading_id,message_id:a.message_id,other_user_fbid:a.other_user_fbid}))}function ia(a,c,d){d=d.reduce(b("bs_belt_Set").remove,c.reduce(b("bs_belt_Set").add,a.ignoredIds));if(d===a.ignoredIds)return a;else return{fbid:a.fbid,deliveryReceipts:a.deliveryReceipts,readReceiptsPerThread:a.readReceiptsPerThread,ignoredIds:d,blockedIds:a.blockedIds,pendingFolderUnseenCount:a.pendingFolderUnseenCount,typing:a.typing,threads:a.threads,pendingReadStatusThreads:a.pendingReadStatusThreads,messages:a.messages,localIDsMap:a.localIDsMap,messagesWithUploadsInFlight:a.messagesWithUploadsInFlight,threadlistOrderMap:a.threadlistOrderMap,pinnedThreads:a.pinnedThreads,montage:a.montage,orderedMessageLists:a.orderedMessageLists,unreadCounts:a.unreadCounts,initialUnreadCounts:a.initialUnreadCounts,unseenTimestamp:a.unseenTimestamp}}var ja=function(a,b){delete a[b];return 0};function ka(a,c,d){var e=b("bs_belt_MapString").get(a,c);if(e===void 0)return a;e=b("bs_caml_option").valFromOption(e);var f=b("bs_belt_Map").get(e,d);if(f!==void 0)return b("bs_belt_MapString").set(a,c,b("bs_belt_Map").remove(e,d));else return a}function la(a,c){var d=c.thread_fbid;if(d==null){if(!(c.type==="typ"||c.type==="page_typing"))return null;c=b("FBID.bs").ofString(c.from.toString());if(c!==void 0)return b("MercuryIDs").getThreadIDFromUserID(b("bs_caml_option").valFromOption(c));else return null}c=b("MercuryThreadIDMap").getForFBID(a);return c.getClientIDFromServerIDNow(d.toString())}var ma=b("gkx")("1275193")?b("MercuryFilters.bs").getSupportedFilters(void 0).concat([b("MercuryFilters.bs").all,b("MercuryFilters.bs").groups,b("MercuryFilters.bs").named,b("MercuryFilters.bs").unnamed]):b("gkx")("1660458")?b("MercuryFilters.bs").getSupportedFilters(void 0).concat([b("MercuryFilters.bs").all,b("MercuryFilters.bs").groups,b("MercuryFilters.bs").unsyncedChat]):b("MercuryFilters.bs").getSupportedFilters(void 0).concat([b("MercuryFilters.bs").all,b("MercuryFilters.bs").groups]),na=b("MessengerFolders.bs").getSupportedFolders(void 0).concat(["spam","page_background"]);function oa(a){var b={};na.forEach(function(a){var c={};ma.forEach(function(a){c[a]={threadlist:[],reachedEnd:!1,existingIDs:new Set()}});b[a]=c});return b}function pa(a,c){a=b("MercuryThreadInformer").getForFBID(a);a.invalidatedThread(c)}function u(a,c){a=b("MercuryThreadInformer").getForFBID(a);a.updatedThread(c)}function qa(a,c){a=b("MercuryThreadInformer").getForFBID(a);a.deletedThread(c)}function ra(a,c,d,e){a=b("MercuryThreadInformer").getForFBID(a);a.changedThreadReadState(c,d,e)}function sa(a,c){var d=new Map();c.forEach(function(a,b){d.set(a,b)});return c.sort(function(c,e){var f=b("bs_belt_Map").get(a.threads,c),g=b("bs_belt_Map").get(a.threads,e);if(f!==void 0&&g!==void 0){g=b("bs_caml_option").valFromOption(g).timestamp-b("bs_caml_option").valFromOption(f).timestamp;if(g>0)return 1;else if(g<0)return-1;else return 0}f=d.get(c);g=d.get(e);return b("bs_belt_Option").getExn(f==null?void 0:b("bs_caml_option").some(f))-b("bs_belt_Option").getExn(g==null?void 0:b("bs_caml_option").some(g))|0})}function ta(a,c,d,e){a=b("bs_js_dict").get(a.threadlistOrderMap,d);if(a===void 0)return;d=b("bs_js_dict").get(b("bs_caml_option").valFromOption(a),e);if(d===void 0)return;var f=b("bs_caml_option").valFromOption(d);c.forEach(function(a){if(!f.existingIDs.has(a))return;f.existingIDs["delete"](a);a=f.threadlist.indexOf(a);f.threadlist.splice(a,1)})}function v(c,d,e,f){c=c!==void 0?c:function(a){return!0};var a=b("bs_belt_Map").get(d.threads,e);if(a===void 0)return d;a=b("bs_caml_option").valFromOption(a);if(!b("bs_curry")._1(c,a))return d;c=b("ImmutableObject").set(a,f);a=b("bs_belt_Map").set(d.threads,e,c);u(d.fbid,e);return{fbid:d.fbid,deliveryReceipts:d.deliveryReceipts,readReceiptsPerThread:d.readReceiptsPerThread,ignoredIds:d.ignoredIds,blockedIds:d.blockedIds,pendingFolderUnseenCount:d.pendingFolderUnseenCount,typing:d.typing,threads:a,pendingReadStatusThreads:d.pendingReadStatusThreads,messages:d.messages,localIDsMap:d.localIDsMap,messagesWithUploadsInFlight:d.messagesWithUploadsInFlight,threadlistOrderMap:d.threadlistOrderMap,pinnedThreads:d.pinnedThreads,montage:d.montage,orderedMessageLists:d.orderedMessageLists,unreadCounts:d.unreadCounts,initialUnreadCounts:d.initialUnreadCounts,unseenTimestamp:d.unseenTimestamp}}function ua(c,a,d){var e=new Set(a.participants);Object.assign(a,{participants:Array.from(a.participants)});d.forEach(function(d){if(!e.has(d)){a.participants.push(d);if(b("bs_caml_obj").caml_equal(d,c)){Object.assign(a,{is_subscribed:!0,can_reply:!0,cannot_reply_reason:null});return}else return}})}var va=b("XGroupsController");function w(a){var c=[b("MercuryFilters.bs").all];a.unread_count>0&&c.push(b("MercuryFilters.bs").unread);a.is_canonical||c.push(b("MercuryFilters.bs").groups);if(b("gkx")("1660458")){var d=a.groups_sync_status;!(d==null)&&b("bs_caml_obj").caml_equal(d,b("MessengerGroupsSyncStatus").OPT_IN)||c.push(b("MercuryFilters.bs").unsyncedChat)}if(b("gkx")("1275193"))if(a.name.length!==0){c.push(b("MercuryFilters.bs").named);return c}else{c.push(b("MercuryFilters.bs").unnamed);return c}else return c}function wa(a,c,d,e){na.forEach(function(b){if(b!==d)return ta(a,c,b,e)});var f=b("bs_js_dict").get(a.threadlistOrderMap,d);if(f!==void 0){f=b("bs_js_dict").get(b("bs_caml_option").valFromOption(f),e);if(f!==void 0){f=b("bs_caml_option").valFromOption(f);f=[f.threadlist,f.existingIDs]}else f=[[],new Set()]}else f=[[],new Set()];var g=f[1],h=f[0];c.forEach(function(a){if(!g.has(a)){g.add(a);h.push(a);return}});return[sa(a,h),g]}function xa(a,c,d,e){c=b("gkx")("1275193")||b("gkx")("1660458")?c.filter(function(c){c=b("bs_belt_Map").get(a.threads,c);if(c===void 0)return!1;c=w(b("bs_caml_option").valFromOption(c));return c.some(function(a){return a===e})}):c;return wa(a,c,d,e)}function ya(a,c,d){if(d===void 0)return;var e=b("bs_js_dict").get(a.unreadCounts,c);if(e!==void 0){b("bs_caml_option").valFromOption(e).add(b("bs_caml_option").valFromOption(d));e=b("MercuryThreadInformer").getForFBID(a.fbid);e.updatedUnreadState();return}d=b("MercuryServerRequests").getForFBID(a.fbid);d.fetchUnreadThreadIDs(c)}var za=b("MessengerFolders.bs").getSupportedFolders(void 0).filter(function(a){return a!=="action:archived"});function Aa(a,c,d){if(d===void 0)return;var e=b("bs_js_dict").get(a.unreadCounts,c);if(e!==void 0){b("bs_caml_option").valFromOption(e)["delete"](b("bs_caml_option").valFromOption(d));e=b("MercuryThreadInformer").getForFBID(a.fbid);e.updatedUnreadState();return}d=b("MercuryServerRequests").getForFBID(a.fbid);d.fetchUnreadThreadIDs(c)}function Ba(c,a,d){var e=b("MessengerFolders.bs").getFromMeta(a);if(d!==e){za.includes(e)&&a.unread_count>0&&ya(c,e,b("bs_caml_option").some(a.thread_id));if(za.includes(d))return Aa(c,d,b("bs_caml_option").some(a.thread_id));else return}}function Ca(a,c,d,e,f){var g=b("gkx")("1275193"),h=b("gkx")("1660458"),i=a.threadlistOrderMap[c][d],j=i.existingIDs.has(e);!f&&(g||h)?xa(a,[e],c,d):wa(a,[e],c,d);if(!(!g&&!h||i.threadlist.length!==0))return;f=b("bs_caml_array").get(i.threadlist,i.threadlist.length-1|0)===e;if(!i.reachedEnd&&!j&&f)return ta(a,[e],c,d)}function Da(a,c,d){if(na.includes(c))if((c==="inbox"||c==="action:archived"||c==="pending")&&(b("gkx")("1275193")||b("gkx")("1660458")))return Ca(a,c,b("MercuryFilters.bs").unread,d,!0);else{wa(a,[d],c,b("MercuryFilters.bs").unread);return}}function Ea(c,a){var d=b("MessengerFolders.bs").getFromMeta(a);if(na.includes(d)){ma.forEach(function(b){return Ca(c,d,b,a.thread_id,!1)});return}}function Fa(d,e,f,g){var a=b("bs_belt_Map").get(d.threads,e);if(a===void 0)return d;a=b("bs_caml_option").valFromOption(a);var h=b("MessengerFolders.bs").getFromMeta(a);if(h!==f){if(g){g=a.comm_status;g=g==null?b("ImmutableObject").set(a,{folder:f}):f==="other"?b("ImmutableObject").set(a,{folder:f,comm_status:b("PageCommItemStatus").SPAM}):f==="inbox"?b("ImmutableObject").set(a,{folder:f,comm_status:b("PageCommItemStatus").TODO}):b("ImmutableObject").set(a,{folder:f})}else g=a;var c=a.other_user_fbid;c=c==null?[]:f==="other"?[b("MercuryIDs").getParticipantIDFromUserID(c)]:[];var i=a.other_user_fbid;f=i==null?[]:f==="other"?[]:[b("MercuryIDs").getParticipantIDFromUserID(i)];i=ia(d,c,f);c=b("bs_belt_Map").set(i.threads,e,g);Ba(i,g,h);Ea(i,g);u(i.fbid,e);return{fbid:i.fbid,deliveryReceipts:i.deliveryReceipts,readReceiptsPerThread:i.readReceiptsPerThread,ignoredIds:i.ignoredIds,blockedIds:i.blockedIds,pendingFolderUnseenCount:i.pendingFolderUnseenCount,typing:i.typing,threads:c,pendingReadStatusThreads:i.pendingReadStatusThreads,messages:i.messages,localIDsMap:i.localIDsMap,messagesWithUploadsInFlight:i.messagesWithUploadsInFlight,threadlistOrderMap:i.threadlistOrderMap,pinnedThreads:i.pinnedThreads,montage:i.montage,orderedMessageLists:i.orderedMessageLists,unreadCounts:i.unreadCounts,initialUnreadCounts:i.initialUnreadCounts,unseenTimestamp:i.unseenTimestamp}}Ea(d,a);return d}function Ga(a,c,d){d=c.is_filtered_content?b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(c):d!==void 0?d:c.body;var e=c.raw_attachments;e=!(e==null)&&e.length!==0?b("MercuryAttachment").convertRaw(e):c.attachments;var f=c.removed_timestamp;if(f==null){f=c.log_message_type;d={snippet:d,snippet_attachments:e,snippet_sender:f==null?c.author:null}}else d={snippet:b("RemovedMessageTombstoneContent").getTombstoneContentForSnippet(c.author),snippet_attachments:null,snippet_sender:null};return Object.assign(a,d)}function x(a,c,d){var e=a.event_title,f=a.event_time;a=a.event_location_name;return{creator_id:null,latitude:null,location_address:null,longitude:null,note:"",related_event:{id:""},repeat_mode:null,seconds_to_notify_before:0,status:null,track_rsvp:c.track_rsvp,title:e==null?c.title:e,event_time:f==null?c.event_time:parseInt(f,10),location_name:a==null?c.location_name:a,event_members:d!==void 0?b("bs_caml_option").valFromOption(d):c.event_members,oid:c.oid,event_type:c.event_type}}function y(b,a){var c={};Object.keys(b).forEach(function(a){c[a]=b[a]});c[a.guest_id]=a.guest_status;return c}var Ha=function(a,b){delete a[b];return 0},z=function(a,b){delete a[b];return 0};function A(a){var c={contents:-1},d={contents:null},e=Math.floor(Date.now()/1e3);b("bs_js_dict").entries(a).forEach(function(a){a=a[1];var b=a.event_time;if(b>e&&(c.contents<0||c.contents>b)){c.contents=b;d.contents=a;return}});return d.contents}var B=b("XMercuryThreadLikeIconController");function C(a,c,d){d=B.getURIBuilder().setString("emoji",d).getURI();new(b("AsyncRequest"))(d).setHandler(function(d){var e=b("MercuryDispatcher").getForFBID(a);e.handleUpdate({actions:[{action_type:b("MercuryActionType").UPDATE_CUSTOM_LIKE,thread_id:c,custom_like:d.getPayload()}],from_client:!0,payload_source:b("MercuryPayloadSource").CLIENT_CHANGE_CUSTOM_LIKE})}).send()}function Ia(d,a,c,e){c=c.log_message_data;if(c==null)return;var f=c.untypedData;if(c.message_type===b("MessagingGenericAdminTextType").CHANGE_THREAD_NICKNAME){var g=a.custom_nickname;if(!(g==null)){g=b("bs_js_dict").fromArray(b("bs_js_dict").entries(g));var h=f.nickname;h.trim().length>0?g[f.participant_id]=h:z(g,f.participant_id);Object.assign(a,{custom_nickname:g})}u(d,e)}else if(c.message_type===b("MessagingGenericAdminTextType").CHANGE_THREAD_ICON)C(d,e,f.thread_icon);else if(c.message_type===b("MessagingGenericAdminTextType").CHANGE_THREAD_THEME){if(!b("ChatConfig").get("chat_tab_has_gradients")){h=f.theme_color;if(h==null)Object.assign(a,{solid_color:null,header_color:null,footer_color:null,gradient_colors:[]});else if(h.length>0){g="#"+h.slice(2);Object.assign(a,{solid_color:g,header_color:g,footer_color:g,gradient_colors:[g]})}else Object.assign(a,{solid_color:null,header_color:null,footer_color:null,gradient_colors:[]});u(d,e)}}else if(f!==void 0)if(c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_CREATE){var i={},j=f.event_creator_id;a.participants.forEach(function(a){a=b("MercuryIDs").getUserIDFromParticipantID(a);if(!(a==null)){i[a]=b("bs_caml_obj").caml_equal(a,j)?"GOING":"INVITED";return}});h=b("bs_js_dict").fromArray(b("bs_js_dict").entries(a.lightweight_events));g=f.event_time;g={track_rsvp:f.event_track_rsvp,title:f.event_title,event_time:g==null?0:parseInt(g,10),location_name:f.event_location_name,event_members:i,oid:f.event_id,event_type:f.event_type};Object.assign(a,{lightweight_event:g});h[f.event_id]=Object.assign({},g);Object.assign(a,{lightweight_events:h});u(d,e)}else if(c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE||c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TIME||c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_TITLE||c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_UPDATE_LOCATION){g=a.lightweight_event;if(!(g==null)){h=b("bs_js_dict").fromArray(b("bs_js_dict").entries(a.lightweight_events));g.oid===f.event_id&&Object.assign(a,{lightweight_event:x(f,g,b("bs_caml_option").some(g.event_members))});g=b("bs_js_dict").get(h,f.event_id);g!==void 0&&(h[f.event_id]=x(f,b("bs_caml_option").valFromOption(g),void 0),Object.assign(a,{lightweight_events:h}))}u(d,e)}else if(c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_RSVP){g=b("bs_js_dict").fromArray(b("bs_js_dict").entries(a.lightweight_events));h=a.lightweight_event;if(!(h==null)&&h.oid===f.event_id){var k=y(h.event_members,f);Object.assign(a,{lightweight_event:x(f,h,b("bs_caml_option").some(k))})}h=b("bs_js_dict").get(g,f.event_id);if(h!==void 0){k=b("bs_caml_option").valFromOption(h);h=y(k.event_members,f);g[f.event_id]=x(f,k,b("bs_caml_option").some(h));Object.assign(a,{lightweight_events:g})}u(d,e)}else if(c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_DELETE||c.message_type===b("MessagingGenericAdminTextType").LIGHTWEIGHT_EVENT_NOTIFY){k=b("bs_js_dict").fromArray(b("bs_js_dict").entries(a.lightweight_events));Ha(k,f.event_id);Object.assign(a,{lightweight_event:A(k),lightweight_events:k});u(d,e)}}function Ja(c,d,e){if(b("CurrentUser").isWorkUser()&&b("gkx")("1179386")){var a=b("bs_belt_Map").get(c.threads,d);if(a!==void 0){a=b("bs_caml_option").valFromOption(a);var f=a.pinned_messages;f=f==null?void 0:f.map(function(a){if(e.findIndex(function(b){return b===a.message_id})!==-1)return{message_id:a.message_id,pinning_time:a.pinning_time,message:null};else return a});if(f!==void 0){a=b("ImmutableObject").set(a,{pinned_messages:f});f=b("bs_belt_Map").set(c.threads,d,a);u(c.fbid,d);a=f}else a=c.threads}else a=c.threads;return{fbid:c.fbid,deliveryReceipts:c.deliveryReceipts,readReceiptsPerThread:c.readReceiptsPerThread,ignoredIds:c.ignoredIds,blockedIds:c.blockedIds,pendingFolderUnseenCount:c.pendingFolderUnseenCount,typing:c.typing,threads:a,pendingReadStatusThreads:c.pendingReadStatusThreads,messages:c.messages,localIDsMap:c.localIDsMap,messagesWithUploadsInFlight:c.messagesWithUploadsInFlight,threadlistOrderMap:c.threadlistOrderMap,pinnedThreads:c.pinnedThreads,montage:c.montage,orderedMessageLists:c.orderedMessageLists,unreadCounts:c.unreadCounts,initialUnreadCounts:c.initialUnreadCounts,unseenTimestamp:c.unseenTimestamp}}else return c}function Ka(a,c,d,e){a=b("MercuryThreadInformer").getForFBID(a);a.updatedMessage(c,d,b("bs_js_null_undefined").fromOption(e))}function La(c,a){c=b("MercuryThreadInformer").getForFBID(c);c.receivedMessage(a)}function Ma(a,c,d){a=b("MercuryThreadInformer").getForFBID(a);a.reorderedMessages(c,d)}function Na(a,c,d,e,f){a=b("MercuryThreadInformer").getForFBID(a);f=b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(f==null?void 0:b("bs_caml_option").some(f),function(a){return b("bs_belt_Array").keepMap(a,function(a){return b("bs_caml_option").nullable_to_opt(a.message_file_fbid)})}),[]);b("MWChatDeleteMessageEventEmitter").emit(d);a.deletedMessage(c,d,b("bs_js_null_undefined").fromOption(e),f)}function Oa(a,c,d,e){a=b("MercuryThreadInformer").getForFBID(a);a.deletedMessage(c,d,b("bs_js_null_undefined").fromOption(e),null)}var Pa=function(a,b){delete a[b];return 0};function D(c,a){var d=c.localIDsMap.get(a);return b("bs_caml_option").nullable_to_opt(c.messages.get(b("bs_belt_Option").getWithDefault(d==null?void 0:b("bs_caml_option").some(d),a)))}function E(a,c,d){a=a!==void 0?a:!1;d=b("bs_belt_Array").keepMap(d,function(a){return D(c,a)});if(a)return d.slice().reverse();else return d}function Qa(a,c){return b("bs_belt_Array").keepMap(c,function(b){return D(a,b)}).sort(function(a,c){return b("MessengerMessage.bs").compare(c,a)}).map(function(a){return a.message_id})}function F(a,b){return{fbid:a.fbid,deliveryReceipts:a.deliveryReceipts,readReceiptsPerThread:a.readReceiptsPerThread,ignoredIds:a.ignoredIds,blockedIds:a.blockedIds,pendingFolderUnseenCount:a.pendingFolderUnseenCount,typing:a.typing,threads:a.threads,pendingReadStatusThreads:a.pendingReadStatusThreads,messages:a.messages.set(b[0],b[1]),localIDsMap:a.localIDsMap,messagesWithUploadsInFlight:a.messagesWithUploadsInFlight,threadlistOrderMap:a.threadlistOrderMap,pinnedThreads:a.pinnedThreads,montage:a.montage,orderedMessageLists:a.orderedMessageLists,unreadCounts:a.unreadCounts,initialUnreadCounts:a.initialUnreadCounts,unseenTimestamp:a.unseenTimestamp}}function G(b,a){b.localIDsMap.set(a.message_id,a.message_id);return{fbid:b.fbid,deliveryReceipts:b.deliveryReceipts,readReceiptsPerThread:b.readReceiptsPerThread,ignoredIds:b.ignoredIds,blockedIds:b.blockedIds,pendingFolderUnseenCount:b.pendingFolderUnseenCount,typing:b.typing,threads:b.threads,pendingReadStatusThreads:b.pendingReadStatusThreads,messages:b.messages,localIDsMap:b.localIDsMap,messagesWithUploadsInFlight:b.messagesWithUploadsInFlight,threadlistOrderMap:b.threadlistOrderMap,pinnedThreads:b.pinnedThreads,montage:b.montage,orderedMessageLists:b.orderedMessageLists,unreadCounts:b.unreadCounts,initialUnreadCounts:b.initialUnreadCounts,unseenTimestamp:b.unseenTimestamp}}var H=function(a,b){delete a[b];return 0};function I(c,d){var a=c.orderedMessageLists;Object.keys(d).forEach(function(e){var f=b("bs_js_dict").get(d,e);if(f===void 0)return;var g=f[0],h=g.limit,i=g.offset;g=a.get(g.threadID);if(g==null)return;g=g.messageIDs;if(g.length>=(i+h|0)){H(d,e);return b("bs_curry")._1(f[1],E(!0,c,g.slice(i,i+h|0)))}})}function Ra(d,c,e){var a=e[1],f=e[0];b("MessengerMessage.bs").finalizeRanges(a);var g=a.offline_threading_id;if(!(g==null)&&g!==a.message_id){d.localIDsMap.set(g,a.message_id);b("MercuryMessageIDs.bs").addServerID(g,a.message_id);g=a.threading_id;g==null||b("MercuryMessageIDs.bs").addServerID(g,a.message_id)}g=d.messages.has(f);var h=d.fbid,i=d.deliveryReceipts,j=d.readReceiptsPerThread,k=d.ignoredIds,l=d.blockedIds,m=d.pendingFolderUnseenCount,n=d.typing,o=d.threads,aa=d.pendingReadStatusThreads,p=d.messages.set(f,a),q=d.localIDsMap,r=d.messagesWithUploadsInFlight,s=d.threadlistOrderMap,ba=d.pinnedThreads,ca=d.montage,t=d.orderedMessageLists,da=d.unreadCounts,ea=d.initialUnreadCounts;d=d.unseenTimestamp;h={fbid:h,deliveryReceipts:i,readReceiptsPerThread:j,ignoredIds:k,blockedIds:l,pendingFolderUnseenCount:m,typing:n,threads:o,pendingReadStatusThreads:aa,messages:p,localIDsMap:q,messagesWithUploadsInFlight:r,threadlistOrderMap:s,pinnedThreads:ba,montage:ca,orderedMessageLists:t,unreadCounts:da,initialUnreadCounts:ea,unseenTimestamp:d};if(!g&&e[2]===1){i=b("bs_belt_Option").getWithDefault(b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(a.thread_id),function(a){return b("bs_caml_option").nullable_to_opt(t.get(a))}),{messageLoadingState:b("MercuryIDs").isLocalThread(a.thread_id)?1:0,messageIDs:[]});j=a.thread_id;if(!(j==null)){k=Qa(h,[f].concat(i.messageIDs.filter(function(c){return b("bs_caml_obj").caml_notequal(c,a.offline_threading_id)})));t.set(j,{messageLoadingState:i.messageLoadingState,messageIDs:k})}I(h,c.messageCallbacks.contents)}return h}function J(b,c,a){b.messagesWithUploadsInFlight.set(c,a);return{fbid:b.fbid,deliveryReceipts:b.deliveryReceipts,readReceiptsPerThread:b.readReceiptsPerThread,ignoredIds:b.ignoredIds,blockedIds:b.blockedIds,pendingFolderUnseenCount:b.pendingFolderUnseenCount,typing:b.typing,threads:b.threads,pendingReadStatusThreads:b.pendingReadStatusThreads,messages:b.messages,localIDsMap:b.localIDsMap,messagesWithUploadsInFlight:b.messagesWithUploadsInFlight,threadlistOrderMap:b.threadlistOrderMap,pinnedThreads:b.pinnedThreads,montage:b.montage,orderedMessageLists:b.orderedMessageLists,unreadCounts:b.unreadCounts,initialUnreadCounts:b.initialUnreadCounts,unseenTimestamp:b.unseenTimestamp}}function Sa(a,c){var d=c[1];c=c[0];var e=a.messagesWithUploadsInFlight.get(c);b("bs_belt_Option").isSome(e==null?void 0:b("bs_caml_option").some(e))||g(0,1777);a.messagesWithUploadsInFlight["delete"](c);if(e==null)return b("bs_pervasives").failwith("Message must exist to update");else return Object.assign(e,{image_ids:d.image_ids,file_ids:d.file_ids,audio_ids:d.audio_ids,gif_ids:d.gif_ids,video_ids:d.video_ids,client_state:b("MercuryMessageClientState").SEND_TO_SERVER})}function Ta(a,c){var d=c[1],e=c[0],f=a.orderedMessageLists.get(e);if(f==null)return a;var g=b("bs_belt_Array").keepMap(d,function(b){return D(a,b)}).map(function(a){return a.message_id}),h=Qa(a,f.messageIDs.filter(function(a){return g.indexOf(a)===-1}));a.orderedMessageLists.set(e,{messageLoadingState:f.messageLoadingState,messageIDs:h});Ma(a.fbid,e,b("bs_js_null_undefined").fromOption(c[2]));f=Ja(a,e,d);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}function Ua(c,d){var e={snippet:"...",snippet_attachments:null,snippet_sender:null};d=b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(c.orderedMessageLists.get(d)),function(a){return b("bs_belt_Array").get(E(void 0,c,a.messageIDs),0)});if(d!==void 0){var a=b("bs_caml_option").valFromOption(d);a=a.is_filtered_content?b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(a):a.body}else a=null;if(d===void 0)return e;d=b("bs_caml_option").valFromOption(d);var f=d.removed_timestamp;if(!(f==null))return{snippet:b("RemovedMessageTombstoneContent").getTombstoneContentForSnippet(d.author),snippet_attachments:null,snippet_sender:null};if(a==null)return e;f=d.log_message_type;return{snippet:a,snippet_attachments:d.attachments,snippet_sender:f==null?d.author:null}}function Va(c,a){var d=a.attachments;if(d==null)return;var e=b("bs_belt_Array").keepMap(d,function(a){if(!(b("MercuryAttachment").isPhotoAttachment(a)||b("MercuryAttachment").isVideoAttachment(a)))return;a=a.metadata;if(!(a==null))return b("bs_caml_option").nullable_to_opt(a.fbid)});b("MessengerSharedMediaActionsLoader").deletePhotos(b("MercuryIDs").getThreadFBIDFromThreadID(a.thread_id),e);if(c!==void 0)return b("MessengerSharedPhotosVideosBaseData.bs").localRemove(b("bs_caml_option").valFromOption(c),b("bs_belt_Array").keepMap(d,function(a){if(!(b("MercuryAttachment").isPhotoAttachment(a)||b("MercuryAttachment").isVideoAttachment(a)))return;a=a.metadata;if(!(a==null))return b("bs_caml_option").nullable_to_opt(a.fbid)}))}function Wa(a,c,d){d=a.orderedMessageLists.get(d);if(d==null)return a;d=d.messageIDs;var e={contents:!0};return b("bs_belt_Array").reduce(d,a,function(d,a){if(!e.contents)return d;var f=d.localIDsMap.get(a);f=b("bs_belt_Option").getWithDefault(f==null?void 0:b("bs_caml_option").some(f),a);if(f===c){e.contents=!1;return d}a=D(d,f);if(a===void 0)return d;a=b("bs_caml_option").valFromOption(a);var g=a.replied_to_message,h;if(g==null)h=void 0;else{g=g.message;if(g==null)h=void 0;else{var i=d.localIDsMap.get(g.message_id);h=b("bs_belt_Option").getWithDefault(i==null?void 0:b("bs_caml_option").some(i),g.message_id)}}if(h===void 0)return d;if(h!==c)return d;i={status:b("RepliedToMessageStatusForGraphQL").DELETED,message:null};g=Object.assign(Object.assign({},a),{replied_to_message:i});return F(d,[f,g])})}function Xa(a,c){if(a==null)return 0;if(a.length===0)return 0;a=b("bs_array").map(function(a){var d=a.type;if(b("bs_caml_obj").caml_equal(d,b("MessageProfileRangeType").THREAD_ACTIVE)||b("bs_caml_obj").caml_equal(d,b("MessageProfileRangeType").THREAD))return b("gkx")("678578");d=a.id;if(d==null)return!1;else return b("bs_caml_obj").caml_equal(b("FBID.bs").ofStringExn(d),c)},a);return b("bs_array").fold_left(function(a,b){if(b)return a+1|0;else return a},0,a)}function Ya(a,c,d){if(b("cr:1299779")==null)return;var e=b("MercuryIDs").getThreadFBIDFromThreadID(a);return b("bs_curry")._1(b("cr:1299779").log,{event_name:b("MessengerWebEvent").SENT_MSG,mid:c,offline_threading_id:d,other_user_fbid:b("MercuryIDs").isCanonical(a)?e:null,thread_fbid:b("MercuryIDs").isGroupChat(a)?e:null})}function Za(d,c,e,f){var g=e.client_message_id,h;if(g==null)h=d;else{var i=D(d,g);if(i!==void 0){i=b("bs_caml_option").valFromOption(i);var j=e.message_id,k=e.status;if(b("bs_caml_obj").caml_equal(i.status,b("MercuryActionStatus").SUCCESS))h=d;else if(d.messages.has(j)){var a=Object.assign(Object.assign({},i),e);Ka(d.fbid,a.thread_id,a.message_id,f);h=F(d,[j,a])}else{a=b("bs_caml_obj").caml_equal(e.status,b("MercuryActionStatus").SUCCESS)?e.error_data:null;b("MercuryMessageIDs.bs").addServerID(g,j);d.localIDsMap.set(g,j);i=Object.assign(Object.assign({},i),{status:k,error_data:a,timestamp:e.timestamp,log_message_data:e.log_message_data,ranges:e.ranges,attachments:e.attachments,has_attachment:e.has_attachment,is_one_way_sent:e.is_one_way_sent,is_forwarded:e.is_forwarded});b("MessengerMessage.bs").finalizeRanges(i);k=F(d,[j,i]);k.messages.set(g,{});k.messages["delete"](g);a=i.thread_id;var l=k.orderedMessageLists.get(a);if(!(l==null)){var m=Qa(k,l.messageIDs);k.orderedMessageLists.set(a,{messageLoadingState:l.messageLoadingState,messageIDs:m})}Ka(k.fbid,i.thread_id,i.message_id,f);a=b("MessengerMessage.bs").isTitanMessage(i);l=c.localTitanMessageCount.get(i.thread_id);a&&!(l==null)&&c.localTitanMessageCount.set(i.thread_id,l-1|0);h={fbid:k.fbid,deliveryReceipts:k.deliveryReceipts,readReceiptsPerThread:k.readReceiptsPerThread,ignoredIds:k.ignoredIds,blockedIds:k.blockedIds,pendingFolderUnseenCount:k.pendingFolderUnseenCount,typing:k.typing,threads:k.threads,pendingReadStatusThreads:k.pendingReadStatusThreads,messages:k.messages,localIDsMap:k.localIDsMap.set(g,j),messagesWithUploadsInFlight:k.messagesWithUploadsInFlight,threadlistOrderMap:k.threadlistOrderMap,pinnedThreads:k.pinnedThreads,montage:k.montage,orderedMessageLists:k.orderedMessageLists,unreadCounts:k.unreadCounts,initialUnreadCounts:k.initialUnreadCounts,unseenTimestamp:k.unseenTimestamp}}}else h=d}m={};f=e.log_message_type;if(f==null)Object.assign(m,{snippet_attachments:e.attachments});else{if(b("bs_caml_obj").caml_equal(f,b("MercuryLogMessageType").THREAD_IMAGE)){a=e.log_message_data;if(a==null)c=null;else{i=a.image;c=i==null?null:i.preview_url}Object.assign(m,{image_src:c});u(h.fbid,e.thread_id)}b("bs_caml_obj").caml_notequal(f,b("MercuryLogMessageType").SUBSCRIBE)&&b("bs_caml_obj").caml_notequal(f,b("MercuryLogMessageType").UNSUBSCRIBE)&&Object.assign(m,{snippet_attachments:e.attachments})}Ya(e.thread_id,e.message_id,e.offline_threading_id);return v(void 0,h,e.thread_id,m)}function $a(c,a,d,e){if(b("bs_caml_obj").caml_equal(d.action_type,b("MercuryActionType").SEND_MESSAGE))return Za(c,a,d,e);var f=d.offline_threading_id;f=b("bs_belt_Option").flatMap(f==null?void 0:b("bs_caml_option").some(f),function(a){return b("bs_caml_option").nullable_to_opt(c.localIDsMap.get(a))});var g=D(c,d.message_id);if(f!==void 0){if(g===void 0)return c;f=b("bs_caml_option").valFromOption(g);if(b("bs_caml_option").nullable_to_opt(f.sticker_id)===void 0)return c;var h=Object.assign(f,{attachments:d.attachments});return F(c,[f.message_id,h])}if(g!==void 0)return c;f=b("bs_caml_obj").caml_equal(e,b("bs_caml_option").some(b("MercuryPayloadSource").CLIENT_SEND_MESSAGE))?G(c,d):c;h=b("bs_caml_obj").caml_equal(d.client_state,b("MercuryMessageClientState").DO_NOT_SEND_TO_SERVER);g=d.upload_id;e=h&&!(g==null)?J(f,g,d):f;h=b("MessengerMessage.bs").isErrorLogMessage(d);g=d.thread_id;h&&!(g==null)&&(a.failedHistoryFetchThreads.contents[g]=!0);f=d.manual_retry_cnt;h=d.thread_id;!(f==null)&&!(h==null)&&f>0&&Ma(e.fbid,h,b("MercuryPayloadSource").CLIENT_SEND_MESSAGE);g=Ra(e,a,[d.message_id,d,1]);La(g.fbid,d);return g}function ab(a,c,d,e){if(c===void 0)return;c=b("bs_caml_obj").caml_equal(b("bs_caml_option").valFromOption(c),b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE);var f=d.thread_id;if(!c){!(f==null);return}if(f==null)return;c=b("MercuryThreadInformer").getForFBID(a);return b("bs_curry")._3(e,c,f,d)}function bb(a,b){var c=a.participants.indexOf(b);if(c>0){Object.assign(a,{participants:[b].concat(a.participants.slice(0,c),a.participants.slice(c+1|0))});return}}function cb(c,d,e,f){var g=d.thread_id;if(g==null)return c;var a=b("bs_belt_Map").get(c.threads,g);if(a===void 0)return c;a=b("bs_caml_option").valFromOption(a);var h={};if(!d.skip_bump_thread&&b("bs_caml_obj").caml_notequal(e,b("bs_caml_option").some(b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO))){Ga(h,d,b("bs_caml_option").nullable_to_opt(d.log_message_body));if(d.timestamp>a.timestamp){Object.assign(h,{timestamp:d.timestamp});if(d.is_unread){Object.assign(h,{unread_count:a.unread_count+1|0});e=Xa(d.profile_ranges,c.fbid);e>0&&Object.assign(h,{unread_mentions_count:a.unread_mentions_count+e|0})}}Object.assign(h,{message_count:a.message_count+1|0,is_archived:!1})}f!==!0&&d.timestamp>h.server_timestamp&&Object.assign(h,{server_timestamp:d.timestamp});if(b("bs_caml_obj").caml_notequal(h,{}))return v(void 0,c,g,h);else return c}function db(b,a,c){var d=new Set(c);Object.assign(a,{participants:a.participants.filter(function(a){return!d.has(a)})});if(d.has(b)){Object.assign(a,{can_reply:!1,is_subscribed:!1});return}}function K(c,a,d){a=a.specific_to_list;if(!(a==null))return a;a=b("MercuryIDs").tokenize(d);if(a.type!=="user"||a.value.length===0)return[c];else return[b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(a.value)),c]}function L(c,a,d){var e=b("MercuryIDs").tokenize(d),f=e.type==="user",g=a.specific_to_list;g=f?!0:g==null?!1:b("MessengerThreadUtils.bs").isCanonicalFromInitialParticipants(c,g);if(g||f)c=K(c,a,d);else{var h=a.specific_to_list;c=h==null?[]:h}return new(b("ImmutableObject"))({admins:{},admin_model_status:null,approval_mode:0,approval_queue_ids:[],associated_object:null,can_reply:!0,cannot_reply_reason:null,can_viewer_report:!1,comm_item_owners:null,comm_source_id:null,comm_status:null,comm_icon_type:[],composer_input_disabled:null,custom_like_icon:null,custom_nickname:null,customization_enabled:!1,description:null,ephemeral_ttl_mode:0,footer_color:null,game_id:null,gradient_colors:[],accessibility_label:null,reverse_gradients_for_radial:null,group_approval_queue:null,group_thread_subtype:null,work_associated_group:null,pinned_messages:null,groups_sync_status:null,has_email_participant:!1,has_montage:!1,unread_mentions_count:0,header_color:null,is_canonical_neo_user:!1,is_from_weak_entry_point:!1,is_pin_protected:!1,is_pinned:!1,is_thread_queue_enabled:!1,joinable_mode:{link:"",mode:0},last_message_timestamp:0,last_message_type:null,last_message_admin_text_type:null,last_message_unsendability_status:null,last_message_id:null,last_read_timestamp:0,lightweight_event:null,lightweight_events:{},marketplace_thread_data:null,mentions_mute_mode:0,mute_until:null,page_comm_item_id:null,page_thread_info:null,page_unsubscribe_status:!1,participant_add_mode:null,participants_event_status:null,reactions_mute_mode:0,read_only:!1,recipients_loadable:!0,rtc_call_data:null,server_timestamp:0,solid_color:null,subtitle:null,theme_id:null,reactions:void 0,thread_associated_job_applications:null,thread_associated_page_admin:null,thread_connectivity_data:null,thread_fbid:null,thread_type:null,thread_pin_timestamp:null,thread_id:d,participants:c,preloaded_participants:[],name:"",snippet:a.body,snippet_attachments:[],snippet_sender:a.author,unread_count:0,message_count:0,image_src:null,square_image_src:null,timestamp:a.timestamp,other_user_fbid:f?b("FBID.bs").ofStringExn(e.value):null,is_canonical_user:f,is_other_recipient_page:!1,is_canonical:g,is_subscribed:!0,folder:"inbox",is_archived:!1,is_page_follow_up:!1,is_page_unresponded_thread:!1,object_association_type:null,joinable_link:null,linked_mentorship_programs:null,thread_unsendability_status:null,is_business_page_active:!1,graphql_token:null,conversion_detection_data:null,suggested_reply_data:null})}function eb(c,d,a,e){e=b("MessengerMessage.bs").hasServerTimestamp(a,e);var f=a.thread_id;if(f==null)return;b("MercuryAssert").isThreadID(f);d=b("bs_belt_Map").get(d,f);if(d!==void 0)return b("bs_caml_option").some(b("bs_caml_option").valFromOption(d));else if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE)&&!e)return b("bs_caml_option").some(L(b("MercuryIDs").getParticipantIDFromUserID(c),a,f));else return}function fb(c,d){var a=d.other_user_fbid;if(a==null){var e=d.thread_fbid;e=e==null?void 0:b("bs_caml_option").some(b("MercuryIDs").getThreadIDFromThreadFBID(e))}else e=b("bs_caml_option").some(b("MercuryIDs").getThreadIDFromUserID(a));a=d.thread_id;e=a==null?e:a==null?void 0:b("bs_caml_option").some(a);a=d.thread_id;var f;if(a==null)f="";else{a=b("bs_belt_Map").get(c.threads,a);f=a!==void 0?b("MessengerFolders.bs").getFromMeta(b("bs_caml_option").valFromOption(a)):d.folder}za.includes(f)&&(b("bs_caml_obj").caml_equal(d.action_type,b("MercuryActionType").USER_GENERATED_MESSAGE)||b("bs_caml_obj").caml_equal(d.action_type,b("MercuryActionType").LOG_MESSAGE))&&d.is_unread&&ya(c,f,e);return{fbid:c.fbid,deliveryReceipts:c.deliveryReceipts,readReceiptsPerThread:c.readReceiptsPerThread,ignoredIds:c.ignoredIds,blockedIds:c.blockedIds,pendingFolderUnseenCount:c.pendingFolderUnseenCount,typing:c.typing,threads:c.threads,pendingReadStatusThreads:c.pendingReadStatusThreads,messages:c.messages,localIDsMap:c.localIDsMap,messagesWithUploadsInFlight:c.messagesWithUploadsInFlight,threadlistOrderMap:c.threadlistOrderMap,pinnedThreads:c.pinnedThreads,montage:c.montage,orderedMessageLists:c.orderedMessageLists,unreadCounts:c.unreadCounts,initialUnreadCounts:c.initialUnreadCounts,unseenTimestamp:c.unseenTimestamp}}var gb=function(a,b){delete a[b];return 0};function hb(a,c){Object.keys(c).forEach(function(d){var e=b("bs_js_dict").get(c,d);if(e===void 0)return;var f=e[0],g=k(f.reduce(function(c,d){var e=b("bs_belt_Map").get(a,d);if(e!==void 0)return b("bs_belt_Map").set(c,d,b("bs_caml_option").valFromOption(e));else return c},b("bs_belt_Map").make(b("ThreadId.bs"))));if(Object.keys(g).length===f.length){gb(c,d);return b("bs_curry")._1(e[1],g)}})}function ib(c,a,d,e,f){var g=c.fbid;d!==0&&ra(g,a.thread_id,f,d);if(a.timestamp===0){b("ChatReliabilityInstrumentation").logERROR("thread timestamp is 0");e.add(a.thread_id);return}d=a.unread_count===0;if(d===f)return;u(g,a.thread_id);if(f)e=0;else{d=b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(c.orderedMessageLists.get(a.thread_id)),function(a){return b("bs_belt_Array").get(E(void 0,c,a.messageIDs),0)});g=d!==void 0?b("bs_caml_option").valFromOption(d).profile_ranges:null;e=Xa(g,c.fbid)}return{unread_count:f?0:1,unread_mentions_count:e}}function jb(a,c,d,e,f){f=b("gkx")("1275193")||b("gkx")("1660458")?xa(a,f,c,d):wa(a,f,c,d);a=a.threadlistOrderMap[c];c=b("bs_js_dict").get(a,d);c=c!==void 0?b("bs_caml_option").valFromOption(c).reachedEnd:!1;a[d]={reachedEnd:e.contents?e.contents:c,threadlist:f[0],existingIDs:f[1]}}function kb(a,c,d,e){var f=b("bs_belt_Array").make(e.length,[]),g={contents:!1};d.forEach(function(d){d.thread_ids.forEach(function(c){var h=b("bs_belt_Map").get(a.threads,c);if(h===void 0)return;h=w(b("bs_caml_option").valFromOption(h));for(var g=0,d=e.length;g<d;++g){var i=h.find(function(a){return function(c){return c===b("bs_caml_array").get(e,a)}}(g));(i===void 0?void 0:b("bs_caml_option").some(i))!==void 0&&b("bs_caml_array").get(f,g).push(c)}});d=d.limit;var h=e.find(function(a){return a===b("MercuryFilters.bs").all});h=h===void 0?void 0:b("bs_caml_option").some(h);for(var i=0,c=f.length;i<c;++i)(h===void 0&&b("bs_caml_array").get(f,i).length<d||b("bs_caml_array").get(e,i)===b("MercuryFilters.bs").all&&b("bs_caml_array").get(f,i).length<d)&&(g.contents=!0)});for(var d=0,h=e.length;d<h;++d)jb(a,c,b("bs_caml_array").get(e,d),g,b("bs_caml_array").get(f,d))}function M(c,a){var d;if(a.is_archived)d="action:archived";else{var e=a.thread_type;d=e==null||e!==b("MessagingThreadType").MARKETPLACE?a.folder:"marketplace_folder"}e=b("bs_js_dict").get(c.threadlistOrderMap,d);if(e!==void 0)return d}function lb(a,c){var d={};na.forEach(function(a){var b={};ma.forEach(function(a){b[a]=[]});d[a]=b});c.forEach(function(c){var e=b("bs_belt_Map").get(a.threads,c.thread_id);if(e===void 0)return;var f=b("bs_caml_option").valFromOption(e),g=M(a,f);if(g!==void 0){w(f).forEach(function(a){if(f.timestamp!==0){d[g][a].push(c.thread_id);return}});return}});na.forEach(function(c){ma.forEach(function(e){var f=d[c][e];b("gkx")("1275193")||b("gkx")("1660458")?xa(a,f,c,e):wa(a,f,c,e)})});return{fbid:a.fbid,deliveryReceipts:a.deliveryReceipts,readReceiptsPerThread:a.readReceiptsPerThread,ignoredIds:a.ignoredIds,blockedIds:a.blockedIds,pendingFolderUnseenCount:a.pendingFolderUnseenCount,typing:a.typing,threads:a.threads,pendingReadStatusThreads:a.pendingReadStatusThreads,messages:a.messages,localIDsMap:a.localIDsMap,messagesWithUploadsInFlight:a.messagesWithUploadsInFlight,threadlistOrderMap:a.threadlistOrderMap,pinnedThreads:a.pinnedThreads,montage:a.montage,orderedMessageLists:a.orderedMessageLists,unreadCounts:a.unreadCounts,initialUnreadCounts:a.initialUnreadCounts,unseenTimestamp:a.unseenTimestamp}}function mb(a){b("bs_belt_Map").map(a.threads,function(c){c=b("bs_belt_Map").get(a.threads,c.thread_id);if(c===void 0)return;c=b("bs_caml_option").valFromOption(c);if(b("bs_caml_option").nullable_to_opt(c.thread_type)!==b("MessagingThreadType").MARKETPLACE)return;c=b("ImmutableObject").set(c,{folder:"marketplace_folder"});lb(a,[c])})}function nb(c,a,d){var e=function(a){return a.timestamp>(d&&c.unseenTimestamp<=a.last_read_timestamp?a.last_read_timestamp:c.unseenTimestamp)},f=function(a){var d;return(d=b("bs_belt_Option")).mapWithDefault(d.flatMap(d.map(d.map(b("bs_caml_option").nullable_to_opt(c.orderedMessageLists.get(a.thread_id)),function(a){return b("bs_caml_array").get(a.messageIDs,0)}),function(a){return b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(c.localIDsMap.get(a)),a)}),function(a){return b("bs_caml_option").nullable_to_opt(c.messages.get(a))}),!1,function(a){return a.author===b("MercuryIDs").getParticipantIDFromUserID(c.fbid)})},g=function(a,c){if(e(a)&&!b("MercuryThreadInfo").isMuted(a)&&!f(a))return c+1|0;else return c};return b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(b("bs_belt_Option").flatMap(b("bs_js_dict").get(c.threadlistOrderMap,"inbox"),function(a){return b("bs_js_dict").get(a,b("MercuryFilters.bs").all)}),function(d){d=d.threadlist;if(d.length!==0)return d.reduce(function(a,d){d=b("bs_belt_Map").get(c.threads,d);if(d!==void 0)return g(b("bs_caml_option").valFromOption(d),a);else return a},0);else if(b("bs_belt_Map").isEmpty(c.threads))return a.fallbackUnseenCount.contents;else return b("bs_belt_Map").reduce(c.threads,0,function(b,d,a){d=M(c,a);if(d==="inbox")return g(a,b);else return b})}),a.fallbackUnseenCount.contents)}function N(c,a){return b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(b("bs_belt_Option").flatMap(b("bs_js_dict").get(c.threadlistOrderMap,"inbox"),function(a){return b("bs_js_dict").get(a,b("MercuryFilters.bs").all)}),function(d){if(d.threadlist.length===0)if(b("bs_belt_Map").isEmpty(c.threads))return a.fallbackUnseenCount.contents;else return b("bs_belt_Map").reduce(c.threads,0,function(d,e,a){var f=M(c,a);if(f===void 0)return d;if(f!=="inbox")return d;if(!(a.timestamp>c.unseenTimestamp&&!b("MercuryThreadInfo").isMuted(a)))return d;f=b("bs_js_dict").get(c.unreadCounts,"inbox");if(f!==void 0&&b("bs_caml_option").valFromOption(f).has(e))return d+1|0;else return d});else return d.threadlist.reduce(function(d,e){var a=b("bs_belt_Map").get(c.threads,e);if(a===void 0)return d;a=b("bs_caml_option").valFromOption(a);if(!(a.timestamp>c.unseenTimestamp&&!b("MercuryThreadInfo").isMuted(a)))return d;a=b("bs_js_dict").get(c.unreadCounts,"inbox");if(a!==void 0&&b("bs_caml_option").valFromOption(a).has(e))return d+1|0;else return d},0)}),a.fallbackUnseenCount.contents)}function ob(c,a,d){if(d==="pending")return{fbid:c.fbid,deliveryReceipts:c.deliveryReceipts,readReceiptsPerThread:c.readReceiptsPerThread,ignoredIds:c.ignoredIds,blockedIds:c.blockedIds,pendingFolderUnseenCount:0,typing:c.typing,threads:c.threads,pendingReadStatusThreads:c.pendingReadStatusThreads,messages:c.messages,localIDsMap:c.localIDsMap,messagesWithUploadsInFlight:c.messagesWithUploadsInFlight,threadlistOrderMap:c.threadlistOrderMap,pinnedThreads:c.pinnedThreads,montage:c.montage,orderedMessageLists:c.orderedMessageLists,unreadCounts:c.unreadCounts,initialUnreadCounts:c.initialUnreadCounts,unseenTimestamp:c.unseenTimestamp};if(b("gkx")("969964")){d=b("MercuryThreadInformer").getForFBID(c.fbid);d.updatedUnseenTimestamp()}return{fbid:c.fbid,deliveryReceipts:c.deliveryReceipts,readReceiptsPerThread:c.readReceiptsPerThread,ignoredIds:c.ignoredIds,blockedIds:c.blockedIds,pendingFolderUnseenCount:c.pendingFolderUnseenCount,typing:c.typing,threads:c.threads,pendingReadStatusThreads:c.pendingReadStatusThreads,messages:c.messages,localIDsMap:c.localIDsMap,messagesWithUploadsInFlight:c.messagesWithUploadsInFlight,threadlistOrderMap:c.threadlistOrderMap,pinnedThreads:c.pinnedThreads,montage:c.montage,orderedMessageLists:c.orderedMessageLists,unreadCounts:c.unreadCounts,initialUnreadCounts:c.initialUnreadCounts,unseenTimestamp:a}}function O(a,c,d){var e=[];return b("bs_array").fold_left(function(f,g){switch(g.TAG|0){case 0:e.push(g._0.TAG|0);break;case 1:case 2:break}switch(g.TAG|0){case 0:var i=g._0;if(typeof i==="number"){a.threadCallbacks.contents={};a.threadSubToken.contents=a.threadSubToken.contents;a.failedHistoryFetchThreads.contents={};a.localTitanMessageCount.clear();b("bs_belt_Map").keysToArray(f.threads).forEach(function(a){return pa(f.fbid,a)});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:void 0,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:b("bs_belt_Map").make(b("ThreadId.bs")),pendingReadStatusThreads:new Set(),messages:new Map(),localIDsMap:new Map(),messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:oa(void 0),pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:new Map(),unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}switch(i.TAG|0){case 0:var m=i._0,n={contents:!1},o={contents:f.deliveryReceipts};Object.keys(m).forEach(function(a){var c=m[a],d=b("bs_belt_Option").getWithDefault(b("bs_belt_MapString").get(o.contents,a),0);if(c>d){n.contents=!0;o.contents=b("bs_belt_MapString").set(o.contents,a,c);return}});if(n.contents)return{fbid:f.fbid,deliveryReceipts:o.contents,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};else return f;case 1:return ia(f,i._0,[]);case 2:var p=i._0,q=i._1;q=q.reduce(b("bs_belt_Set").remove,p.reduce(b("bs_belt_Set").add,f.blockedIds));if(q===f.blockedIds)return f;else return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:q,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 3:p=i._0;q=p.reduce(function(a,c){var d=c.is_messenger_ignored;if(d==null)return a;else if(d)return b("bs_belt_Set").add(a,b("MercuryIDs").getParticipantIDFromUserID(c.fbid));else return b("bs_belt_Set").remove(a,b("MercuryIDs").getParticipantIDFromUserID(c.fbid))},f.ignoredIds);if(q===f.ignoredIds)return f;else return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:q,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 4:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("SetInitialPendingFolderUnseenCount");p=i._0;return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:p,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 5:q=i._0;p=la(f.fbid,q);if(p==null)return f;var r=b("FBID.bs").ofString(q.from.toString());if(r===void 0)return f;b("MessengerPersonas.bs").addPersona(q.persona);var s=q.persona;r=s==null?b("MercuryIDs").getParticipantIDFromUserID(b("bs_caml_option").valFromOption(r)):b("MercuryIDs").getParticipantIDFromUserID(s.id);if(q.st===b("TypingStates").TYPING){s=b("bs_belt_MapString").get(f.typing,p);if(s!==void 0)return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:b("bs_belt_MapString").set(f.typing,p,b("bs_belt_Map").set(b("bs_caml_option").valFromOption(s),r,Date.now())),threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};s=b("bs_belt_Map").set(b("bs_belt_Map").make(b("ParticipantId.bs")),r,Date.now());return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:b("bs_belt_MapString").set(f.typing,p,s),threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}if(q.st!==b("TypingStates").INACTIVE)return f;s=ka(f.typing,p,r);if(s!==f.typing)return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:s,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};else return f;case 6:var ba=i._0,ca={contents:!1},t={contents:f.readReceiptsPerThread};Object.keys(ba).forEach(function(a){Object.keys(ba[a]).forEach(function(c){var d=b("bs_belt_MapString").get(t.contents,a);d=d!==void 0?b("bs_caml_option").valFromOption(d):b("immutable").OrderedMap();var e=d.get(c),f=ba[a][c];if(!(e==null)&&f.watermark<=e.watermark)return;ca.contents=!0;t.contents=b("bs_belt_MapString").set(t.contents,a,d.set(c,f))});var c=b("bs_belt_MapString").get(t.contents,a);if(c!==void 0){ca.contents=!0;t.contents=b("bs_belt_MapString").set(t.contents,a,b("bs_caml_option").valFromOption(c).sort(function(a,c){return b("bs_caml_primitive").caml_float_compare(a.watermark,c.watermark)}));return}});if(ca.contents)return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:t.contents,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};else return f;case 7:q=i._0;if(q.length===0)return f;p=f.threads;r=q.reduce(function(c,a){return b("bs_belt_Map").set(c,a.thread_id,new(b("ImmutableObject"))(a))},p);hb(r,a.threadCallbacks.contents);q.forEach(function(a){return u(f.fbid,a.thread_id)});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 8:s=i._0;if(s.length===0)return f;var da=f.pendingReadStatusThreads,ea=b("MercuryServerRequests").getForFBID(f.fbid);s.forEach(function(a){var b=a.thread_id;if(da.has(b)){da["delete"](b);if(a.unread_count>0){ea.changeThreadReadStatus(b,!0,null,null,null,null);return}else return}});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:da,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 9:var fa=i._0;b("qex")._("998180")&&b("MessengerEnvironment").messengerdotcom&&mb(f);na.forEach(function(a){ma.forEach(function(c){var d=fa.filter(function(d){var e=d.filter;e=e==null?b("MercuryFilters.bs").all:e;d=d.folder;d=d==null?a==="inbox":d===a;if(d)return e===c;else return!1});if(!b("gkx")("1275193")&&!b("gkx")("1660458")||a!=="inbox"&&a!=="action:archived"&&a!=="pending"||c===b("MercuryFilters.bs").groups){var e=[],g={contents:!1};d.forEach(function(a){a.thread_ids.forEach(function(a){e.push(a)});var b=a.limit;if(a.thread_ids.length<b){g.contents=!0;return}});return jb(f,a,c,g,e)}if(c!==b("MercuryFilters.bs").all)return kb(f,a,d,[b("MercuryFilters.bs").all,c]);var h=b("gkx")("1275193")?[b("MercuryFilters.bs").all,b("MercuryFilters.bs").unread,b("MercuryFilters.bs").named,b("MercuryFilters.bs").unnamed]:[b("MercuryFilters.bs").all,b("MercuryFilters.bs").unread,b("MercuryFilters.bs").unsyncedChat];return kb(f,a,d,h)})});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 10:return lb(f,i._0);case 11:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdatePinnedThreads");p=i._0;if(p.length===0)return f;p.forEach(function(b){if(!a.existingPinnedThreads.has(b)){f.pinnedThreads.push(b);a.existingPinnedThreads.add(b);return}});q=b("MercuryThreadInformer").getForFBID(f.fbid);q.updatedThreadlist();return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 12:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UnSubscribeStatusUpdate");r=i._0;var ha=i._1;return v(function(a){return a.page_unsubscribe_status!==ha},f,r,{page_unsubscribe_status:ha});case 13:s=i._0;p=i._1;q=i._2;return v(void 0,f,s,{can_reply:p,cannot_reply_reason:q});case 14:r=i._0;s=i._1;p=b("bs_belt_Map").get(f.threads,r);if(p===void 0)return f;q=Object.assign({},b("bs_caml_option").valFromOption(p));ua(b("MercuryIDs").getParticipantIDFromUserID(f.fbid),q,s);return v(void 0,f,r,q);case 15:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangeFlag");p=i._0;s=i._1;r=b("bs_belt_Map").get(f.threads,p);if(r===void 0)return f;q=b("bs_caml_option").valFromOption(r);r=q.page_thread_info;q=b("ImmutableObject").set(q,{page_thread_info:Object.assign(r==null?{}:r,{flagged:s})});r=b("bs_belt_Map").set(f.threads,p,q);u(f.fbid,p);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 16:s=i._0;return v(function(a){return b("MessageRequestUtils").isMessageRequest(a)},f,s,{folder:"inbox"});case 17:q=i._0;p=i._1;return v(void 0,f,q,{custom_like_icon:p});case 18:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("PromoteGroupAdmins");r=i._0;s=i._1;q=b("bs_belt_Map").get(f.threads,r);if(q===void 0)return f;p=b("bs_caml_option").valFromOption(q);q=b("bs_js_dict").fromArray(b("bs_js_dict").entries(p.admins));p=b("ImmutableObject").set(p,{admins:b("bs_array").fold_left(function(a,b){a[b.admin_fbid]=b.admin_type;return a},q,s)});q=b("bs_belt_Map").set(f.threads,r,p);u(f.fbid,r);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:q,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 19:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("RemoveGroupAdmins");s=i._0;p=i._1;r=b("bs_belt_Map").get(f.threads,s);if(r===void 0)return f;q=b("bs_caml_option").valFromOption(r);r=b("bs_js_dict").fromArray(b("bs_js_dict").entries(q.admins));q=b("ImmutableObject").set(q,{admins:b("bs_array").fold_left(function(c,a){var d=b("bs_js_dict").get(c,a);d!==void 0&&ja(c,a);return c},r,p)});r=b("bs_belt_Map").set(f.threads,s,q);u(f.fbid,s);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 20:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("JoinableMode");p=i._0;q=i._1;return v(void 0,f,p,{joinable_mode:q});case 21:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ApprovalMode");s=i._0;r=i._1;return v(void 0,f,s,{approval_mode:r});case 22:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ApprovalQueue");p=i._0;q=i._1;s=i._2;var ra=i._3,sa=i._4;r=b("bs_belt_Map").get(f.threads,p);if(r===void 0)return f;r=b("bs_caml_option").valFromOption(r);var w=r.group_approval_queue;r={approval_queue_ids:r.approval_queue_ids.slice(),group_approval_queue:w==null?null:w.slice()};!(q==null)&&r.approval_queue_ids.indexOf(q)===-1&&Object.assign(r,{approval_queue_ids:r.approval_queue_ids.concat([q])});if(!(s==null)){w=r.group_approval_queue;w==null?Object.assign(r,{group_approval_queue:[s]}):w.map(function(a){return a.requester.id}).indexOf(s.requester.id)===-1&&Object.assign(r,{group_approval_queue:w.concat([s])})}ra==null||Object.assign(r,{approval_queue_ids:r.approval_queue_ids.filter(function(a){return b("bs_caml_obj").caml_notequal(a,ra)})});if(!(sa==null)){q=r.group_approval_queue;Object.assign(r,{group_approval_queue:(q==null?[]:q).filter(function(a){return a.requester.id!==sa})})}return v(void 0,f,p,r);case 23:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("IsPinProtected");w=i._0;s=i._1;return v(void 0,f,w,{is_pin_protected:s});case 24:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateRtcCallData");q=i._0;p=i._1;r=i._2;w=i._3;s=b("bs_belt_Map").get(f.threads,q);if(s===void 0)return f;if(p==null){s=b("bs_caml_option").valFromOption(s).rtc_call_data;s=s==null?void 0:p}else s=p;return v(void 0,f,q,{rtc_call_data:new(b("ImmutableObject"))({call_state:r,server_info_data:w,initiator_fbid:s})});case 25:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateCommStatus");p=i._0;q=i._1;return v(void 0,f,p,{comm_status:q});case 26:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateCommItemOwner");r=i._0;w=i._1;s=i._2;p=i._3;q=w==null?{nodes:[]}:{nodes:[{admin:{id:w,name:s,profile_picture:{uri:p}}}]};v(void 0,f,r,{comm_item_owners:q});if(w==null)return v(void 0,f,r,{thread_associated_page_admin:null});else return v(void 0,f,r,{thread_associated_page_admin:{id:w,name:s,profile_picture:{uri:p}}});case 27:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("EventRsvpChanged");q=i._0;var xa=i._1;r=i._2;w=b("bs_belt_Map").get(f.threads,q);if(w===void 0)return f;s=b("bs_caml_option").valFromOption(w).participants_event_status;p=(s==null?[]:s).filter(function(a){return b("bs_caml_obj").caml_notequal(a.participant_id,xa)});p.push({participant_id:xa,event_status:r});return v(void 0,f,q,{participants_event_status:p});case 28:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("GroupsSyncStatusChanged");w=i._0;s=i._1;r=i._2;return!(r==null)&&b("bs_caml_obj").caml_equal(r,b("MessengerGroupsSyncStatus").OPT_IN)?v(void 0,f,w,{groups_sync_status:s}):v(void 0,f,w,{groups_sync_status:s,work_associated_group:null});case 29:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("GroupsSyncMetadataUpdate");q=i._0;p=i._1;r=i._2;w=i._3;if(p==null)return v(void 0,f,q,{work_associated_group:null});if(!b("bs_caml_obj").caml_equal(p,b("MessengerGroupsSyncStatus").OPT_IN))if(b("bs_caml_obj").caml_equal(p,b("MessengerGroupsSyncStatus").UPDATE_EMOJI))return v(void 0,f,q,{work_associated_group:{id:r,group_icon:{emoji_codepoints:w}}});else return v(void 0,f,q,{work_associated_group:null});s=new(h||(h=b("URI")))(document.URL);p=s.getDomain();w=va.getURIBuilder().setString("idorvanity",r).getURI().setDomain(p==null?"":p.replace("messenger.com","facebook.com")).setPort(s.getPort()).setProtocol("https");return v(void 0,f,q,{work_associated_group:{id:r,url:w.toString(),group_saves:{count:0},group_events:{count:0}}});case 30:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("DescriptionChanged");p=i._0;s=i._1;return v(void 0,f,p,{description:s});case 31:q=i._0;r=i._1;return v(void 0,f,q,{solid_color:r.solid_color,header_color:r.header_color,footer_color:r.footer_color,gradient_colors:r.gradient_colors,theme_id:r.theme_id,reactions:r.reactions});case 32:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateJoinableLink");w=i._0;p=i._1;return v(void 0,f,w,{joinable_link:p});case 33:var Ca=i._0;s=b("bs_belt_Map").toArray(f.threads).reduce(function(c,d){var a=d[1];d=d[0];if(a.folder===Ca){u(f.fbid,d);return b("bs_belt_Map").set(c,d,b("ImmutableObject").set(a,{unread_count:0,unread_mentions_count:0}))}else return c},f.threads);f.unreadCounts[Ca]=new Set();q=b("MercuryThreadInformer").getForFBID(f.fbid);q.updatedUnreadState();return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:s,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 34:var Ga=i._0;b("gkx")("1199097")&&b("ChatReliabilityInstrumentation").logDELETE_THREAD(Ga);r=b("bs_belt_Map").remove(f.threads,Ga);f.orderedMessageLists["delete"](Ga);f.messages.forEach(function(a,c,d){if(!b("bs_caml_obj").caml_equal(a.thread_id,Ga))return;f.messages["delete"](a.message_id);c=a.offline_threading_id;if(!(c==null)){d=f.localIDsMap.get(c);d==null||(f.messages["delete"](d),f.localIDsMap["delete"](c))}f.localIDsMap["delete"](a.message_id)});pa(f.fbid,Ga);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 35:w=i._0;return Ra(f,a,[w.message_id,w,i._1]);case 36:p=[i._0,i._1,i._2];var x=p[2];q=p[1];var y=p[0];if(q.length===0)return f;s=Ta(f,[y,q,x]);r=0;x!==void 0&&b("bs_caml_obj").caml_equal(b("bs_caml_option").valFromOption(x),b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)||(r=1);r===1&&b("MercuryServerRequests").getForFBID(s.fbid).deleteMessages(y,q);return b("bs_belt_Array").reduce(q,s,function(d,e){var c=D(d,e),a=b("bs_belt_Map").get(d.threads,y);if(a!==void 0){a=b("bs_caml_option").valFromOption(a);a=b("ImmutableObject").set(b("ImmutableObject").set(a,Ua(d,y)),{message_count:a.message_count-1|0});a=b("bs_belt_Map").set(d.threads,y,a);u(d.fbid,y);a={fbid:d.fbid,deliveryReceipts:d.deliveryReceipts,readReceiptsPerThread:d.readReceiptsPerThread,ignoredIds:d.ignoredIds,blockedIds:d.blockedIds,pendingFolderUnseenCount:d.pendingFolderUnseenCount,typing:d.typing,threads:a,pendingReadStatusThreads:d.pendingReadStatusThreads,messages:d.messages,localIDsMap:d.localIDsMap,messagesWithUploadsInFlight:d.messagesWithUploadsInFlight,threadlistOrderMap:d.threadlistOrderMap,pinnedThreads:d.pinnedThreads,montage:d.montage,orderedMessageLists:d.orderedMessageLists,unreadCounts:d.unreadCounts,initialUnreadCounts:d.initialUnreadCounts,unseenTimestamp:d.unseenTimestamp}}else a=d;if(c!==void 0){d=b("bs_caml_option").valFromOption(c);Va(b("bs_caml_option").some(y),d);Na(a.fbid,y,e,x,d.attachments)}return a});case 37:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangeFolder");return Fa(f,i._0,i._1,1);case 38:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangeMuteSettings");w=i._0;p=i._1;r=b("bs_belt_Map").get(f.threads,w);if(r===void 0)return f;q=b("bs_caml_option").valFromOption(r);var Ha;switch(p.TAG|0){case 0:Ha=b("ImmutableObject").set(q,{reactions_mute_mode:p._0?1:0});break;case 1:Ha=b("ImmutableObject").set(q,{mentions_mute_mode:p._0?1:0});break;case 2:s=p._0;Ha=b("ImmutableObject").set(q,{mute_until:s===0?void 0:s});break}r=b("bs_belt_Map").set(f.threads,w,Ha);u(f.fbid,w);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 39:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangeArchivedStatus");p=i._0;q=i._1;s=b("bs_belt_Map").get(f.threads,p);if(s===void 0)return f;w=b("bs_caml_option").valFromOption(s);if(w.is_archived===q)return f;r=b("MessengerFolders.bs").getFromMeta(w);s=w.comm_status;s=s==null?b("ImmutableObject").set(w,{is_archived:q}):b("ImmutableObject").set(w,{is_archived:q,comm_status:q?b("PageCommItemStatus").DONE:b("PageCommItemStatus").TODO});w=b("bs_belt_Map").set(f.threads,p,s);Ba(f,s,r);Ea(f,s);u(f.fbid,p);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:w,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 40:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangePageFollowUpStatus");q=i._0;r=i._1;s=b("bs_belt_Map").get(f.threads,q);if(s===void 0)return f;p=b("bs_caml_option").valFromOption(s);if(p.is_page_follow_up===r)return f;w=b("ImmutableObject").set(p,{is_page_follow_up:r});s=b("bs_belt_Map").set(f.threads,q,w);u(f.fbid,q);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:s,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 41:p=i._0;r=i._1;w=i._2;q=i._3;s=i._4;var z=b("bs_belt_Map").get(f.threads,p);if(z===void 0)return f;z=b("bs_caml_option").valFromOption(z);w=ib(f,z,w,f.pendingReadStatusThreads,r);w=w!==void 0&&z.last_message_timestamp>z.last_read_timestamp?b("bs_caml_option").some(Object.assign(b("bs_caml_option").valFromOption(w),{last_read_timestamp:z.last_message_timestamp})):w;if(w!==void 0){w=b("ImmutableObject").set(z,b("bs_caml_option").valFromOption(w));var A=b("bs_belt_Map").set(f.threads,p,w);if(q){q=!z.read_only&&z.folder==="inbox";var B=b("MercuryServerRequests").getForFBID(f.fbid);B.changeThreadReadStatus(w.thread_id,r,s,w.last_read_timestamp,q,w.last_message_type)}B=A}else B=f.threads;s=b("MessengerFolders.bs").getFromMeta(z);r?(ta(f,[p],s,b("MercuryFilters.bs").unread),Aa(f,s,b("bs_caml_option").some(p))):(b("gkx")("1275193")||b("gkx")("1660458")?Da(f,s,p):wa(f,[p],s,b("MercuryFilters.bs").unread),ya(f,s,b("bs_caml_option").some(p)));return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:B,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 42:var C=i._0;q=b("bs_belt_Option").getWithDefault(b("bs_belt_Option").map(b("bs_caml_option").nullable_to_opt(f.orderedMessageLists.get(C)),function(a){return{messageLoadingState:a.messageLoadingState,messageIDs:[]}}),{messageLoadingState:0,messageIDs:[]});f.orderedMessageLists.set(C,q);w=b("bs_belt_Option").map(b("bs_belt_Map").get(f.threads,C),function(a){return b("ImmutableObject").set(a,{message_count:0})});if(w!==void 0){var La=b("bs_caml_option").valFromOption(w);A=b("bs_belt_Map").set(f.threads,C,La);ma.forEach(function(a){return ta(f,[C],b("MessengerFolders.bs").getFromMeta(La),a)});z=A}else z=f.threads;za.forEach(function(a){a=b("bs_js_dict").get(f.unreadCounts,a);if(a!==void 0){b("bs_caml_option").valFromOption(a)["delete"](C);return}});qa(f.fbid,C);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:z,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 43:r=[i._0,i._1,i._2];s=Sa(f,[r[0],r[1]]);p=s.thread_id;B=Ta(f,[p,[s.message_id],r[2]]);q=a.localTitanMessageCount.get(p);q==null||a.localTitanMessageCount.set(p,Math.max(0,q-1|0));return B;case 44:w=[i._0,i._1];A=Sa(f,[w[0],w[1]]);b("MercuryServerRequests").getForFBID(f.fbid).sendNewMessage(Object.assign(A,{preview_attachments:void 0}));return f;case 45:z=[i._0,i._1,i._2,i._3];s=z[2];r=z[1];p=z[0];q=D(f,p);if(q===void 0)return f;B=b("bs_caml_option").valFromOption(q);w=b("bs_js_dict").map(function(a){return a},b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(B.reactions),{}));r!==void 0?w[s]=r:Pa(w,s);A=Object.assign(Object.assign({},B),{reactions:w});q=B.thread_id;q==null||Ka(f.fbid,q,p,z[3]);return F(f,[p,A]);case 46:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("MontageDirectExpire");r=i._0;s=D(f,r);if(s===void 0)return f;w=b("bs_caml_option").valFromOption(s);B=w.attachments;if(B==null)return f;if(B.length===0)return f;q=b("bs_caml_array").get(B,0);z=q.share;if(z==null)return f;p=z.target;if(p==null)return f;A=p.message_state;if(A==null)return f;s=Object.assign(Object.assign({},w),{attachments:b("bs_caml_array").set(b("bs_array").copy(B),0,Object.assign(Object.assign({},q),{share:Object.assign(Object.assign({},z),{target:Object.assign(Object.assign({},p),{message_state:"EXPIRED"})})}))});return F(f,[r,s]);case 47:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("LiveLocationUpdate");A=[i._0,i._1,i._2];w=A[0];B=D(f,w);if(B===void 0)return f;q=b("bs_caml_option").valFromOption(B);z=q.attachments;if(z==null)return f;if(z.length===0)return f;p=b("bs_caml_array").get(z,0);r=p.share;if(r==null)return f;s=r.target;if(s==null)return f;B=b("bs_array").copy(z);b("bs_caml_array").set(B,0,Object.assign(Object.assign({},p),{share:Object.assign(Object.assign({},r),{target:Object.assign(Object.assign({},A[1]),{live_location_id:s.live_location_id})})}));z=Object.assign(Object.assign({},q),{attachments:B});p=q.thread_id;p==null||Ka(f.fbid,p,w,A[2]);return F(f,[w,z]);case 48:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ReplaceMessage");r=i._0;s=i._1;var E=r.replaced_message_id;if(E==null)return f;B=D(f,E);if(B===void 0)return f;q=r.message_id;p={timestamp:r.timestamp};A=b("bs_caml_option").nullable_to_opt(r.status);A!==void 0&&(p.status=b("bs_caml_option").valFromOption(A));w=b("bs_caml_option").nullable_to_opt(r.log_message_data);w!==void 0&&(p.log_message_data=b("bs_caml_option").valFromOption(w));z=b("bs_caml_option").nullable_to_opt(r.meta_ranges);z!==void 0&&(p.meta_ranges=b("bs_caml_option").valFromOption(z));A=b("bs_caml_option").nullable_to_opt(r.ranges);A!==void 0&&(p.ranges=b("bs_caml_option").valFromOption(A));w=b("bs_caml_option").nullable_to_opt(r.raw_attachments);w!==void 0&&(p.raw_attachments=b("bs_caml_option").valFromOption(w));z=b("bs_caml_option").nullable_to_opt(r.attachments);z!==void 0&&(p.attachments=b("bs_caml_option").valFromOption(z));A=b("bs_caml_option").nullable_to_opt(r.body);A!==void 0&&(p.body=b("bs_caml_option").valFromOption(A));w=b("bs_caml_option").nullable_to_opt(r.platform_xmd);w!==void 0&&(p.platform_xmd=b("bs_caml_option").valFromOption(w));z=b("bs_caml_option").nullable_to_opt(r.profile_ranges);z!==void 0&&(p.profile_ranges=b("bs_caml_option").valFromOption(z));A=p;w=Object.assign(Object.assign({},b("bs_caml_option").valFromOption(B)),A);b("MercuryMessageIDs.bs").addServerID(q,q);var G=F(f,[q,w]);if(q!==E){G.messages["delete"](E);G.localIDsMap.set(E,q);z=b("bs_belt_Option").flatMap(b("bs_caml_option").nullable_to_opt(r.thread_id),function(a){return b("bs_caml_option").nullable_to_opt(G.orderedMessageLists.get(a))});p=r.thread_id;if(z!==void 0&&!(p==null)){B=Qa(G,[q].concat(z.messageIDs.filter(function(a){return a!==E})));G.orderedMessageLists.set(p,{messageLoadingState:z.messageLoadingState,messageIDs:B})}}A=r.message_id;w=r.thread_id;w==null||(Ka(G.fbid,w,E,s),Ka(G.fbid,w,A,s));return{fbid:G.fbid,deliveryReceipts:G.deliveryReceipts,readReceiptsPerThread:G.readReceiptsPerThread,ignoredIds:G.ignoredIds,blockedIds:G.blockedIds,pendingFolderUnseenCount:G.pendingFolderUnseenCount,typing:G.typing,threads:G.threads,pendingReadStatusThreads:G.pendingReadStatusThreads,messages:G.messages,localIDsMap:G.localIDsMap,messagesWithUploadsInFlight:G.messagesWithUploadsInFlight,threadlistOrderMap:G.threadlistOrderMap,pinnedThreads:G.pinnedThreads,montage:G.montage,orderedMessageLists:G.orderedMessageLists,unreadCounts:G.unreadCounts,initialUnreadCounts:G.initialUnreadCounts,unseenTimestamp:G.unseenTimestamp};case 49:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateLocalTitanMessagesCount");q=[i._0,i._1];p=q[0];z=D(f,q[1]);if(z!==void 0&&b("MessengerMessage.bs").isTitanMessage(b("bs_caml_option").valFromOption(z))){B=a.localTitanMessageCount.get(p);B==null?a.localTitanMessageCount.set(p,1):a.localTitanMessageCount.set(p,1+B|0)}return f;case 50:return Za(f,a,i._0,i._1);case 51:r=i._0;w=i._1;A=i._2;s=r.author;if(s==null)q=!1;else{z=b("MercuryIDs").getUserIDFromParticipantID(s);q=z==null?!1:z===b("CurrentUser").getID()}p=r.offline_threading_id;B=p==null?void 0:b("bs_caml_option").nullable_to_opt(f.localIDsMap.get(p));s=B!==void 0;if(b("gkx")("1491696")&&!q&&b("bs_caml_obj").caml_equal(w,b("bs_caml_option").some(b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE))&&s)return f;z=cb(f,r,w,A==null?void 0:b("bs_caml_option").some(A));ab(z.fbid,w,r,function(a,b,c){a.informNewMessage(b,c)});p=z.fbid;if(r.folder==="pending"&&b("bs_caml_obj").caml_equal(w,b("bs_caml_option").some(b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)))B={fbid:z.fbid,deliveryReceipts:z.deliveryReceipts,readReceiptsPerThread:z.readReceiptsPerThread,ignoredIds:z.ignoredIds,blockedIds:z.blockedIds,pendingFolderUnseenCount:z.pendingFolderUnseenCount+1|0,typing:z.typing,threads:z.threads,pendingReadStatusThreads:z.pendingReadStatusThreads,messages:z.messages,localIDsMap:z.localIDsMap,messagesWithUploadsInFlight:z.messagesWithUploadsInFlight,threadlistOrderMap:z.threadlistOrderMap,pinnedThreads:z.pinnedThreads,montage:z.montage,orderedMessageLists:z.orderedMessageLists,unreadCounts:z.unreadCounts,initialUnreadCounts:z.initialUnreadCounts,unseenTimestamp:z.unseenTimestamp};else if(r.folder==="inbox"){q=r.thread_id;B=q==null?z:Fa(z,q,r.folder,0)}else{s=r.thread_id;if(s==null)B=z;else{q=eb(z.fbid,z.threads,r,A);if(q!==void 0){A=b("bs_caml_option").valFromOption(q);q=z.fbid;var H=z.deliveryReceipts,I=z.readReceiptsPerThread,J=z.ignoredIds,K=z.blockedIds,L=z.pendingFolderUnseenCount,M=z.typing,N=b("bs_belt_Map").set(z.threads,A.thread_id,A),O=z.pendingReadStatusThreads,P=z.messages,Q=z.localIDsMap,R=z.messagesWithUploadsInFlight,S=z.threadlistOrderMap,T=z.pinnedThreads,U=z.montage,V=z.orderedMessageLists,W=z.unreadCounts,X=z.initialUnreadCounts,Y=z.unseenTimestamp;q={fbid:q,deliveryReceipts:H,readReceiptsPerThread:I,ignoredIds:J,blockedIds:K,pendingFolderUnseenCount:L,typing:M,threads:N,pendingReadStatusThreads:O,messages:P,localIDsMap:Q,messagesWithUploadsInFlight:R,threadlistOrderMap:S,pinnedThreads:T,montage:U,orderedMessageLists:V,unreadCounts:W,initialUnreadCounts:X,unseenTimestamp:Y};if(b("bs_caml_obj").caml_equal(w,b("bs_caml_option").some(b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE))){H=r.offline_threading_id;H==null?Object.assign(r,{folder:A.folder}):b("bs_caml_obj").caml_equal(b("bs_caml_option").nullable_to_opt(Q.get(H)),H)?Object.assign(r,{client_message_id:r.offline_threading_id,status:b("MercuryActionStatus").SUCCESS,action_type:b("MercuryActionType").SEND_MESSAGE}):Object.assign(r,{folder:A.folder})}Ea(q,A);I=Object.assign({},A);J=r.offline_threading_id;if(!(J==null)){if(J!==r.message_id){Object.assign(I,{last_message_timestamp:r.timestamp});K=r.comm_status;K==null||Object.assign(I,{last_message_id:r.message_id})}L=r.author;if(!(b("cr:1299779")==null)&&!(L==null)){M=b("MercuryIDs").getParticipantIDFromUserID(p);r.has_attachment&&M===L&&Ya(s,r.message_id,J)}}N=r.comm_status;O=I.comm_status;!(N==null)&&!(O==null)&&b("bs_caml_obj").caml_notequal(O,b("PageCommItemStatus").FOLLOW_UP)&&Object.assign(I,{comm_status:N});P=r.creator_info;!(P==null)&&b("bs_caml_obj").caml_equal(P.pageID,p)&&Object.assign(I,{folder:r.folder});R=r.author;R==null||bb(I,R);B=v(void 0,q,s,I)}else B=z}}S=$a(B,a,r,w);T=fb(S,r);U=b("bs_caml_obj").caml_notequal(r.author,b("MercuryViewer").getID());V=r.thread_id;W=r.author;if(!U)return T;if(V==null)return T;if(W==null)return T;X=ka(T.typing,V,W);if(X!==T.typing)return{fbid:T.fbid,deliveryReceipts:T.deliveryReceipts,readReceiptsPerThread:T.readReceiptsPerThread,ignoredIds:T.ignoredIds,blockedIds:T.blockedIds,pendingFolderUnseenCount:T.pendingFolderUnseenCount,typing:X,threads:T.threads,pendingReadStatusThreads:T.pendingReadStatusThreads,messages:T.messages,localIDsMap:T.localIDsMap,messagesWithUploadsInFlight:T.messagesWithUploadsInFlight,threadlistOrderMap:T.threadlistOrderMap,pinnedThreads:T.pinnedThreads,montage:T.montage,orderedMessageLists:T.orderedMessageLists,unreadCounts:T.unreadCounts,initialUnreadCounts:T.initialUnreadCounts,unseenTimestamp:T.unseenTimestamp};else return T;case 52:Y=i._0;Q=i._1;H=i._2;A=b("bs_caml_obj").caml_notequal(H==null?void 0:b("bs_caml_option").some(H),!1);K=b("bs_caml_obj").caml_equal(H==null?void 0:b("bs_caml_option").some(H),!0);M=f.fbid;L=b("MercuryIDs").getParticipantIDFromUserID(M);J=$a(f,a,Y,Q);ab(J.fbid,Q,Y,function(a,b,c){a.informNewLogMessage(b,c)});O=cb(J,Y,Q,H==null?void 0:b("bs_caml_option").some(H));N=Y.thread_id;if(N==null)P=O;else{p=b("bs_belt_Map").get(O.threads,N);if(p!==void 0){R=Object.assign({},b("bs_caml_option").valFromOption(p));Ea(O,R);R.last_message_timestamp<Y.timestamp&&Object.assign(R,{last_message_timestamp:Y.timestamp});if(Y.timestamp>=R.timestamp||b("gkx")("1183082")){q=Y.log_message_type;if(!(q==null))if(b("bs_caml_obj").caml_equal(q,b("MercuryLogMessageType").SUBSCRIBE)&&!K){s=Y.log_message_data;if(s==null)I=[];else{z=s.added_participants;I=z==null?[]:z}ua(L,R,I);u(M,N)}else if(b("bs_caml_obj").caml_equal(q,b("MercuryLogMessageType").UNSUBSCRIBE)&&!K){B=Y.log_message_data;if(B==null)w=[];else{S=B.removed_participants;w=S==null?[]:S}db(L,R,w);u(M,N)}else if(b("bs_caml_obj").caml_equal(q,b("MercuryLogMessageType").THREAD_IMAGE)){if(!A){r=Y.log_message_data;if(r==null)U=null;else{V=r.image;U=V==null?null:V.preview_url}Object.assign(R,{image_src:U})}}else if(b("bs_caml_obj").caml_equal(q,b("MercuryLogMessageType").THREAD_NAME)){W=Y.log_message_data;if(!(W==null)){X=W.name;!(X==null)&&R.name===X||u(M,N);Object.assign(R,{name:W.name})}}else b("bs_caml_obj").caml_equal(q,b("MercuryLogMessageType").GENERIC_ADMIN_TEXT)&&Ia(M,R,Y,N)}P=v(void 0,O,N,R)}else P=O}return fb(P,Y);case 53:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("PinMessage");if(b("gkx")("1179386")){T=i._0;var pb=i._1;J=b("bs_belt_Map").get(f.threads,T);if(J!==void 0&&!(pb==null)){Q=b("bs_caml_option").valFromOption(J);H=Q.pinned_messages;p=H==null?[pb.message]:H.findIndex(function(a){return a.message_id===pb.message.message_id})===-1?[pb.message]:void 0;if(p!==void 0){s=b("ImmutableObject").set(Q,{pinned_messages:b("bs_belt_Option").getExn(p)});z=b("bs_belt_Map").set(f.threads,T,s);u(f.fbid,T);I=z}else I=f.threads}else I=f.threads;return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:I,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}else return f;case 54:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UnpinMessage");if(b("gkx")("1179386")){K=i._0;var Z=i._1;B=b("bs_belt_Map").get(f.threads,K);if(B!==void 0&&!(Z==null)){S=b("bs_caml_option").valFromOption(B);L=S.pinned_messages;w=L==null?void 0:L.filter(function(a){return a.message_id!==Z.message_id});if(w!==void 0){A=b("ImmutableObject").set(S,{pinned_messages:b("bs_belt_Option").getExn(w)});r=b("bs_belt_Map").set(f.threads,K,A);u(f.fbid,K);V=r}else V=f.threads}else V=f.threads;return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:V,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}else return f;case 55:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("ChangePinnedStatus");U=i._0;X=i._1;W=i._2;q=b("bs_belt_Map").get(f.threads,U);M=!1;if(X&&!a.existingPinnedThreads.has(U))f.pinnedThreads.push(U),a.existingPinnedThreads.add(U),M=!0;else if(!X&&a.existingPinnedThreads.has(U)){N=f.pinnedThreads.indexOf(U);N>-1&&f.pinnedThreads.splice(N,1);a.existingPinnedThreads["delete"](U);M=!0}if(q!==void 0){R=b("bs_caml_option").valFromOption(q);O=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(R.thread_pin_timestamp),0);if(R.is_pinned!==X||O!==W){P=b("ImmutableObject").set(R,{is_pinned:X,thread_pin_timestamp:W});Y=b("bs_belt_Map").set(f.threads,U,P);u(f.fbid,U);M=!0;J=Y}else J=f.threads}else J=f.threads;if(M)return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:J,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};else return f;case 56:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("InvalidateMontageState");H=i._0;Q=b("bs_js_dict").fromArray(b("bs_js_dict").entries(f.montage));Q[H]=[];return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:Q,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 57:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("NewMontageMessage");p=i._0;s=b("bs_js_dict").fromArray(b("bs_js_dict").entries(f.montage));T=p.actor.id;z=b("bs_js_dict").get(s,T);z!==void 0?(z.push(p),s[T]=z):s[T]=[p];return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:s,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 58:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("InstantiateMontageThread");I=i._0;B=b("bs_js_dict").fromArray(b("bs_js_dict").entries(f.montage));L=b("bs_js_dict").get(B,I);L!==void 0||(B[I]=[]);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:B,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 59:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("DeleteMontageMessage");var rb=i._0,$=b("bs_js_dict").fromArray(b("bs_js_dict").entries(f.montage));S=Object.keys($);S.forEach(function(a){var c=b("bs_js_dict").get($,a);if(c===void 0)return;c=c.filter(function(a){return a.id!==rb.messageFBID});$[a]=c});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:$,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 60:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("AddFetchedAllHistoryMarkers");w=[i._0,i._1];var sb=w[1];w[0].forEach(function(a){var b=f.orderedMessageLists.get(a);b==null?f.orderedMessageLists.set(a,{messageLoadingState:1,messageIDs:[]}):f.orderedMessageLists.set(a,{messageLoadingState:1,messageIDs:b.messageIDs});return Ma(f.fbid,a,sb)});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 61:A=i._0;A.forEach(function(c){var a=c.folder;if(!za.includes(a))return;c=c.thread_fbids.map(function(a){return b("MercuryIDs").getThreadIDFromThreadFBID(a)}).concat(c.other_user_fbids.map(function(a){return b("MercuryIDs").getThreadIDFromUserID(a)}));f.unreadCounts[a]=new Set(c);a=b("MercuryThreadInformer").getForFBID(f.fbid);a.updatedUnreadState()});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 62:K=i._0;var d={contents:f.unseenTimestamp};K.forEach(function(c){f.initialUnreadCounts[c.folder]=c.unread_count;c.unread_count===0&&(f.unreadCounts[c.folder]=new Set());c.folder==="inbox"&&(d.contents=b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(c.seen_timestamp),d.contents),a.fallbackUnseenCount.contents=c.unseen_count);c=b("MercuryThreadInformer").getForFBID(f.fbid);c.updatedUnreadState();c.updatedUnseenState()});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:d.contents};case 63:var tb=i._0;za.forEach(function(a){a=b("bs_js_dict").get(f.unreadCounts,a);if(a===void 0)return;var c=b("bs_caml_option").valFromOption(a);b("bs_js_dict").entries(tb).forEach(function(a){var b=a[0];if(c.has(b)){c.add(a[1]);c["delete"](b);return}})});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 64:r=i._0;V=i._1;N=i._2;q=i._3;O=i._4;R=Ja(f,r,[V]);X=D(R,V);if(X!==void 0){W=b("bs_caml_option").valFromOption(X);Va(b("bs_caml_option").some(r),W);P=b("MessengerMessage.bs").makeFakeMessage(W.message_id,W.thread_id,W.author,W.action_type,W.timestamp,{removed_timestamp:q,message_unsendability_status:b("MessageUnsendabilityStatus").DENY_TOMBSTONE_MESSAGE,unsender:{id:N}});U=F(R,[V,P]);Y=W.thread_id;if(Y==null)return U;M=Wa(U,V,Y);Ka(M.fbid,Y,V,O);Na(M.fbid,Y,V,O,W.attachments);J=b("bs_belt_Map").get(M.threads,Y);if(J===void 0)return M;H=b("bs_caml_option").valFromOption(J);Q=Xa(W.profile_ranges,M.fbid);z=b("ImmutableObject").set(b("ImmutableObject").set(H,Ua(M,Y)),{unread_mentions_count:H.unread_mentions_count-Q|0});T=b("bs_belt_Map").set(M.threads,Y,z);u(M.fbid,Y);return{fbid:M.fbid,deliveryReceipts:M.deliveryReceipts,readReceiptsPerThread:M.readReceiptsPerThread,ignoredIds:M.ignoredIds,blockedIds:M.blockedIds,pendingFolderUnseenCount:M.pendingFolderUnseenCount,typing:M.typing,threads:T,pendingReadStatusThreads:M.pendingReadStatusThreads,messages:M.messages,localIDsMap:M.localIDsMap,messagesWithUploadsInFlight:M.messagesWithUploadsInFlight,threadlistOrderMap:M.threadlistOrderMap,pinnedThreads:M.pinnedThreads,montage:M.montage,orderedMessageLists:M.orderedMessageLists,unreadCounts:M.unreadCounts,initialUnreadCounts:M.initialUnreadCounts,unseenTimestamp:M.unseenTimestamp}}Oa(R.fbid,r,V,O);return R;case 65:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UpdateConnectivityStatus");p=i._0;s=i._1;L=b("ThreadConnectivityStatus.bs").toGraphQLValue(s);I=b("bs_belt_Map").get(f.threads,p);if(I===void 0)return f;B=b("bs_caml_option").valFromOption(I);S=B.thread_connectivity_data;w=S==null?b("ImmutableObject").set(B,{thread_connectivity_data:{connectivity_status:L,first_sender_id:null}}):b("ImmutableObject").set(B,{thread_connectivity_data:{connectivity_status:L,first_sender_id:S.first_sender_id}});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:b("bs_belt_Map").set(f.threads,p,w),pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 66:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("DeltaMarkFolderSeen");var ub=i._0;return b("bs_belt_Array").reduceU(ub.folders,f,function(c,a){a=b("bs_js_dict").get(j,a);if(a!==void 0)return ob(c,Number(ub.timestamp),a);else return c});case 67:A=[i._0,i._1,i._2,i._3];var vb=A[2];K=A[0];X=D(f,K);if(X===void 0)return f;q=b("bs_caml_option").valFromOption(X);N=A[1].concat(q.tags).filter(function(a){return vb.indexOf(a)===-1});P=Object.assign(Object.assign({},q),{tags:N});U=q.thread_id;U==null||Ka(f.fbid,U,K,A[3]);return F(f,[K,P]);case 68:J=i._0;W=i._1;return v(void 0,f,J,{conversion_detection_data:W});case 69:H=[i._0,i._1,i._2,i._3,i._4];Q=H[0];z=D(f,Q);if(z===void 0)return f;Y=b("bs_caml_option").valFromOption(z);T=Y.attachments;if(T==null)return f;if(T.length!==1)return f;M=T[0];r=H[2]?[Object.assign(Object.assign({},M),{blurred_image_uri:void 0})]:[Object.assign(Object.assign({},M),{blurred_image_uri:H[3]})];V=Object.assign(Object.assign({},Y),{attachments:r});O=Y.thread_id;O==null||Ka(f.fbid,O,Q,H[4]);return F(f,[Q,V]);case 70:R=i._0;s=i._1;return v(void 0,f,R,{suggested_reply_data:s})}case 1:I=g._0;if(typeof I==="number")if(I===0){var wb=[];b("bs_belt_MapString").forEach(f.typing,function(a,c){return b("bs_belt_Map").forEach(c,function(b,c){if(c<Date.now()-3e4){wb.push([a,b]);return}})});if(wb.length===0)return f;var c={contents:f.typing};wb.forEach(function(a){c.contents=ka(c.contents,a[0],a[1])});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:c.contents,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}else{if(nb(f,a,!1)<=0)return f;B=b("MercuryServerRequests").getForFBID(f.fbid);B.markSeen();return ob(f,B.getLastActionTimestamp(),"inbox")}switch(I.TAG|0){case 0:L=I._0;S=I._1;p=I._2;w=I._3;var xb=f.threads,yb=[];X=k(L.reduce(function(d,c){var a=b("bs_belt_Map").get(xb,c);if(a!==void 0)return b("bs_belt_Map").set(d,c,b("bs_caml_option").valFromOption(a));else{yb.push(c);return d}},b("bs_belt_Map").make(b("ThreadId.bs"))));if(yb.length!==0){N=a.threadSubToken;q=N.contents.toString();a.threadSubToken.contents=N.contents+1|0;a.threadCallbacks.contents[q]=[L,p];U=b("MercuryServerRequests").getForFBID(f.fbid);A=yb.reduce(function(d,c){var e=b("MercuryIDs").tokenize(c),g=e.type;e=e.value;if(g!=="user")return d;g=b("MercuryIDs").getParticipantIDFromUserID(b("FBID.bs").ofStringExn(e));e=b("MercuryIDs").getParticipantIDFromUserID(f.fbid);e=b("MessengerThreadUtils.bs").createNewLocalThread(e,c,b("bs_caml_obj").caml_equal(g,e)?[e]:[e,g],null);g=b("bs_belt_Map").set(d,c,e);b("gkx")("1074761")||hb(g,a.threadCallbacks.contents);return g},f.threads);U.fetchThreadData(yb,w);b("bs_curry")._1(S,q);if(A===f.threads)return f;else return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:A,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp}}b("bs_curry")._1(p,X);return f;case 1:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("UnsubscribeThread");K=a.threadCallbacks.contents;gb(K,I._0);a.threadCallbacks.contents=K;return f;case 2:P=I._0;J=b("bs_belt_Array").keepMap(P,function(a){a=D(f,a);if(a!==void 0)return b("bs_caml_option").nullable_to_opt(b("bs_caml_option").valFromOption(a).offline_threading_id)});J.forEach(function(a){f.localIDsMap["delete"](a)});return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 3:b("ChatReliabilityInstrumentation").logPROCESS_DELTA("MontagePollStickerVoted");var zb=I._0;W=b("bs_js_dict").fromArray(b("bs_js_dict").entries(f.montage));z=zb.montageActorID;T=b("bs_js_dict").get(W,z);if(T!==void 0){M=T.map(function(a){if(b("bs_caml_obj").caml_equal(zb.montageMessageID,a.id)){var c=a.montage_overlays.map(function(a){if(!b("bs_caml_obj").caml_equal(a.poll.id,zb.pollID))return a;var c=a.poll.poll_options.map(function(a,c){if(c===zb.optionVotedIndex)return new(b("ImmutableObject"))({text:a.text,vote_count:a.vote_count+1|0});else return a});c=new(b("ImmutableObject"))({can_viewer_vote:a.poll.can_viewer_vote,id:a.poll.id,poll_options:c,viewer_vote_index:zb.optionVotedIndex});return b("ImmutableObject").set(new(b("ImmutableObject"))(a),{poll:c})});return b("ImmutableObject").set(new(b("ImmutableObject"))(a),{montage_overlays:c})}else return a});W[z]=M}return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:f.threads,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:W,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 4:r=b("bs_belt_Map").set(f.threads,I._0,I._1);return{fbid:f.fbid,deliveryReceipts:f.deliveryReceipts,readReceiptsPerThread:f.readReceiptsPerThread,ignoredIds:f.ignoredIds,blockedIds:f.blockedIds,pendingFolderUnseenCount:f.pendingFolderUnseenCount,typing:f.typing,threads:r,pendingReadStatusThreads:f.pendingReadStatusThreads,messages:f.messages,localIDsMap:f.localIDsMap,messagesWithUploadsInFlight:f.messagesWithUploadsInFlight,threadlistOrderMap:f.threadlistOrderMap,pinnedThreads:f.pinnedThreads,montage:f.montage,orderedMessageLists:f.orderedMessageLists,unreadCounts:f.unreadCounts,initialUnreadCounts:f.initialUnreadCounts,unseenTimestamp:f.unseenTimestamp};case 5:b("MercuryServerRequests").getForFBID(f.fbid).updateLastActionTimestamp(I._0);return f}case 2:Y=g._0;switch(Y.TAG|0){case 0:b("bs_curry")._1(Y._0,{blocked_ids:f.blockedIds});break;case 1:b("bs_curry")._1(Y._1,b("bs_belt_Map").get(f.threads,Y._0));break;case 2:b("bs_curry")._1(Y._0,f.pinnedThreads.concat([]));break;case 3:b("bs_curry")._2(Y._0,f,a);break}return f}},d,c)}function P(a){var c=[b("MercurySyncEventsProxy").getArbiterTypeForFBID(a,"TYP")];b("FBIDCheck").isUser_deprecated(a)||c.push(b("ChannelConstants").getArbiterType("page_typing"));return c}function Q(a){return{fbid:a,deliveryReceipts:void 0,readReceiptsPerThread:void 0,ignoredIds:b("bs_belt_Set").make(b("ParticipantId.bs")),blockedIds:b("bs_belt_Set").make(b("ParticipantId.bs")),pendingFolderUnseenCount:0,typing:void 0,threads:b("bs_belt_Map").make(b("ThreadId.bs")),pendingReadStatusThreads:new Set(),messages:new Map(),localIDsMap:new Map(),messagesWithUploadsInFlight:new Map(),threadlistOrderMap:oa(void 0),pinnedThreads:[],montage:{},orderedMessageLists:new Map(),unreadCounts:{},initialUnreadCounts:{},unseenTimestamp:0}}var R={contents:{}},S={contents:0},T=new Map(),U={contents:{}},V={contents:0},W=new Set(),X={contents:{}},Y={contents:0},pb={threadCallbacks:R,threadSubToken:S,localTitanMessageCount:T,messageCallbacks:U,messageSubToken:V,existingPinnedThreads:W,failedHistoryFetchThreads:X,fallbackUnseenCount:Y},qb={contents:0},Z={};function rb(a,c,d){d=c!==void 0?b("bs_caml_option").valFromOption(c):b("RemoteAction.bs").create(void 0);c=b("bs_js_dict").get(Z,a);if(c!==void 0)return;Z[a]={subscriptions:new Set(),state:Q(a),remoteAction:d};b("RemoteAction.bs").subscribe(function(c){var d=b("bs_js_dict").get(Z,a);if(d!==void 0){var e=d.state;c=O(pb,c,e);Z[a]={subscriptions:d.subscriptions,state:c,remoteAction:d.remoteAction};if(c===e)return;d=b("bs_js_dict").get(Z,a);d!==void 0?d.subscriptions.forEach(function(a){return b("bs_curry")._1(a.fn,void 0)}):b("recoverableViolation")("Subscriptions deleted after createion","messenger_comet");return}b("recoverableViolation")("State deleted after creation","messenger_comet")},d);var e=b("bs_caml_option").some(a),f=function(a){return $(e,a)},g=function(a){b("bs_curry")._1(f,[{TAG:0,_0:{TAG:5,_0:a}}]),b("setTimeoutAcrossTransitions")(function(a){return b("bs_curry")._1(f,[{TAG:1,_0:0}])},3e4)};b("Arbiter").subscribe(P(a),function(b,c){b=c.obj;c=b.to;if(!(c==null)&&c.toString()!==a)return;else{g(b);return}})}function $(a,c){a=a!==void 0?b("bs_caml_option").valFromOption(a):b("CurrentUser").getID();rb(a,void 0,void 0);a=b("bs_js_dict").get(Z,a);if(a!==void 0)return b("RemoteAction.bs").send(a.remoteAction,c);else{b("recoverableViolation")("Subscriptions deleted after createion","messenger_comet");return}}function sb(a,c,d,e){var f=a!==void 0?b("bs_caml_option").valFromOption(a):b("CurrentUser").getID();e=c!==void 0?b("bs_caml_option").valFromOption(c):b("RemoteAction.bs").create(void 0);rb(f,b("bs_caml_option").some(e),void 0);a=i.useState(function(){var a=b("bs_js_dict").get(Z,f);if(a!==void 0)return a.state;else return b("unrecoverableViolation")("Rendering without state initialized","messenger_comet")});var g=a[1],h=a[0];c=b("bs_js_dict").get(Z,f);var j=i.useCallback(function(a){a=b("bs_js_dict").get(Z,f);var c=a!==void 0?a.state:b("unrecoverableViolation")("Rendering without state initialized","messenger_comet");if(d!==void 0)if(b("bs_curry")._2(d,h,c))return b("bs_curry")._1(g,function(a){return c});else return;else return b("bs_curry")._1(g,function(a){return c})},[d,h,g,c,f]);i.useEffect(function(){qb.contents=qb.contents+1|0;var a=qb.contents,c={id:a,fn:j};a=b("bs_js_dict").get(Z,f);a!==void 0?a.subscriptions.add(c):b("recoverableViolation")("Subscriptions deleted after createion, can't add subscription","messenger_comet");b("bs_curry")._1(j,void 0);return function(a){a=b("bs_js_dict").get(Z,f);a!==void 0?a.subscriptions["delete"](c):b("recoverableViolation")("Subscriptions deleted after createion, can't remove subscription","messenger_comet")}},[j,f]);return h}function tb(a){var c=a.shouldUpdate,d=a.remoteAction,e=a.fbid;a=a.children;e=e!==void 0?b("bs_caml_option").valFromOption(e):b("CurrentUser").getID();return b("bs_curry")._1(a,sb(b("bs_caml_option").some(e),d,c,void 0))}function ub(a){b("gkx")("1463539")&&b("recoverableViolation")("messenger state is not allowed when lightspeed is enabled","messenger_comet");return sb(b("bs_caml_option").some(a),void 0,void 0,void 0)}function vb(a,c){return $(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:0,_0:c}}])}function wb(a,c){b("MercuryAssert").isThreadID(c);var d={contents:void 0},e=function(a){d.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:1,_0:c,_1:e}}]);return b("bs_js_null_undefined").fromOption(d.contents)}function xb(a,c,d,e){if(c.length!==0){b("MercuryAssert").allThreadID(c);var f={contents:null},g=function(a){f.contents=a};$(b("bs_caml_option").some(a),[{TAG:1,_0:{TAG:0,_0:c,_1:g,_2:d,_3:e}}]);return f.contents}b("bs_curry")._1(d,{});return null}function yb(a,c,d,e){return xb(a,[c],function(a){return b("bs_curry")._1(d,a[c])},e)}function zb(a,c,d,e){var f={contents:void 0},g=function(a){f.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:1,_0:c,_1:g}}]);g=f.contents;if(g!==void 0)return b("bs_caml_option").valFromOption(g);g=b("MessengerThreadUtils.bs").createNewLocalThread(b("MercuryIDs").getParticipantIDFromUserID(a),c,d,e);$(b("bs_caml_option").some(a),[{TAG:1,_0:{TAG:4,_0:c,_1:g}}]);return g}function Ab(a){var c=b("MercuryLocalIDs").generateThreadID(null);zb(a,c,[],null);return c}function Bb(a,c,d,e){var f={contents:void 0},g=function(a){f.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:1,_0:c,_1:g}}]);g=f.contents;if(g!==void 0)return b("bs_caml_option").valFromOption(g);g=b("MessengerThreadUtils.bs").createNewLocalGroupGeneralThread(b("MercuryIDs").getParticipantIDFromUserID(a),c,d,e);$(b("bs_caml_option").some(a),[{TAG:1,_0:{TAG:4,_0:c,_1:g}}]);return g}function Cb(a,c,d){var e=b("MercuryLocalIDs").generateThreadID(null);Bb(a,e,c,d);return e}function Db(a,c){var d={contents:void 0},e=function(a){d.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:1,_0:c,_1:e}}]);a=d.contents;if(a!==void 0)return b("MercuryThreadInfo").isEmptyLocalThread(b("bs_caml_option").valFromOption(a));else return!1}function Eb(a,c){var d={contents:void 0},e=function(a){d.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:1,_0:c,_1:e}}]);a=d.contents;if(a!==void 0)return b("MercuryThreadInfo").isNewEmptyLocalThread(b("bs_caml_option").valFromOption(a));else return!1}function Fb(c){var a={contents:[]},d=function(b){a.contents=b};$(b("bs_caml_option").some(c),[{TAG:2,_0:{TAG:2,_0:d}}]);return a.contents}function Gb(a,c){return $(b("bs_caml_option").some(a),[{TAG:1,_0:{TAG:1,_0:c}}])}function Hb(a){var c=a.payload_source;if(c==null)return!1;if(b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").CLIENT_CHANGE_ARCHIVED_STATUS)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").CLIENT_CHANNEL_MESSAGE)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").CLIENT_SEND_MESSAGE)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_SEND_MESSAGE)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_FETCH_THREADLIST_INFO)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_THREAD_SYNC)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_CHANGE_PINNED_STATUS)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_CHANGE_PINNED_MESSAGES)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)||b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").CLIENT_UPDATE_COMM_STATUS))return!0;if(!b("bs_caml_obj").caml_equal(c,b("MercuryPayloadSource").SERVER_INITIAL_DATA))return!1;c=a.ordered_threadlists;return!(c==null)}function Ib(a,c){c={TAG:1,_0:{TAG:3,_0:c}};return $(b("bs_caml_option").some(a),[c])}function Jb(a,c){return $(a==null?void 0:b("bs_caml_option").some(a),c)}function Kb(a){var c=[],d=!1;if(!(a==null)){var e=a.payload_source;!(e==null)&&b("bs_caml_obj").caml_equal(e,b("MercuryPayloadSource").SERVER_INVALIDATE_GLOBAL_STATE)&&(d=!0);e=a.newlyAddedClientIDs;!(e==null)&&Object.keys(e).length>0&&c.push({TAG:0,_0:{TAG:63,_0:e}});e=a.delivery_receipts;e==null||c.push({TAG:0,_0:{TAG:0,_0:e}});e=a.message_ignored_ids;e==null||c.push({TAG:0,_0:{TAG:1,_0:e}});e=a.threads;if(!(e==null)){var f=a.payload_source;f==null||(b("bs_caml_obj").caml_equal(f,b("MercuryPayloadSource").SERVER_FETCH_THREAD_INFO)&&c.push({TAG:0,_0:{TAG:8,_0:e}}),b("bs_caml_obj").caml_equal(f,b("MercuryPayloadSource").SERVER_INVALIDATE_THREAD_STATE)&&e.length>0&&c.unshift({TAG:0,_0:{TAG:34,_0:b("bs_caml_array").get(e,0).thread_id}}));c.push({TAG:0,_0:{TAG:7,_0:e}})}f=a.participants;if(!(f==null)){c.push({TAG:0,_0:{TAG:3,_0:f}});var g=[],h=[];f.forEach(function(a){a.is_messenger_blocked||a.is_facebook_blocked?g.push(b("MercuryIDs").getParticipantIDFromUserID(a.fbid)):h.push(b("MercuryIDs").getParticipantIDFromUserID(a.fbid))});e=0;(g.length!==0||h.length!==0)&&(e=1);e===1&&c.push({TAG:0,_0:{TAG:2,_0:g,_1:h}})}f=a.message_blocked_ids;!(f==null)&&f.length>0&&c.push({TAG:0,_0:{TAG:2,_0:f,_1:[]}});e=a.message_unblocked_ids;!(e==null)&&e.length>0&&c.push({TAG:0,_0:{TAG:2,_0:[],_1:e}});f=a.pending_folder_unseen_count;f==null||c.push({TAG:0,_0:{TAG:4,_0:f}});e=a.global_actions;e==null||e.forEach(function(a){if(b("bs_caml_obj").caml_equal(a.action_type,b("MercuryGlobalActionType").MARK_ALL_READ)){c.push({TAG:0,_0:{TAG:33,_0:a.folder}});return}});if(Hb(a)){f=a.ordered_threadlists;e=0;f==null||f.length===0?e=1:c.push({TAG:0,_0:{TAG:9,_0:f}});if(e===1){f=a.threads;e=a.payload_source;!(f==null)&&!(e==null)&&f.length>0&&e!==b("MercuryPayloadSource").SERVER_CHANGE_PINNED_STATUS&&c.push({TAG:0,_0:{TAG:10,_0:f}})}}e=a.pinned_thread_ids;!(e==null)&&e.length>0&&Hb(a)&&c.push({TAG:0,_0:{TAG:11,_0:e}});f=a.roger;f==null||c.push({TAG:0,_0:{TAG:6,_0:f}});e=a.montage_delete_message_delta;e==null||c.push({TAG:0,_0:{TAG:59,_0:e}});f=a.montage_new_message_delta;f==null||c.push({TAG:0,_0:{TAG:57,_0:f}});e=a.montage_poll_sticker_vote;e==null||e.forEach(function(a){c.push({TAG:1,_0:{TAG:3,_0:a}})});f=a.current_montage_thread;if(!(f==null)){e=f.user;if(!(e==null)){f=e.messenger_montage_thread;f==null||(c.push({TAG:0,_0:{TAG:58,_0:e.id}}),f.montage_messages.edges.forEach(function(a){c.push({TAG:0,_0:{TAG:57,_0:a.node}})}))}}e=a.unread_thread_fbids;e==null||c.push({TAG:0,_0:{TAG:61,_0:e}});f=a.message_counts;f==null||c.push({TAG:0,_0:{TAG:62,_0:f}});e=a.actions;if(!(e==null)){var i=a.payload_source,j=i==null?void 0:b("bs_caml_option").some(i);e.forEach(function(d){var e=d.action_type,f=0;(i==null||!i.startsWith("server"))&&(f=1);f===1&&c.push({TAG:1,_0:{TAG:5,_0:d.timestamp}});if(b("bs_caml_obj").caml_equal(j,b("bs_caml_option").some(b("MercuryPayloadSource").SERVER_SEARCH))){c.push({TAG:0,_0:{TAG:35,_0:d,_1:0}});return}if(b("bs_caml_obj").caml_equal(b("bs_caml_option").nullable_to_opt(d.client_state),b("bs_caml_option").some(b("MercuryMessageClientState").SEND_TO_SERVER))){c.push({TAG:0,_0:{TAG:35,_0:d,_1:0}});return}f=d.thread_id;var g=d.upload_id,h=d.upload_data,k=d.message_ids;ha(d);if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").DELETE_MESSAGES))if(!(f==null)&&!(k==null)){c.push({TAG:0,_0:{TAG:36,_0:f,_1:k,_2:j}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_FOLDER)){k=d.new_folder;if(!(f==null)&&!(k==null)){c.push({TAG:0,_0:{TAG:37,_0:f,_1:k}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_ARCHIVED_STATUS))if(!(f==null)){c.push({TAG:0,_0:{TAG:39,_0:f,_1:d.archived}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_MUTE_SETTINGS)){k=d.reactions_mute_mode;var l=d.mentions_mute_mode,m=d.mute_until;l=k==null?l==null?m==null?void 0:{TAG:2,_0:m}:m==null?{TAG:1,_0:l===1}:void 0:!(l==null)||!(m==null)?void 0:{TAG:0,_0:k===1};if(!(f==null)&&l!==void 0){c.push({TAG:0,_0:{TAG:38,_0:f,_1:l}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_READ_STATUS)){if(f==null)return;m=a.from_client;c.push({TAG:0,_0:{TAG:41,_0:f,_1:d.mark_as_read,_2:d.timestamp,_3:m==null?!1:m,_4:d.source}});return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_PAGE_FOLLOW_UP_STATUS))if(!(f==null)){c.push({TAG:0,_0:{TAG:40,_0:f,_1:d.is_page_follow_up}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").BLOCK_STATUS_CHANGED)){if(f==null)return;k=d.canViewerReply?null:b("MessengerThreadCannotReplyReason.bs").fromMessageThreadCannotReplyReason(d.reason);c.push({TAG:0,_0:{TAG:13,_0:f,_1:d.canViewerReply,_2:k}});return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").DELETE_THREAD))if(!(f==null)){c.push({TAG:0,_0:{TAG:42,_0:f}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").REACTION_UPDATE)){l=d.messageId;m=d.userId;if(!(l==null)&&!(m==null)){c.push({TAG:0,_0:{TAG:45,_0:l,_1:b("bs_caml_option").nullable_to_opt(d.reaction),_2:m,_3:j}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").MONTAGE_DIRECT_EXPIRE)){k=d.messageId;if(!(k==null)){c.push({TAG:0,_0:{TAG:46,_0:k,_1:j}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").LIVE_LOCATION_UPDATE)){l=d.messageId;m=d.liveLocation;if(!(l==null)&&!(m==null)){c.push({TAG:0,_0:{TAG:47,_0:l,_1:m,_2:j}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").REPLACE_MESSAGE)){c.push({TAG:0,_0:{TAG:48,_0:d,_1:j}});return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CONFIRM_ATTACHMENT_PLACEHOLDER))if(!(g==null)&&!(h==null)){c.push({TAG:0,_0:{TAG:44,_0:g,_1:h}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CANCEL_ATTACHMENT_PLACEHOLDER))if(!(g==null)&&!(h==null)){c.push({TAG:0,_0:{TAG:43,_0:g,_1:h,_2:j}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").SEND_MESSAGE)){c.push({TAG:0,_0:{TAG:50,_0:d,_1:j}});return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").USER_GENERATED_MESSAGE)){c.push({TAG:0,_0:{TAG:51,_0:d,_1:j,_2:a.from_client}});return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").LOG_MESSAGE))if(!b("MessengerMessage.bs").isLocalMessage(d)){c.push({TAG:0,_0:{TAG:52,_0:d,_1:j,_2:a.from_client}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_PINNED_STATUS))if(!(f==null)){c.push({TAG:0,_0:{TAG:55,_0:f,_1:d.is_pinned,_2:d.thread_pin_timestamp}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").PIN_MESSAGE))if(!(f==null)){c.push({TAG:0,_0:{TAG:53,_0:f,_1:d.pin_message_action}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UNPIN_MESSAGE))if(!(f==null)){c.push({TAG:0,_0:{TAG:54,_0:f,_1:d.unpin_message_action}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").REMOVE_MESSAGE)){k=d.thread_id;l=d.messageId;m=d.removed_timestamp;g=d.author;if(!(k==null)&&!(l==null)&&!(m==null)&&!(g==null)){c.push({TAG:0,_0:{TAG:64,_0:k,_1:l,_2:g,_3:m,_4:j}});b("MessengerDesktopNotifications").removeNotification(l);return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UNSUBSCRIBE_STATUS_UPDATE))if(!(f==null)){c.push({TAG:0,_0:{TAG:12,_0:f,_1:d.page_unsubscribe_status}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").BLURRED_IMAGE_STATUS)){h=d.image_message_id;k=d.image_id;g=d.should_show;m=d.blurred_image_uri;if(!(h==null)&&!(k==null)&&!(g==null)&&!(m==null)){c.push({TAG:0,_0:{TAG:69,_0:h,_1:k,_2:g,_3:m,_4:j}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").ADD_PARTICIPANTS))if(!(f==null)){c.push({TAG:0,_0:{TAG:14,_0:f,_1:d.participants}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").CHANGE_FLAG))if(!(f==null)){c.push({TAG:0,_0:{TAG:15,_0:f,_1:d.mark_as_flag}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").MOVE_PENDING_TO_INBOX))if(!(f==null)){c.push({TAG:0,_0:{TAG:16,_0:f}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_CUSTOM_LIKE))if(!(f==null)){c.push({TAG:0,_0:{TAG:17,_0:f,_1:d.custom_like}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").PROMOTE_GROUP_ADMINS)){l=d.promoted_admins;if(!(f==null)&&!(l==null)){c.push({TAG:0,_0:{TAG:18,_0:f,_1:l}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").REMOVE_GROUP_ADMINS)){h=d.removed_admin_ids;if(!(f==null)&&!(h==null)){c.push({TAG:0,_0:{TAG:19,_0:f,_1:h}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").JOINABLE_MODE))if(!(f==null)){c.push({TAG:0,_0:{TAG:20,_0:f,_1:d.joinable_mode}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").APPROVAL_MODE))if(!(f==null)){c.push({TAG:0,_0:{TAG:21,_0:f,_1:d.approval_mode}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").APPROVAL_QUEUE))if(!(f==null)){c.push({TAG:0,_0:{TAG:22,_0:f,_1:d.added_id,_2:d.added_group_id,_3:d.removed_id,_4:d.removed_group_id}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").IS_PIN_PROTECTED))if(!(f==null)){c.push({TAG:0,_0:{TAG:23,_0:f,_1:d.is_pin_protected}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_RTC_CALL_DATA))if(!(f==null)){c.push({TAG:0,_0:{TAG:24,_0:f,_1:d.initiator_fbid,_2:d.call_state,_3:d.server_info_data}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_COMM_STATUS))if(!(f==null)){c.push({TAG:0,_0:{TAG:25,_0:f,_1:d.comm_status}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_COMM_ITEM_OWNER))if(!(f==null)){c.push({TAG:0,_0:{TAG:26,_0:f,_1:d.id,_2:d.name,_3:d.profile_pic_uri}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").EVENT_RSVP_CHANGED))if(!(f==null)){c.push({TAG:0,_0:{TAG:27,_0:f,_1:d.actor_fbid,_2:d.rsvp_status}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_CONNECTIVITY_STATUS)){k=d.thread_connectivity_status;if(!(f==null)&&!(k==null)){c.push({TAG:0,_0:{TAG:65,_0:f,_1:k}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").GROUPS_SYNC_STATUS_CHANGED))if(!(f==null)){c.push({TAG:0,_0:{TAG:28,_0:f,_1:d.groups_sync_action,_2:d.groups_sync_status_string}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").GROUPS_SYNC_METADATA_UPDATE))if(!(f==null)){c.push({TAG:0,_0:{TAG:29,_0:f,_1:d.groups_sync_action,_2:d.fb_group_id,_3:d.emoji_codepoints}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").DESCRIPTION_CHANGED))if(!(f==null)){c.push({TAG:0,_0:{TAG:30,_0:f,_1:d.group_thread_description_string}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_THREAD_THEME))if(!(f==null)){c.push({TAG:0,_0:{TAG:31,_0:f,_1:{solid_color:d.solid_color,header_color:d.header_color,footer_color:d.footer_color,gradient_colors:d.gradient_colors,theme_id:d.theme_id,reactions:d.reactions}}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").UPDATE_JOINABLE_LINK))if(!(f==null)){c.push({TAG:0,_0:{TAG:32,_0:f,_1:d.joinable_link}});return}else return;if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").MUTATE_TAGS)){g=d.tags_to_add;m=g==null?[]:g;l=d.tags_to_delete;h=l==null?[]:l;k=d.messageId;if(!(k==null)){c.push({TAG:0,_0:{TAG:67,_0:k,_1:m,_2:h,_3:j}});return}else return}if(b("bs_caml_obj").caml_equal(e,b("MercuryActionType").ADS_CONVERSION_UPDATE)){g=d.conversion_detection_data;if(!(f==null)&&!(g==null)){c.push({TAG:0,_0:{TAG:68,_0:f,_1:g}});return}else return}if(!b("bs_caml_obj").caml_equal(e,b("MercuryActionType").SUGGESTED_REPLY_UPDATE))return;l=d.suggested_reply_data;if(!(f==null)&&!(l==null)){c.push({TAG:0,_0:{TAG:70,_0:f,_1:l}});return}});b("Utils.bs").isTruthy(a.from_client)&&e.forEach(function(a){var b=a.thread_id;if(!(b==null)){c.push({TAG:0,_0:{TAG:49,_0:b,_1:a.message_id}});return}})}f=a.end_of_history;f==null||c.push({TAG:0,_0:{TAG:60,_0:f,_1:a.payload_source}})}d&&c.unshift({TAG:0,_0:0});return c}function Lb(c,d){var a={contents:[]},e=function(b,c){c=b.orderedMessageLists.get(d);if(!(c==null)){a.contents=E(!0,b,c.messageIDs);return}};$(b("bs_caml_option").some(c),[{TAG:2,_0:{TAG:3,_0:e}}]);return a.contents}function Mb(c,d){var a={contents:d},e=function(b,c){c=b.localIDsMap.get(d);if(!(c==null)){a.contents=c;return}};$(b("bs_caml_option").some(c),[{TAG:2,_0:{TAG:3,_0:e}}]);return a.contents}function Nb(a,c){var d={contents:void 0},e=function(a,b){d.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:e}}]);a=d.contents;if(a!==void 0)return E(!1,a,c);else return[]}function Ob(a,c){var d={contents:void 0},e=function(a,b){d.contents=a};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:e}}]);a=d.contents;if(a!==void 0)return b("bs_caml_option").nullable_to_opt(a.messages.get(c))}function Pb(a,c,d){var e={contents:!1},f=function(a,b){b=a.orderedMessageLists.get(c);if(b==null)return;a=b.messageLoadingState;b=b.messageIDs.length;a?e.contents=!0:e.contents=b>=d};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:f}}]);return e.contents}function Qb(a,c){var d={contents:!1},e=function(a,b){b=a.orderedMessageLists.get(c);if(b==null)return;a=b.messageLoadingState;a?d.contents=!0:d.contents=!1};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:e}}]);return d.contents}function Rb(a,c){return $(b("bs_caml_option").some(a),[{TAG:1,_0:{TAG:2,_0:c}}])}function Sb(a,c,d,e){var f=[],g=function(g,h){h=g.orderedMessageLists.get(c);if(h==null)return;h=h.messageIDs;for(var i=d,j=d+e|0;i<=j;++i){var a=b("bs_belt_Option").flatMap(b("bs_belt_Array").get(h,i),function(a){return D(g,a)});a!==void 0&&f.push(b("bs_caml_option").valFromOption(a))}};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:g}}]);return f}var Tb={contents:void 0};function Ub(a,c,d,e,f,g,h){var i=function(j,i){Tb.contents=[c,d,e];var k=j.orderedMessageLists.get(c);k=k==null?[[],void 0]:[k.messageIDs,k.messageLoadingState];var l=k[0];if(b("bs_js_dict").get(i.failedHistoryFetchThreads.contents,c)!==!0){var m=i.localTitanMessageCount;m=l.length-b("bs_belt_Option").getWithDefault(b("bs_caml_option").nullable_to_opt(m.get(c)),0)|0;m>0&&b("ChatReliabilityInstrumentation").logERROR("fetch made with message in flight");var n=m-d|0;n=e-n|0;if(!(n>0&&b("bs_caml_obj").caml_notequal(k[1],1)))return b("bs_curry")._1(f,b("bs_belt_Array").keepMap(l,function(a){return D(j,a)}).slice(d,e));k=b("MercuryServerRequests").getForFBID(a);l=b("bs_js_null_undefined").fromOption(b("bs_belt_Option").map(b("bs_belt_Option").flatMap(b("bs_belt_Array").get(l,m-1|0),function(a){return D(j,a)}),function(a){return a.timestamp}));var o=i.messageSubToken.contents;i.messageSubToken.contents=o+1|0;i.messageCallbacks.contents[String(o)]=[{threadID:c,offset:d,limit:e},f];if(b("bs_caml_obj").caml_equal([c,d,e],Tb.contents)){k.fetchThreadMessages(c,m,n,l,g,h);return}else return}Tb.contents=void 0;i.failedHistoryFetchThreads.contents[c]=!1};return $(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:i}}])}function Vb(a,b,c,d,e,f,g){if(!Qb(a,b))return Ub(a,b,c,d,e,f,g)}function Wb(a){var c={contents:0},d=function(d,a){c.contents=b("bs_caml_primitive").caml_int_min(N(d,a),b("MercuryThreadlistConstants").MAX_UNSEEN_COUNT)};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:d}}]);return c.contents}function Xb(a){var c={contents:0},d=function(b,a){c.contents=N(b,a)};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:d}}]);return c.contents}function Yb(a){var c={contents:0},d=function(d,a){c.contents=b("bs_caml_primitive").caml_int_min(nb(d,a,!0),b("MercuryThreadlistConstants").MAX_UNSEEN_COUNT)};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:d}}]);return c.contents}function Zb(a){return $(b("bs_caml_option").some(a),[{TAG:1,_0:1}])}function $b(a,c){var d={contents:null},e=function(a,e){e=b("bs_js_dict").get(a.unreadCounts,c);d.contents=e!==void 0?b("bs_belt_Array").keepMap(b("JSSet.bs").values(b("bs_caml_option").valFromOption(e)),function(c){return b("bs_caml_option").nullable_to_opt(l(a,c))}).filter(function(a){return!b("MercuryThreadInfo").isMuted(a)}).length:null};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:e}}]);return d.contents}function ac(a){var c={contents:[]},d=function(a,d){c.contents=b("bs_belt_Map").keysToArray(a.threads)};$(b("bs_caml_option").some(a),[{TAG:2,_0:{TAG:3,_0:d}}]);return c.contents}R={make:tb};S=tb;f.irisMapping=j;f.fbid=c;f.deliveryReceipts=d;f.readReceiptsPerThread=e;f.ignoredIds=m;f.blockedIds=n;f.pendingFolderUnseenCount=o;f.typing=aa;f.pendingReadStatusThreads=p;f.messages=q;f.localIDsMap=r;f.messagesWithUploadsInFlight=s;f.threadlistOrderMap=ba;f.pinnedThreads=ca;f.montage=t;f.orderedMessageLists=da;f.unreadCounts=ea;f.initialUnreadCounts=fa;f.unseenTimestamp=ga;f.threads=a;f.thread=l;f.send=$;f.compute=vb;f.getThreadMetaNow=wb;f.getMultiThreadMeta=xb;f.getThreadMeta=yb;f.createNewLocalThread=zb;f.createNewLocalThreadGenerateID=Ab;f.createNewLocalGroupGeneralThreadGenerateID=Cb;f.isEmptyLocalThread=Db;f.isNewEmptyLocalThread=Eb;f.getPinnedThreadlist=Fb;f.unsubscribeThread=Gb;f.sendJS=Jb;f.invalidateSearchedMessages=Rb;f.hasLoadedNMessages=Pb;f.hasLoadedAllMessages=Qb;f.getCurrentlyLoadedMessages=Lb;f.getServerMessageID=Mb;f.getMessagesFromIDs=Nb;f.getMessageFromID=Ob;f.getThreadMessagesRange=Ub;f.getThreadMessagesRangeNow=Sb;f.fetchMoreMessages=Vb;f.processPollStickerVoted=Ib;f.getUnseenUnreadCount=Wb;f.getUnseenUnreadCountRaw=Xb;f.getUnseenCount=Yb;f.getThreadIDs_debug=ac;f.getUnreadThreadCount=$b;f.markAsSeen=Zb;f.processJSActions=Kb;f.Provider=R;f.jsComponent=S;f.useHook=ub}),null);
__d("MessengerState.re",["bs_curry","MessengerState.bs"],(function(a,b,c,d,e,f){c=(a=b("MessengerState.bs")).fbid;f.fbid=c;d=a.deliveryReceipts;f.deliveryReceipts=d;e=a.readReceiptsPerThread;f.readReceiptsPerThread=e;c=a.ignoredIds;f.ignoredIds=c;d=a.blockedIds;f.blockedIds=d;e=a.pendingFolderUnseenCount;f.pendingFolderUnseenCount=e;c=a.typing;f.typing=c;d=a.pendingReadStatusThreads;f.pendingReadStatusThreads=d;e=a.messages;f.messages=e;c=a.localIDsMap;f.localIDsMap=c;d=a.messagesWithUploadsInFlight;f.messagesWithUploadsInFlight=d;e=a.threadlistOrderMap;f.threadlistOrderMap=e;c=a.pinnedThreads;f.pinnedThreads=c;d=a.montage;f.montage=d;e=a.orderedMessageLists;f.orderedMessageLists=e;c=a.unreadCounts;f.unreadCounts=c;d=a.initialUnreadCounts;f.initialUnreadCounts=d;e=a.unseenTimestamp;f.unseenTimestamp=e;c=a.threads;f.threads=c;d=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").thread,a,c);return a};f.thread=d;e=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").compute,a,c);return a};f.compute=e;c=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getThreadMetaNow,a,c);return a};f.getThreadMetaNow=c;d=function(a,c,d,e){a=b("bs_curry")._4(b("MessengerState.bs").getMultiThreadMeta,a,c,d,e);return a};f.getMultiThreadMeta=d;e=function(a,c,d,e){a=b("bs_curry")._4(b("MessengerState.bs").getThreadMeta,a,c,d,e);return a};f.getThreadMeta=e;c=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").isEmptyLocalThread,a,c);return a};f.isEmptyLocalThread=c;d=a.getPinnedThreadlist;f.getPinnedThreadlist=d;e=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").unsubscribeThread,a,c);return a};f.unsubscribeThread=e;c=function(a,c,d){a=b("bs_curry")._3(b("MessengerState.bs").hasLoadedNMessages,a,c,d);return a};f.hasLoadedNMessages=c;d=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getCurrentlyLoadedMessages,a,c);return a};f.getCurrentlyLoadedMessages=d;e=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getServerMessageID,a,c);return a};f.getServerMessageID=e;c=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getMessagesFromIDs,a,c);return a};f.getMessagesFromIDs=c;d=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getMessageFromID,a,c);return a};f.getMessageFromID=d;e=function(a,c,d,e,f,g,h){a=b("bs_curry")._7(b("MessengerState.bs").getThreadMessagesRange,a,c,d,e,f,g,h);return a};f.getThreadMessagesRange=e;c=function(a,c,d,e){a=b("bs_curry")._4(b("MessengerState.bs").getThreadMessagesRangeNow,a,c,d,e);return a};f.getThreadMessagesRangeNow=c;d=function(a,c,d,e,f,g,h){a=b("bs_curry")._7(b("MessengerState.bs").fetchMoreMessages,a,c,d,e,f,g,h);return a};f.fetchMoreMessages=d;e=a.getUnseenUnreadCount;f.getUnseenUnreadCount=e;c=a.getUnseenCount;f.getUnseenCount=c;d=a.getThreadIDs_debug;f.getThreadIDs_debug=d;e=function(a,c){a=b("bs_curry")._2(b("MessengerState.bs").getUnreadThreadCount,a,c);return a};f.getUnreadThreadCount=e;(function(a){return null});c=a.jsComponent;f.jsComponent=c;d=a.useHook;f.useHook=d}),null);
__d("MercuryDelayedDispatcher",["MercuryDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequests","MercurySingletonProvider","MercuryThreadIDMap"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){var c=this;this.$1=a;this.$2=[];this.$3=b("MercuryThreadIDMap").getForFBID(this.$1);this.$4=b("MercuryDispatcher").getForFBID(this.$1);this.$5=b("MercuryServerRequests").getForFBID(this.$1);this.$6=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1);this.$4.subscribe("model-update-completed",function(a,b){return c.$7()})}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.handleUpdateWaitForThread=function(a,b){var c=this,d=this.$3.getClientIDFromServerIDNow(b);if(d){this.$8(a);return}this.$3.getClientIDFromServerID(b,function(){return c.$2.push({thread_fbid:b,payload:a})});this.$5.ensureThreadIsFetched(b)};c.$7=function(){if(this.$2&&this.$2.length){var a=this.$2.shift(),b=a.thread_fbid;a=a.payload;this.handleUpdateWaitForThread(a,b)}};c.$8=function(a){a.from_client?this.$4.handleUpdate(a):this.$6.handleUpdate(a)};return a}();e.exports=a;var g=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercuryDispatcher",["invariant","ArbiterMixin","LogHistory","MercuryMessagingLightswitch","MercurySingletonProvider","MercuryThreadInformer","MessengerParticipants.bs","MessengerState.bs","gkx","isEmpty","mixin"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("LogHistory").getInstance("mercury_dispatcher");a=function(a){babelHelpers.inheritsLoose(c,a);c.getForFBID=function(a){return j.getForFBID(a)};c.get=function(){return j.get()};function c(b){var c;c=a.call(this)||this;c.$MercuryDispatcher1=b;return c}var d=c.prototype;d.handlePreprocessedUpdate=function(a){a.preprocessed=!0,this.handleUpdate(a)};d.handleUpdate=function(a){var c=this;this.$MercuryDispatcher2(a);!!a.from_client!==!!a.preprocessed||g(0,5757);delete a.preprocessed;(h||(h=b("isEmpty")))(a)||b("MercuryThreadInformer").getForFBID(this.$MercuryDispatcher1).synchronizeInforms(function(){a.payload_source==="server_invalidate_global_state"&&(c.inform("invalidate-global-state",{}),b("MessengerParticipants.bs").reset());if(a.payload_source==="server_invalidate_thread_state"){var d=a.threads&&a.threads.length>0&&a.threads[0]&&a.threads[0].thread_id;d&&c.inform("invalidate-thread-state",d)}a.threads&&Array.isArray(a.threads)&&a.threads.length>0&&b("gkx")("1443200")&&b("MessengerParticipants.bs").addPreloadedParticipants(a.threads[0]);b("MessengerParticipants.bs").addParticipants(a);b("MessengerState.bs").sendJS(c.$MercuryDispatcher1,b("MessengerState.bs").processJSActions(a));c.inform("update-threadlist",a);c.inform("update-messages",a);c.inform("model-update-completed",null)})};d.$MercuryDispatcher2=function(a){var c=a.payload_source;if(c==="client_change_read_status"||c==="client_mark_thread_seen")return;var d={from_client:a.from_client,messages:null};if(a.actions){a=a.actions.filter(function(a){return a.action_type==="ma-type:user-generated-message"||a.action_type==="ma-type:log-message"}).map(function(a){return{action_type:a.action_type,other_user_fbid:a.other_user_fbid,thread_fbid:a.thread_fbid,message_id:a.message_id}});a.length&&(d.messages=a)}b("MercuryMessagingLightswitch").guard(function(){i.debug("update:"+c,JSON.stringify(d))})};return c}(b("mixin")(b("ArbiterMixin")));e.exports=a;var j=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercurySendErrorLogger",["Banzai","BanzaiLogger","MercuryMessagingLightswitch"],(function(a,b,c,d,e,f){var g=b("BanzaiLogger").create({retry:!0}),h=b("Banzai").isEnabled("mercury_send_error_logging");a={log:function(a){if(!h)return;b("MercuryMessagingLightswitch").guard(function(){var b={message_id:a.message_id,timestamp_client:Date.now(),error_type:a.error_data.type,error_code:a.error_data.code,error_description:a.error_data.description,is_transient:a.error_data.is_transient};g.log("MercurySendErrorLoggerConfig",b)})}};c=a;e.exports=c}),null);
__d("MercuryServerPayloadPreprocessor",["invariant","ChatReliabilityInstrumentation","LogHistory","MercuryAttachment","MercuryDispatcher","MercuryIDs","MercuryMessagingLightswitch","MercurySendErrorLogger","MercurySingletonProvider","MercuryThreadIDMap","MessengerEnvironment","MessengerState.re","URI","gkx"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){this.$4=b("LogHistory").getInstance("MercuryServerPayloadPreprocessor"),this.$1=a,this.$2=b("MercuryThreadIDMap").getForFBID(this.$1),this.$3=b("MercuryDispatcher").getForFBID(this.$1)}a.getForFBID=function(a){return i.getForFBID(a)};a.get=function(){return i.get()};var c=a.prototype;c.handleUpdate=function(a){var c=this,e={};a.from_client&&g(0,2150);(a.threads||[]).forEach(function(a){c.$5(a,e);var b=c.$2.getServerIDFromClientIDNow(a.thread_id);d(["MercuryServerRequests"],function(d){d=d.getForFBID(c.$1);d.markThreadFetched(a.thread_id);b&&d.markThreadFetched(b);d.updateLastActionTimestamp(a.timestamp)})});a.pinned_thread_ids=(a.pinned_thread_ids||[]).map(function(a){return c.$2.getClientIDFromServerIDNow(a)});(a.ordered_threadlists||[]).forEach(function(a){var b=a.thread_fbids||[];b=b.concat(a.other_user_fbids||[]);a.thread_ids=b.map(function(a){return c.$2.getClientIDFromServerIDNow(a.toString())})});if(a.delivery_receipts){var f={};for(var h=a.delivery_receipts,i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k;if(i){if(j>=h.length)break;k=h[j++]}else{j=h.next();if(j.done)break;k=j.value}k=k;var l=k.other_user_fbid?b("MercuryIDs").getThreadIDFromUserID(k.other_user_fbid):this.$2.getClientIDFromServerIDNow(k.thread_fbid);l&&(f[l]=k.time)}a.delivery_receipts=f}a.actions=a.actions||[];a.actions.forEach(function(f){f.action_type==="ma-type:send-message"&&f.status===10&&b("MercuryMessagingLightswitch").guard(function(){b("MercurySendErrorLogger").log(f)});var h=null,i=null;f.other_user_fbid?(i=b("MercuryIDs").getThreadIDFromUserID(f.other_user_fbid),h=f.other_user_fbid):f.thread_fbid?(i=b("MercuryIDs").getThreadIDFromThreadFBID(f.thread_fbid),h=f.thread_fbid):f.thread_id?(i=b("MercuryIDs").getThreadIDFromThreadFBID(f.thread_id),h=f.thread_id):f.status&&f.status!=1&&f.client_thread_id?i=f.client_thread_id:g(0,2151,f.action_type,f.status);h=h&&h.toString();f.thread_id=c.$2.hasClientIDForServerID(h)?c.$2.getClientIDFromServerIDNow(h):i;f.action_type=="ma-type:send-message"&&f.client_thread_id&&h&&(f.thread_id=f.client_thread_id,c.$6("forceSetServerIDToClientID",h,f.client_thread_id)&&b("ChatReliabilityInstrumentation").logSET_THREAD_ID_MAP(h+":"+f.client_thread_id),c.$2.forceSetServerIDToClientID(h,f.client_thread_id),e[h]=f.client_thread_id);f.thread_id||g(0,2152,f.action_type);(!a.payload_source||!a.payload_source.startsWith("server"))&&d(["MercuryServerRequests"],function(a){a.getForFBID(c.$1).updateLastActionTimestamp(f.timestamp)})});this.$7(a);this.$8(a);if(a.end_of_history){l=[];for(var k=0;k<a.end_of_history.length;k++){j=a.end_of_history[k];j.type=="user"?l.push("user:"+j.fbid):j.type=="thread"&&this.$2.hasClientIDForServerID(j.fbid)&&l.push(this.$2.getClientIDFromServerIDNow(j.fbid))}a.end_of_history=l}if(a.roger){var m={};Object.keys(a.roger).forEach(function(d){var e=Object.keys(a.roger[d]),f;d?f=c.$2.getClientIDFromServerIDNow(d):e.length===1&&(f=b("MercuryIDs").getThreadIDFromUserID(e[0]));if(f){e=a.roger[d];m[f]={};for(var g in e)if(Object.prototype.hasOwnProperty.call(e,g)){d=b("MercuryIDs").getParticipantIDFromUserID(g);m[f][d]=e[g]}}});a.roger=m}a.newlyAddedClientIDs=e;a.preprocessed=!0;this.$3.handleUpdate(a)};c.$6=function(a,c,d){var e=this;if(!b("gkx")("1199097"))return;var f=b("MessengerState.re").getThreadMetaNow(this.$1,d);if(f==null){b("MercuryMessagingLightswitch").guard(function(){e.$4.debug(a,c+":"+d)});return!0}return!1};c.$5=function(a,c){var d=a.other_user_fbid?a.other_user_fbid:a.thread_fbid;d||g(0,2153);var e=this.$2.getClientIDFromServerIDNow(d);e||(e=a.other_user_fbid?b("MercuryIDs").getThreadIDFromUserID(a.other_user_fbid):b("MercuryIDs").getThreadIDFromThreadFBID(a.thread_fbid),this.$6("setServerIDToClientID",d,e),this.$2.setServerIDToClientID(d,e),this.$2.setDeprecatedServerIDToClientID(a.thread_id,e),c[d]=e);a.thread_id=e};c.$7=function(a){a.actions.forEach(function(a){a.action_type==="ma-type:user-generated-message"&&(a.attachments=a.attachments||[],a.attachments.forEach(function(a){if(b("MercuryAttachment").isShareAttachment(a)&&a.share&&b("MessengerEnvironment").messengerui){var c=new(h||(h=b("URI")))(a.share.uri);c.getDomain()||(a.share.uri=c.setDomain("facebook.com").setSubdomain((h||(h=b("URI"))).getRequestURI().getSubdomain()).setProtocol("https").toString())}}))})};c.$8=function(a){a.actions.forEach(function(a){if(a.action_type!=="ma-type:user-generated-message")return;a=a;if(!a.has_attachment||!a.attachments)return;for(var c=a.attachments.length-1;c>=0;c-=1){var d=a.attachments[c];if(!d.share||!d.share.style_list||d.share.style_list[0]!="genie_message")continue;d.share.target.genie_id&&(a.author=b("MercuryIDs").getParticipantIDFromUserID(d.share.target.genie_id));d.share.target&&!d.share.target.attachment&&(a.attachments.splice(c,1),a.has_attachment=a.attachments.length>0)}})};return a}();e.exports=a;var i=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercuryServerSendMessageQueueOptions",[],(function(a,b,c,d,e,f){a=function(a,b,c,d,e,f){this.success_handler=a,this.error_handler=b,this.transport_error_handler=c,this.timeout_handler=d,this.timeout=e,this.connection_retries=f};e.exports=a}),null);
__d("XMercuryUnseenThreadIDsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/mercury/unseen_thread_ids/",{})}),null);
__d("XMessagingChangeMentionsMuteModeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/mercury/change_mentions_mute_thread/",{})}),null);
__d("XMessagingChangeReactionsMuteModeController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/ajax/mercury/change_reactions_mute_thread/",{})}),null);
__d("MercuryServerRequests",["errorCode","invariant","Promise","Arbiter","AsyncResponse","AvailableListConstants","Bootloader","ChannelConstants","ChatReliabilityInstrumentation","CurrentUser","Env","LogHistory","MercuryAPIArgsSource","MercuryAssert","MercuryDispatcher","MercuryIDs","MercuryMessageClientState","MercuryMessageIDs.bs","MercuryMessagingLightswitch","MercurySendErrorLogger","MercuryServerDispatcher","MercuryServerPayloadPreprocessor","MercuryServerRequestsConfig","MercuryServerSendMessageQueueOptions","MercuryServerSendMessageQueueRouter","MercuryServerURIs","MercurySingletonProvider","MercurySyncDeltaHolder","MercuryTagHelper","MercuryThreadIDMap","MessagingConfig","MessagingTag","MessengerEnvironment","MessengerWebStgTypedLoggerLite","ODS","PresenceStatus","ScriptPath","XMercuryUnseenThreadIDsController","XMessagingChangeMentionsMuteModeController","XMessagingChangeReactionsMuteModeController","createObjectFrom","promiseDone","setTimeoutAcrossTransitions","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";var i,j=b("MessengerWebStgTypedLoggerLite").log,k=b("LogHistory").getInstance("mercury_server"),l=b("MercuryAPIArgsSource").MERCURY,m=30*1e3;function n(a){return a.getError()?"_"+a.getError():""}function o(a,c){var d=babelHelpers["extends"]({},a),e;if(c.threads){d.threads||(d.threads={});for(e in c.threads)d.threads[e]=Object.keys(b("createObjectFrom")((d.threads[e]||[]).concat(c.threads[e]||[])))}if(c.messages){d.messages||(d.messages={});for(e in c.messages){d.messages[e]||(d.messages[e]={});for(var f in c.messages[e])d.messages[e][f]?d.messages[e][f]=s(d.messages[e][f],c.messages[e][f]):d.messages[e][f]=c.messages[e][f]}}d.client=a.client||c.client;return d}function p(a,c){var d=Object.assign(b("createObjectFrom")(a.folders,!0),b("createObjectFrom")(c.folders,!0));a=a.client||c.client;return{folders:Object.keys(d),client:a}}function q(a,b){for(var c in b)if(a[c]&&typeof a[c]==="object")a[c]=s(a[c],b[c]);else if(b[c]&&typeof b[c]==="object"){var d={};Object.assign(d,b[c]);a[c]=d}return a}function r(a,b){return b}function s(a,b){var c=Math.max(a.limit,b.limit),d;!a.timestamp?d=b.timestamp:!b.timestamp?d=a.timestamp:d=Math.min(a.timestamp,b.timestamp);return{limit:c,timestamp:d}}function t(a,b){var c=a.client||b.client;c={ids:{},client:c};Object.assign(c.ids,a.ids,b.ids);return c}function u(a,c){var d={},e,f=a.client||c.client;delete a.client;delete c.client;for(e in a)Object.assign(d,b("createObjectFrom")(a[e],e));for(e in c)Object.assign(d,b("createObjectFrom")(c[e],e));a={client:f};for(var g in d)e=d[g],a[e]||(a[e]=[]),a[e].push(g);return a}function v(a,c){var d=a.client||c.client;a=b("createObjectFrom")(a.ids,!0);c=b("createObjectFrom")(c.ids,!0);a=Object.assign(a,c);return{ids:Object.keys(a),client:d}}a=function(){function a(a){var c=this;this.$1=a;this.$2=0;this.$3={};this.$4={};this.__threadIDMap=b("MercuryThreadIDMap").getForFBID(this.$1);this.$5=b("MercuryDispatcher").getForFBID(this.$1);this.$6=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1);this.$7=new(b("MercuryServerSendMessageQueueOptions"))(function(a,b){c.__handleUpdate(a,b)},function(a){return c.$9(a)},function(a){c.$10(a)},function(a){return c.$11(a)},b("MercuryServerRequestsConfig").sendMessageTimeout,b("MessagingConfig").SEND_CONNECTION_RETRIES);this.$8=b("MercurySyncDeltaHolder").getForFBID(this.$1);this.$12()}a.getForFBID=function(a){return w.getForFBID(a)};a.get=function(){return w.get()};var c=a.prototype;c.fetchThreadlistInfo=function(a,c,d,e,f,g){d===void 0&&(d=b("MessagingTag").INBOX);f===void 0&&(f=l);var h=e?b("MercuryServerDispatcher").IMMEDIATE:null;f={client:f};f[d]={offset:a,limit:c,filter:e,before:g};this.__sendRequest(b("MercuryServerURIs").THREADLIST_INFO,f,h)};c.fetchUnseenThreadIDs=function(a,c){a===void 0&&b("MessagingTag").INBOX,c===void 0&&(c=l),this.__sendRequest(b("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString(),{})};c.fetchUnreadThreadIDs=function(a,c){c===void 0&&(c=l),this.__sendRequest(b("MercuryServerURIs").UNREAD_THREADS,{folders:[a],client:c})};c.fetchThreadData=function(a,c){var d=this;c===void 0&&(c=l);b("MercuryAssert").allThreadID(a);var e={threads:{},client:c},f=[],g=[];a.forEach(function(a){if(d.$3[a])return;d.$3[a]=!0;var c=d.__threadIDMap.getServerIDFromClientIDNow(a);a=b("MercuryIDs").tokenize(a);if(a.type=="user")f.push(a.value),e.threads.user_ids=f;else if(a.type=="thread")c?g.push(c):g.push(a.value),e.threads.thread_fbids=g;else if(a.type=="root")c&&(g.push(c),e.threads.thread_fbids=g);else if(a.type!="pending")throw new Error("Unknown thread type",a)});e.threads.user_ids&&e.threads.user_ids.forEach(function(a){a||(b("MercuryMessagingLightswitch").guard(function(){k.error("empty user id",JSON.stringify(f))}),b("ChatReliabilityInstrumentation").logERROR("Invalid user ID sent to thread_info.php: "+JSON.stringify(f)))});e.threads.thread_fbids&&e.threads.thread_fbids.forEach(function(c){c||b("ChatReliabilityInstrumentation").logERROR("Invalid FBID sent to thread_info.php: "+JSON.stringify(a))});for(var h in e.threads){this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,e);break}};c.ensureThreadIsFetched=function(a,c){c===void 0&&(c=l);if(!this.__threadIDMap.getClientIDFromServerIDNow(a)&&!this.$3[a]){if(!a){b("ChatReliabilityInstrumentation").logERROR("Ensure invalid FBID sent to thread_info.php");k.error("attempting to fetch empty thread_fbid. Bad idea!");return}this.$3[a]=!0;this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,{threads:{thread_fbids:[a]},client:c})}};c.fetchThreadMessages=function(a,c,d,e,f,g){var h=this;g===void 0&&(g=l);b("MercuryAssert").isThreadID(a);var i;c=b("MercuryIDs").tokenize(a);var j=this.__threadIDMap.getServerIDFromClientIDNow(a),k=!1;if(j)j=j,i=c.type=="user"?"user_ids":"thread_fbids";else{j=c.value;switch(c.type){case"user":i="user_ids";k=!0;break;case"thread":i="thread_fbids";break}}var m={messages:{},threads:{},client:g};i?(m.messages[i]={},m.messages[i][j]={timestamp:e,limit:d},k&&(m.threads[i]=[j]),this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,m,f)):this.__threadIDMap.getServerIDFromClientID(a,function(a){m.messages.thread_fbids={},m.messages.thread_fbids[a]={timestamp:e,limit:d},h.__sendRequest(b("MercuryServerURIs").THREAD_INFO,m,f)})};c.handleThreadInfoError=function(a,c){var d=a.getData();c=[];if(d.messages&&!b("gkx")("1738138")){for(var e in d.messages.thread_fbids){a=this.__threadIDMap.getClientIDFromServerIDNow(e);a&&c.push(this.$13(a))}for(var f in d.messages.user_ids)c.push(this.$13("user:"+f));for(var g in d.messages.group_ids)c.push(this.$13("group:"+g))}c.length&&this.$5.handleUpdate({actions:c,from_client:!0,payload_source:"client_channel_message"});if(d.threads&&(d.threads.user_ids||d.threads.thread_fbids||d.threads.group_ids||d.threads.thread_ids)){a=5;c=!0;d.retry_count||(d.retry_count=0,d.messages&&delete d.messages);if(c){c=Math.pow(2,Math.min(d.retry_count,a))*1e3;b("setTimeoutAcrossTransitions")(function(){k.log("retry_thread","{}"),this.__sendRequest(b("MercuryServerURIs").THREAD_INFO,d)}.bind(this),c);d.retry_count++}}};c.markFolderAsRead=function(a){this.__sendRequest(b("MercuryServerURIs").MARK_FOLDER_READ,{folder:a});a=[{action_type:"mga-type:mark-all-read",folder:a}];this.$5.handleUpdate({global_actions:a,from_client:!0,payload_source:"client_change_read_status"})};c.changeThreadReadStatus=function(a,c,d,e,f,g){var h=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(i){var j;j={ids:(j={},j[i]=c,j),source:d,watermarkTimestamp:e,shouldSendReadReceipt:f,commerce_last_message_type:g};b("MercuryMessagingLightswitch").guard(function(){k.log("initiate_change_read_status",JSON.stringify({thread_id:a,thread_fbid:i,mark_as_read:c,watermarkTimestamp:e}))});h.__sendRequest(b("MercuryServerURIs").CHANGE_READ_STATUS,j)})};c.changeThreadArchivedStatus=function(a,c,d){var e=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){var f={ids:{},source:d};f.ids[a]=c;e.__sendRequest(b("MercuryServerURIs").CHANGE_ARCHIVED_STATUS,f)})};c.changeThreadPinnedStatus=function(a,c,d){var e=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){var f={ids:{},source:d};f.ids[a]=c;e.__sendRequest(b("MercuryServerURIs").CHANGE_PINNED_STATUS,f)})};c.changeThreadPageFollowUpStatus=function(a,c,d){var e=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){var f={ids:{},source:d};f.ids[a]=c;e.__sendRequest(b("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS,f)})};c.changeThreadFolder=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){var e={};e[c]=[a];d.__sendRequest(b("MercuryServerURIs").MOVE_THREAD,e)})};c.changeMutingOnThread=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){d.__sendRequest(b("MercuryServerURIs").CHANGE_MUTE_THREAD,{thread_fbid:a,mute_settings:c,payload_source:l})})};c.changeMentionsMutingOnThread=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){d.__sendRequest(b("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:a,mentions_mute_mode:c,payload_source:l})})};c.changeReactionsMutingOnThread=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){d.__sendRequest(b("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI(),{thread_fbid:a,reactions_mute_mode:c,payload_source:l})})};c.markThreadSpam=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){d.__sendRequest(b("MercuryServerURIs").MARK_SPAM,{id:a,source:c})})};c.unmarkThreadSpam=function(a,c){var d=this;b("MercuryAssert").isThreadID(a);this.__threadIDMap.getServerIDFromClientID(a,function(a){d.__sendRequest(b("MercuryServerURIs").UNMARK_SPAM,{id:a,source:c})})};c.deleteThread=function(a,b){this.deleteThreads([a],b)};c.deleteThreads=function(a,c){var d=this;b("promiseDone")(b("Promise").all(a.map(function(a){b("MercuryAssert").isThreadID(a);return new(b("Promise"))(function(b){return d.__threadIDMap.getServerIDFromClientID(a,b)})})).then(function(a){d.__sendRequest(b("MercuryServerURIs").DELETE_THREAD,{ids:a,source:c})}))};c.deleteMessages=function(a,c){b("MercuryMessageIDs.bs").getServerIDs(c||[],function(a){this.__sendRequest(b("MercuryServerURIs").DELETE_MESSAGES,{message_ids:a})}.bind(this))};c.sendDeliveryReceipts=function(a,c){b("MercuryMessageIDs.bs").getServerIDs(a||[],function(a){this.__sendRequest(b("MercuryServerURIs").DELIVERY_RECEIPTS,{message_ids:a,thread_ids:c})}.bind(this))};c.sendNewMessage=function(a,c){var d=this;c===void 0&&(c=l);a.offline_threading_id||b("ODS").bumpEntityKey(3303,"chat.web","missing_otid_on_send");if(a.client_state&&a.client_state!==b("MercuryMessageClientState").SEND_TO_SERVER)return;var e=b("MercuryIDs").tokenize(a.thread_id),f=e.type,g=babelHelpers["extends"]({},a);g.thread_id=null;f=="user"?(g.other_user_fbid=e.value,this.$14(g,c)):f=="thread"?(g.thread_fbid=e.value,this.$14(g,c)):f=="root"&&e.value==g.offline_threading_id?(g.client_thread_id=a.thread_id,this.$14(g,c)):(b("MercuryIDs").isLocalThread(a.thread_id)||h(0,5587,a.thread_id),this.__threadIDMap.getServerIDFromClientID(a.thread_id,function(a){g.thread_fbid=a,d.$14(g,c)}));this.$15("send_msg",a);b("MercuryMessagingLightswitch").guard(function(){b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerStart(c.SEND_MESSAGE,a.offline_threading_id)},"MercuryServerRequests")})};c.$15=function(a,c){try{var d=(i||(i=b("Env"))).isCQuick?"Comet Inbox":b("MessengerEnvironment").messengerdotcom?"messenger_dot_com":b("MessengerEnvironment").facebookdotcom?"Facebook Messenger (other)":"Other",e=b("MercuryTagHelper").get(c.tags||[],"entrypoint"),f=b("MercuryIDs").getThreadFBIDFromThreadID(c.thread_id),g=b("PresenceStatus").get(f)===b("AvailableListConstants").ACTIVE;j({attachment_infos:void 0,client_timestamp:Date.now(),entry_point:e,event_name:a,first_attachment_type:void 0,"interface":d,mid:c.message_id,offline_threading_id:c.offline_threading_id,other_user_fbid:b("MercuryIDs").isGroupChat(c.thread_id)?void 0:f,thread_fbid:b("MercuryIDs").isGroupChat(c.thread_id)?f:void 0,extra_data:{pathName:b("ScriptPath").getScriptPath(),isActiveNow:g}})}catch(a){b("ODS").bumpEntityKey(3303,"chat.web","logging_error")}};c.$14=function(a,c){b("Arbiter").inform(b("ChannelConstants").ATTEMPT_RECONNECT),this.$4[a.message_id]=Date.now(),b("MercuryServerSendMessageQueueRouter").getForFBID(this.$1).enqueue(a.other_user_fbid||a.thread_fbid||a.client_thread_id,this.$7,c,a)};c.__getSendMessageQueueOptions=function(){return this.$7};c.markSeen=function(){var a=this.$2;this.__sendRequest(b("MercuryServerURIs").MARK_SEEN,{seen_timestamp:a})};c.$16=function(a,c,d,e){a=a.getData();var f=a.message_batch||[a];b("MercuryMessagingLightswitch").guard(function(){k.debug("handle_send_message_error_common",JSON.stringify({reliability_error_status:d,request_error_status:c,error_data:e,message_list:f}))});b("ChatReliabilityInstrumentation").logERROR("send_message_fail");var g=f.map(function(a){a={action_type:"ma-type:send-message",other_user_fbid:a.other_user_fbid,thread_fbid:a.thread_fbid,client_message_id:a.message_id,message_id:a.message_id,client_thread_id:a.client_thread_id,status:c,error_data:e};return a});g.forEach(function(a){a.action_type==="ma-type:send-message"&&a.status===10&&this.__logMercurySendError(a)},this);a={actions:g,payload_source:"client_handle_error"};b("MercuryMessagingLightswitch").guard(function(){b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(a,b){g.map(function(c){a.markerEnd(b.SEND_MESSAGE,"FAIL",c.client_message_id)})},"MercuryServerRequests")});this.$6.handleUpdate(a)};c.handleSendMessageError=function(a){var c=a.getPayload(),d=null,e=null;c&&c.error_payload?(d=3,e="send_error"):(d=10,e="request_error"+n(a));c=a.error;c===1404102?b("AsyncResponse").verboseErrorHandler(a):(c===1545052||c===1409009||c===1409008||c===1409007||c===1409006||c===1545083||c===1545084)&&b("AsyncResponse").defaultErrorHandler(a);c=/<.*>/.test(a.getErrorDescription())?a.getErrorSummary():a.getErrorDescription();this.$16(a.getRequest(),d,e,{type:1,code:a.getError(),description:c,is_transient:a.isTransient()})};c.handleSendMessageTransportError=function(a){this.$16(a.getRequest(),10,"transport_error"+n(a),{type:2,code:a.getError(),is_transient:!0})};c.handleSendMessageTimeout=function(a){this.$16(a,10,"transport_timeout",{type:3,is_transient:!0})};c.getLastActionTimestamp=function(){return this.$2};c.__logMercurySendError=function(a){b("MercurySendErrorLogger").log(a)};c.updateLastActionTimestamp=function(a){var b=Date.now()-1e3*60*60*24;a&&a>b&&(this.$2=Math.max(this.$2,a))};c.markThreadFetched=function(a){delete this.$3[a]};c.$13=function(a){return{action_type:"ma-type:log-message",thread_id:a,message_id:a,timestamp:Date.now(),is_unread:!1,source:"source:unknown",log_message_body:"",log_message_type:"log:error-msg",log_message_data:{}}};c.__getForAsyncRequest=function(c){c=c.getData();c=c.request_user_id?c.request_user_id:b("CurrentUser").getID();return a.getForFBID(c)};c.__handleUpdate=function(a,c){a.payload_source==="server_send_message"&&b("MercuryMessagingLightswitch").guard(function(){b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){var d=a.actions&&a.actions[0]&&a.actions[0].client_message_id;d&&b.markerEnd(c.SEND_MESSAGE,"SUCCESS",d)},"MercuryServerRequests")}),this.__getForAsyncRequest(c).$6.handleUpdate(a)};c.$17=function(a){var b=this.__getForAsyncRequest(a);b.handleThreadInfoError(a)};c.$18=function(a){var b=this.__getForAsyncRequest(a);b.handleThreadInfoError(a,!0)};c.$9=function(a){var b=this.__getForAsyncRequest(a.getRequest());b.handleSendMessageError(a)};c.$10=function(a){var b=this.__getForAsyncRequest(a.getRequest());b.handleSendMessageTransportError(a)};c.$11=function(a){var b=this.__getForAsyncRequest(a);b.handleSendMessageTimeout(a)};c.$12=function(){var a=this,c,d=null;b("MercuryServerRequestsConfig").msgrRegion&&(d={name:"X-MSGR-Region",value:b("MercuryServerRequestsConfig").msgrRegion});c=(c={},c[b("MercuryServerURIs").THREAD_INFO]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_DEFERRED_MULTI,customHeader:d,batch_function:o,handler:function(b,c){return a.__handleUpdate(b,c)},error_handler:function(b){return a.$17(b.getRequest())},timeout_handler:function(b){return a.$18(b)},timeout:m},c[b("MercuryServerURIs").MARK_FOLDER_READ]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").CHANGE_READ_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(c,d){a.__handleUpdate(c,d);var e=(c.threads||[]).map(function(a){return a&&a.thread_id});b("MercuryMessagingLightswitch").guard(function(){k.log("response_change_read_status",JSON.stringify({threads:e}))})}},c[b("MercuryServerURIs").MARK_SEEN]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:r,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").THREADLIST_INFO]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:d,batch_function:q,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").MARK_SPAM]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").UNMARK_SPAM]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").UNREAD_THREADS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE_UNIQUE,customHeader:d,batch_function:p,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").CHANGE_ARCHIVED_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:t,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").CHANGE_PINNED_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:t,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").CHANGE_PAGE_FOLLOW_UP_STATUS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:t,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").DELETE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:v,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").DELETE_MESSAGES]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").DELIVERY_RECEIPTS]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").MOVE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").BATCH_SUCCESSIVE,customHeader:d,batch_function:u,handler:function(b,c){return a.__handleUpdate(b,c)}},c[b("MercuryServerURIs").CHANGE_MUTE_THREAD]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}},c);var e=b("XMercuryUnseenThreadIDsController").getURIBuilder().getURI().toString();c[e]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}};e=b("XMessagingChangeMentionsMuteModeController").getURIBuilder().getURI().toString();c[e]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}};e=b("XMessagingChangeReactionsMuteModeController").getURIBuilder().getURI().toString();c[e]={request_user_id:this.$1,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:d,handler:function(b,c){return a.__handleUpdate(b,c)}};b("MercuryServerDispatcher").registerEndpoints(c)};c.__sendRequest=function(a,c,d){if(this.$8)switch(a){case b("MercuryServerURIs").THREADLIST_INFO:case b("MercuryServerURIs").THREAD_INFO:c.cachius_min_seq_id=this.$8.getLastSeqID();break;default:break}b("MercuryServerDispatcher").trySend(a,c,d,this.$1)};c.__getFBID=function(){return this.$1};return a}();e.exports=a;var w=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercuryThreadIDMap",["KeyedCallbackManager","MercuryAssert","MercuryIDs","MercurySingletonProvider"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a,this.$2=new(b("KeyedCallbackManager"))(),this.$3=new(b("KeyedCallbackManager"))()}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.setServerIDToClientID=function(a,b){var c=this.getClientIDFromServerIDNow(a);if(c)return;this.forceSetServerIDToClientID(a,b)};c.forceSetServerIDToClientID=function(a,b){this.$2.setResource(a,b),this.$3.setResource(b,a)};c.setDeprecatedServerIDToClientID=function(a,b){a&&this.$2.setResource(a,b)};c.getClientIDFromServerIDNow=function(a){return this.$2.getResource(a)};c.getClientIDFromServerID=function(a,b){var c=this;this.$2.executeOrEnqueue(a,b);d(["MercuryServerRequests"],function(b){b.getForFBID(c.$1).ensureThreadIsFetched(a)})};c.getServerIDFromClientIDNow=function(a){return this.$3.getResource(a)};c.getServerIDFromClientID=function(a,c){var e=this;b("MercuryAssert").isThreadID(a);var f=this.$3.executeOrEnqueue(a,c);d(["MercuryServerRequests"],function(c){var d=e.$3.getUnavailableResources(f),g=b("MercuryIDs").tokenize(a);d.length&&g.type!="root"&&c.getForFBID(e.$1).fetchThreadData(d)})};c.hasClientIDForServerID=function(a){return!!this.getClientIDFromServerIDNow(a)};c.convertThreadIDIfAvailable=function(a){var b=this.getClientIDFromServerIDNow(a);return b||a};c.canLinkExternally=function(a){b("MercuryAssert").isThreadID(a);var c=b("MercuryIDs").tokenize(a);return c.type=="user"||!!this.getServerIDFromClientIDNow(a)};c.reset=function(){this.$3.reset(),this.$2.reset()};return a}();e.exports=a;var g=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercuryLoggingHelper",[],(function(a,b,c,d,e,f){a={obfuscateThread:function(a){var b=babelHelpers["extends"]({},a);a&&a.snippet&&a.snippet.length>0&&(b.snippet="*** [redacted] ***");return b},obfuscateMessage:function(a){var b=babelHelpers["extends"]({},a);a&&a.body&&a.body.length>0&&(b.body="*** [redacted] ***");return b}};e.exports=a}),null);
__d("MercuryServerSendMessageQueueSimulatedError",["AsyncRequest","AsyncResponse"],(function(a,b,c,d,e,f){var g=9999;a={create:function(a){a=new(b("AsyncRequest"))(this.endpoint_uri).setData({message_batch:[a],client:this.client});var c=new(b("AsyncResponse"))(a,{});Object.assign(c,{error:g,silentError:!1,transientError:!0,request:a});return c}};e.exports=a}),null);
__d("XMessagingSendController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/messaging/send/",{privacy_mutation_token:{type:"String"}})}),null);
__d("MercuryServerSendMessageQueue",["fbt","ChatReliabilityInstrumentation","CurrentUser","LogHistory","MercuryIDs","MercuryLoggingHelper","MercuryMessagingLightswitch","MercuryServerDispatcher","MercuryServerRequestsConfig","MercuryServerSendMessageQueueSimulatedError","MercurySyncDeltaHandler","MessengerAttachmentTransformerForSend.bs","MessengerObjectAssociationType","MessengerState.bs","ODS","Run","XMessagingSendController"],(function(a,b,c,d,e,f,g){"use strict";var h=b("LogHistory").getInstance("mercury_server_send_message_queue");a=function(){function a(a,c,d,e){var f=this;this.pending_message=null;this.queue=[];this.$6=function(){return f.queue.length||f.pending_message?g._("Vous n\u2019avez pas encore envoy\u00e9 votre message. Voulez-vous quitter sans envoyer\u00a0?"):void 0};this.sender_id=a;this.queue_id=c;this.$2=d.success_handler;this.$1=d.error_handler;this.$4=d.transport_error_handler;this.$3=d.timeout_handler;this.$5=b("MercurySyncDeltaHandler").getForFBID(this.sender_id);this.client=e;b("Run").onBeforeUnload(this.$6,!1);a=null;b("MercuryServerRequestsConfig").msgrRegion&&(a={name:"X-MSGR-Region",value:b("MercuryServerRequestsConfig").msgrRegion});c=this.__getSendURI();c=(e={},e[c]={request_user_id:this.sender_id,endpoint_id:this.queue_id,mode:b("MercuryServerDispatcher").IMMEDIATE,customHeader:a,handler:this.handleSuccess.bind(this),error_handler:this.handleError.bind(this),transport_error_handler:this.handleTransportError.bind(this),timeout:d.timeout,timeout_handler:this.handleTimeout.bind(this),connection_retries:d.connection_retries},e);b("MercuryServerDispatcher").registerEndpoints(c)}var c=a.prototype;c.__getSendURI=function(){return b("XMessagingSendController").getURIBuilder().getURI().toString()};c.__preparePayload=function(a){var c;c=(c=a)!=null?(c=c.replied_to_message)!=null?(c=c.message)!=null?c.message_id:c:c:c;var d=null,e=a.client_thread_id;if(b("MercuryIDs").isLocalThread(e)){e=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),e);if(e&&e.message_count===1&&e.object_association_type===b("MessengerObjectAssociationType").GENERAL_CHAT){d=(e=e)!=null?(e=e.associated_object)!=null?e.id:e:e}}e=c?b("MessengerState.bs").getServerMessageID(b("CurrentUser").getID(),c):null;return{client:this.client,action_type:a.action_type,app_id:a.app_id,audio_ids:a.audio_ids,body:a.body,client_thread_id:a.client_thread_id,ephemeral_ttl_mode:a.ephemeral_ttl_mode,file_ids:a.file_ids,gif_ids:a.gif_ids,has_attachment:a.has_attachment,image_ids:a.image_ids,location_attachment:a.location_attachment,lightweight_action_attachment:a.lightweight_action_attachment,log_message_data:a.log_message_data,log_message_type:a.log_message_type,message_id:a.message_id,message_source_data:a.message_source_data,montage_reply_data:a.montage_reply_data,offline_threading_id:a.offline_threading_id,other_user_fbid:a.other_user_fbid,photo_fbids:a.photo_fbids,shareable_attachment:a.shareable_attachment,signature_id:a.signatureID,source:a.source,specific_to_list:a.specific_to_list,sticker_id:a.sticker_id,tags:a.tags,thread_fbid:a.thread_fbid,timestamp:a.timestamp,ui_push_phase:a.ui_push_phase,video_ids:a.video_ids,platform_xmd:a.platform_xmd,profile_xmd:a.profile_xmd,replied_to_message_id:e,work_synced_group_id:d,to_list_md5:a.to_list_md5,mib_direct_message_data:a.mib_direct_message_data}};c.enqueue=function(a){this.queue.push(a),this.$7()};c.$7=function(){if(this.pending_message||!this.queue.length){this.pending_message&&this.$8();return}this.pending_message=this.queue.shift();var a=this.__preparePayload(this.pending_message);for(var c in a)(a[c]===void 0||a[c]===null)&&delete a[c];if(!a.action_type){var d=b("MercuryLoggingHelper").obfuscateMessage(a);b("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller");b("MercuryMessagingLightswitch").guard(function(){h.debug("missing_action_type",JSON.stringify(d))})}if(!a.message_id){var e=b("MercuryLoggingHelper").obfuscateMessage(a);b("ChatReliabilityInstrumentation").logERROR("missing action type before sending to send controller"+JSON.stringify(e));b("MercuryMessagingLightswitch").guard(function(){h.debug("missing_message_id",JSON.stringify(e))})}this.$9();b("MercuryServerDispatcher").trySend(this.__getSendURI(),a,null,this.sender_id,this.queue_id)};c.$10=function(){while(this.queue.length)this.$11(this.queue.shift())};c.$11=function(a){var c=this;this.$1(b("MercuryServerSendMessageQueueSimulatedError").create(a));b("MercuryMessagingLightswitch").guard(function(){h.error("mark_as_failed",JSON.stringify({fbid:c.sender_id,queue_id:c.queue_id,message:b("MercuryLoggingHelper").obfuscateMessage(a)}))})};c.handleSuccess=function(a,c){var d=this;this.pending_message=null;var e=(a.actions||[]).map(function(a){var c=babelHelpers["extends"]({},a);if(a.graphql_payload&&a.graphql_payload.length>0){var e=b("MessengerAttachmentTransformerForSend.bs").transform(d.sender_id,a.graphql_payload,a.message_id,a.for_page);c=Object.assign(c,{attachments:e})}e=(e=a)!=null?(e=e.log_message_data)!=null?e.graphql_image:e:e;if(e){e=b("MessengerAttachmentTransformerForSend.bs").transform(d.sender_id,[e],a.message_id,a.for_page);c=Object.assign(c,{log_message_data:{image:e[0]}})}return c});a.actions=e;this.resumeAfterSuccess(a,c)};c.resumeAfterSuccess=function(a,b){this.$2(a,b),this.$12(),this.$7()};c.handleError=function(a){this.pending_message=null,this.$12(),this.$1(a),this.$10()};c.handleTransportError=function(a){this.pending_message=null,this.$12(),this.$4(a),this.$10()};c.handleTimeout=function(a){this.pending_message=null,this.$12(),this.$3(a),this.$10()};c.$9=function(){this.$5.pause()};c.$12=function(){this.$5.resume()};c.$8=function(){var a=this;b("MercuryMessagingLightswitch").guard(function(){h.debug("maybe_send_next_pending_message",JSON.stringify({fbid:a.sender_id,queue_id:a.queue_id,pending_message:b("MercuryLoggingHelper").obfuscateMessage(a.pending_message),queue:a.queue.map(function(a){return b("MercuryLoggingHelper").obfuscateMessage(a)})}))});var c="send_queue.delayed.queue_length."+this.queue.length.toString();b("ODS").bumpEntityKey(3303,"chat.web",c)};return a}();e.exports=a}),null);
__d("MercurySingletonMixin",["CurrentUser"],(function(a,b,c,d,e,f){a={_getInstances:function(){this._instances||(this._instances={});return this._instances},get:function(){return this.getForFBID(b("CurrentUser").getID())},getForFBID:function(a){var b=this._getInstances();b[a]||(b[a]=new this(a));return b[a]}};e.exports=a}),null);
__d("MercuryServerSendMessageQueueRouter",["LogHistory","MercuryServerSendMessageQueue","MercurySingletonMixin","ODS"],(function(a,b,c,d,e,f){var g=b("LogHistory").getInstance("mercury_server_send_message_queue_router"),h="chat.web.send_queue_router";b("ODS").setEntitySample(h,.1);a=function(){function a(a){this.queues=new Map(),this.fbid=a}var c=a.prototype;c.enqueue=function(a,c,d,e){var f=this.queues.get(a);f===void 0&&(f=new(b("MercuryServerSendMessageQueue"))(this.fbid,a,c,d),this.queues.set(a,f),g.debug("added queue",JSON.stringify({fbid:this.fbid,queue_id:a})),b("ODS").bumpEntityKey(3303,h,"new_queue"));f.enqueue(e)};return a}();e.exports=a;Object.assign(a,b("MercurySingletonMixin"))}),null);
__d("MercurySyncDataFetcherImpl",["invariant","Promise","AsyncResponse","Bootloader","CurrentUser","FBIDCheck","MercuryConfig","MercuryThreadlistConstants","MessagingConfig","UserActivity","clearTimeout","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";f.fetchThreadlistFromGraphQL=a;f.fetchThreadFromGraphQL=c;f.fetchMessageFromGraphQL=d;var h=null,i=null,j=null,k={limit:b("MercuryThreadlistConstants").WEBMESSENGER_THREAD_COUNT+1,folder:"inbox",tags:["INBOX"],timestamp:null,filter:null,includeDeliveryReceipts:!1,includeSeqID:!0},l={};function a(a){return new(b("Promise"))(function(b,c){m(a,b,c,0)})}function m(a,c,d,e){if(!b("CurrentUser").isLoggedInNow()||e>b("MessagingConfig").syncFetchRetries){b("clearTimeout")(l[a]);d();return}var f=e===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,e);b("UserActivity").isOnTab()||(f+=b("MercuryConfig").DFFD*Math.random());b("clearTimeout")(l[a]);l[a]=b("setTimeoutAcrossTransitions")(function(){var f=!1,n=function(h){if(f)return;if(h.errors&&h.errors.length>0){var k=h.errors[0].message;if(k){var l=function(){j&&i||g(0,3650),new j().setErrorMessage(k).setEvent(i.DFF_FAILURE).setQueryParams(a).log()};j&&i?l():b("Bootloader").loadModules(["MessengerWebGraphQLTypedLogger","MessengerWebGraphQLEvent"],function(a,b){j=a,i=b,l()},"MercurySyncDataFetcherImpl")}}f=!0;m(a,c,d,e+1)},o=function(){if(!b("CurrentUser").isLoggedInNow())return;h||g(0,3651);h.fetchAll(a,[k],!b("FBIDCheck").isUser_deprecated(a),"dff").then(function(d){f=!0,c(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},d,{payload_source:"server_invalidate_global_state"}))),b("clearTimeout")(l[a])},n)};h?o():b("Bootloader").loadModules(["MessengerGraphQLThreadlistFetcher.bs"],function(a){h=a,o()},"MercurySyncDataFetcherImpl")},f)}function c(a,c,d){return new(b("Promise"))(function(b,e){n(a,c,d,b,e,0)})}function n(a,c,d,e,f,g){if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;n(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerThreadDFFFetcher.bs"],function(f){return f.fetch_(a,{id:c,limit:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a,{payload_source:"server_invalidate_thread_state"})))},i)},"MercurySyncDataFetcherImpl")},h)}function d(a,c,d){return new(b("Promise"))(function(b,e){o(a,c,d,b,e,0)})}function o(a,c,d,e,f,g){if(g>b("MessagingConfig").syncFetchRetries){f();return}var h=g===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,g);b("setTimeoutAcrossTransitions")(function(){var h=!1,i=function(b){if(h)return;h=!0;o(a,c,d,e,f,g+1)};b("Bootloader").loadModules(["MessengerMessageDFFFetcher.bs"],function(f){return f.fetch_(a,{thread_id:c,message_id:d},!b("FBIDCheck").isUser_deprecated(a)).then(function(a){h=!0,e(new(b("AsyncResponse"))(null,babelHelpers["extends"]({},a)))},i)},"MercurySyncDataFetcherImpl")},h)}}),null);
__d("MercurySyncDataFetcher",["Promise","LogHistory","MercurySyncDataFetcherImpl","MessagingConfig","WebGraphQLConfig","clearTimeout","promiseDone","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";f.getMaxTimeoutMs=a;f.fetchThreadlistFromGraphQL=c;f.fetchThreadFromGraphQL=d;f.fetchMessageFromGraphQL=e;var g=b("LogHistory").getInstance("mercury_sync_data_fetcher");function a(){var a=0;for(var c=0;c<b("MessagingConfig").syncFetchRetries;c++){var d=c===0?0:b("MessagingConfig").syncFetchInitialTimeoutMs*Math.pow(b("MessagingConfig").syncFetchTimeoutMultiplier,c);a+=d+b("MessagingConfig").syncFetchRequestTimeoutMs}return a}var h=a();function c(a){var c=null;return new(b("Promise"))(function(d,e){var f=function(a){g.error("fetch_threadlist_graphql_timeout",JSON.stringify({timeout:h})),b("clearTimeout")(c),e(a)};c=b("setTimeoutAcrossTransitions")(f,Math.max(h,b("WebGraphQLConfig").timeout*b("MessagingConfig").syncFetchRetries));b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchThreadlistFromGraphQL(a),function(a){b("clearTimeout")(c),d(a)},f)})}function d(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_thread_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchThreadFromGraphQL(a,c,d),function(a){b("clearTimeout")(j),e(a)},i)})}function e(a,c,d){return new(b("Promise"))(function(e,f){var i=function(a){g.error("fetch_message_graphql_timeout",JSON.stringify({timeout:h})),f(a)},j=b("setTimeoutAcrossTransitions")(i,h);b("promiseDone")(b("MercurySyncDataFetcherImpl").fetchMessageFromGraphQL(a,c,d),function(a){b("clearTimeout")(j),e(a)},i)})}}),null);
__d("MercurySyncDFFDataFetcher",["Promise","CurrentUser","MercurySingletonProvider","MercurySyncDataFetcher","MercuryThreadIDMap","MessengerState.bs"],(function(a,b,c,d,e,f){"use strict";a=function(){function a(a){this.$1=a,this.__threadIDMap=b("MercuryThreadIDMap").getForFBID(this.$1)}a.getForFBID=function(a){return g.getForFBID(a)};a.get=function(){return g.get()};var c=a.prototype;c.fetchInvalidateGlobalStateForGraphQL=function(){return this.$1&&this.$1!=="0"&&b("CurrentUser").isLoggedIn()?b("MercurySyncDataFetcher").fetchThreadlistFromGraphQL(this.$1):new(b("Promise"))(function(a,b){return b(!0)})};c.fetchInvalidateThreadState=function(a,c){var d=11,e=3;a=a||c;c=this.__threadIDMap.getClientIDFromServerIDNow(a);if(!c)return b("Promise").resolve({getPayload:function(){return{}}});e=e+b("MessengerState.bs").getCurrentlyLoadedMessages(this.$1,c).length;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchThreadFromGraphQL(this.$1,a,Math.max(e,d))};c.fetchInvalidateMessage=function(a,c,d){a=a||c;return!a?b("Promise").resolve({getPayload:function(){return{}}}):b("MercurySyncDataFetcher").fetchMessageFromGraphQL(this.$1,a,d)};return a}();e.exports=a;var g=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercurySyncTopicType",[],(function(a,b,c,d,e,f){a=Object.freeze({DELTA:"delta",DELTAFLOW:"deltaflow",DELTAFLOWREJECT:"deltaflowreject"});e.exports=a}),null);
__d("onAfterLoadSafe",["Run","TimeSlice","requestIdleCallback"],(function(a,b,c,d,e,f){"use strict";e.exports=a;function a(a){return b("TimeSlice").guard(function(){return b("Run").onAfterLoad(function(){b("requestIdleCallback")(a)})},"delayed after load",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()}}),null);
__d("MercurySyncDeltaHandler",["invariant","Arbiter","Bootloader","ChatReliabilityInstrumentation","CurrentUser","LogHistory","MercuryDelayedDispatcher","MercuryMessagingLightswitch","MercuryServerPayloadPreprocessor","MercurySingletonProvider","MercurySyncConstants","MercurySyncDeltaHolder","MercurySyncDeltaTypes","MercurySyncEventsProxy","MercurySyncForcedFetchHandler","MercurySyncHolesTypedLogger","MercurySyncTopicType","MercuryThreadIDMap","MessengerDeltaTransformer.bs","gkx","onAfterLoadSafe","performanceAbsoluteNow","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i=b("LogHistory").getInstance("mercury_sync_delta_handler"),j="app_id:219994525426954";a=function(){a.getForFBID=function(a){return k.getForFBID(a)};a.get=function(){return k.get()};function a(a){var c=this;this.$1=a;this.$2=b("MercurySyncForcedFetchHandler").getForFBID(this.$1);this.__payloadPreprocessor=b("MercuryServerPayloadPreprocessor").getForFBID(this.$1);this.__delayedDispatcher=b("MercuryDelayedDispatcher").getForFBID(this.$1);this.$3=b("MercurySyncDeltaHolder").getForFBID(this.$1);this.$4=0;this.$11=b("MercuryThreadIDMap").getForFBID(this.$1);this.$5=[];this.$10=b("MercurySyncEventsProxy").getForFBID(this.$1);b("MercuryMessagingLightswitch").guard(function(){i.debug("constructor",JSON.stringify({fbid:c.$1}))});b("Arbiter").subscribe(b("MercurySyncEventsProxy").Events.INIT,function(d,e){b("MercuryMessagingLightswitch").guard(function(){i.debug("initSeqID",JSON.stringify(e))});d=e&&e.seqID;var a=e&&e.fbid;if(!a)return;if(a!==c.$1)return;d?c.$3.updateLastSeqID(d):c.$3.updateLastSeqID(0);c.$12();b("gkx")("678667")&&b("onAfterLoadSafe")(function(){b("Bootloader").loadModules(["MessengerSyncSeqIDSanityCheck"],function(a){a.getForFBID(c.$1).init()},"MercurySyncDeltaHandler")})})}var c=a.prototype;c.$12=function(){var a=this;b("MercuryMessagingLightswitch").guard(function(){i.debug("setUpSubscriptionsToRealTimeUpdates",JSON.stringify({fbid:a.$1}))});this.$6=b("Arbiter").subscribe(this.$10.getArbiterType(b("MercurySyncEventsProxy").Events.DELTA),function(c,d){c=d&&d.obj&&d.obj.queue;if(c&&c.toString()!==a.$1)return;c=d&&d.obj&&d.obj.delta;d=d&&d.obj&&d.obj.iseq;if(!c||!d)return;a.$13(d,b("MercurySyncTopicType").DELTA);a.$14(d,c);a.$3.push(d,c);a.$15()});this.$8=b("Arbiter").subscribe(this.$10.getArbiterType(b("MercurySyncEventsProxy").Events.FLOW_REJECT),function(b,c){b=c&&c.obj&&c.obj.queue;if(b&&b.toString()!==a.$1)return;a.$9&&a.$16()});this.$7=b("Arbiter").subscribe(this.$10.getArbiterType(b("MercurySyncEventsProxy").Events.FAKE_DFF),function(b,c){b=c&&c.obj&&c.obj.queue;if(b&&b.toString()!==a.$1)return;b=c&&c.obj&&c.obj.delta;if(!b)return;if(a.$17(b))if(a.$5.some(function(b){return a.$17(b)}))return;else a.$5.push(b);else a.$5.push(b);a.$15()});this.$9=!0};c.$17=function(a){return a["class"]===b("MercurySyncDeltaTypes").ForcedFetch&&!a.threadKey&&!a.messageId};c.$15=function(){if(this.$4>0)return;if(this.$5.length>0){var a=this.$5.shift();this.$18(this.$3.getLastSeqID(),a);this.$15()}a=this.$3.peek();if(!a)return;a=a-this.$3.getLastSeqID();if(a===1){var b=this.$3.pop();if(!b)return;var c=b.seqID;b=b.delta;this.$18(c,b);this.$15()}else a>1?this.$19():(this.$3.pop(),this.$15())};c.$18=function(a,c){c.numNoOps&&c.numNoOps>1?this.$3.updateLastSeqID(a+c.numNoOps-1):this.$3.updateLastSeqID(a),c["class"]===b("MercurySyncDeltaTypes").ForcedFetch?(b("MercuryMessagingLightswitch").guard(function(){i.debug("DFF",JSON.stringify(c))}),c.threadKey!==void 0&&c.messageId===void 0?this.$20(a,c):c.threadKey!==void 0&&c.messageId!==void 0?this.$21(a,c):(b("ChatReliabilityInstrumentation").logDFF_DELTA_INIT(JSON.stringify(c)),this.$22(a))):b("MessengerDeltaTransformer.bs").transform(this.$1,c)};c.$19=function(){var a=JSON.stringify({$23:this.$3.getLastSeqID(),nextSeqID:this.$3.peek()});b("MercuryMessagingLightswitch").guard(function(){i.warn("hole",a)});var c=this.$3.peek();!c&&g(0,5132);c=c-1;b("ChatReliabilityInstrumentation").logDFF_HOLE_INIT(a);this.$22(c)};c.$24=function(a,c,d,e){var f=this;this.$4&&g(0,5134);this.$4++;b("MercuryMessagingLightswitch").guard(function(){i.debug("_scheduleDataFetch:start",JSON.stringify({seqID:a}))});b("promiseDone")(c(),function(c){b("MercuryMessagingLightswitch").guard(function(){i.debug("_scheduleDataFetch:success",JSON.stringify({seqID:a}))}),f.$4--,d(a,c),f.$15()},function(c){b("MercuryMessagingLightswitch").guard(function(){i.error("_scheduleDataFetch:failure",JSON.stringify({seqID:a}))}),f.$4--,e(a,c),f.$15()})};c.emergencyDFF=function(a,b){this.$22(0,a,b)};c.$22=function(a,c,d){var e=this;if(!b("CurrentUser").isLoggedInNow())return;this.$24(void 0,function(){return e.$2.processGlobalDFFForGraphQL()},function(a,d){b("gkx")("1199098")&&e.$11.reset();var f=d.getPayload();e.__payloadPreprocessor.handleUpdate(f);f.sequence_id&&(b("MercuryMessagingLightswitch").guard(function(){i.debug("_initiateGlobalDFF:success",JSON.stringify({seqID:f.sequence_id}))}),b("gkx")("678668")?e.$3.updateLastSeqIDAndClearHistory(f.sequence_id):e.$3.updateLastSeqID(f.sequence_id));b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RECOVER);c&&c(f.sequence_id)},function(f,g){b("MercuryMessagingLightswitch").guard(function(){i.error("_initiateGlobalDFF:failure","")}),g?(e.$9&&e.$16(),d&&d()):(b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE_RETRY),b("MercuryMessagingLightswitch").guard(function(){i.debug("_initiateGlobalDFF:retry","")}),e.$22(a,c,d))})};c.$20=function(a,c){var d=this;this.$24(a,function(){return d.$2.processThreadDFF(a,c.threadKey,c.isLazy)},function(a,b){d.__payloadPreprocessor.handleUpdate(b.getPayload()),d.$3.updateLastSeqID(a)},function(){b("MercuryMessagingLightswitch").guard(function(){i.error("_initiateThreadDFF:failure",JSON.stringify(c))});var e=babelHelpers["extends"]({},c);delete e.threadKey;d.$3.updateLastSeqID(a-1);d.$3.push(a,e)})};c.$21=function(a,c){var d=this;this.$24(a,function(){return d.$2.processMessageDFF(a,c.threadKey,c.messageId,c.isLazy)},function(a,b){b=b.getPayload();var c=b.other_user_fbid?b.other_user_fbid:b.thread_fbid;b=[babelHelpers["extends"]({},b)];var e="client_channel_message";d.__delayedDispatcher.handleUpdateWaitForThread({actions:b,payload_source:e},c);d.$3.updateLastSeqID(a)},function(){b("MercuryMessagingLightswitch").guard(function(){i.error("_initiateMessageDFF:failure",JSON.stringify(c))});var e=babelHelpers["extends"]({},c);delete e.messageId;d.$3.updateLastSeqID(a-1);d.$3.push(a,e)})};c.$13=function(a,c){var d=a-this.$3.getLastSeqID();if(d!==1&&d!==0){if(!b("CurrentUser").isEmployee())return;new(b("MercurySyncHolesTypedLogger"))().setSeqID(a).setDifference(d).setTopicType(c).log()}};c.$14=function(a,c){switch(c["class"]){case b("MercurySyncDeltaTypes").NewMessage:var d=(h||(h=b("performanceAbsoluteNow")))();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(a,e){var f=c.messageMetadata.tags;Array.isArray(f)&&f.includes(j)&&b("MercuryMessagingLightswitch").guard(function(){a.markerEnd(e.SEND_MESSAGE,"SUCCESS",c.messageMetadata.offlineThreadingId,d)})},"MercurySyncDeltaHandler");b("MercuryMessagingLightswitch").guard(function(){i.debug("message_delta",JSON.stringify({seqID:a,threadKey:c.messageMetadata.threadKey,messageId:c.messageMetadata.messageId}))});break;case b("MercurySyncDeltaTypes").ReadReceipt:b("MercuryMessagingLightswitch").guard(function(){i.debug("read_receipt_delta",JSON.stringify({seqID:a,threadKey:c.threadKey,actionTimestampMs:c.actionTimestampMs,watermarkTimestampMs:c.watermarkTimestampMs}))});break;case b("MercurySyncDeltaTypes").DeliveryReceipt:b("MercuryMessagingLightswitch").guard(function(){i.debug("delivery_receipt_delta",JSON.stringify({seqID:a,deliveredWatermarkTimestampMs:c.deliveredWatermarkTimestampMs,messageIds:c.messageIds}))});break}};c.pause=function(){this.$4++};c.resume=function(){this.$4--,this.$15()};c.$16=function(a){a===void 0&&(a=!1),this.$9=!1,b("Arbiter").unsubscribe(this.$6),b("Arbiter").unsubscribe(this.$7),b("Arbiter").unsubscribe(this.$8),a||b("Arbiter").inform(b("MercurySyncConstants").ARBITER_EVENT_INVALID_STATE)};return a}();e.exports=a;var k=new(b("MercurySingletonProvider"))(a)}),null);
__d("MercurySyncForcedFetchHandler",["Promise","MercurySingletonProvider","MercurySyncDFFDataFetcher","MercuryThreadIDMap","MessengerState.bs"],(function(a,b,c,d,e,f){"use strict";function g(a){return{getPayload:function(){return{sequence_id:a}}}}a=function(){a.getForFBID=function(a){return h.getForFBID(a)};a.get=function(){return h.get()};function a(a){this.$1=a,this.$2=b("MercuryThreadIDMap").getForFBID(this.$1),this.$3=b("MercurySyncDFFDataFetcher").getForFBID(this.$1)}var c=a.prototype;c.processMessageDFF=function(a,c,d,e){if(e){e=c.otherUserFbId!==void 0?c.otherUserFbId.toString():c.threadFbId.toString();e=this.$2.getClientIDFromServerIDNow(e);if(e===void 0)return b("Promise").resolve(g(a));e=b("MessengerState.bs").getMessagesFromIDs(this.$1,[d]);if(e.length===0)return b("Promise").resolve(g(a))}return this.$3.fetchInvalidateMessage(c.otherUserFbId,c.threadFbId,d)};c.processThreadDFF=function(a,c,d){if(d){d=c.otherUserFbId!==void 0?c.otherUserFbId.toString():c.threadFbId.toString();d=this.$2.getClientIDFromServerIDNow(d);if(d===void 0)return b("Promise").resolve(g(a))}return this.$3.fetchInvalidateThreadState(c.otherUserFbId,c.threadFbId)};c.processGlobalDFFForGraphQL=function(){return this.$3.fetchInvalidateGlobalStateForGraphQL()};return a}();e.exports=a;var h=new(b("MercurySingletonProvider"))(a)}),null);
__d("MontageDispatcher",["ExplicitRegistrationDispatcher"],(function(a,b,c,d,e,f){"use strict";a=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.apply(this,arguments)||this}return b}(b("ExplicitRegistrationDispatcher"));c=new a({strict:!1});e.exports=c}),null);
__d("MontageActions",["Bootloader","CurrentUser","MercuryServerPayloadPreprocessor","MontageDispatcher","WebGraphQL","keyMirror","promiseDone","uniqueID"],(function(a,b,c,d,e,f){"use strict";f.requestUpdate=a;f.montageThreadChanged=c;f.hasUpdated=d;f.loadMontageThreadForActor=e;f.deleteMontage=i;f.handleNewMontageDelta=j;f.updatePollStickerChoice=k;var g=b("keyMirror")({REQUEST_UPDATE:null,HAS_UPDATED:null,HANDLE_ACTION:null});f.Types=g;var h=new Set();function a(a){b("MontageDispatcher").dispatch({type:g.REQUEST_UPDATE,threadFBID:a})}function c(a,c){b("MontageDispatcher").dispatch({type:g.REQUEST_UPDATE,threadFBID:a})}function d(a){b("MontageDispatcher").dispatch({type:g.HAS_UPDATED,threadFBID:a})}function e(a){if(h.has(a))return;h.add(a);b("Bootloader").loadModules(["MessengerMontageThreadQueryWebGraphQLQuery"],function(c){c=b("WebGraphQL").exec(new c({id:a}));b("promiseDone")(c,function(c){b("MercuryServerPayloadPreprocessor").getForFBID(b("CurrentUser").getID()).handleUpdate({current_montage_thread:c}),h["delete"](a)})},"MontageActions")}function i(a,c){b("MercuryServerPayloadPreprocessor").getForFBID(b("CurrentUser").getID()).handleUpdate({montage_delete_message_delta:c})}function j(a,c){b("Bootloader").loadModules(["MessengerNewMontageMessageWebGraphQLQuery"],function(a){a=b("WebGraphQL").exec(new a({id:c.message_fbid}));b("promiseDone")(a,function(a){b("MercuryServerPayloadPreprocessor").getForFBID(b("CurrentUser").getID()).handleUpdate({montage_new_message_delta:a.montage_message})})},"MontageActions")}function k(a){b("Bootloader").loadModules(["MessengerState.bs","MessengerMontagePollVoteMutationWebGraphQLMutation"],function(c,d){b("MercuryServerPayloadPreprocessor").getForFBID(b("CurrentUser").getID()).handleUpdate({montage_poll_sticker_vote:[a]});c=b("WebGraphQL").exec(new d({input:{client_mutation_id:b("uniqueID")(),story_card_poll_id:a.pollID,option:a.optionVotedIndex,actor_id:b("CurrentUser").getID()}}));b("promiseDone")(c,function(a){},function(a){})},"MontageActions")}}),null);
__d("RemovedMessageTombstoneContent",["fbt","CurrentUser","GenderConst","IntlVariations","MercuryIDs","MessengerParticipants.bs","MessengerState.bs","gkx","immutable"],(function(a,b,c,d,e,f,g){"use strict";f.getRemovedMessageTombstoneContent=a;f.getTombstoneContentForSnippet=c;f._getFbtForCurrentViewerAuthor=d;f._getFbtForOtherAuthor=e;f._getFbtForUnknownAuthor=h;function a(a,c){var d;d=((d=a.unsender)==null?void 0:d.id)||a.author;var e=b("MercuryIDs").getUserIDFromParticipantID(d),f=b("CurrentUser").getID();if(e===f)return this._getFbtForCurrentViewerAuthor();f=b("MessengerState.bs").getThreadMetaNow(f,a.thread_id);f=f==null?void 0:(f=f.custom_nickname)==null?void 0:f[e];f=f||((e=c.get(d))==null?void 0:e.short_name)||((f=a.unsender)==null?void 0:f.short_name)||((e=a.unsender)==null?void 0:e.name);e=(a=c.get(d))==null?void 0:a.gender;if(f)return this._getFbtForOtherAuthor(f,e);else return this._getFbtForUnknownAuthor()}function c(a){if(a==null)return this._getFbtForUnknownAuthor().toString();var c=b("MercuryIDs").getUserIDFromParticipantID(a);if(c===b("CurrentUser").getID())return this._getFbtForCurrentViewerAuthor().toString();c=b("MessengerParticipants.bs").getNow(a);a=c&&c.short_name;c=c&&c.gender;if(a)return this._getFbtForOtherAuthor(a,c).toString();else return this._getFbtForUnknownAuthor().toString()}function d(){return b("gkx")("1531920")?g._("Vous avez retir\u00e9 un message"):g._("Vous avez supprim\u00e9 un message")}function e(a,c){return b("gkx")("1531920")?g._({"*":"{name} a retir\u00e9 un message"},[g._param("name",a,[1,c===b("GenderConst").FEMALE_SINGULAR?b("IntlVariations").GENDER_FEMALE:b("IntlVariations").GENDER_MALE])]):g._({"*":"{name} a supprim\u00e9 un message"},[g._param("name",a,[1,c===b("GenderConst").FEMALE_SINGULAR?b("IntlVariations").GENDER_FEMALE:b("IntlVariations").GENDER_MALE])])}function h(){return b("gkx")("1531920")?g._("Un contact a retir\u00e9 un message"):g._("Un contact a supprim\u00e9 un message")}}),null);